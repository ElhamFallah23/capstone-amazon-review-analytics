[0m07:01:42.561967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dbfd0>]}


============================== 07:01:42.564824 | 2f323e27-fac6-4261-93ea-91e7329348b1 ==============================
[0m07:01:42.564824 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:01:42.565150 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt', 'printer_width': '80', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'fail_fast': 'False', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None'}
[0m07:01:42.573806 [info ] [MainThread]: dbt version: 1.11.3
[0m07:01:42.574025 [info ] [MainThread]: python version: 3.10.19
[0m07:01:42.574187 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:01:42.574343 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:01:42.574685 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 1
  ------------------------------
  1  | AWSTemplateFormatVersion: "2010-09-09"capstone_amazon_profile:
  2  | target: dev
  3  | outputs:
  4  | 
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 1, column 39
[0m07:01:42.576668 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.03243442, "process_in_blocks": "0", "process_kernel_time": 0.124905, "process_mem_max_rss": "108380160", "process_out_blocks": "0", "process_user_time": 0.674725}
[0m07:01:42.576921 [debug] [MainThread]: Command `dbt debug` failed at 07:01:42.576875 after 0.03 seconds
[0m07:01:42.577094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d0970>]}
[0m07:01:42.577279 [debug] [MainThread]: Flushing usage events
[0m07:01:43.040616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:06:10.988396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730ff40>]}


============================== 07:06:10.991359 | 21d52dc3-a8f4-4475-b455-33a41702f7d4 ==============================
[0m07:06:10.991359 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:06:10.991682 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m07:06:11.000295 [info ] [MainThread]: dbt version: 1.11.3
[0m07:06:11.000529 [info ] [MainThread]: python version: 3.10.19
[0m07:06:11.000693 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:06:11.000847 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:06:11.001190 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 1
  ------------------------------
  1  | AWSTemplateFormatVersion: "2010-09-09"capstone_amazon_profile:
  2  | target: dev
  3  | outputs:
  4  | 
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 1, column 39
[0m07:06:11.003094 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.032970168, "process_in_blocks": "0", "process_kernel_time": 0.125207, "process_mem_max_rss": "107872256", "process_out_blocks": "0", "process_user_time": 0.658286}
[0m07:06:11.003345 [debug] [MainThread]: Command `dbt debug` failed at 07:06:11.003295 after 0.03 seconds
[0m07:06:11.003523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fc9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fc8e0>]}
[0m07:06:11.003711 [debug] [MainThread]: Flushing usage events
[0m07:06:11.531522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:07:01.894340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aebc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aebfd0>]}


============================== 07:07:01.897359 | 824296a0-7574-4632-84e0-a89948b90264 ==============================
[0m07:07:01.897359 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:07:01.897688 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt', 'invocation_command': 'dbt debug', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'None', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False'}
[0m07:07:01.906328 [info ] [MainThread]: dbt version: 1.11.3
[0m07:07:01.906547 [info ] [MainThread]: python version: 3.10.19
[0m07:07:01.906710 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:07:01.906866 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:07:01.907205 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 1
  ------------------------------
  1  | AWSTemplateFormatVersion: "2010-09-09"capstone_amazon_profile:
  2  | target: dev
  3  | outputs:
  4  | 
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 1, column 39
[0m07:07:01.909120 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.03238246, "process_in_blocks": "0", "process_kernel_time": 0.121237, "process_mem_max_rss": "107544576", "process_out_blocks": "0", "process_user_time": 0.659543}
[0m07:07:01.909365 [debug] [MainThread]: Command `dbt debug` failed at 07:07:01.909316 after 0.03 seconds
[0m07:07:01.909543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd8970>]}
[0m07:07:01.909729 [debug] [MainThread]: Flushing usage events
[0m07:07:02.366303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:08:56.439734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108688c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109764430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109764580>]}


============================== 07:08:56.443605 | a8a74cbe-1a94-4da6-814c-ab8f0c21db21 ==============================
[0m07:08:56.443605 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:08:56.443951 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'empty': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'debug': 'False', 'quiet': 'False', 'printer_width': '80'}
[0m07:08:56.452268 [info ] [MainThread]: dbt version: 1.11.3
[0m07:08:56.452485 [info ] [MainThread]: python version: 3.10.19
[0m07:08:56.452651 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:08:56.452808 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:08:56.454580 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:08:56.454760 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:08:56.454915 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:08:56.487770 [info ] [MainThread]: Configuration:
[0m07:08:56.488067 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m07:08:56.488232 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m07:08:56.488384 [info ] [MainThread]: Required dependencies:
[0m07:08:56.488580 [debug] [MainThread]: Executing "git --help"
[0m07:08:56.501817 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:08:56.502434 [debug] [MainThread]: STDERR: "b''"
[0m07:08:56.502630 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:08:56.502811 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:08:56.503036 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:08:56.503196 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'capstone_amazon_profile'


[0m07:08:56.503356 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['sources']: None is not of type 'object'

Error encountered in /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml


[0m07:08:56.505472 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.11011725, "process_in_blocks": "0", "process_kernel_time": 0.126251, "process_mem_max_rss": "109953024", "process_out_blocks": "0", "process_user_time": 0.721791}
[0m07:08:56.505765 [debug] [MainThread]: Command `dbt debug` failed at 07:08:56.505708 after 0.11 seconds
[0m07:08:56.506038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108688c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109002a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971c0d0>]}
[0m07:08:56.506295 [debug] [MainThread]: Flushing usage events
[0m07:08:57.048999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:09:37.490463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bec400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bec550>]}


============================== 07:09:37.494091 | 82ef857e-d0d8-4865-b3cf-1148dc697c2d ==============================
[0m07:09:37.494091 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:09:37.494450 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m07:09:37.502760 [info ] [MainThread]: dbt version: 1.11.3
[0m07:09:37.502986 [info ] [MainThread]: python version: 3.10.19
[0m07:09:37.503153 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:09:37.503312 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:09:37.505083 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:09:37.505253 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:09:37.505405 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:09:37.537149 [info ] [MainThread]: Configuration:
[0m07:09:37.537408 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m07:09:37.537563 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m07:09:37.537710 [info ] [MainThread]: Required dependencies:
[0m07:09:37.537909 [debug] [MainThread]: Executing "git --help"
[0m07:09:37.553469 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:09:37.554116 [debug] [MainThread]: STDERR: "b''"
[0m07:09:37.554351 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:09:37.554555 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:09:37.554788 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:09:37.554943 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'capstone_amazon_profile'


[0m07:09:37.555098 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['sources']: None is not of type 'object'

Error encountered in /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml


[0m07:09:37.557382 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.10859025, "process_in_blocks": "0", "process_kernel_time": 0.127024, "process_mem_max_rss": "111951872", "process_out_blocks": "0", "process_user_time": 0.724261}
[0m07:09:37.557886 [debug] [MainThread]: Command `dbt debug` failed at 07:09:37.557814 after 0.11 seconds
[0m07:09:37.558270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdf760>]}
[0m07:09:37.558620 [debug] [MainThread]: Flushing usage events
[0m07:09:38.049153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:11:39.230126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bec610>]}


============================== 07:11:39.233882 | 91ab6e2d-c088-408f-9ed8-6c55d9f312d8 ==============================
[0m07:11:39.233882 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:11:39.234211 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None'}
[0m07:11:39.242796 [info ] [MainThread]: dbt version: 1.11.3
[0m07:11:39.243014 [info ] [MainThread]: python version: 3.10.19
[0m07:11:39.243176 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:11:39.243332 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:11:39.245028 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:11:39.245213 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:11:39.245369 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:11:39.277774 [info ] [MainThread]: Configuration:
[0m07:11:39.278083 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m07:11:39.278246 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m07:11:39.278404 [info ] [MainThread]: Required dependencies:
[0m07:11:39.278606 [debug] [MainThread]: Executing "git --help"
[0m07:11:39.292013 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:11:39.292614 [debug] [MainThread]: STDERR: "b''"
[0m07:11:39.292818 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:11:39.293001 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:11:39.293231 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:11:39.293392 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'capstone_amazon_profile'


[0m07:11:39.293552 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['sources']: None is not of type 'object'

Error encountered in /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml


[0m07:11:39.295719 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.11320508, "process_in_blocks": "0", "process_kernel_time": 0.131044, "process_mem_max_rss": "111214592", "process_out_blocks": "0", "process_user_time": 0.743737}
[0m07:11:39.296074 [debug] [MainThread]: Command `dbt debug` failed at 07:11:39.296006 after 0.11 seconds
[0m07:11:39.296365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba7a00>]}
[0m07:11:39.296615 [debug] [MainThread]: Flushing usage events
[0m07:11:39.820624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:56.768525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ecbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac8610>]}


============================== 07:16:56.772399 | 62b14484-45bf-405a-9ac4-0b7be035a77e ==============================
[0m07:16:56.772399 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:16:56.772729 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/elham/.dbt', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m07:16:56.781050 [info ] [MainThread]: dbt version: 1.11.3
[0m07:16:56.781265 [info ] [MainThread]: python version: 3.10.19
[0m07:16:56.781428 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:16:56.781582 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:16:56.783326 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:16:56.783504 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:16:56.783658 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:16:56.816248 [info ] [MainThread]: Configuration:
[0m07:16:56.816606 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m07:16:56.816776 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m07:16:56.816927 [info ] [MainThread]: Required dependencies:
[0m07:16:56.817129 [debug] [MainThread]: Executing "git --help"
[0m07:16:56.830054 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:16:56.830674 [debug] [MainThread]: STDERR: "b''"
[0m07:16:56.830898 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:16:56.831087 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:16:56.831327 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:16:56.831486 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'capstone_amazon_profile'


[0m07:16:56.831646 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('+materialized', '+schema', 'capstone_amazon_analytics', 'marts', 'staging' were unexpected)

Error encountered in /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml


[0m07:16:56.833456 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.10929409, "process_in_blocks": "0", "process_kernel_time": 0.126997, "process_mem_max_rss": "110723072", "process_out_blocks": "0", "process_user_time": 0.721703}
[0m07:16:56.833807 [debug] [MainThread]: Command `dbt debug` failed at 07:16:56.833734 after 0.11 seconds
[0m07:16:56.834092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ecbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f7520>]}
[0m07:16:56.834336 [debug] [MainThread]: Flushing usage events
[0m07:16:57.355456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:20:47.010473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c14b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf04f0>]}


============================== 07:20:47.014021 | 99bb1fea-80f3-402a-bbd9-dce7af4dabac ==============================
[0m07:20:47.014021 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:20:47.014344 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m07:20:47.022608 [info ] [MainThread]: dbt version: 1.11.3
[0m07:20:47.022842 [info ] [MainThread]: python version: 3.10.19
[0m07:20:47.023013 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:20:47.023183 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:20:47.024840 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:20:47.025005 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:20:47.025156 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:20:47.057192 [info ] [MainThread]: Configuration:
[0m07:20:47.057478 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m07:20:47.057648 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m07:20:47.057797 [info ] [MainThread]: Required dependencies:
[0m07:20:47.058013 [debug] [MainThread]: Executing "git --help"
[0m07:20:47.071495 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:20:47.072093 [debug] [MainThread]: STDERR: "b''"
[0m07:20:47.072288 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:20:47.072470 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:20:47.072693 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:20:47.072852 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'capstone_amazon_profile'


[0m07:20:47.073018 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('+materialized', 'capstone_amazon_analytics', 'marts', 'staging' were unexpected)

Error encountered in /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml


[0m07:20:47.075140 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.10830317, "process_in_blocks": "0", "process_kernel_time": 0.127887, "process_mem_max_rss": "111329280", "process_out_blocks": "0", "process_user_time": 0.723809}
[0m07:20:47.075507 [debug] [MainThread]: Command `dbt debug` failed at 07:20:47.075445 after 0.11 seconds
[0m07:20:47.075791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c14b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c77c40>]}
[0m07:20:47.076060 [debug] [MainThread]: Flushing usage events
[0m07:20:47.616957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:25:34.779337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bc520>]}


============================== 07:25:34.783264 | 432711e3-0874-4cda-9a77-7c6064b07fc6 ==============================
[0m07:25:34.783264 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:25:34.783624 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'no_print': 'None', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m07:25:34.793710 [info ] [MainThread]: dbt version: 1.11.3
[0m07:25:34.793955 [info ] [MainThread]: python version: 3.10.19
[0m07:25:34.794129 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:25:34.794292 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:25:34.796136 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:25:34.796314 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:25:34.796467 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:25:34.858520 [info ] [MainThread]: Configuration:
[0m07:25:34.858858 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m07:25:34.859031 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:25:34.859185 [info ] [MainThread]: Required dependencies:
[0m07:25:34.859382 [debug] [MainThread]: Executing "git --help"
[0m07:25:34.880279 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:25:34.880976 [debug] [MainThread]: STDERR: "b''"
[0m07:25:34.881223 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:25:34.881443 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:25:34.881725 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:25:34.881916 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'capstone_amazon_profile'


[0m07:25:34.884355 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1545152, "process_in_blocks": "0", "process_kernel_time": 0.13584, "process_mem_max_rss": "111263744", "process_out_blocks": "0", "process_user_time": 0.80722}
[0m07:25:34.884832 [debug] [MainThread]: Command `dbt debug` failed at 07:25:34.884750 after 0.16 seconds
[0m07:25:34.885189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102942e90>]}
[0m07:25:34.885468 [debug] [MainThread]: Flushing usage events
[0m07:25:35.395218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:37:34.298785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104510c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ec400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ec550>]}


============================== 07:37:34.302413 | 6a4fdad5-4187-46c9-bfce-2d0ee6b39209 ==============================
[0m07:37:34.302413 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:37:34.302781 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt debug'}
[0m07:37:34.310976 [info ] [MainThread]: dbt version: 1.11.3
[0m07:37:34.311190 [info ] [MainThread]: python version: 3.10.19
[0m07:37:34.311351 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:37:34.311505 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:37:34.513813 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:37:34.514119 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:37:34.514297 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:37:34.544986 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:37:34.545243 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:37:34.545409 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:37:34.545739 [info ] [MainThread]: adapter type: snowflake
[0m07:37:34.545936 [info ] [MainThread]: adapter version: 1.11.1
[0m07:37:34.598285 [info ] [MainThread]: Configuration:
[0m07:37:34.598598 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:37:34.598762 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:37:34.598908 [info ] [MainThread]: Required dependencies:
[0m07:37:34.599108 [debug] [MainThread]: Executing "git --help"
[0m07:37:34.618985 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:37:34.619563 [debug] [MainThread]: STDERR: "b''"
[0m07:37:34.619772 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:37:34.619964 [info ] [MainThread]: Connection:
[0m07:37:34.620166 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m07:37:34.620316 [info ] [MainThread]:   user: MOHAMMAD
[0m07:37:34.620461 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m07:37:34.620602 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m07:37:34.620741 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m07:37:34.620878 [info ] [MainThread]:   schema: RAW
[0m07:37:34.621014 [info ] [MainThread]:   authenticator: jwt
[0m07:37:34.621156 [info ] [MainThread]:   oauth_client_id: None
[0m07:37:34.621289 [info ] [MainThread]:   query_tag: None
[0m07:37:34.621427 [info ] [MainThread]:   client_session_keep_alive: False
[0m07:37:34.621564 [info ] [MainThread]:   host: None
[0m07:37:34.621697 [info ] [MainThread]:   port: None
[0m07:37:34.621828 [info ] [MainThread]:   proxy_host: None
[0m07:37:34.622058 [info ] [MainThread]:   proxy_port: None
[0m07:37:34.622255 [info ] [MainThread]:   protocol: None
[0m07:37:34.622413 [info ] [MainThread]:   connect_retries: 1
[0m07:37:34.622559 [info ] [MainThread]:   connect_timeout: None
[0m07:37:34.622701 [info ] [MainThread]:   retry_on_database_errors: False
[0m07:37:34.622843 [info ] [MainThread]:   retry_all: False
[0m07:37:34.622979 [info ] [MainThread]:   insecure_mode: False
[0m07:37:34.623115 [info ] [MainThread]:   reuse_connections: True
[0m07:37:34.623251 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m07:37:34.623388 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m07:37:34.623771 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:37:34.688156 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m07:37:34.716208 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:37:34.716478 [debug] [MainThread]: On debug: select 1 as id
[0m07:37:34.716652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:34.716921 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m07:37:34.717083 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m07:37:34.717273 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:37:34.717468 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:37:34.717624 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '.../public_private_key_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:37:34.720790 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.46448678, "process_in_blocks": "0", "process_kernel_time": 0.202941, "process_mem_max_rss": "139804672", "process_out_blocks": "0", "process_user_time": 0.936565}
[0m07:37:34.721345 [debug] [MainThread]: Command `dbt debug` failed at 07:37:34.721282 after 0.47 seconds
[0m07:37:34.721551 [debug] [MainThread]: Connection 'debug' was left open.
[0m07:37:34.721709 [debug] [MainThread]: On debug: No close available on handle
[0m07:37:34.721894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104510c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106433040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c6fb0>]}
[0m07:37:34.722114 [debug] [MainThread]: Flushing usage events
[0m07:37:35.240974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:42.746005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060dcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bec430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bec580>]}


============================== 08:51:42.749931 | 4e75480e-e872-4a67-834c-9665f25a6a28 ==============================
[0m08:51:42.749931 [info ] [MainThread]: Running with dbt=1.11.3
[0m08:51:42.750294 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'empty': 'None', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'profiles_dir': '/Users/elham/.dbt', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m08:51:42.758093 [info ] [MainThread]: dbt version: 1.11.3
[0m08:51:42.758312 [info ] [MainThread]: python version: 3.10.19
[0m08:51:42.758476 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m08:51:42.758631 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m08:51:42.952188 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:51:42.952499 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:51:42.952678 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:51:42.983389 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m08:51:42.983658 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m08:51:42.983828 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m08:51:42.984144 [info ] [MainThread]: adapter type: snowflake
[0m08:51:42.984341 [info ] [MainThread]: adapter version: 1.11.1
[0m08:51:43.037137 [info ] [MainThread]: Configuration:
[0m08:51:43.037457 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:51:43.037618 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:51:43.037767 [info ] [MainThread]: Required dependencies:
[0m08:51:43.037967 [debug] [MainThread]: Executing "git --help"
[0m08:51:43.052166 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:51:43.052986 [debug] [MainThread]: STDERR: "b''"
[0m08:51:43.053281 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:51:43.053483 [info ] [MainThread]: Connection:
[0m08:51:43.053697 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m08:51:43.053850 [info ] [MainThread]:   user: MOHAMMAD
[0m08:51:43.054002 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m08:51:43.054143 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m08:51:43.054282 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m08:51:43.054423 [info ] [MainThread]:   schema: RAW
[0m08:51:43.054560 [info ] [MainThread]:   authenticator: jwt
[0m08:51:43.054697 [info ] [MainThread]:   oauth_client_id: None
[0m08:51:43.054839 [info ] [MainThread]:   query_tag: None
[0m08:51:43.054974 [info ] [MainThread]:   client_session_keep_alive: False
[0m08:51:43.055113 [info ] [MainThread]:   host: None
[0m08:51:43.055247 [info ] [MainThread]:   port: None
[0m08:51:43.055382 [info ] [MainThread]:   proxy_host: None
[0m08:51:43.055519 [info ] [MainThread]:   proxy_port: None
[0m08:51:43.055657 [info ] [MainThread]:   protocol: None
[0m08:51:43.055801 [info ] [MainThread]:   connect_retries: 1
[0m08:51:43.055938 [info ] [MainThread]:   connect_timeout: None
[0m08:51:43.056075 [info ] [MainThread]:   retry_on_database_errors: False
[0m08:51:43.056211 [info ] [MainThread]:   retry_all: False
[0m08:51:43.056343 [info ] [MainThread]:   insecure_mode: False
[0m08:51:43.056484 [info ] [MainThread]:   reuse_connections: True
[0m08:51:43.056626 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m08:51:43.056760 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m08:51:43.057162 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m08:51:43.120385 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m08:51:43.146864 [debug] [MainThread]: Using snowflake connection "debug"
[0m08:51:43.147119 [debug] [MainThread]: On debug: select 1 as id
[0m08:51:43.147284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:43.147567 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m08:51:43.147754 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m08:51:43.147948 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m08:51:43.148124 [info ] [MainThread]: [31m1 check failed:[0m
[0m08:51:43.148282 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '../public_private_key_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m08:51:43.150561 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44653833, "process_in_blocks": "0", "process_kernel_time": 0.191804, "process_mem_max_rss": "139591680", "process_out_blocks": "0", "process_user_time": 0.938442}
[0m08:51:43.151127 [debug] [MainThread]: Command `dbt debug` failed at 08:51:43.151062 after 0.45 seconds
[0m08:51:43.151346 [debug] [MainThread]: Connection 'debug' was left open.
[0m08:51:43.151505 [debug] [MainThread]: On debug: No close available on handle
[0m08:51:43.151700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060dcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b40eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107388fa0>]}
[0m08:51:43.151916 [debug] [MainThread]: Flushing usage events
[0m08:51:43.609397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:10.511176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ec430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ec580>]}


============================== 08:55:10.514860 | 66262b27-07d8-46d3-bb07-604f3cc48ac1 ==============================
[0m08:55:10.514860 [info ] [MainThread]: Running with dbt=1.11.3
[0m08:55:10.515235 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt debug'}
[0m08:55:10.523471 [info ] [MainThread]: dbt version: 1.11.3
[0m08:55:10.523690 [info ] [MainThread]: python version: 3.10.19
[0m08:55:10.523857 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m08:55:10.524015 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m08:55:10.725613 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:55:10.725957 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:55:10.726130 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:55:10.757335 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m08:55:10.757607 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m08:55:10.757776 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m08:55:10.758079 [info ] [MainThread]: adapter type: snowflake
[0m08:55:10.758235 [info ] [MainThread]: adapter version: 1.11.1
[0m08:55:10.811422 [info ] [MainThread]: Configuration:
[0m08:55:10.811744 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:55:10.811908 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:55:10.812054 [info ] [MainThread]: Required dependencies:
[0m08:55:10.812253 [debug] [MainThread]: Executing "git --help"
[0m08:55:10.837363 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:55:10.838212 [debug] [MainThread]: STDERR: "b''"
[0m08:55:10.838458 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:55:10.838670 [info ] [MainThread]: Connection:
[0m08:55:10.838898 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m08:55:10.839055 [info ] [MainThread]:   user: MOHAMMAD
[0m08:55:10.839203 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m08:55:10.839343 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m08:55:10.839481 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m08:55:10.839616 [info ] [MainThread]:   schema: RAW
[0m08:55:10.839749 [info ] [MainThread]:   authenticator: jwt
[0m08:55:10.839882 [info ] [MainThread]:   oauth_client_id: None
[0m08:55:10.840017 [info ] [MainThread]:   query_tag: None
[0m08:55:10.840154 [info ] [MainThread]:   client_session_keep_alive: False
[0m08:55:10.840290 [info ] [MainThread]:   host: None
[0m08:55:10.840423 [info ] [MainThread]:   port: None
[0m08:55:10.840555 [info ] [MainThread]:   proxy_host: None
[0m08:55:10.840689 [info ] [MainThread]:   proxy_port: None
[0m08:55:10.840827 [info ] [MainThread]:   protocol: None
[0m08:55:10.840996 [info ] [MainThread]:   connect_retries: 1
[0m08:55:10.841198 [info ] [MainThread]:   connect_timeout: None
[0m08:55:10.841355 [info ] [MainThread]:   retry_on_database_errors: False
[0m08:55:10.841499 [info ] [MainThread]:   retry_all: False
[0m08:55:10.841637 [info ] [MainThread]:   insecure_mode: False
[0m08:55:10.841776 [info ] [MainThread]:   reuse_connections: True
[0m08:55:10.841910 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m08:55:10.842046 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m08:55:10.842445 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m08:55:10.905793 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m08:55:10.933306 [debug] [MainThread]: Using snowflake connection "debug"
[0m08:55:10.933630 [debug] [MainThread]: On debug: select 1 as id
[0m08:55:10.933833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:10.934091 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m08:55:10.934248 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m08:55:10.934430 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m08:55:10.934612 [info ] [MainThread]: [31m1 check failed:[0m
[0m08:55:10.934770 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '..../public_private_key_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m08:55:10.936592 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.46819216, "process_in_blocks": "0", "process_kernel_time": 0.204894, "process_mem_max_rss": "139886592", "process_out_blocks": "0", "process_user_time": 0.942537}
[0m08:55:10.937063 [debug] [MainThread]: Command `dbt debug` failed at 08:55:10.936999 after 0.47 seconds
[0m08:55:10.937273 [debug] [MainThread]: Connection 'debug' was left open.
[0m08:55:10.937427 [debug] [MainThread]: On debug: No close available on handle
[0m08:55:10.937609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110844eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107088fa0>]}
[0m08:55:10.937838 [debug] [MainThread]: Flushing usage events
[0m08:55:11.479647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:21.346247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106024c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100580>]}


============================== 08:55:21.350042 | a8c82f85-ee98-49de-b893-ac54274f532c ==============================
[0m08:55:21.350042 [info ] [MainThread]: Running with dbt=1.11.3
[0m08:55:21.350380 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'None', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:21.358116 [info ] [MainThread]: dbt version: 1.11.3
[0m08:55:21.358343 [info ] [MainThread]: python version: 3.10.19
[0m08:55:21.358510 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m08:55:21.358672 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m08:55:21.555425 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:55:21.555745 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:55:21.555926 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:55:21.586497 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m08:55:21.586765 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m08:55:21.586934 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m08:55:21.587273 [info ] [MainThread]: adapter type: snowflake
[0m08:55:21.587470 [info ] [MainThread]: adapter version: 1.11.1
[0m08:55:21.640420 [info ] [MainThread]: Configuration:
[0m08:55:21.640735 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:55:21.640906 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:55:21.641061 [info ] [MainThread]: Required dependencies:
[0m08:55:21.641263 [debug] [MainThread]: Executing "git --help"
[0m08:55:21.655023 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:55:21.655681 [debug] [MainThread]: STDERR: "b''"
[0m08:55:21.655891 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:55:21.656080 [info ] [MainThread]: Connection:
[0m08:55:21.656285 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m08:55:21.656433 [info ] [MainThread]:   user: MOHAMMAD
[0m08:55:21.656583 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m08:55:21.656729 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m08:55:21.656950 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m08:55:21.657164 [info ] [MainThread]:   schema: RAW
[0m08:55:21.657334 [info ] [MainThread]:   authenticator: jwt
[0m08:55:21.657487 [info ] [MainThread]:   oauth_client_id: None
[0m08:55:21.657635 [info ] [MainThread]:   query_tag: None
[0m08:55:21.657781 [info ] [MainThread]:   client_session_keep_alive: False
[0m08:55:21.657925 [info ] [MainThread]:   host: None
[0m08:55:21.658065 [info ] [MainThread]:   port: None
[0m08:55:21.658207 [info ] [MainThread]:   proxy_host: None
[0m08:55:21.658349 [info ] [MainThread]:   proxy_port: None
[0m08:55:21.658489 [info ] [MainThread]:   protocol: None
[0m08:55:21.658628 [info ] [MainThread]:   connect_retries: 1
[0m08:55:21.658767 [info ] [MainThread]:   connect_timeout: None
[0m08:55:21.658903 [info ] [MainThread]:   retry_on_database_errors: False
[0m08:55:21.659042 [info ] [MainThread]:   retry_all: False
[0m08:55:21.659179 [info ] [MainThread]:   insecure_mode: False
[0m08:55:21.659311 [info ] [MainThread]:   reuse_connections: True
[0m08:55:21.659446 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m08:55:21.659581 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m08:55:21.659978 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m08:55:21.722224 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m08:55:21.748743 [debug] [MainThread]: Using snowflake connection "debug"
[0m08:55:21.749001 [debug] [MainThread]: On debug: select 1 as id
[0m08:55:21.749157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:21.749400 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m08:55:21.749544 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m08:55:21.749715 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m08:55:21.749887 [info ] [MainThread]: [31m1 check failed:[0m
[0m08:55:21.750043 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: './public_private_key_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m08:55:21.751800 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44604537, "process_in_blocks": "0", "process_kernel_time": 0.180444, "process_mem_max_rss": "139182080", "process_out_blocks": "0", "process_user_time": 0.947897}
[0m08:55:21.752362 [debug] [MainThread]: Command `dbt debug` failed at 08:55:21.752268 after 0.45 seconds
[0m08:55:21.752592 [debug] [MainThread]: Connection 'debug' was left open.
[0m08:55:21.752752 [debug] [MainThread]: On debug: No close available on handle
[0m08:55:21.752951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106024c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d54eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699cfa0>]}
[0m08:55:21.753185 [debug] [MainThread]: Flushing usage events
[0m08:55:22.201270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:52.603052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075683a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075684f0>]}


============================== 09:32:52.606815 | c3a6fd0d-6788-47ad-b785-26091defe21f ==============================
[0m09:32:52.606815 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:32:52.607155 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'empty': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/elham/.dbt'}
[0m09:32:52.615148 [info ] [MainThread]: dbt version: 1.11.3
[0m09:32:52.615366 [info ] [MainThread]: python version: 3.10.19
[0m09:32:52.615530 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m09:32:52.615688 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m09:32:52.818020 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:32:52.818335 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:32:52.818511 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:32:52.851386 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m09:32:52.851710 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m09:32:52.851890 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m09:32:52.852293 [info ] [MainThread]: adapter type: snowflake
[0m09:32:52.852507 [info ] [MainThread]: adapter version: 1.11.1
[0m09:32:52.907564 [info ] [MainThread]: Configuration:
[0m09:32:52.907920 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:32:52.908089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:32:52.908241 [info ] [MainThread]: Required dependencies:
[0m09:32:52.908440 [debug] [MainThread]: Executing "git --help"
[0m09:32:52.920638 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:32:52.921296 [debug] [MainThread]: STDERR: "b''"
[0m09:32:52.921523 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:32:52.921717 [info ] [MainThread]: Connection:
[0m09:32:52.921916 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:32:52.922122 [info ] [MainThread]:   user: TERRAFORM_USER
[0m09:32:52.922357 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:32:52.922520 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:32:52.922673 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m09:32:52.922812 [info ] [MainThread]:   schema: RAW
[0m09:32:52.922951 [info ] [MainThread]:   authenticator: jwt
[0m09:32:52.923093 [info ] [MainThread]:   oauth_client_id: None
[0m09:32:52.923227 [info ] [MainThread]:   query_tag: None
[0m09:32:52.923365 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:32:52.923499 [info ] [MainThread]:   host: None
[0m09:32:52.923631 [info ] [MainThread]:   port: None
[0m09:32:52.923763 [info ] [MainThread]:   proxy_host: None
[0m09:32:52.923898 [info ] [MainThread]:   proxy_port: None
[0m09:32:52.924026 [info ] [MainThread]:   protocol: None
[0m09:32:52.924157 [info ] [MainThread]:   connect_retries: 1
[0m09:32:52.924287 [info ] [MainThread]:   connect_timeout: None
[0m09:32:52.924420 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:32:52.924552 [info ] [MainThread]:   retry_all: False
[0m09:32:52.924682 [info ] [MainThread]:   insecure_mode: False
[0m09:32:52.924814 [info ] [MainThread]:   reuse_connections: True
[0m09:32:52.924945 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m09:32:52.925080 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m09:32:52.925441 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:32:52.987875 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:32:53.014993 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:32:53.015255 [debug] [MainThread]: On debug: select 1 as id
[0m09:32:53.015409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:53.015659 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m09:32:53.015811 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m09:32:53.015989 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:32:53.016170 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:32:53.016328 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: './public_private_key_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:32:53.018071 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.45521522, "process_in_blocks": "0", "process_kernel_time": 0.192526, "process_mem_max_rss": "139837440", "process_out_blocks": "0", "process_user_time": 0.943778}
[0m09:32:53.018523 [debug] [MainThread]: Command `dbt debug` failed at 09:32:53.018464 after 0.46 seconds
[0m09:32:53.018710 [debug] [MainThread]: Connection 'debug' was left open.
[0m09:32:53.018864 [debug] [MainThread]: On debug: No close available on handle
[0m09:32:53.019055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106704550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826ee30>]}
[0m09:32:53.019280 [debug] [MainThread]: Flushing usage events
[0m09:32:53.458715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:38.221358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ec430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ec580>]}


============================== 09:41:38.225113 | 6297ab24-6f3b-4c17-a49a-ce777c55114c ==============================
[0m09:41:38.225113 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:41:38.225461 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/elham/.dbt', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m09:41:38.234127 [info ] [MainThread]: dbt version: 1.11.3
[0m09:41:38.234339 [info ] [MainThread]: python version: 3.10.19
[0m09:41:38.234504 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m09:41:38.234661 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m09:41:38.439832 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:41:38.440147 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:41:38.440328 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:41:38.471098 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m09:41:38.471370 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m09:41:38.471542 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m09:41:38.471859 [info ] [MainThread]: adapter type: snowflake
[0m09:41:38.472020 [info ] [MainThread]: adapter version: 1.11.1
[0m09:41:38.524250 [info ] [MainThread]: Configuration:
[0m09:41:38.524560 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:41:38.524726 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:41:38.524873 [info ] [MainThread]: Required dependencies:
[0m09:41:38.525063 [debug] [MainThread]: Executing "git --help"
[0m09:41:38.557557 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:41:38.558182 [debug] [MainThread]: STDERR: "b''"
[0m09:41:38.558394 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:41:38.558583 [info ] [MainThread]: Connection:
[0m09:41:38.558789 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:41:38.558942 [info ] [MainThread]:   user: TERRAFORM_USER
[0m09:41:38.559090 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:41:38.559240 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:41:38.559378 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:41:38.559514 [info ] [MainThread]:   schema: RAW
[0m09:41:38.559690 [info ] [MainThread]:   authenticator: jwt
[0m09:41:38.559923 [info ] [MainThread]:   oauth_client_id: None
[0m09:41:38.560171 [info ] [MainThread]:   query_tag: None
[0m09:41:38.560369 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:41:38.560533 [info ] [MainThread]:   host: None
[0m09:41:38.560681 [info ] [MainThread]:   port: None
[0m09:41:38.560825 [info ] [MainThread]:   proxy_host: None
[0m09:41:38.560969 [info ] [MainThread]:   proxy_port: None
[0m09:41:38.561108 [info ] [MainThread]:   protocol: None
[0m09:41:38.561247 [info ] [MainThread]:   connect_retries: 1
[0m09:41:38.561385 [info ] [MainThread]:   connect_timeout: None
[0m09:41:38.561522 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:41:38.561668 [info ] [MainThread]:   retry_all: False
[0m09:41:38.561802 [info ] [MainThread]:   insecure_mode: False
[0m09:41:38.561936 [info ] [MainThread]:   reuse_connections: True
[0m09:41:38.562075 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m09:41:38.562212 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m09:41:38.562609 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:41:38.628827 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:41:38.658354 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:41:38.658683 [debug] [MainThread]: On debug: select 1 as id
[0m09:41:38.658842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:38.659110 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m09:41:38.659266 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m09:41:38.659437 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:41:38.659611 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:41:38.659772 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '.../public_private_key_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:41:38.661829 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.48310247, "process_in_blocks": "0", "process_kernel_time": 0.202806, "process_mem_max_rss": "140361728", "process_out_blocks": "0", "process_user_time": 0.936508}
[0m09:41:38.662280 [debug] [MainThread]: Command `dbt debug` failed at 09:41:38.662223 after 0.48 seconds
[0m09:41:38.662474 [debug] [MainThread]: Connection 'debug' was left open.
[0m09:41:38.662617 [debug] [MainThread]: On debug: No close available on handle
[0m09:41:38.662796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c640eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b88fa0>]}
[0m09:41:38.663011 [debug] [MainThread]: Flushing usage events
[0m09:41:39.196719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:18.064668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113befc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113befac0>]}


============================== 10:13:18.068385 | 5487cdf1-bf92-45a3-9dac-6d7f6edf0b33 ==============================
[0m10:13:18.068385 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:13:18.068731 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'None', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m10:13:18.077597 [info ] [MainThread]: dbt version: 1.11.3
[0m10:13:18.077816 [info ] [MainThread]: python version: 3.10.19
[0m10:13:18.077983 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m10:13:18.078145 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m10:13:18.288551 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:13:18.288870 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:13:18.289050 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:13:18.320103 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m10:13:18.320381 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m10:13:18.320553 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m10:13:18.320856 [info ] [MainThread]: adapter type: snowflake
[0m10:13:18.321016 [info ] [MainThread]: adapter version: 1.11.1
[0m10:13:18.373387 [info ] [MainThread]: Configuration:
[0m10:13:18.373714 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:13:18.373879 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:13:18.374029 [info ] [MainThread]: Required dependencies:
[0m10:13:18.374221 [debug] [MainThread]: Executing "git --help"
[0m10:13:18.389240 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:13:18.389872 [debug] [MainThread]: STDERR: "b''"
[0m10:13:18.390085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:13:18.390268 [info ] [MainThread]: Connection:
[0m10:13:18.390488 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m10:13:18.390638 [info ] [MainThread]:   user: TERRAFORM_USER
[0m10:13:18.390780 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m10:13:18.390924 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m10:13:18.391061 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m10:13:18.391199 [info ] [MainThread]:   schema: RAW
[0m10:13:18.391338 [info ] [MainThread]:   authenticator: jwt
[0m10:13:18.391478 [info ] [MainThread]:   oauth_client_id: None
[0m10:13:18.391611 [info ] [MainThread]:   query_tag: None
[0m10:13:18.391749 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:13:18.391887 [info ] [MainThread]:   host: None
[0m10:13:18.392022 [info ] [MainThread]:   port: None
[0m10:13:18.392158 [info ] [MainThread]:   proxy_host: None
[0m10:13:18.392295 [info ] [MainThread]:   proxy_port: None
[0m10:13:18.392430 [info ] [MainThread]:   protocol: None
[0m10:13:18.392564 [info ] [MainThread]:   connect_retries: 1
[0m10:13:18.392701 [info ] [MainThread]:   connect_timeout: None
[0m10:13:18.392837 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:13:18.392975 [info ] [MainThread]:   retry_all: False
[0m10:13:18.393111 [info ] [MainThread]:   insecure_mode: False
[0m10:13:18.393246 [info ] [MainThread]:   reuse_connections: True
[0m10:13:18.393379 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:13:18.393513 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m10:13:18.393882 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:13:18.463252 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:13:18.494729 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:13:18.494980 [debug] [MainThread]: On debug: select 1 as id
[0m10:13:18.495129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:18.495393 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m10:13:18.495537 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m10:13:18.495702 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:13:18.495865 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:13:18.496022 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 21] Is a directory: '/Users/elham/neueFische/Capstone Project/public_private_key_snowflake'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:13:18.497828 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.47625384, "process_in_blocks": "0", "process_kernel_time": 0.205356, "process_mem_max_rss": "140099584", "process_out_blocks": "0", "process_user_time": 0.936543}
[0m10:13:18.498256 [debug] [MainThread]: Command `dbt debug` failed at 10:13:18.498201 after 0.48 seconds
[0m10:13:18.498437 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:13:18.498582 [debug] [MainThread]: On debug: No close available on handle
[0m10:13:18.498751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b2b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fbae90>]}
[0m10:13:18.498958 [debug] [MainThread]: Flushing usage events
[0m10:13:19.050329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:15.097817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108300b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dc4f0>]}


============================== 10:33:15.101559 | 843b5bc1-a4e7-4c77-9301-703dbe9ab65d ==============================
[0m10:33:15.101559 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:33:15.101876 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None'}
[0m10:33:15.110695 [info ] [MainThread]: dbt version: 1.11.3
[0m10:33:15.110917 [info ] [MainThread]: python version: 3.10.19
[0m10:33:15.111081 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m10:33:15.111238 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m10:33:15.322851 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:33:15.323157 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:33:15.323332 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:33:15.354132 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m10:33:15.354403 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m10:33:15.354574 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m10:33:15.354879 [info ] [MainThread]: adapter type: snowflake
[0m10:33:15.355039 [info ] [MainThread]: adapter version: 1.11.1
[0m10:33:15.408081 [info ] [MainThread]: Configuration:
[0m10:33:15.408406 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:33:15.408580 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:33:15.408731 [info ] [MainThread]: Required dependencies:
[0m10:33:15.408930 [debug] [MainThread]: Executing "git --help"
[0m10:33:15.425793 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:33:15.426418 [debug] [MainThread]: STDERR: "b''"
[0m10:33:15.426644 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:33:15.426832 [info ] [MainThread]: Connection:
[0m10:33:15.427042 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m10:33:15.427191 [info ] [MainThread]:   user: TERRAFORM_USER
[0m10:33:15.427338 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m10:33:15.427486 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m10:33:15.427624 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m10:33:15.427764 [info ] [MainThread]:   schema: RAW
[0m10:33:15.427901 [info ] [MainThread]:   authenticator: jwt
[0m10:33:15.428039 [info ] [MainThread]:   oauth_client_id: None
[0m10:33:15.428176 [info ] [MainThread]:   query_tag: None
[0m10:33:15.428316 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:33:15.428452 [info ] [MainThread]:   host: None
[0m10:33:15.428587 [info ] [MainThread]:   port: None
[0m10:33:15.428722 [info ] [MainThread]:   proxy_host: None
[0m10:33:15.428903 [info ] [MainThread]:   proxy_port: None
[0m10:33:15.429151 [info ] [MainThread]:   protocol: None
[0m10:33:15.429321 [info ] [MainThread]:   connect_retries: 1
[0m10:33:15.429477 [info ] [MainThread]:   connect_timeout: None
[0m10:33:15.429622 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:33:15.429766 [info ] [MainThread]:   retry_all: False
[0m10:33:15.429905 [info ] [MainThread]:   insecure_mode: False
[0m10:33:15.430040 [info ] [MainThread]:   reuse_connections: True
[0m10:33:15.430176 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:33:15.430314 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m10:33:15.430711 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:33:15.495682 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:33:15.524784 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:33:15.525063 [debug] [MainThread]: On debug: select 1 as id
[0m10:33:15.525230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:15.525605 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m10:33:15.525761 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m10:33:15.525934 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:33:15.526104 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:33:15.526267 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '/Users/elham/neueFische/Capstone Project/public_private_key_snowflake/dbt_svc_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:33:15.528041 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.47584608, "process_in_blocks": "0", "process_kernel_time": 0.200643, "process_mem_max_rss": "140328960", "process_out_blocks": "0", "process_user_time": 0.936779}
[0m10:33:15.528464 [debug] [MainThread]: Command `dbt debug` failed at 10:33:15.528408 after 0.48 seconds
[0m10:33:15.528649 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:33:15.528801 [debug] [MainThread]: On debug: No close available on handle
[0m10:33:15.528982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108300b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a222f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0319c0>]}
[0m10:33:15.529194 [debug] [MainThread]: Flushing usage events
[0m10:33:16.057027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:38.326680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b98c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74550>]}


============================== 10:35:38.330216 | 28368d39-5ec7-4bc7-9509-8694fc064d62 ==============================
[0m10:35:38.330216 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:35:38.330554 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'no_print': 'None', 'profiles_dir': '/Users/elham/.dbt', 'empty': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m10:35:38.339396 [info ] [MainThread]: dbt version: 1.11.3
[0m10:35:38.339613 [info ] [MainThread]: python version: 3.10.19
[0m10:35:38.339784 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m10:35:38.339942 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m10:35:38.546359 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:35:38.546676 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:35:38.546849 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:35:38.577874 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m10:35:38.578149 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m10:35:38.578322 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m10:35:38.578650 [info ] [MainThread]: adapter type: snowflake
[0m10:35:38.578809 [info ] [MainThread]: adapter version: 1.11.1
[0m10:35:38.631935 [info ] [MainThread]: Configuration:
[0m10:35:38.632259 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:35:38.632428 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:35:38.632578 [info ] [MainThread]: Required dependencies:
[0m10:35:38.632775 [debug] [MainThread]: Executing "git --help"
[0m10:35:38.652294 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:35:38.652900 [debug] [MainThread]: STDERR: "b''"
[0m10:35:38.653131 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:35:38.653320 [info ] [MainThread]: Connection:
[0m10:35:38.653530 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m10:35:38.653682 [info ] [MainThread]:   user: TERRAFORM_USER
[0m10:35:38.653825 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m10:35:38.653967 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m10:35:38.654112 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m10:35:38.654248 [info ] [MainThread]:   schema: RAW
[0m10:35:38.654386 [info ] [MainThread]:   authenticator: jwt
[0m10:35:38.654593 [info ] [MainThread]:   oauth_client_id: None
[0m10:35:38.654819 [info ] [MainThread]:   query_tag: None
[0m10:35:38.654981 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:35:38.655130 [info ] [MainThread]:   host: None
[0m10:35:38.655274 [info ] [MainThread]:   port: None
[0m10:35:38.655418 [info ] [MainThread]:   proxy_host: None
[0m10:35:38.655568 [info ] [MainThread]:   proxy_port: None
[0m10:35:38.655706 [info ] [MainThread]:   protocol: None
[0m10:35:38.655842 [info ] [MainThread]:   connect_retries: 1
[0m10:35:38.655985 [info ] [MainThread]:   connect_timeout: None
[0m10:35:38.656121 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:35:38.656258 [info ] [MainThread]:   retry_all: False
[0m10:35:38.656394 [info ] [MainThread]:   insecure_mode: False
[0m10:35:38.656533 [info ] [MainThread]:   reuse_connections: True
[0m10:35:38.656667 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:35:38.656802 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m10:35:38.657195 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:35:38.720761 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:35:38.750946 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:35:38.751225 [debug] [MainThread]: On debug: select 1 as id
[0m10:35:38.751386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:39.263386 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m10:35:39.263938 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m10:35:39.264338 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:35:39.264688 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:35:39.264988 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: KEMXMAE-OW63667.snowflakecomputing.com:443. Role 'ARA_TRANSFORM_DEV' specified in the connect string is not granted to this user, or is not permitted for the credentials being used. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:35:39.268842 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.9864438, "process_in_blocks": "0", "process_kernel_time": 0.210299, "process_mem_max_rss": "151404544", "process_out_blocks": "0", "process_user_time": 1.129521}
[0m10:35:39.269452 [debug] [MainThread]: Command `dbt debug` failed at 10:35:39.269334 after 0.99 seconds
[0m10:35:39.269847 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:35:39.270133 [debug] [MainThread]: On debug: No close available on handle
[0m10:35:39.270462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b98c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794efb0>]}
[0m10:35:39.270849 [debug] [MainThread]: Flushing usage events
[0m10:35:39.792350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:03.361694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103794ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873940>]}


============================== 10:45:03.365356 | 3a86f71a-d0cf-4e00-b83c-b7cc4a754bb0 ==============================
[0m10:45:03.365356 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:45:03.365692 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'empty': 'None'}
[0m10:45:03.374513 [info ] [MainThread]: dbt version: 1.11.3
[0m10:45:03.374724 [info ] [MainThread]: python version: 3.10.19
[0m10:45:03.374888 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m10:45:03.375044 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m10:45:03.585426 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:45:03.585738 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:45:03.585913 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:45:03.617187 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m10:45:03.617502 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m10:45:03.617677 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m10:45:03.618444 [info ] [MainThread]: adapter type: snowflake
[0m10:45:03.618684 [info ] [MainThread]: adapter version: 1.11.1
[0m10:45:03.676042 [info ] [MainThread]: Configuration:
[0m10:45:03.676356 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:45:03.676522 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:45:03.676667 [info ] [MainThread]: Required dependencies:
[0m10:45:03.676864 [debug] [MainThread]: Executing "git --help"
[0m10:45:03.702896 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:45:03.703505 [debug] [MainThread]: STDERR: "b''"
[0m10:45:03.703725 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:45:03.703917 [info ] [MainThread]: Connection:
[0m10:45:03.704118 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m10:45:03.704268 [info ] [MainThread]:   user: TERRAFORM_USER
[0m10:45:03.704408 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m10:45:03.704547 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m10:45:03.704685 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m10:45:03.704819 [info ] [MainThread]:   schema: RAW
[0m10:45:03.704952 [info ] [MainThread]:   authenticator: jwt
[0m10:45:03.705089 [info ] [MainThread]:   oauth_client_id: None
[0m10:45:03.705222 [info ] [MainThread]:   query_tag: None
[0m10:45:03.705359 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:45:03.705492 [info ] [MainThread]:   host: None
[0m10:45:03.705626 [info ] [MainThread]:   port: None
[0m10:45:03.705762 [info ] [MainThread]:   proxy_host: None
[0m10:45:03.705894 [info ] [MainThread]:   proxy_port: None
[0m10:45:03.706028 [info ] [MainThread]:   protocol: None
[0m10:45:03.706165 [info ] [MainThread]:   connect_retries: 1
[0m10:45:03.706301 [info ] [MainThread]:   connect_timeout: None
[0m10:45:03.706491 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:45:03.706712 [info ] [MainThread]:   retry_all: False
[0m10:45:03.706877 [info ] [MainThread]:   insecure_mode: False
[0m10:45:03.707026 [info ] [MainThread]:   reuse_connections: True
[0m10:45:03.707170 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:45:03.707310 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m10:45:03.707701 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:45:03.774546 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:45:03.802089 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:45:03.802370 [debug] [MainThread]: On debug: select 1 as id
[0m10:45:03.802607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:04.789171 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.986 seconds
[0m10:45:04.792139 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:45:04.792828 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:45:04.798395 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.483059, "process_in_blocks": "0", "process_kernel_time": 0.224315, "process_mem_max_rss": "152256512", "process_out_blocks": "0", "process_user_time": 1.160157}
[0m10:45:04.799330 [debug] [MainThread]: Command `dbt debug` succeeded at 10:45:04.799155 after 1.48 seconds
[0m10:45:04.799886 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:45:04.800247 [debug] [MainThread]: On debug: Close
[0m10:45:04.927592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103794ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fd480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b23d90>]}
[0m10:45:04.928393 [debug] [MainThread]: Flushing usage events
[0m10:45:05.435210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:23.758540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086bcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109797e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109797d30>]}


============================== 10:49:23.762139 | fe7dbd88-a1de-4019-a1f5-428bee9fa437 ==============================
[0m10:49:23.762139 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:49:23.762505 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True'}
[0m10:49:23.968190 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:49:23.968518 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:49:23.968701 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:49:24.064187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe7dbd88-a1de-4019-a1f5-428bee9fa437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d4850>]}
[0m10:49:24.094572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe7dbd88-a1de-4019-a1f5-428bee9fa437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109794e80>]}
[0m10:49:24.095119 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:49:24.166537 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:49:24.167032 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:49:24.167253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe7dbd88-a1de-4019-a1f5-428bee9fa437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a57d1b0>]}
[0m10:49:24.171805 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key database in file `models/sources/sources.yml`
[0m10:49:24.172074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fe7dbd88-a1de-4019-a1f5-428bee9fa437', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5dba90>]}
[0m10:49:24.795371 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m10:49:24.795843 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:49:24.798286 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.0828639, "process_in_blocks": "0", "process_kernel_time": 0.194798, "process_mem_max_rss": "137166848", "process_out_blocks": "0", "process_user_time": 1.536222}
[0m10:49:24.798652 [debug] [MainThread]: Command `dbt source freshness` failed at 10:49:24.798593 after 1.08 seconds
[0m10:49:24.798879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086bcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab156c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab15720>]}
[0m10:49:24.799091 [debug] [MainThread]: Flushing usage events
[0m10:49:25.340815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:14.554479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f44430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f44580>]}


============================== 10:52:14.557376 | 7126399d-a8ec-4183-b833-fa761b33fb6e ==============================
[0m10:52:14.557376 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:52:14.557746 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select stg_*'}
[0m10:52:14.769847 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:52:14.770163 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:52:14.770356 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:52:14.863133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7126399d-a8ec-4183-b833-fa761b33fb6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064caf50>]}
[0m10:52:14.893849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7126399d-a8ec-4183-b833-fa761b33fb6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880e6e0>]}
[0m10:52:14.894389 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:52:14.964711 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:52:14.965227 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:52:14.965442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7126399d-a8ec-4183-b833-fa761b33fb6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883d060>]}
[0m10:52:14.970224 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key database in file `models/sources/sources.yml`
[0m10:52:14.970480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7126399d-a8ec-4183-b833-fa761b33fb6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d007f0>]}
[0m10:52:15.564250 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m10:52:15.564707 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:52:15.567330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0564333, "process_in_blocks": "0", "process_kernel_time": 0.210218, "process_mem_max_rss": "144179200", "process_out_blocks": "0", "process_user_time": 1.54294}
[0m10:52:15.567658 [debug] [MainThread]: Command `dbt run` failed at 10:52:15.567606 after 1.06 seconds
[0m10:52:15.567884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d47f0>]}
[0m10:52:15.568097 [debug] [MainThread]: Flushing usage events
[0m10:52:16.093141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:13.914592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bc430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bc580>]}


============================== 11:27:13.918154 | 65e0259e-9637-4902-8512-f3ebc5bba87f ==============================
[0m11:27:13.918154 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:27:13.918477 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m11:27:13.983800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e0259e-9637-4902-8512-f3ebc5bba87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f69e0>]}
[0m11:27:13.994358 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.122425206, "process_in_blocks": "0", "process_kernel_time": 0.127799, "process_mem_max_rss": "111919104", "process_out_blocks": "0", "process_user_time": 0.740212}
[0m11:27:13.994623 [debug] [MainThread]: Command `dbt clean` succeeded at 11:27:13.994573 after 0.12 seconds
[0m11:27:13.994814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e72f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d9510>]}
[0m11:27:13.995000 [debug] [MainThread]: Flushing usage events
[0m11:27:14.552624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:21.110971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b4610>]}


============================== 11:27:21.114354 | 12b76ff0-9c8c-4aec-9afd-208663db035e ==============================
[0m11:27:21.114354 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:27:21.114677 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt parse', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'None', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/elham/.dbt', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:27:21.327962 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:27:21.328328 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:27:21.328517 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:27:21.418790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12b76ff0-9c8c-4aec-9afd-208663db035e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df7bb0>]}
[0m11:27:21.449929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12b76ff0-9c8c-4aec-9afd-208663db035e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614e1a0>]}
[0m11:27:21.450789 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:27:21.521479 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:27:21.522001 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:21.522230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12b76ff0-9c8c-4aec-9afd-208663db035e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626ee60>]}
[0m11:27:21.526871 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key description in file `models/sources/sources.yml`
[0m11:27:21.527153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12b76ff0-9c8c-4aec-9afd-208663db035e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f60>]}
[0m11:27:22.146916 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m11:27:22.147365 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:27:22.149690 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.0791315, "process_in_blocks": "0", "process_kernel_time": 0.167147, "process_mem_max_rss": "139165696", "process_out_blocks": "0", "process_user_time": 1.552513}
[0m11:27:22.150018 [debug] [MainThread]: Command `dbt parse` failed at 11:27:22.149965 after 1.08 seconds
[0m11:27:22.150230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742a9b0>]}
[0m11:27:22.150432 [debug] [MainThread]: Flushing usage events
[0m11:27:22.589987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:28.910334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e80c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f58550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f586a0>]}


============================== 11:27:28.913902 | 5ae5a7ff-7891-4cb5-a7c3-5abe7b830f4c ==============================
[0m11:27:28.913902 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:27:28.914232 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/Users/elham/.dbt', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt source freshness', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'None', 'use_experimental_parser': 'False'}
[0m11:27:29.093666 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:27:29.093981 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:27:29.094167 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:27:29.184094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ae5a7ff-7891-4cb5-a7c3-5abe7b830f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a4d90>]}
[0m11:27:29.214547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ae5a7ff-7891-4cb5-a7c3-5abe7b830f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f59150>]}
[0m11:27:29.215306 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:27:29.281980 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:27:29.282486 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:29.282716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ae5a7ff-7891-4cb5-a7c3-5abe7b830f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d43100>]}
[0m11:27:29.286860 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key description in file `models/sources/sources.yml`
[0m11:27:29.287109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ae5a7ff-7891-4cb5-a7c3-5abe7b830f4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d9c790>]}
[0m11:27:29.874252 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m11:27:29.874818 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:27:29.877416 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.0075141, "process_in_blocks": "0", "process_kernel_time": 0.135698, "process_mem_max_rss": "145227776", "process_out_blocks": "0", "process_user_time": 1.523521}
[0m11:27:29.877784 [debug] [MainThread]: Command `dbt source freshness` failed at 11:27:29.877732 after 1.01 seconds
[0m11:27:29.878007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e80c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d9ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e85e0>]}
[0m11:27:29.878211 [debug] [MainThread]: Flushing usage events
[0m11:27:30.337442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:47.746941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e84f0>]}


============================== 11:27:47.749643 | ca531e3e-3f3a-4492-8aec-ea4db9fbdfee ==============================
[0m11:27:47.749643 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:27:47.749983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select stg_*', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_experimental_parser': 'False'}
[0m11:27:47.949437 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:27:47.949814 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:27:47.949995 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:27:48.039515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca531e3e-3f3a-4492-8aec-ea4db9fbdfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e46ec0>]}
[0m11:27:48.069767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca531e3e-3f3a-4492-8aec-ea4db9fbdfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b64fc40>]}
[0m11:27:48.070508 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:27:48.138267 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:27:48.138766 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:48.138978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca531e3e-3f3a-4492-8aec-ea4db9fbdfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9057b0>]}
[0m11:27:48.143072 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key description in file `models/sources/sources.yml`
[0m11:27:48.143326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca531e3e-3f3a-4492-8aec-ea4db9fbdfee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8aff70>]}
[0m11:27:48.735251 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m11:27:48.735709 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:27:48.738530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0310585, "process_in_blocks": "0", "process_kernel_time": 0.169779, "process_mem_max_rss": "146817024", "process_out_blocks": "0", "process_user_time": 1.526001}
[0m11:27:48.738865 [debug] [MainThread]: Command `dbt run` failed at 11:27:48.738810 after 1.03 seconds
[0m11:27:48.739082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c782dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e000880>]}
[0m11:27:48.739286 [debug] [MainThread]: Flushing usage events
[0m11:27:49.200919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:28.834119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de86a0>]}


============================== 11:39:28.837718 | 79214132-2fb7-4f42-8fdb-517fa5f81662 ==============================
[0m11:39:28.837718 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:39:28.838057 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt source freshness', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m11:39:29.046171 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:39:29.046496 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:39:29.046676 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:39:29.140324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79214132-2fb7-4f42-8fdb-517fa5f81662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104501690>]}
[0m11:39:29.170725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79214132-2fb7-4f42-8fdb-517fa5f81662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de9150>]}
[0m11:39:29.171236 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:39:29.239168 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:39:29.239661 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:39:29.239871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79214132-2fb7-4f42-8fdb-517fa5f81662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765b100>]}
[0m11:39:29.244158 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key schema in file `models/sources/sources.yml`
[0m11:39:29.244419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '79214132-2fb7-4f42-8fdb-517fa5f81662', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b4790>]}
[0m11:39:29.838928 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m11:39:29.839389 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:39:29.841283 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.0493553, "process_in_blocks": "0", "process_kernel_time": 0.203042, "process_mem_max_rss": "146817024", "process_out_blocks": "0", "process_user_time": 1.524385}
[0m11:39:29.841655 [debug] [MainThread]: Command `dbt source freshness` failed at 11:39:29.841598 after 1.05 seconds
[0m11:39:29.841881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d005e0>]}
[0m11:39:29.842088 [debug] [MainThread]: Flushing usage events
[0m11:39:30.369494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:08.762039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d88be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e643a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e644f0>]}


============================== 11:42:08.765619 | 46e25b30-02f3-4751-b5b6-fe7aba1d6e4c ==============================
[0m11:42:08.765619 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:42:08.765944 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'empty': 'None', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/elham/.dbt'}
[0m11:42:08.832453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46e25b30-02f3-4751-b5b6-fe7aba1d6e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df3b20>]}
[0m11:42:08.843416 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12499075, "process_in_blocks": "0", "process_kernel_time": 0.127769, "process_mem_max_rss": "112492544", "process_out_blocks": "0", "process_user_time": 0.746446}
[0m11:42:08.843677 [debug] [MainThread]: Command `dbt clean` succeeded at 11:42:08.843623 after 0.13 seconds
[0m11:42:08.843869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d88be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdada0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f78760>]}
[0m11:42:08.844051 [debug] [MainThread]: Flushing usage events
[0m11:42:09.381625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:14.930814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106664b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107740520>]}


============================== 11:42:14.934325 | c95bc7b8-8fcf-4baa-a5d8-5edd491e2f36 ==============================
[0m11:42:14.934325 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:42:14.934654 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt parse', 'empty': 'None', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m11:42:15.140803 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:42:15.141120 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:42:15.141299 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:42:15.232157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c95bc7b8-8fcf-4baa-a5d8-5edd491e2f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d6290>]}
[0m11:42:15.262686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c95bc7b8-8fcf-4baa-a5d8-5edd491e2f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107007310>]}
[0m11:42:15.263597 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:42:15.331131 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:42:15.331626 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:42:15.331840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c95bc7b8-8fcf-4baa-a5d8-5edd491e2f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085245e0>]}
[0m11:42:15.336039 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key schema in file `models/sources/sources.yml`
[0m11:42:15.336294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c95bc7b8-8fcf-4baa-a5d8-5edd491e2f36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844a020>]}
[0m11:42:15.942626 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m11:42:15.943089 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:42:15.944907 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.0545526, "process_in_blocks": "0", "process_kernel_time": 0.172778, "process_mem_max_rss": "145375232", "process_out_blocks": "0", "process_user_time": 1.541111}
[0m11:42:15.945268 [debug] [MainThread]: Command `dbt parse` failed at 11:42:15.945213 after 1.05 seconds
[0m11:42:15.945491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106664b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abf3a0>]}
[0m11:42:15.945706 [debug] [MainThread]: Flushing usage events
[0m11:42:16.402720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:22.865804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a58c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b33eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b33d60>]}


============================== 11:42:22.869398 | be1e11a4-4e66-48bf-bfa5-58bb8def6e46 ==============================
[0m11:42:22.869398 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:42:22.869729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt source freshness', 'empty': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m11:42:23.053182 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:42:23.053508 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:42:23.053692 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:42:23.143966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be1e11a4-4e66-48bf-bfa5-58bb8def6e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c7cd90>]}
[0m11:42:23.174475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be1e11a4-4e66-48bf-bfa5-58bb8def6e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b30be0>]}
[0m11:42:23.175367 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:42:23.247545 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:42:23.248054 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:42:23.248280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be1e11a4-4e66-48bf-bfa5-58bb8def6e46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c49d0>]}
[0m11:42:23.252293 [warn ] [MainThread]: [[33mWARNING[0m][CustomTopLevelKeyDeprecation]: Deprecated functionality
Unexpected top-level key schema in file `models/sources/sources.yml`
[0m11:42:23.252556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be1e11a4-4e66-48bf-bfa5-58bb8def6e46', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c04c0>]}
[0m11:42:23.860375 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.stg_meta' (models/staging/stg_meta.sql) depends on a source named 'amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE' which was not found
[0m11:42:23.860828 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- CustomTopLevelKeyDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:42:23.862628 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.0392976, "process_in_blocks": "0", "process_kernel_time": 0.154108, "process_mem_max_rss": "144736256", "process_out_blocks": "0", "process_user_time": 1.546337}
[0m11:42:23.862996 [debug] [MainThread]: Command `dbt source freshness` failed at 11:42:23.862943 after 1.04 seconds
[0m11:42:23.863221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a58c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105956f50>]}
[0m11:42:23.863434 [debug] [MainThread]: Flushing usage events
[0m11:42:24.320130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:25.516326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104508c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e4580>]}


============================== 11:44:25.519908 | e7483fd6-94f2-41f7-af01-b5bfd5b82425 ==============================
[0m11:44:25.519908 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:44:25.520251 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt clean', 'introspect': 'True'}
[0m11:44:25.586317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7483fd6-94f2-41f7-af01-b5bfd5b82425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551e9e0>]}
[0m11:44:25.597005 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.122968584, "process_in_blocks": "0", "process_kernel_time": 0.126937, "process_mem_max_rss": "112017408", "process_out_blocks": "0", "process_user_time": 0.743165}
[0m11:44:25.597266 [debug] [MainThread]: Command `dbt clean` succeeded at 11:44:25.597217 after 0.12 seconds
[0m11:44:25.597461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104508c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9af20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105701ed0>]}
[0m11:44:25.597644 [debug] [MainThread]: Flushing usage events
[0m11:44:26.111039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:31.440913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106294b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073703d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107370520>]}


============================== 11:44:31.444379 | 877608eb-40c7-425c-8f31-5ae15cbff994 ==============================
[0m11:44:31.444379 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:44:31.444694 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt parse', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/Users/elham/.dbt', 'use_colors': 'True'}
[0m11:44:31.654100 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:44:31.654428 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:44:31.654609 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:44:31.745112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877608eb-40c7-425c-8f31-5ae15cbff994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970a290>]}
[0m11:44:31.775219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877608eb-40c7-425c-8f31-5ae15cbff994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c37310>]}
[0m11:44:31.775914 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:44:31.843395 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:44:31.843888 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:44:31.844105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '877608eb-40c7-425c-8f31-5ae15cbff994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098585e0>]}
[0m11:44:32.455996 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.fct_reviews' (models/marts/fct_reviews.sql) depends on a node named 'stg_amazon_reviews' which was not found
[0m11:44:32.457923 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.0560145, "process_in_blocks": "0", "process_kernel_time": 0.173381, "process_mem_max_rss": "147030016", "process_out_blocks": "0", "process_user_time": 1.538883}
[0m11:44:32.458196 [debug] [MainThread]: Command `dbt parse` failed at 11:44:32.458144 after 1.06 seconds
[0m11:44:32.458408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106294b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8b820>]}
[0m11:44:32.458612 [debug] [MainThread]: Flushing usage events
[0m11:44:32.906504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:53.846881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cacbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d87e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d87d30>]}


============================== 11:44:53.850567 | 9352d72c-52c4-4607-9c01-9b57e9a280a5 ==============================
[0m11:44:53.850567 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:44:53.850893 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'None', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt source freshness', 'warn_error': 'None'}
[0m11:44:54.053358 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:44:54.053667 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:44:54.053847 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:44:54.144647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9352d72c-52c4-4607-9c01-9b57e9a280a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c4850>]}
[0m11:44:54.175086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9352d72c-52c4-4607-9c01-9b57e9a280a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d84e80>]}
[0m11:44:54.175858 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:44:54.246350 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:44:54.246846 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:44:54.247071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9352d72c-52c4-4607-9c01-9b57e9a280a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6d1b0>]}
[0m11:44:54.872717 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.fct_reviews' (models/marts/fct_reviews.sql) depends on a node named 'stg_amazon_reviews' which was not found
[0m11:44:54.875292 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.0706633, "process_in_blocks": "0", "process_kernel_time": 0.179504, "process_mem_max_rss": "145801216", "process_out_blocks": "0", "process_user_time": 1.560644}
[0m11:44:54.875600 [debug] [MainThread]: Command `dbt source freshness` failed at 11:44:54.875545 after 1.07 seconds
[0m11:44:54.875824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cacbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a139060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8d420>]}
[0m11:44:54.876050 [debug] [MainThread]: Flushing usage events
[0m11:44:55.322465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:37.684696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cec610>]}


============================== 11:49:37.688570 | 1cddf7d2-2e2d-4fff-8da8-2880e00a31bc ==============================
[0m11:49:37.688570 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:49:37.688912 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/Users/elham/.dbt', 'log_format': 'default', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False'}
[0m11:49:37.755643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cddf7d2-2e2d-4fff-8da8-2880e00a31bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c26ec0>]}
[0m11:49:37.766633 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12797621, "process_in_blocks": "0", "process_kernel_time": 0.132087, "process_mem_max_rss": "112738304", "process_out_blocks": "0", "process_user_time": 0.745181}
[0m11:49:37.766946 [debug] [MainThread]: Command `dbt clean` succeeded at 11:49:37.766895 after 0.13 seconds
[0m11:49:37.767145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e085b0>]}
[0m11:49:37.767344 [debug] [MainThread]: Flushing usage events
[0m11:49:38.300876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:40.555480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b10bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eec610>]}


============================== 11:49:40.558532 | 3b516fa1-9220-45c0-9264-d6aa0aa91271 ==============================
[0m11:49:40.558532 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:49:40.558853 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt parse', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'profiles_dir': '/Users/elham/.dbt', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m11:49:40.783790 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:49:40.784121 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:49:40.784305 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:49:40.874083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b516fa1-9220-45c0-9264-d6aa0aa91271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652bbb0>]}
[0m11:49:40.905676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b516fa1-9220-45c0-9264-d6aa0aa91271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116821a0>]}
[0m11:49:40.906586 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:49:40.976053 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:49:40.976586 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:49:40.976811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b516fa1-9220-45c0-9264-d6aa0aa91271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11179ee60>]}
[0m11:49:41.601342 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.fct_reviews' (models/marts/fct_reviews.sql) depends on a node named 'stg_amazon_reviews' which was not found
[0m11:49:41.603126 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.0860595, "process_in_blocks": "0", "process_kernel_time": 0.16882, "process_mem_max_rss": "145391616", "process_out_blocks": "0", "process_user_time": 1.549676}
[0m11:49:41.603388 [debug] [MainThread]: Command `dbt parse` failed at 11:49:41.603337 after 1.09 seconds
[0m11:49:41.603594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b10bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129797e0>]}
[0m11:49:41.603802 [debug] [MainThread]: Flushing usage events
[0m11:49:42.042339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:48.103731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ebe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ebd30>]}


============================== 11:49:48.106733 | 9a6b1e39-f05d-436f-b8f7-cfc206865177 ==============================
[0m11:49:48.106733 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:49:48.107128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt source freshness', 'use_colors': 'True', 'empty': 'None', 'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None'}
[0m11:49:48.282073 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:49:48.282389 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:49:48.282571 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:49:48.372086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a6b1e39-f05d-436f-b8f7-cfc206865177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0850>]}
[0m11:49:48.402643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a6b1e39-f05d-436f-b8f7-cfc206865177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e8e80>]}
[0m11:49:48.403529 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:49:48.471252 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:49:48.472054 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:49:48.472449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a6b1e39-f05d-436f-b8f7-cfc206865177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd11b0>]}
[0m11:49:49.088841 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capstone_amazon_analytics.fct_reviews' (models/marts/fct_reviews.sql) depends on a node named 'stg_amazon_reviews' which was not found
[0m11:49:49.091473 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.0272118, "process_in_blocks": "0", "process_kernel_time": 0.142087, "process_mem_max_rss": "146407424", "process_out_blocks": "0", "process_user_time": 1.540909}
[0m11:49:49.091777 [debug] [MainThread]: Command `dbt source freshness` failed at 11:49:49.091725 after 1.03 seconds
[0m11:49:49.091993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b1060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f05420>]}
[0m11:49:49.092200 [debug] [MainThread]: Flushing usage events
[0m11:49:49.547242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:43.534152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108154bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922c610>]}


============================== 11:51:43.537780 | 283fe9bc-3f96-4809-a57b-dcfdec1a4c5a ==============================
[0m11:51:43.537780 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:51:43.538125 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt clean', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m11:51:43.605121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283fe9bc-3f96-4809-a57b-dcfdec1a4c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916b820>]}
[0m11:51:43.616263 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12740146, "process_in_blocks": "0", "process_kernel_time": 0.133829, "process_mem_max_rss": "112394240", "process_out_blocks": "0", "process_user_time": 0.75599}
[0m11:51:43.616535 [debug] [MainThread]: Command `dbt clean` succeeded at 11:51:43.616485 after 0.13 seconds
[0m11:51:43.616723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108154bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b2ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109350640>]}
[0m11:51:43.616909 [debug] [MainThread]: Flushing usage events
[0m11:51:44.166515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:14.222033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747c520>]}


============================== 11:52:14.225696 | fff76993-8f7a-44cc-9411-00e9cd40686b ==============================
[0m11:52:14.225696 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:52:14.226065 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt parse', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'empty': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None'}
[0m11:52:14.436968 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:52:14.437293 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:52:14.437480 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:52:14.530849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff76993-8f7a-44cc-9411-00e9cd40686b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fef80>]}
[0m11:52:14.561436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fff76993-8f7a-44cc-9411-00e9cd40686b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108110550>]}
[0m11:52:14.562016 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:52:14.636844 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:52:14.637349 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:52:14.637566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fff76993-8f7a-44cc-9411-00e9cd40686b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ccdc0>]}
[0m11:52:15.307634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fff76993-8f7a-44cc-9411-00e9cd40686b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e17b0>]}
[0m11:52:15.310234 [info ] [MainThread]: Performance info: /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/perf_info.json
[0m11:52:15.352049 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:52:15.353651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:52:15.355479 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.1743515, "process_in_blocks": "0", "process_kernel_time": 0.199528, "process_mem_max_rss": "148045824", "process_out_blocks": "0", "process_user_time": 1.641109}
[0m11:52:15.355751 [debug] [MainThread]: Command `dbt parse` succeeded at 11:52:15.355701 after 1.17 seconds
[0m11:52:15.355969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109543850>]}
[0m11:52:15.356184 [debug] [MainThread]: Flushing usage events
[0m11:52:15.814794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:08.532190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cfd90>]}


============================== 11:53:08.535881 | 44267b25-ed25-4b38-a05a-dd77bd65f80a ==============================
[0m11:53:08.535881 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:53:08.536215 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt source freshness', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m11:53:08.746066 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:53:08.746374 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:53:08.746552 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:53:08.839670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44267b25-ed25-4b38-a05a-dd77bd65f80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d62e30>]}
[0m11:53:08.870216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44267b25-ed25-4b38-a05a-dd77bd65f80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ccc10>]}
[0m11:53:08.870879 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:53:08.938573 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:53:09.016328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:09.016583 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:53:09.016739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:09.036754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44267b25-ed25-4b38-a05a-dd77bd65f80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830d510>]}
[0m11:53:09.081032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:53:09.082591 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:53:09.094452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44267b25-ed25-4b38-a05a-dd77bd65f80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082864a0>]}
[0m11:53:09.094756 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m11:53:09.094956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44267b25-ed25-4b38-a05a-dd77bd65f80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108286680>]}
[0m11:53:09.095719 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:53:09.108972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:53:09.109830 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:53:09.111630 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/sources.json
[0m11:53:09.111799 [info ] [MainThread]: Done.
[0m11:53:09.113828 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.62497365, "process_in_blocks": "0", "process_kernel_time": 0.1911, "process_mem_max_rss": "141852672", "process_out_blocks": "0", "process_user_time": 1.082469}
[0m11:53:09.114156 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:53:09.114107 after 0.63 seconds
[0m11:53:09.114370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835ae00>]}
[0m11:53:09.114566 [debug] [MainThread]: Flushing usage events
[0m11:53:09.636571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:46.153431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104514c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ec550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ec6a0>]}


============================== 11:56:46.157058 | 4bcfe02b-07ef-432f-8b90-070f1ee8b53a ==============================
[0m11:56:46.157058 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:56:46.157423 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt ls --select staging', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'None', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m11:56:46.364695 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:56:46.365010 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:56:46.365184 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:56:46.458801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bcfe02b-07ef-432f-8b90-070f1ee8b53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8f220>]}
[0m11:56:46.489341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bcfe02b-07ef-432f-8b90-070f1ee8b53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105570b50>]}
[0m11:56:46.489917 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:56:46.560857 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:56:46.640711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:46.640980 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:56:46.641133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:46.661485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bcfe02b-07ef-432f-8b90-070f1ee8b53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106831750>]}
[0m11:56:46.706112 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:56:46.707466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:56:46.717557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bcfe02b-07ef-432f-8b90-070f1ee8b53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d85b0>]}
[0m11:56:46.717869 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m11:56:46.718063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcfe02b-07ef-432f-8b90-070f1ee8b53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d83a0>]}
[0m11:56:46.718385 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_meta
[0m11:56:46.718554 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_reviews
[0m11:56:46.720543 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6092423, "process_in_blocks": "0", "process_kernel_time": 0.198775, "process_mem_max_rss": "141770752", "process_out_blocks": "0", "process_user_time": 1.076062}
[0m11:56:46.720908 [debug] [MainThread]: Command `dbt ls` succeeded at 11:56:46.720861 after 0.61 seconds
[0m11:56:46.721108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104514c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106819750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d9750>]}
[0m11:56:46.721289 [debug] [MainThread]: Flushing usage events
[0m11:56:47.227914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:10.671840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106100c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8550>]}


============================== 11:57:10.674546 | c9515e0a-3a24-4304-9598-e02b01fd4976 ==============================
[0m11:57:10.674546 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:57:10.674955 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m11:57:10.876978 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:57:10.877295 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:57:10.877483 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:57:10.968086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475ef20>]}
[0m11:57:10.998905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcbd60>]}
[0m11:57:10.999806 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:57:11.068454 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:57:11.144112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:57:11.144389 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:57:11.144547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:57:11.164753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108421450>]}
[0m11:57:11.208043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:57:11.209436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:57:11.220157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083924a0>]}
[0m11:57:11.220460 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m11:57:11.220658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c8790>]}
[0m11:57:11.221366 [info ] [MainThread]: 
[0m11:57:11.221554 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:11.221708 [info ] [MainThread]: 
[0m11:57:11.221974 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:11.224493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:57:11.259042 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:57:11.259340 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m11:57:11.259507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:11.936129 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.676 seconds
[0m11:57:11.940517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_RAW)
[0m11:57:11.953875 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_RAW"
[0m11:57:11.954278 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_RAW: show objects in AMAZON_REVIEW_ANALYTICS_DEV.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_RAW"} */;
[0m11:57:12.292212 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.337 seconds
[0m11:57:12.296851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcc160>]}
[0m11:57:12.302092 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:57:12.302537 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:57:12.303016 [info ] [Thread-2 (]: 1 of 2 START sql view model RAW.stg_meta ....................................... [RUN]
[0m11:57:12.303528 [info ] [Thread-3 (]: 2 of 2 START sql view model RAW.stg_reviews .................................... [RUN]
[0m11:57:12.304033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_RAW, now model.capstone_amazon_analytics.stg_meta)
[0m11:57:12.304510 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.stg_reviews'
[0m11:57:12.304873 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:57:12.305199 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:57:12.313355 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:57:12.317766 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:57:12.319082 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:57:12.325771 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:57:12.353869 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:57:12.350907 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:57:12.355384 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:57:12.355740 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.RAW.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m11:57:12.356452 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:57:12.356980 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.RAW.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m11:57:12.357289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:57:12.491134 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24bb1-0306-10cf-0004-85da0003816a
[0m11:57:12.491433 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'RAW'.
[0m11:57:12.492661 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m11:57:12.493931 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108422110>]}
[0m11:57:12.494320 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model RAW.stg_meta .............................. [[31mERROR[0m in 0.19s]
[0m11:57:12.494635 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:57:12.494938 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m11:57:12.734876 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24bb1-0306-10cf-0004-85da0003816e
[0m11:57:12.736352 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'RAW'.
[0m11:57:12.739351 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m11:57:12.740399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9515e0a-3a24-4304-9598-e02b01fd4976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480bfa0>]}
[0m11:57:12.741191 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model RAW.stg_reviews ........................... [[31mERROR[0m in 0.44s]
[0m11:57:12.741764 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:57:12.742228 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m11:57:12.743374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:12.743737 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m11:57:12.744049 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:57:12.849634 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m11:57:12.850457 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:57:12.925711 [info ] [MainThread]: 
[0m11:57:12.932531 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m11:57:12.933639 [debug] [MainThread]: Command end result
[0m11:57:13.021473 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:57:13.022784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:57:13.027133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m11:57:13.027446 [info ] [MainThread]: 
[0m11:57:13.027687 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:57:13.027879 [info ] [MainThread]: 
[0m11:57:13.028102 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m11:57:13.028302 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m11:57:13.028463 [info ] [MainThread]: 
[0m11:57:13.028648 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m11:57:13.028804 [info ] [MainThread]: 
[0m11:57:13.028996 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m11:57:13.029184 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m11:57:13.029334 [info ] [MainThread]: 
[0m11:57:13.029508 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m11:57:13.029656 [info ] [MainThread]: 
[0m11:57:13.029826 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m11:57:13.032486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4019363, "process_in_blocks": "0", "process_kernel_time": 0.240173, "process_mem_max_rss": "160972800", "process_out_blocks": "0", "process_user_time": 1.623068}
[0m11:57:13.032815 [debug] [MainThread]: Command `dbt run` failed at 11:57:13.032762 after 2.40 seconds
[0m11:57:13.033075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106100c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ffa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d3fa0>]}
[0m11:57:13.033298 [debug] [MainThread]: Flushing usage events
[0m11:57:13.477919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:35.585952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104550c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056283a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056284f0>]}


============================== 12:09:35.588767 | 8339ae29-2f16-447e-829b-a873ed86b6f2 ==============================
[0m12:09:35.588767 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:09:35.589148 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile --select staging', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/elham/.dbt', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m12:09:35.802450 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:09:35.802775 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:09:35.802953 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:09:35.896140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8339ae29-2f16-447e-829b-a873ed86b6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b14e0>]}
[0m12:09:35.926689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8339ae29-2f16-447e-829b-a873ed86b6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e89840>]}
[0m12:09:35.927220 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:09:35.994405 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m12:09:36.072251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:36.072515 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:09:36.072666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:36.092967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8339ae29-2f16-447e-829b-a873ed86b6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106871420>]}
[0m12:09:36.137525 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:09:36.139216 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:09:36.149569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8339ae29-2f16-447e-829b-a873ed86b6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e1900>]}
[0m12:09:36.149855 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m12:09:36.150051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8339ae29-2f16-447e-829b-a873ed86b6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068510f0>]}
[0m12:09:36.150813 [info ] [MainThread]: 
[0m12:09:36.151002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:36.151157 [info ] [MainThread]: 
[0m12:09:36.151418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:36.153889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_RAW'
[0m12:09:36.191909 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_RAW"
[0m12:09:36.192218 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_RAW: show objects in AMAZON_REVIEW_ANALYTICS_DEV.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_RAW"} */;
[0m12:09:36.192391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:37.334410 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.142 seconds
[0m12:09:37.338565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8339ae29-2f16-447e-829b-a873ed86b6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e1fc0>]}
[0m12:09:37.341730 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m12:09:37.342147 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m12:09:37.342589 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_RAW, now model.capstone_amazon_analytics.stg_meta)
[0m12:09:37.343098 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.stg_reviews'
[0m12:09:37.343491 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m12:09:37.343826 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m12:09:37.352814 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m12:09:37.355706 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m12:09:37.356654 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m12:09:37.357314 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m12:09:37.357833 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m12:09:37.358456 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m12:09:37.359221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:37.359502 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m12:09:37.359768 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m12:09:37.548939 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m12:09:37.550735 [debug] [MainThread]: Command end result
[0m12:09:37.568904 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:09:37.570236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:09:37.575266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m12:09:37.575538 [debug] [MainThread]: Excluded node 'stg_meta' from results
[0m12:09:37.575721 [debug] [MainThread]: Excluded node 'stg_reviews' from results
[0m12:09:37.578071 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0355284, "process_in_blocks": "0", "process_kernel_time": 0.247112, "process_mem_max_rss": "150290432", "process_out_blocks": "0", "process_user_time": 1.406832}
[0m12:09:37.578403 [debug] [MainThread]: Command `dbt compile` succeeded at 12:09:37.578341 after 2.04 seconds
[0m12:09:37.578670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104550c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f6b90>]}
[0m12:09:37.578905 [debug] [MainThread]: Flushing usage events
[0m12:09:38.083111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:51.493708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180d0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aec3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aec4f0>]}


============================== 12:46:51.497370 | 1af62f21-dbb8-43a7-b5e0-5d22c3524b79 ==============================
[0m12:46:51.497370 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:46:51.497707 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m12:46:51.506653 [info ] [MainThread]: dbt version: 1.11.3
[0m12:46:51.506872 [info ] [MainThread]: python version: 3.10.19
[0m12:46:51.507036 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m12:46:51.507191 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m12:46:51.725238 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:46:51.725561 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:46:51.725735 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:46:51.756750 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m12:46:51.757040 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m12:46:51.757212 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m12:46:51.757535 [info ] [MainThread]: adapter type: snowflake
[0m12:46:51.757700 [info ] [MainThread]: adapter version: 1.11.1
[0m12:46:51.810755 [info ] [MainThread]: Configuration:
[0m12:46:51.811072 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:46:51.811241 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:46:51.811389 [info ] [MainThread]: Required dependencies:
[0m12:46:51.811583 [debug] [MainThread]: Executing "git --help"
[0m12:46:51.832588 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:46:51.833210 [debug] [MainThread]: STDERR: "b''"
[0m12:46:51.833412 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:46:51.833607 [info ] [MainThread]: Connection:
[0m12:46:51.833814 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m12:46:51.833971 [info ] [MainThread]:   user: DBT_AIRFLOW_DEV
[0m12:46:51.834115 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m12:46:51.834257 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m12:46:51.834398 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m12:46:51.834539 [info ] [MainThread]:   schema: RAW
[0m12:46:51.834679 [info ] [MainThread]:   authenticator: jwt
[0m12:46:51.834821 [info ] [MainThread]:   oauth_client_id: None
[0m12:46:51.834957 [info ] [MainThread]:   query_tag: None
[0m12:46:51.835096 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:46:51.835233 [info ] [MainThread]:   host: None
[0m12:46:51.835368 [info ] [MainThread]:   port: None
[0m12:46:51.835500 [info ] [MainThread]:   proxy_host: None
[0m12:46:51.835634 [info ] [MainThread]:   proxy_port: None
[0m12:46:51.835767 [info ] [MainThread]:   protocol: None
[0m12:46:51.835905 [info ] [MainThread]:   connect_retries: 1
[0m12:46:51.836036 [info ] [MainThread]:   connect_timeout: None
[0m12:46:51.836170 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:46:51.836303 [info ] [MainThread]:   retry_all: False
[0m12:46:51.836433 [info ] [MainThread]:   insecure_mode: False
[0m12:46:51.836563 [info ] [MainThread]:   reuse_connections: True
[0m12:46:51.836700 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:46:51.836838 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:46:51.837219 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:46:51.900022 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:46:51.928501 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:46:51.928790 [debug] [MainThread]: On debug: select 1 as id
[0m12:46:51.928964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:52.418586 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:46:52.419024 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:46:52.419381 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:46:52.419716 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:46:52.420011 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: KEMXMAE-OW63667.snowflakecomputing.com:443. JWT token is invalid. [04dff006-39cf-4d7e-b1e0-88ad30a55ae7]

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:46:52.423424 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.97553164, "process_in_blocks": "0", "process_kernel_time": 0.213116, "process_mem_max_rss": "151420928", "process_out_blocks": "0", "process_user_time": 1.137613}
[0m12:46:52.423871 [debug] [MainThread]: Command `dbt debug` failed at 12:46:52.423778 after 0.98 seconds
[0m12:46:52.424192 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:46:52.424458 [debug] [MainThread]: On debug: No close available on handle
[0m12:46:52.424774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180d0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118388550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfc6f50>]}
[0m12:46:52.425145 [debug] [MainThread]: Flushing usage events
[0m12:46:52.953478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:32.073573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f584c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f58610>]}


============================== 13:01:32.077584 | a98fb18e-64fb-484f-a2f2-613487cdc9b6 ==============================
[0m13:01:32.077584 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:01:32.077944 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt'}
[0m13:01:32.086807 [info ] [MainThread]: dbt version: 1.11.3
[0m13:01:32.087025 [info ] [MainThread]: python version: 3.10.19
[0m13:01:32.087191 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m13:01:32.087355 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m13:01:32.303530 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:01:32.303915 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:01:32.304111 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:01:32.338146 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m13:01:32.338505 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m13:01:32.338733 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m13:01:32.339161 [info ] [MainThread]: adapter type: snowflake
[0m13:01:32.339347 [info ] [MainThread]: adapter version: 1.11.1
[0m13:01:32.398091 [info ] [MainThread]: Configuration:
[0m13:01:32.398445 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:01:32.398622 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:01:32.398777 [info ] [MainThread]: Required dependencies:
[0m13:01:32.398976 [debug] [MainThread]: Executing "git --help"
[0m13:01:32.426132 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:01:32.426818 [debug] [MainThread]: STDERR: "b''"
[0m13:01:32.427036 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:01:32.427225 [info ] [MainThread]: Connection:
[0m13:01:32.427434 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m13:01:32.427590 [info ] [MainThread]:   user: DBT_AIRFLOW_DEV
[0m13:01:32.427734 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m13:01:32.427877 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m13:01:32.428023 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m13:01:32.428167 [info ] [MainThread]:   schema: RAW
[0m13:01:32.428305 [info ] [MainThread]:   authenticator: jwt
[0m13:01:32.428445 [info ] [MainThread]:   oauth_client_id: None
[0m13:01:32.428588 [info ] [MainThread]:   query_tag: None
[0m13:01:32.428726 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:01:32.428865 [info ] [MainThread]:   host: None
[0m13:01:32.429007 [info ] [MainThread]:   port: None
[0m13:01:32.429148 [info ] [MainThread]:   proxy_host: None
[0m13:01:32.429283 [info ] [MainThread]:   proxy_port: None
[0m13:01:32.429420 [info ] [MainThread]:   protocol: None
[0m13:01:32.429556 [info ] [MainThread]:   connect_retries: 1
[0m13:01:32.429691 [info ] [MainThread]:   connect_timeout: None
[0m13:01:32.429827 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:01:32.429966 [info ] [MainThread]:   retry_all: False
[0m13:01:32.430100 [info ] [MainThread]:   insecure_mode: False
[0m13:01:32.430235 [info ] [MainThread]:   reuse_connections: True
[0m13:01:32.430371 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:01:32.430508 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:01:32.430905 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m13:01:32.493349 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:01:32.520565 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:01:32.520807 [debug] [MainThread]: On debug: select 1 as id
[0m13:01:32.520959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:32.996506 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:01:32.997117 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:01:32.997514 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:01:32.997856 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:01:32.998159 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: KEMXMAE-OW63667.snowflakecomputing.com:443. JWT token is invalid. [e64c8289-e5a7-4333-a4e3-b549a94a34a2]

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:01:33.001175 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.97308135, "process_in_blocks": "0", "process_kernel_time": 0.209991, "process_mem_max_rss": "150994944", "process_out_blocks": "0", "process_user_time": 1.147766}
[0m13:01:33.001713 [debug] [MainThread]: Command `dbt debug` failed at 13:01:33.001600 after 0.97 seconds
[0m13:01:33.002114 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:01:33.002409 [debug] [MainThread]: On debug: No close available on handle
[0m13:01:33.002728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107baebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105897bb0>]}
[0m13:01:33.003106 [debug] [MainThread]: Flushing usage events
[0m13:01:33.510688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:50.223614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c20c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aec490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aec5e0>]}


============================== 13:09:50.227326 | ef0cedea-7d32-4be6-a045-ad338b31a8f9 ==============================
[0m13:09:50.227326 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:09:50.227656 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/elham/.dbt', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False'}
[0m13:09:50.236323 [info ] [MainThread]: dbt version: 1.11.3
[0m13:09:50.236538 [info ] [MainThread]: python version: 3.10.19
[0m13:09:50.236700 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m13:09:50.236850 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m13:09:50.468220 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:09:50.468539 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:09:50.468724 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:09:50.503073 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m13:09:50.503378 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m13:09:50.503553 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m13:09:50.503939 [info ] [MainThread]: adapter type: snowflake
[0m13:09:50.504101 [info ] [MainThread]: adapter version: 1.11.1
[0m13:09:50.560474 [info ] [MainThread]: Configuration:
[0m13:09:50.560797 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:09:50.560964 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:09:50.561116 [info ] [MainThread]: Required dependencies:
[0m13:09:50.561316 [debug] [MainThread]: Executing "git --help"
[0m13:09:50.591261 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:09:50.592017 [debug] [MainThread]: STDERR: "b''"
[0m13:09:50.592271 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:09:50.592474 [info ] [MainThread]: Connection:
[0m13:09:50.592696 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m13:09:50.592850 [info ] [MainThread]:   user: DBT_AIRFLOW_DEV
[0m13:09:50.592994 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m13:09:50.593134 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m13:09:50.593276 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m13:09:50.593411 [info ] [MainThread]:   schema: RAW
[0m13:09:50.593547 [info ] [MainThread]:   authenticator: jwt
[0m13:09:50.593683 [info ] [MainThread]:   oauth_client_id: None
[0m13:09:50.593819 [info ] [MainThread]:   query_tag: None
[0m13:09:50.593960 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:09:50.594095 [info ] [MainThread]:   host: None
[0m13:09:50.594230 [info ] [MainThread]:   port: None
[0m13:09:50.594362 [info ] [MainThread]:   proxy_host: None
[0m13:09:50.594500 [info ] [MainThread]:   proxy_port: None
[0m13:09:50.594637 [info ] [MainThread]:   protocol: None
[0m13:09:50.594771 [info ] [MainThread]:   connect_retries: 1
[0m13:09:50.594906 [info ] [MainThread]:   connect_timeout: None
[0m13:09:50.595043 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:09:50.595180 [info ] [MainThread]:   retry_all: False
[0m13:09:50.595313 [info ] [MainThread]:   insecure_mode: False
[0m13:09:50.595448 [info ] [MainThread]:   reuse_connections: True
[0m13:09:50.595580 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:09:50.595716 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:09:50.596186 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m13:09:50.663371 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:09:50.693658 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:09:50.693929 [debug] [MainThread]: On debug: select 1 as id
[0m13:09:50.694090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:51.196743 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:09:51.197329 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:09:51.197803 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:09:51.198263 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:09:51.198653 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: KEMXMAE-OW63667.snowflakecomputing.com:443. JWT token is invalid. [34bcdaff-327f-4696-b261-4932f50c7687]

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:09:51.202098 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.0216428, "process_in_blocks": "0", "process_kernel_time": 0.225872, "process_mem_max_rss": "151552000", "process_out_blocks": "0", "process_user_time": 1.146869}
[0m13:09:51.202575 [debug] [MainThread]: Command `dbt debug` failed at 13:09:51.202471 after 1.02 seconds
[0m13:09:51.202895 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:09:51.203163 [debug] [MainThread]: On debug: No close available on handle
[0m13:09:51.203474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c20c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111258df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c6f50>]}
[0m13:09:51.203853 [debug] [MainThread]: Flushing usage events
[0m13:09:51.708617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:37.140391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff45e0>]}


============================== 13:41:37.144042 | d7aa0d7a-a068-403a-b0bf-b8c18f77a14f ==============================
[0m13:41:37.144042 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:41:37.144397 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt', 'use_colors': 'True', 'empty': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m13:41:37.153097 [info ] [MainThread]: dbt version: 1.11.3
[0m13:41:37.153312 [info ] [MainThread]: python version: 3.10.19
[0m13:41:37.153479 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m13:41:37.153634 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m13:41:37.380783 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:41:37.381111 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:41:37.381290 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:41:37.412161 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m13:41:37.412430 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m13:41:37.412597 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m13:41:37.412929 [info ] [MainThread]: adapter type: snowflake
[0m13:41:37.413124 [info ] [MainThread]: adapter version: 1.11.1
[0m13:41:37.466337 [info ] [MainThread]: Configuration:
[0m13:41:37.466677 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:41:37.466842 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:41:37.467008 [info ] [MainThread]: Required dependencies:
[0m13:41:37.467220 [debug] [MainThread]: Executing "git --help"
[0m13:41:37.483486 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:41:37.484189 [debug] [MainThread]: STDERR: "b''"
[0m13:41:37.484461 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:41:37.484661 [info ] [MainThread]: Connection:
[0m13:41:37.484896 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m13:41:37.485059 [info ] [MainThread]:   user: DBT_AIRFLOW_DEV
[0m13:41:37.485203 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m13:41:37.485342 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m13:41:37.485483 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m13:41:37.485620 [info ] [MainThread]:   schema: RAW
[0m13:41:37.485760 [info ] [MainThread]:   authenticator: jwt
[0m13:41:37.485899 [info ] [MainThread]:   oauth_client_id: None
[0m13:41:37.486036 [info ] [MainThread]:   query_tag: None
[0m13:41:37.486174 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:41:37.486310 [info ] [MainThread]:   host: None
[0m13:41:37.486445 [info ] [MainThread]:   port: None
[0m13:41:37.486581 [info ] [MainThread]:   proxy_host: None
[0m13:41:37.486715 [info ] [MainThread]:   proxy_port: None
[0m13:41:37.486850 [info ] [MainThread]:   protocol: None
[0m13:41:37.486983 [info ] [MainThread]:   connect_retries: 1
[0m13:41:37.487114 [info ] [MainThread]:   connect_timeout: None
[0m13:41:37.487248 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:41:37.487381 [info ] [MainThread]:   retry_all: False
[0m13:41:37.487517 [info ] [MainThread]:   insecure_mode: False
[0m13:41:37.487651 [info ] [MainThread]:   reuse_connections: True
[0m13:41:37.487781 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:41:37.487915 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:41:37.488303 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m13:41:37.551416 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:41:37.580356 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:41:37.580614 [debug] [MainThread]: On debug: select 1 as id
[0m13:41:37.580767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:37.581005 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:41:37.581152 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:41:37.581325 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:41:37.581488 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:41:37.581649 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '/Users/elham/neueFische/Capstone Project/public_private_key_dbt_snowflake/snowflake_tf_private_key.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:41:37.583458 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.48739287, "process_in_blocks": "0", "process_kernel_time": 0.204543, "process_mem_max_rss": "140345344", "process_out_blocks": "0", "process_user_time": 0.944725}
[0m13:41:37.583895 [debug] [MainThread]: Command `dbt debug` failed at 13:41:37.583840 after 0.49 seconds
[0m13:41:37.584079 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:41:37.584225 [debug] [MainThread]: On debug: No close available on handle
[0m13:41:37.584400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e36fb0>]}
[0m13:41:37.584611 [debug] [MainThread]: Flushing usage events
[0m13:41:38.103693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:36.290428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab04f0>]}


============================== 13:47:36.294214 | 7faf867f-3b6d-4d54-b815-3335a77d5ed4 ==============================
[0m13:47:36.294214 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:47:36.294570 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt debug', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None'}
[0m13:47:36.303339 [info ] [MainThread]: dbt version: 1.11.3
[0m13:47:36.303557 [info ] [MainThread]: python version: 3.10.19
[0m13:47:36.303718 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m13:47:36.303875 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m13:47:36.519388 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:47:36.519710 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:47:36.519890 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:47:36.550849 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m13:47:36.551138 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m13:47:36.551315 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m13:47:36.551665 [info ] [MainThread]: adapter type: snowflake
[0m13:47:36.551825 [info ] [MainThread]: adapter version: 1.11.1
[0m13:47:36.604925 [info ] [MainThread]: Configuration:
[0m13:47:36.605240 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:47:36.605408 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:47:36.605562 [info ] [MainThread]: Required dependencies:
[0m13:47:36.605756 [debug] [MainThread]: Executing "git --help"
[0m13:47:36.620188 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:47:36.620810 [debug] [MainThread]: STDERR: "b''"
[0m13:47:36.621019 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:47:36.621216 [info ] [MainThread]: Connection:
[0m13:47:36.621417 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m13:47:36.621569 [info ] [MainThread]:   user: DBT_AIRFLOW_DEV
[0m13:47:36.621709 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m13:47:36.621848 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m13:47:36.621990 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m13:47:36.622128 [info ] [MainThread]:   schema: RAW
[0m13:47:36.622268 [info ] [MainThread]:   authenticator: jwt
[0m13:47:36.622406 [info ] [MainThread]:   oauth_client_id: None
[0m13:47:36.622548 [info ] [MainThread]:   query_tag: None
[0m13:47:36.622687 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:47:36.622832 [info ] [MainThread]:   host: None
[0m13:47:36.622968 [info ] [MainThread]:   port: None
[0m13:47:36.623107 [info ] [MainThread]:   proxy_host: None
[0m13:47:36.623244 [info ] [MainThread]:   proxy_port: None
[0m13:47:36.623380 [info ] [MainThread]:   protocol: None
[0m13:47:36.623517 [info ] [MainThread]:   connect_retries: 1
[0m13:47:36.623651 [info ] [MainThread]:   connect_timeout: None
[0m13:47:36.623784 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:47:36.623924 [info ] [MainThread]:   retry_all: False
[0m13:47:36.624061 [info ] [MainThread]:   insecure_mode: False
[0m13:47:36.624194 [info ] [MainThread]:   reuse_connections: True
[0m13:47:36.624332 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:47:36.624469 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m13:47:36.624872 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m13:47:36.694138 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:47:36.724614 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:47:36.724924 [debug] [MainThread]: On debug: select 1 as id
[0m13:47:36.725094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:37.153255 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:47:37.153691 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:47:37.154043 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:47:37.154375 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:47:37.154674 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: KEMXMAE-OW63667.snowflakecomputing.com:443. JWT token is invalid. [ac6c0c40-65f7-44db-aa75-1cb840f8515e]

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:47:37.157747 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.91201335, "process_in_blocks": "0", "process_kernel_time": 0.222118, "process_mem_max_rss": "145129472", "process_out_blocks": "0", "process_user_time": 1.130892}
[0m13:47:37.158282 [debug] [MainThread]: Command `dbt debug` failed at 13:47:37.158167 after 0.91 seconds
[0m13:47:37.158624 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:47:37.158917 [debug] [MainThread]: On debug: No close available on handle
[0m13:47:37.159242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c50550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10978ef50>]}
[0m13:47:37.159620 [debug] [MainThread]: Flushing usage events
[0m13:47:37.686492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:00.777964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106458c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534580>]}


============================== 14:16:00.781625 | cc9048ec-dda2-4e78-b924-05087022a1d9 ==============================
[0m14:16:00.781625 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:16:00.781997 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m14:16:00.790733 [info ] [MainThread]: dbt version: 1.11.3
[0m14:16:00.790949 [info ] [MainThread]: python version: 3.10.19
[0m14:16:00.791114 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m14:16:00.791269 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m14:16:01.004472 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:16:01.004784 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:16:01.004957 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:16:01.038535 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m14:16:01.038818 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m14:16:01.038994 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m14:16:01.039312 [info ] [MainThread]: adapter type: snowflake
[0m14:16:01.039519 [info ] [MainThread]: adapter version: 1.11.1
[0m14:16:01.092741 [info ] [MainThread]: Configuration:
[0m14:16:01.093168 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:01.093342 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:16:01.093498 [info ] [MainThread]: Required dependencies:
[0m14:16:01.093708 [debug] [MainThread]: Executing "git --help"
[0m14:16:01.110055 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:01.110675 [debug] [MainThread]: STDERR: "b''"
[0m14:16:01.110872 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:01.111057 [info ] [MainThread]: Connection:
[0m14:16:01.111261 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m14:16:01.111418 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m14:16:01.111560 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m14:16:01.111712 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m14:16:01.111850 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m14:16:01.111989 [info ] [MainThread]:   schema: RAW
[0m14:16:01.112129 [info ] [MainThread]:   authenticator: jwt
[0m14:16:01.112267 [info ] [MainThread]:   oauth_client_id: None
[0m14:16:01.112405 [info ] [MainThread]:   query_tag: None
[0m14:16:01.112548 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:16:01.112686 [info ] [MainThread]:   host: None
[0m14:16:01.112825 [info ] [MainThread]:   port: None
[0m14:16:01.112961 [info ] [MainThread]:   proxy_host: None
[0m14:16:01.113098 [info ] [MainThread]:   proxy_port: None
[0m14:16:01.113236 [info ] [MainThread]:   protocol: None
[0m14:16:01.113370 [info ] [MainThread]:   connect_retries: 1
[0m14:16:01.113612 [info ] [MainThread]:   connect_timeout: None
[0m14:16:01.113814 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:16:01.113973 [info ] [MainThread]:   retry_all: False
[0m14:16:01.114125 [info ] [MainThread]:   insecure_mode: False
[0m14:16:01.114271 [info ] [MainThread]:   reuse_connections: True
[0m14:16:01.114416 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m14:16:01.114558 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m14:16:01.114942 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:16:01.177485 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:16:01.205227 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:16:01.205565 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:01.205741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:02.306885 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.101 seconds
[0m14:16:02.309646 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:16:02.310757 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:16:02.315354 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5810223, "process_in_blocks": "0", "process_kernel_time": 0.219345, "process_mem_max_rss": "152141824", "process_out_blocks": "0", "process_user_time": 1.170625}
[0m14:16:02.316016 [debug] [MainThread]: Command `dbt debug` succeeded at 14:16:02.315903 after 1.58 seconds
[0m14:16:02.316379 [debug] [MainThread]: Connection 'debug' was left open.
[0m14:16:02.316666 [debug] [MainThread]: On debug: Close
[0m14:16:02.468098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106458c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bdab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd96c0>]}
[0m14:16:02.469339 [debug] [MainThread]: Flushing usage events
[0m14:16:02.970349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:57.176032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091905e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109190730>]}


============================== 14:18:57.179641 | b652e03d-9569-40d9-93c7-e82713992be5 ==============================
[0m14:18:57.179641 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:18:57.179979 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt source freshness', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default'}
[0m14:18:57.388007 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:18:57.388321 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:18:57.388498 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:18:57.481372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b652e03d-9569-40d9-93c7-e82713992be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c007940>]}
[0m14:18:57.511857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b652e03d-9569-40d9-93c7-e82713992be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f83670>]}
[0m14:18:57.512420 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:18:57.583357 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:18:57.635064 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:18:57.635405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b652e03d-9569-40d9-93c7-e82713992be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2f6d0>]}
[0m14:18:58.289701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b652e03d-9569-40d9-93c7-e82713992be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d381e40>]}
[0m14:18:58.330242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:18:58.332344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:18:58.343360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b652e03d-9569-40d9-93c7-e82713992be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d383370>]}
[0m14:18:58.343650 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m14:18:58.343848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b652e03d-9569-40d9-93c7-e82713992be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d381fc0>]}
[0m14:18:58.344577 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:18:58.357376 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:18:58.358210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:18:58.359788 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/sources.json
[0m14:18:58.359956 [info ] [MainThread]: Done.
[0m14:18:58.361975 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 1.2289772, "process_in_blocks": "0", "process_kernel_time": 0.189606, "process_mem_max_rss": "148668416", "process_out_blocks": "0", "process_user_time": 1.698968}
[0m14:18:58.362233 [debug] [MainThread]: Command `dbt source freshness` succeeded at 14:18:58.362189 after 1.23 seconds
[0m14:18:58.362433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f83670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d406e60>]}
[0m14:18:58.362625 [debug] [MainThread]: Flushing usage events
[0m14:18:58.854940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:27.515913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104684c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105760400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105760550>]}


============================== 14:19:27.519595 | c44da582-41e6-4215-b8da-62761075e0ce ==============================
[0m14:19:27.519595 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:19:27.519937 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '/Users/elham/.dbt', 'empty': 'None'}
[0m14:19:27.733039 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:19:27.733364 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:19:27.733543 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:19:27.824281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c44da582-41e6-4215-b8da-62761075e0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ce2f50>]}
[0m14:19:27.854592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c44da582-41e6-4215-b8da-62761075e0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f6680>]}
[0m14:19:27.855229 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:19:27.924066 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:19:27.998872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:27.999144 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:19:27.999298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:28.019756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c44da582-41e6-4215-b8da-62761075e0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699d330>]}
[0m14:19:28.022020 [info ] [MainThread]: Performance info: /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/perf_info.json
[0m14:19:28.066244 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:19:28.067555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:19:28.069566 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.596, "process_in_blocks": "0", "process_kernel_time": 0.189219, "process_mem_max_rss": "141262848", "process_out_blocks": "0", "process_user_time": 1.076132}
[0m14:19:28.069956 [debug] [MainThread]: Command `dbt parse` succeeded at 14:19:28.069900 after 0.60 seconds
[0m14:19:28.070174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104684c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699e260>]}
[0m14:19:28.070375 [debug] [MainThread]: Flushing usage events
[0m14:19:28.532141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:35.449968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075283a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075284f0>]}


============================== 14:19:35.453405 | 78adf3f4-66aa-4ced-8fd1-a9d8fabc9a58 ==============================
[0m14:19:35.453405 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:19:35.453732 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt clean'}
[0m14:19:35.516313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78adf3f4-66aa-4ced-8fd1-a9d8fabc9a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b3b20>]}
[0m14:19:35.529540 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11836387, "process_in_blocks": "0", "process_kernel_time": 0.111556, "process_mem_max_rss": "112427008", "process_out_blocks": "0", "process_user_time": 0.754214}
[0m14:19:35.529819 [debug] [MainThread]: Command `dbt clean` succeeded at 14:19:35.529766 after 0.12 seconds
[0m14:19:35.530022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107644790>]}
[0m14:19:35.530223 [debug] [MainThread]: Flushing usage events
[0m14:19:35.974464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:43.086793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e64bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3c610>]}


============================== 14:19:43.090292 | 3e2b01e6-5942-4114-ae6b-4286958e59ad ==============================
[0m14:19:43.090292 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:19:43.090645 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'debug': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt parse', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:19:43.294666 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:19:43.294999 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:19:43.295180 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:19:43.385892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e2b01e6-5942-4114-ae6b-4286958e59ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10387fbb0>]}
[0m14:19:43.416438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e2b01e6-5942-4114-ae6b-4286958e59ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd61a0>]}
[0m14:19:43.417013 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:19:43.485147 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:19:43.485638 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:19:43.485853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e2b01e6-5942-4114-ae6b-4286958e59ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf6e60>]}
[0m14:19:44.153682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e2b01e6-5942-4114-ae6b-4286958e59ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f0d60>]}
[0m14:19:44.156085 [info ] [MainThread]: Performance info: /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/perf_info.json
[0m14:19:44.197870 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:19:44.199198 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:19:44.201112 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.1541102, "process_in_blocks": "0", "process_kernel_time": 0.182556, "process_mem_max_rss": "149880832", "process_out_blocks": "0", "process_user_time": 1.645619}
[0m14:19:44.201359 [debug] [MainThread]: Command `dbt parse` succeeded at 14:19:44.201312 after 1.15 seconds
[0m14:19:44.201569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e64bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024f6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e07a60>]}
[0m14:19:44.201778 [debug] [MainThread]: Flushing usage events
[0m14:19:44.662716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:42.018425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060acc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107184580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071846d0>]}


============================== 14:20:42.022022 | 7cbb8725-10ce-4f60-8346-8e8c79c1fd39 ==============================
[0m14:20:42.022022 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:20:42.022386 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'invocation_command': 'dbt ls --select staging', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m14:20:42.227935 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:42.228242 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:42.228421 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:42.321707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cbb8725-10ce-4f60-8346-8e8c79c1fd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac48e0>]}
[0m14:20:42.352532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cbb8725-10ce-4f60-8346-8e8c79c1fd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710bd60>]}
[0m14:20:42.353107 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:20:42.420559 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:20:42.499426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:42.499697 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:20:42.499852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:42.520058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cbb8725-10ce-4f60-8346-8e8c79c1fd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c97e0>]}
[0m14:20:42.563879 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:20:42.565446 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:20:42.575854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cbb8725-10ce-4f60-8346-8e8c79c1fd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f43c40>]}
[0m14:20:42.576165 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m14:20:42.576357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbb8725-10ce-4f60-8346-8e8c79c1fd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817de40>]}
[0m14:20:42.576678 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_meta
[0m14:20:42.576842 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_reviews
[0m14:20:42.578518 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6034872, "process_in_blocks": "0", "process_kernel_time": 0.19427, "process_mem_max_rss": "140705792", "process_out_blocks": "0", "process_user_time": 1.076177}
[0m14:20:42.578908 [debug] [MainThread]: Command `dbt ls` succeeded at 14:20:42.578859 after 0.60 seconds
[0m14:20:42.579119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060acc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f43c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083716f0>]}
[0m14:20:42.579310 [debug] [MainThread]: Flushing usage events
[0m14:20:43.116913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:57.048192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce4610>]}


============================== 14:20:57.050960 | fae0551c-2994-4e50-8b49-dd5239e49c34 ==============================
[0m14:20:57.050960 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:20:57.051306 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select staging', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'use_colors': 'True'}
[0m14:20:57.250490 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:57.250808 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:57.250985 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:57.341132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dac20>]}
[0m14:20:57.371650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105624850>]}
[0m14:20:57.372550 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:20:57.442228 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:20:57.517120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:57.517418 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:20:57.517585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:57.539924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2d420>]}
[0m14:20:57.587011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:20:57.588885 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:20:57.599928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9d8a0>]}
[0m14:20:57.600256 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m14:20:57.600461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed2e60>]}
[0m14:20:57.601210 [info ] [MainThread]: 
[0m14:20:57.601474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:57.601673 [info ] [MainThread]: 
[0m14:20:57.601959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:57.604662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m14:20:57.639327 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m14:20:57.639633 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m14:20:57.639820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:58.451892 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.812 seconds
[0m14:20:58.455720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_RAW)
[0m14:20:58.467796 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_RAW"
[0m14:20:58.468194 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_RAW: show objects in AMAZON_REVIEW_ANALYTICS_DEV.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_RAW"} */;
[0m14:20:58.617112 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.148 seconds
[0m14:20:58.621474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797a3b0>]}
[0m14:20:58.624531 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m14:20:58.624941 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m14:20:58.625604 [info ] [Thread-2 (]: 1 of 2 START sql view model RAW.stg_meta ....................................... [RUN]
[0m14:20:58.626158 [info ] [Thread-3 (]: 2 of 2 START sql view model RAW.stg_reviews .................................... [RUN]
[0m14:20:58.626827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_RAW, now model.capstone_amazon_analytics.stg_meta)
[0m14:20:58.627308 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.stg_reviews'
[0m14:20:58.627692 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m14:20:58.628052 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m14:20:58.636457 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m14:20:58.640371 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m14:20:58.641628 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m14:20:58.641995 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m14:20:58.670160 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m14:20:58.670610 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m14:20:58.672149 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m14:20:58.672868 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m14:20:58.673218 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.RAW.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m14:20:58.673614 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.RAW.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m14:20:58.673930 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:58.864893 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24c40-0306-1054-0004-85da0003658a
[0m14:20:58.868619 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'RAW'.
[0m14:20:58.870221 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m14:20:58.871711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd4d60>]}
[0m14:20:58.872230 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model RAW.stg_meta .............................. [[31mERROR[0m in 0.24s]
[0m14:20:58.872659 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m14:20:58.873062 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m14:20:59.151804 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24c40-0306-10cf-0004-85da00038326
[0m14:20:59.153180 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'RAW'.
[0m14:20:59.155490 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m14:20:59.156111 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae0551c-2994-4e50-8b49-dd5239e49c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109092380>]}
[0m14:20:59.156764 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model RAW.stg_reviews ........................... [[31mERROR[0m in 0.53s]
[0m14:20:59.157323 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m14:20:59.157771 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m14:20:59.158826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:59.159121 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m14:20:59.159361 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m14:20:59.249886 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m14:20:59.250724 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m14:20:59.379963 [info ] [MainThread]: 
[0m14:20:59.380901 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m14:20:59.382595 [debug] [MainThread]: Command end result
[0m14:20:59.454898 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:20:59.456040 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:20:59.460132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m14:20:59.460354 [info ] [MainThread]: 
[0m14:20:59.460594 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:20:59.460795 [info ] [MainThread]: 
[0m14:20:59.461029 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m14:20:59.461256 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m14:20:59.461437 [info ] [MainThread]: 
[0m14:20:59.461636 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m14:20:59.461800 [info ] [MainThread]: 
[0m14:20:59.462002 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m14:20:59.462207 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'RAW'.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m14:20:59.462371 [info ] [MainThread]: 
[0m14:20:59.462559 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m14:20:59.462716 [info ] [MainThread]: 
[0m14:20:59.462897 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m14:20:59.465114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4584148, "process_in_blocks": "0", "process_kernel_time": 0.217269, "process_mem_max_rss": "162054144", "process_out_blocks": "0", "process_user_time": 1.628693}
[0m14:20:59.465431 [debug] [MainThread]: Command `dbt run` failed at 14:20:59.465378 after 2.46 seconds
[0m14:20:59.465672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104401c30>]}
[0m14:20:59.465902 [debug] [MainThread]: Flushing usage events
[0m14:20:59.911454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:06.312020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104398be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054743a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054744f0>]}


============================== 14:29:06.315652 | 4ad0b656-8940-48c6-a18f-f7537656789e ==============================
[0m14:29:06.315652 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:29:06.316018 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt clean', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True'}
[0m14:29:06.385251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ad0b656-8940-48c6-a18f-f7537656789e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ffa90>]}
[0m14:29:06.398404 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13422325, "process_in_blocks": "0", "process_kernel_time": 0.134862, "process_mem_max_rss": "112590848", "process_out_blocks": "0", "process_user_time": 0.766101}
[0m14:29:06.398707 [debug] [MainThread]: Command `dbt clean` succeeded at 14:29:06.398651 after 0.13 seconds
[0m14:29:06.398917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104398be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ffa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105591bd0>]}
[0m14:29:06.399129 [debug] [MainThread]: Flushing usage events
[0m14:29:06.938980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:13.807127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4580>]}


============================== 14:29:13.811149 | 49832cbf-de2e-4274-bdbb-340a8c450ba7 ==============================
[0m14:29:13.811149 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:29:13.811484 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt debug', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m14:29:13.822124 [info ] [MainThread]: dbt version: 1.11.3
[0m14:29:13.822373 [info ] [MainThread]: python version: 3.10.19
[0m14:29:13.822542 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m14:29:13.822704 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m14:29:14.079794 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:29:14.080127 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:29:14.080321 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:29:14.115389 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m14:29:14.115708 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m14:29:14.115887 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m14:29:14.116290 [info ] [MainThread]: adapter type: snowflake
[0m14:29:14.116453 [info ] [MainThread]: adapter version: 1.11.1
[0m14:29:14.172715 [info ] [MainThread]: Configuration:
[0m14:29:14.173036 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:29:14.173206 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:29:14.173360 [info ] [MainThread]: Required dependencies:
[0m14:29:14.173572 [debug] [MainThread]: Executing "git --help"
[0m14:29:14.186333 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:29:14.186889 [debug] [MainThread]: STDERR: "b''"
[0m14:29:14.187096 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:29:14.187285 [info ] [MainThread]: Connection:
[0m14:29:14.187507 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m14:29:14.187648 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m14:29:14.187786 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m14:29:14.187924 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m14:29:14.188060 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m14:29:14.188203 [info ] [MainThread]:   schema: RAW
[0m14:29:14.188335 [info ] [MainThread]:   authenticator: jwt
[0m14:29:14.188469 [info ] [MainThread]:   oauth_client_id: None
[0m14:29:14.188639 [info ] [MainThread]:   query_tag: None
[0m14:29:14.188880 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:29:14.189048 [info ] [MainThread]:   host: None
[0m14:29:14.189203 [info ] [MainThread]:   port: None
[0m14:29:14.189349 [info ] [MainThread]:   proxy_host: None
[0m14:29:14.189493 [info ] [MainThread]:   proxy_port: None
[0m14:29:14.189631 [info ] [MainThread]:   protocol: None
[0m14:29:14.189777 [info ] [MainThread]:   connect_retries: 1
[0m14:29:14.189917 [info ] [MainThread]:   connect_timeout: None
[0m14:29:14.190052 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:29:14.190190 [info ] [MainThread]:   retry_all: False
[0m14:29:14.190326 [info ] [MainThread]:   insecure_mode: False
[0m14:29:14.190471 [info ] [MainThread]:   reuse_connections: True
[0m14:29:14.190605 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m14:29:14.190743 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m14:29:14.191137 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:29:14.255331 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:29:14.283016 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:29:14.283271 [debug] [MainThread]: On debug: select 1 as id
[0m14:29:14.283423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:14.868678 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.585 seconds
[0m14:29:14.871876 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:29:14.872469 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:29:14.876910 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1119969, "process_in_blocks": "0", "process_kernel_time": 0.198928, "process_mem_max_rss": "151027712", "process_out_blocks": "0", "process_user_time": 1.157915}
[0m14:29:14.877412 [debug] [MainThread]: Command `dbt debug` succeeded at 14:29:14.877306 after 1.11 seconds
[0m14:29:14.877756 [debug] [MainThread]: Connection 'debug' was left open.
[0m14:29:14.878035 [debug] [MainThread]: On debug: Close
[0m14:29:15.292320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7b1f0>]}
[0m14:29:15.292979 [debug] [MainThread]: Flushing usage events
[0m14:29:15.752399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:21.801193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e86a0>]}


============================== 14:29:21.804655 | b58a4a59-8450-434d-937c-77e10f47bae0 ==============================
[0m14:29:21.804655 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:29:21.804978 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'None', 'write_json': 'True', 'invocation_command': 'dbt ls --select staging', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'log_cache_events': 'False'}
[0m14:29:21.983707 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:29:21.984017 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:29:21.984197 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:29:22.074980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58a4a59-8450-434d-937c-77e10f47bae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109980910>]}
[0m14:29:22.105887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58a4a59-8450-434d-937c-77e10f47bae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107189e10>]}
[0m14:29:22.106661 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:29:22.174473 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:29:22.174983 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:29:22.175207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b58a4a59-8450-434d-937c-77e10f47bae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad32e0>]}
[0m14:29:22.852519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58a4a59-8450-434d-937c-77e10f47bae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace59f0>]}
[0m14:29:22.896950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:29:22.898218 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:29:22.908562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b58a4a59-8450-434d-937c-77e10f47bae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca5810>]}
[0m14:29:22.908881 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m14:29:22.909076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58a4a59-8450-434d-937c-77e10f47bae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca4640>]}
[0m14:29:22.909447 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_meta
[0m14:29:22.909657 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_reviews
[0m14:29:22.911405 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.150885, "process_in_blocks": "0", "process_kernel_time": 0.151063, "process_mem_max_rss": "147718144", "process_out_blocks": "0", "process_user_time": 1.65743}
[0m14:29:22.911643 [debug] [MainThread]: Command `dbt ls` succeeded at 14:29:22.911598 after 1.15 seconds
[0m14:29:22.911843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107189e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad1f5e0>]}
[0m14:29:22.912027 [debug] [MainThread]: Flushing usage events
[0m14:29:23.356070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:29.977027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e84f0>]}


============================== 14:29:29.980992 | 33595257-0543-4bea-bce3-756c227ed065 ==============================
[0m14:29:29.980992 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:29:29.981384 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt run --select staging', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/elham/.dbt', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'False', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m14:29:30.161195 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:29:30.161513 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:29:30.161693 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:29:30.252096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33595257-0543-4bea-bce3-756c227ed065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bfbb0>]}
[0m14:29:30.282704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33595257-0543-4bea-bce3-756c227ed065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a91690>]}
[0m14:29:30.283589 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m14:29:30.352293 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:29:30.427905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:30.428180 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:29:30.428334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:30.448543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33595257-0543-4bea-bce3-756c227ed065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebb610>]}
[0m14:29:30.491956 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m14:29:30.493030 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m14:29:30.503554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33595257-0543-4bea-bce3-756c227ed065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110db4ee0>]}
[0m14:29:30.503856 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m14:29:30.504058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33595257-0543-4bea-bce3-756c227ed065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de7dc0>]}
[0m14:29:30.504782 [info ] [MainThread]: 
[0m14:29:30.504978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:30.505137 [info ] [MainThread]: 
[0m14:29:30.505405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:30.507897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m14:29:30.535484 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m14:29:30.535757 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m14:29:30.535925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:31.078398 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.542 seconds
[0m14:29:31.081003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m14:29:31.082070 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m14:29:31.088255 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m14:29:31.088895 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m14:29:31.149769 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24c49-0306-09f2-0004-85da0002d98a
[0m14:29:31.150548 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m14:29:31.151254 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m14:29:31.151686 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:29:31.152643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:31.153096 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m14:29:31.153536 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m14:29:31.255108 [info ] [MainThread]: 
[0m14:29:31.256474 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m14:29:31.257128 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m14:29:31.260524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3257841, "process_in_blocks": "0", "process_kernel_time": 0.172355, "process_mem_max_rss": "159154176", "process_out_blocks": "0", "process_user_time": 1.325831}
[0m14:29:31.260977 [debug] [MainThread]: Command `dbt run` failed at 14:29:31.260890 after 1.33 seconds
[0m14:29:31.261347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e854e0>]}
[0m14:29:31.261731 [debug] [MainThread]: Flushing usage events
[0m14:29:31.720806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:01.140431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107798c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108874430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108874580>]}


============================== 15:37:01.143978 | 1bfa25b9-db26-4f74-8de7-1458dfede8a0 ==============================
[0m15:37:01.143978 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:37:01.144310 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/elham/.dbt', 'no_print': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'write_json': 'True'}
[0m15:37:01.153101 [info ] [MainThread]: dbt version: 1.11.3
[0m15:37:01.153342 [info ] [MainThread]: python version: 3.10.19
[0m15:37:01.153512 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m15:37:01.153675 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m15:37:01.365032 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:37:01.365359 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:37:01.365536 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:37:01.396616 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m15:37:01.396894 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m15:37:01.397068 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m15:37:01.397399 [info ] [MainThread]: adapter type: snowflake
[0m15:37:01.397608 [info ] [MainThread]: adapter version: 1.11.1
[0m15:37:01.451093 [info ] [MainThread]: Configuration:
[0m15:37:01.451411 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:37:01.451581 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:37:01.451732 [info ] [MainThread]: Required dependencies:
[0m15:37:01.451925 [debug] [MainThread]: Executing "git --help"
[0m15:37:01.464699 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:37:01.465365 [debug] [MainThread]: STDERR: "b''"
[0m15:37:01.465572 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:37:01.465764 [info ] [MainThread]: Connection:
[0m15:37:01.465970 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m15:37:01.466116 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m15:37:01.466257 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m15:37:01.466396 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m15:37:01.466533 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m15:37:01.466670 [info ] [MainThread]:   schema: RAW
[0m15:37:01.466804 [info ] [MainThread]:   authenticator: jwt
[0m15:37:01.466940 [info ] [MainThread]:   oauth_client_id: None
[0m15:37:01.467073 [info ] [MainThread]:   query_tag: None
[0m15:37:01.467208 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:37:01.467342 [info ] [MainThread]:   host: None
[0m15:37:01.467474 [info ] [MainThread]:   port: None
[0m15:37:01.467606 [info ] [MainThread]:   proxy_host: None
[0m15:37:01.467739 [info ] [MainThread]:   proxy_port: None
[0m15:37:01.467870 [info ] [MainThread]:   protocol: None
[0m15:37:01.468003 [info ] [MainThread]:   connect_retries: 1
[0m15:37:01.468135 [info ] [MainThread]:   connect_timeout: None
[0m15:37:01.468267 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:37:01.468400 [info ] [MainThread]:   retry_all: False
[0m15:37:01.468529 [info ] [MainThread]:   insecure_mode: False
[0m15:37:01.468660 [info ] [MainThread]:   reuse_connections: True
[0m15:37:01.468790 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m15:37:01.468924 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m15:37:01.469268 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:37:01.533302 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:37:01.560765 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:37:01.561027 [debug] [MainThread]: On debug: select 1 as id
[0m15:37:01.561188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:02.175382 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.614 seconds
[0m15:37:02.178762 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:37:02.179617 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:37:02.185993 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0884147, "process_in_blocks": "0", "process_kernel_time": 0.217697, "process_mem_max_rss": "151732224", "process_out_blocks": "0", "process_user_time": 1.15031}
[0m15:37:02.186698 [debug] [MainThread]: Command `dbt debug` succeeded at 15:37:02.186578 after 1.09 seconds
[0m15:37:02.187076 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:37:02.187384 [debug] [MainThread]: On debug: Close
[0m15:37:02.285767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107798c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950b1f0>]}
[0m15:37:02.287569 [debug] [MainThread]: Flushing usage events
[0m15:37:02.749923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:33.535002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eacc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f84400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f84550>]}


============================== 15:38:33.538938 | 3d43b593-8235-4048-826c-93278df39e4e ==============================
[0m15:38:33.538938 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:38:33.539320 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt'}
[0m15:38:33.743594 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:38:33.743909 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:38:33.744093 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:38:33.839319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d43b593-8235-4048-826c-93278df39e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653ef20>]}
[0m15:38:33.869884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d43b593-8235-4048-826c-93278df39e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e196f0>]}
[0m15:38:33.870478 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:38:33.937634 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:38:34.015852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:34.016110 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:38:34.016267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:34.036406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d43b593-8235-4048-826c-93278df39e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cd450>]}
[0m15:38:34.081105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m15:38:34.082812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m15:38:34.094616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d43b593-8235-4048-826c-93278df39e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a13e110>]}
[0m15:38:34.094906 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m15:38:34.095101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d43b593-8235-4048-826c-93278df39e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a174820>]}
[0m15:38:34.095842 [info ] [MainThread]: 
[0m15:38:34.096039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:38:34.096195 [info ] [MainThread]: 
[0m15:38:34.096473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:34.099024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m15:38:34.133095 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m15:38:34.133413 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m15:38:34.133586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:34.783643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.650 seconds
[0m15:38:34.787253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m15:38:34.787827 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m15:38:34.793027 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m15:38:34.793419 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m15:38:34.896100 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24c8e-0306-1054-0004-85da000366be
[0m15:38:34.897081 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m15:38:34.897951 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m15:38:34.898621 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:34.899387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:34.899684 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m15:38:34.899963 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m15:38:35.124946 [info ] [MainThread]: 
[0m15:38:35.126175 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m15:38:35.126875 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m15:38:35.130884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6434721, "process_in_blocks": "0", "process_kernel_time": 0.229341, "process_mem_max_rss": "158810112", "process_out_blocks": "0", "process_user_time": 1.335028}
[0m15:38:35.131376 [debug] [MainThread]: Command `dbt run` failed at 15:38:35.131282 after 1.64 seconds
[0m15:38:35.131764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eacc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ccb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a215ba0>]}
[0m15:38:35.132141 [debug] [MainThread]: Flushing usage events
[0m15:38:35.660585 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:15.517764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee46d0>]}


============================== 17:11:15.521636 | d5bd4cd5-57f8-4c6f-986d-6dde01e4f852 ==============================
[0m17:11:15.521636 [info ] [MainThread]: Running with dbt=1.11.3
[0m17:11:15.521993 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:11:15.776154 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m17:11:15.776473 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m17:11:15.776665 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m17:11:15.871564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5bd4cd5-57f8-4c6f-986d-6dde01e4f852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058208e0>]}
[0m17:11:15.902160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5bd4cd5-57f8-4c6f-986d-6dde01e4f852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd7c40>]}
[0m17:11:15.902723 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m17:11:15.973936 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m17:11:16.052651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:16.052937 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:11:16.053093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:16.073318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5bd4cd5-57f8-4c6f-986d-6dde01e4f852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812d480>]}
[0m17:11:16.119053 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m17:11:16.120646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m17:11:16.131969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5bd4cd5-57f8-4c6f-986d-6dde01e4f852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809cc70>]}
[0m17:11:16.132269 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m17:11:16.132464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5bd4cd5-57f8-4c6f-986d-6dde01e4f852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d4700>]}
[0m17:11:16.133173 [info ] [MainThread]: 
[0m17:11:16.133368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:16.133522 [info ] [MainThread]: 
[0m17:11:16.133788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:16.136254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m17:11:16.170220 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m17:11:16.170531 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m17:11:16.170710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:16.954304 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.783 seconds
[0m17:11:16.957115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m17:11:16.957745 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m17:11:16.963996 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m17:11:16.964378 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m17:11:17.171737 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24ceb-0306-10cf-0004-85da0003846a
[0m17:11:17.172688 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m17:11:17.173313 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m17:11:17.173702 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:11:17.174393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:17.174692 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m17:11:17.174979 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m17:11:17.260576 [info ] [MainThread]: 
[0m17:11:17.261936 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m17:11:17.262743 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m17:11:17.266127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7952516, "process_in_blocks": "0", "process_kernel_time": 0.238533, "process_mem_max_rss": "157974528", "process_out_blocks": "0", "process_user_time": 1.350405}
[0m17:11:17.266579 [debug] [MainThread]: Command `dbt run` failed at 17:11:17.266490 after 1.80 seconds
[0m17:11:17.266943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108171570>]}
[0m17:11:17.267324 [debug] [MainThread]: Flushing usage events
[0m17:11:17.803086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:35.376311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106364be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743c610>]}


============================== 17:32:35.379968 | 5bf1b8b1-4c85-47e4-b65b-54ef4d60a461 ==============================
[0m17:32:35.379968 [info ] [MainThread]: Running with dbt=1.11.3
[0m17:32:35.380297 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'empty': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select staging', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt'}
[0m17:32:35.591892 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m17:32:35.592208 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m17:32:35.592387 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m17:32:35.686249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bf1b8b1-4c85-47e4-b65b-54ef4d60a461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c2ef0>]}
[0m17:32:35.717064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bf1b8b1-4c85-47e4-b65b-54ef4d60a461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d2fe0>]}
[0m17:32:35.717643 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m17:32:35.787641 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m17:32:35.865644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:35.865914 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:32:35.866067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:35.886255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bf1b8b1-4c85-47e4-b65b-54ef4d60a461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108687fa0>]}
[0m17:32:35.930455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m17:32:35.931945 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m17:32:35.942802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bf1b8b1-4c85-47e4-b65b-54ef4d60a461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f8f10>]}
[0m17:32:35.943097 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m17:32:35.943294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bf1b8b1-4c85-47e4-b65b-54ef4d60a461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862c820>]}
[0m17:32:35.943997 [info ] [MainThread]: 
[0m17:32:35.944190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:32:35.944345 [info ] [MainThread]: 
[0m17:32:35.944611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:35.947095 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m17:32:35.981964 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m17:32:35.982266 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m17:32:35.982428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:36.764909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.782 seconds
[0m17:32:36.769277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m17:32:36.769929 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m17:32:36.775290 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m17:32:36.775686 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m17:32:36.911559 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24d00-0306-10cf-0004-85da0003846e
[0m17:32:36.912499 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m17:32:36.913101 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m17:32:36.913411 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:32:36.914107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:36.914431 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m17:32:36.914714 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m17:32:37.009329 [info ] [MainThread]: 
[0m17:32:37.010269 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m17:32:37.010801 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m17:32:37.014309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.682011, "process_in_blocks": "0", "process_kernel_time": 0.214492, "process_mem_max_rss": "158023680", "process_out_blocks": "0", "process_user_time": 1.344605}
[0m17:32:37.014686 [debug] [MainThread]: Command `dbt run` failed at 17:32:37.014619 after 1.68 seconds
[0m17:32:37.014994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106364be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108687280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c9b10>]}
[0m17:32:37.015287 [debug] [MainThread]: Flushing usage events
[0m17:32:37.483803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:10.845810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ebc40>]}


============================== 18:02:10.849450 | 12666471-5479-4e15-8932-6f3ec061ce86 ==============================
[0m18:02:10.849450 [info ] [MainThread]: Running with dbt=1.11.3
[0m18:02:10.849778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt run --select staging cd ..', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None'}
[0m18:02:11.053435 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:02:11.053739 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:02:11.053917 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:02:11.145496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12666471-5479-4e15-8932-6f3ec061ce86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110bd7e0>]}
[0m18:02:11.176085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12666471-5479-4e15-8932-6f3ec061ce86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798a7a0>]}
[0m18:02:11.176591 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:02:11.242988 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m18:02:11.321805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:11.322091 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:02:11.322257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:11.342577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12666471-5479-4e15-8932-6f3ec061ce86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112147fa0>]}
[0m18:02:11.386706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m18:02:11.388144 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m18:02:11.399266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12666471-5479-4e15-8932-6f3ec061ce86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b5f60>]}
[0m18:02:11.399571 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m18:02:11.399770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12666471-5479-4e15-8932-6f3ec061ce86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e8820>]}
[0m18:02:11.400114 [warn ] [MainThread]: The selection criterion 'cd' does not match any enabled nodes
[0m18:02:11.400321 [warn ] [MainThread]: The selection criterion '..' does not match any enabled nodes
[0m18:02:11.400915 [info ] [MainThread]: 
[0m18:02:11.401099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:02:11.401247 [info ] [MainThread]: 
[0m18:02:11.401511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:02:11.404017 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m18:02:11.437934 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m18:02:11.438235 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m18:02:11.438403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:12.483960 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.045 seconds
[0m18:02:12.487613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m18:02:12.488463 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m18:02:12.491479 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m18:02:12.491695 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m18:02:12.637129 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24d1e-0306-09f2-0004-85da0002dac2
[0m18:02:12.637833 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m18:02:12.638093 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:02:12.638244 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:02:12.638678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:12.638862 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m18:02:12.639020 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m18:02:12.772316 [info ] [MainThread]: 
[0m18:02:12.773411 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m18:02:12.774242 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m18:02:12.777645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9781976, "process_in_blocks": "0", "process_kernel_time": 0.238209, "process_mem_max_rss": "157564928", "process_out_blocks": "0", "process_user_time": 1.359767}
[0m18:02:12.778139 [debug] [MainThread]: Command `dbt run` failed at 18:02:12.778063 after 1.98 seconds
[0m18:02:12.778534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112189bd0>]}
[0m18:02:12.778913 [debug] [MainThread]: Flushing usage events
[0m18:02:13.530097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:48.052196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a98430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a98580>]}


============================== 18:44:48.055865 | cf18ddf4-47f2-4ee7-9089-23c4d6923432 ==============================
[0m18:44:48.055865 [info ] [MainThread]: Running with dbt=1.11.3
[0m18:44:48.056206 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True'}
[0m18:44:48.064941 [info ] [MainThread]: dbt version: 1.11.3
[0m18:44:48.065162 [info ] [MainThread]: python version: 3.10.19
[0m18:44:48.065326 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m18:44:48.065490 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m18:44:48.275680 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:44:48.276014 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:44:48.276190 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:44:48.307386 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m18:44:48.307650 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m18:44:48.307820 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m18:44:48.308145 [info ] [MainThread]: adapter type: snowflake
[0m18:44:48.308343 [info ] [MainThread]: adapter version: 1.11.1
[0m18:44:48.361768 [info ] [MainThread]: Configuration:
[0m18:44:48.362098 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:44:48.362271 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:44:48.362424 [info ] [MainThread]: Required dependencies:
[0m18:44:48.362619 [debug] [MainThread]: Executing "git --help"
[0m18:44:48.379623 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:44:48.380278 [debug] [MainThread]: STDERR: "b''"
[0m18:44:48.380509 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:44:48.380702 [info ] [MainThread]: Connection:
[0m18:44:48.380914 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m18:44:48.381062 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m18:44:48.381208 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m18:44:48.381354 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m18:44:48.381494 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m18:44:48.381631 [info ] [MainThread]:   schema: RAW
[0m18:44:48.381769 [info ] [MainThread]:   authenticator: jwt
[0m18:44:48.381908 [info ] [MainThread]:   oauth_client_id: None
[0m18:44:48.382045 [info ] [MainThread]:   query_tag: None
[0m18:44:48.382182 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:44:48.382317 [info ] [MainThread]:   host: None
[0m18:44:48.382454 [info ] [MainThread]:   port: None
[0m18:44:48.382588 [info ] [MainThread]:   proxy_host: None
[0m18:44:48.382724 [info ] [MainThread]:   proxy_port: None
[0m18:44:48.382859 [info ] [MainThread]:   protocol: None
[0m18:44:48.382995 [info ] [MainThread]:   connect_retries: 1
[0m18:44:48.383128 [info ] [MainThread]:   connect_timeout: None
[0m18:44:48.383264 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:44:48.383532 [info ] [MainThread]:   retry_all: False
[0m18:44:48.383728 [info ] [MainThread]:   insecure_mode: False
[0m18:44:48.383891 [info ] [MainThread]:   reuse_connections: True
[0m18:44:48.384042 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m18:44:48.384187 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m18:44:48.384577 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:44:48.448406 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:44:48.476225 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:44:48.476496 [debug] [MainThread]: On debug: select 1 as id
[0m18:44:48.476652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:49.077952 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.601 seconds
[0m18:44:49.080985 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:44:49.081641 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:44:49.086119 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0784332, "process_in_blocks": "0", "process_kernel_time": 0.219657, "process_mem_max_rss": "152076288", "process_out_blocks": "0", "process_user_time": 1.148574}
[0m18:44:49.086677 [debug] [MainThread]: Command `dbt debug` succeeded at 18:44:49.086550 after 1.08 seconds
[0m18:44:49.087066 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:44:49.087513 [debug] [MainThread]: On debug: Close
[0m18:44:49.173876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772f1f0>]}
[0m18:44:49.174396 [debug] [MainThread]: Flushing usage events
[0m18:44:49.701742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:07.225564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e60c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38580>]}


============================== 18:45:07.229151 | 74ffd18e-1312-4995-9026-318246426a7a ==============================
[0m18:45:07.229151 [info ] [MainThread]: Running with dbt=1.11.3
[0m18:45:07.229484 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select staging', 'use_colors': 'True', 'no_print': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt'}
[0m18:45:07.434312 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:45:07.434628 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:45:07.434808 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:45:07.528322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74ffd18e-1312-4995-9026-318246426a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bef50>]}
[0m18:45:07.559178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74ffd18e-1312-4995-9026-318246426a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088026e0>]}
[0m18:45:07.559790 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:45:07.628659 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m18:45:07.706631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:07.706891 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:45:07.707052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:07.727226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74ffd18e-1312-4995-9026-318246426a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a181480>]}
[0m18:45:07.771634 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m18:45:07.773334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m18:45:07.783892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74ffd18e-1312-4995-9026-318246426a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f4f70>]}
[0m18:45:07.784192 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m18:45:07.784389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ffd18e-1312-4995-9026-318246426a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a128550>]}
[0m18:45:07.785098 [info ] [MainThread]: 
[0m18:45:07.785290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:07.785447 [info ] [MainThread]: 
[0m18:45:07.785714 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:07.788206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m18:45:07.821087 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m18:45:07.821447 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m18:45:07.821618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:08.287807 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.466 seconds
[0m18:45:08.289723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m18:45:08.290241 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m18:45:08.294766 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m18:45:08.295131 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m18:45:08.389361 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24d49-0306-09f2-0004-85da0002dd06
[0m18:45:08.389765 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m18:45:08.390168 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:45:08.390440 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:45:08.391057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:08.391342 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m18:45:08.391613 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m18:45:08.504835 [info ] [MainThread]: 
[0m18:45:08.506155 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m18:45:08.506786 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m18:45:08.510837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3252668, "process_in_blocks": "0", "process_kernel_time": 0.221115, "process_mem_max_rss": "159285248", "process_out_blocks": "0", "process_user_time": 1.328381}
[0m18:45:08.511398 [debug] [MainThread]: Command `dbt run` failed at 18:45:08.511279 after 1.33 seconds
[0m18:45:08.511835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e60c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c5b10>]}
[0m18:45:08.512251 [debug] [MainThread]: Flushing usage events
[0m18:45:09.020904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:34.548300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e40c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f18580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f186d0>]}


============================== 20:21:34.551941 | c2d6b18c-e115-467c-8e6e-46e0a57a6620 ==============================
[0m20:21:34.551941 [info ] [MainThread]: Running with dbt=1.11.3
[0m20:21:34.552284 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select staging', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None'}
[0m20:21:34.772456 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m20:21:34.772792 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m20:21:34.772978 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m20:21:34.866476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2d6b18c-e115-467c-8e6e-46e0a57a6620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078588e0>]}
[0m20:21:34.897153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2d6b18c-e115-467c-8e6e-46e0a57a6620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0bc40>]}
[0m20:21:34.897690 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m20:21:34.969897 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m20:21:35.048379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:21:35.048658 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:21:35.048811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:21:35.069013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2d6b18c-e115-467c-8e6e-46e0a57a6620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a161480>]}
[0m20:21:35.113307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m20:21:35.114567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m20:21:35.125684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2d6b18c-e115-467c-8e6e-46e0a57a6620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d0c70>]}
[0m20:21:35.125995 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m20:21:35.126195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d6b18c-e115-467c-8e6e-46e0a57a6620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a108700>]}
[0m20:21:35.126913 [info ] [MainThread]: 
[0m20:21:35.127100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:21:35.127251 [info ] [MainThread]: 
[0m20:21:35.127510 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:21:35.130019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m20:21:35.163406 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m20:21:35.163847 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m20:21:35.164032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:35.921973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.758 seconds
[0m20:21:35.926247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m20:21:35.926954 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m20:21:35.932327 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m20:21:35.932740 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m20:21:36.072657 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24da9-0306-1054-0004-85da00036a26
[0m20:21:36.073900 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m20:21:36.075016 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m20:21:36.075379 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:21:36.076080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:36.076390 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m20:21:36.076666 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m20:21:36.213445 [info ] [MainThread]: 
[0m20:21:36.214759 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m20:21:36.215916 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m20:21:36.219450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7152492, "process_in_blocks": "0", "process_kernel_time": 0.24305, "process_mem_max_rss": "158384128", "process_out_blocks": "0", "process_user_time": 1.348507}
[0m20:21:36.219968 [debug] [MainThread]: Command `dbt run` failed at 20:21:36.219876 after 1.72 seconds
[0m20:21:36.220338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e40c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a163580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a5570>]}
[0m20:21:36.220704 [debug] [MainThread]: Flushing usage events
[0m20:21:36.756055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:17.006020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d08c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de04f0>]}


============================== 20:56:17.009769 | 154daa29-08fb-4bb8-87cf-c1efb283b286 ==============================
[0m20:56:17.009769 [info ] [MainThread]: Running with dbt=1.11.3
[0m20:56:17.010144 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/Users/elham/.dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:56:17.220388 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m20:56:17.220711 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m20:56:17.220895 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m20:56:17.314271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154daa29-08fb-4bb8-87cf-c1efb283b286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f694e0>]}
[0m20:56:17.344864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154daa29-08fb-4bb8-87cf-c1efb283b286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abe0e0>]}
[0m20:56:17.345416 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m20:56:17.413123 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m20:56:17.492122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:17.492402 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:56:17.492554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:17.512979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154daa29-08fb-4bb8-87cf-c1efb283b286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a029450>]}
[0m20:56:17.557031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m20:56:17.558720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m20:56:17.569725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154daa29-08fb-4bb8-87cf-c1efb283b286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f98e80>]}
[0m20:56:17.570043 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m20:56:17.570245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154daa29-08fb-4bb8-87cf-c1efb283b286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd0760>]}
[0m20:56:17.570967 [info ] [MainThread]: 
[0m20:56:17.571153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:17.571307 [info ] [MainThread]: 
[0m20:56:17.571563 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:56:17.574030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m20:56:17.607788 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m20:56:17.608130 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m20:56:17.608303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:18.253723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.645 seconds
[0m20:56:18.256948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE)
[0m20:56:18.257594 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "RAW_STAGE"
"
[0m20:56:18.262763 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"
[0m20:56:18.263146 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.RAW_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE"} */
[0m20:56:18.337328 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24dcc-0306-10cf-0004-85da0003862e
[0m20:56:18.338116 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m20:56:18.338566 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m20:56:18.338854 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:56:18.339522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:18.339813 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE' was left open.
[0m20:56:18.340092 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_RAW_STAGE: Close
[0m20:56:18.443754 [info ] [MainThread]: 
[0m20:56:18.444660 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m20:56:18.445146 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m20:56:18.448620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4869491, "process_in_blocks": "0", "process_kernel_time": 0.230497, "process_mem_max_rss": "158957568", "process_out_blocks": "0", "process_user_time": 1.335776}
[0m20:56:18.449083 [debug] [MainThread]: Command `dbt run` failed at 20:56:18.448994 after 1.49 seconds
[0m20:56:18.449487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d08c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a028a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06db40>]}
[0m20:56:18.449864 [debug] [MainThread]: Flushing usage events
[0m20:56:19.033000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:19.344588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104618be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f44f0>]}


============================== 21:05:19.348122 | f68dd2cc-d8bc-43b9-9a57-e094ec76cd6a ==============================
[0m21:05:19.348122 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:05:19.348476 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/Users/elham/.dbt', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt debug', 'write_json': 'True', 'debug': 'False', 'empty': 'None', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m21:05:19.357256 [info ] [MainThread]: dbt version: 1.11.3
[0m21:05:19.357474 [info ] [MainThread]: python version: 3.10.19
[0m21:05:19.357639 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m21:05:19.357799 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m21:05:19.569491 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:05:19.569809 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:05:19.569983 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:05:19.600787 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m21:05:19.601045 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m21:05:19.601214 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m21:05:19.601519 [info ] [MainThread]: adapter type: snowflake
[0m21:05:19.601678 [info ] [MainThread]: adapter version: 1.11.1
[0m21:05:19.654189 [info ] [MainThread]: Configuration:
[0m21:05:19.654503 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:05:19.654667 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:05:19.654818 [info ] [MainThread]: Required dependencies:
[0m21:05:19.655010 [debug] [MainThread]: Executing "git --help"
[0m21:05:19.682463 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:05:19.683077 [debug] [MainThread]: STDERR: "b''"
[0m21:05:19.683297 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:05:19.683489 [info ] [MainThread]: Connection:
[0m21:05:19.683723 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m21:05:19.683878 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m21:05:19.684019 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m21:05:19.684163 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m21:05:19.684302 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m21:05:19.684442 [info ] [MainThread]:   schema: RAW
[0m21:05:19.684579 [info ] [MainThread]:   authenticator: jwt
[0m21:05:19.684721 [info ] [MainThread]:   oauth_client_id: None
[0m21:05:19.684859 [info ] [MainThread]:   query_tag: None
[0m21:05:19.685007 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:05:19.685145 [info ] [MainThread]:   host: None
[0m21:05:19.685282 [info ] [MainThread]:   port: None
[0m21:05:19.685531 [info ] [MainThread]:   proxy_host: None
[0m21:05:19.685716 [info ] [MainThread]:   proxy_port: None
[0m21:05:19.685876 [info ] [MainThread]:   protocol: None
[0m21:05:19.686023 [info ] [MainThread]:   connect_retries: 1
[0m21:05:19.686166 [info ] [MainThread]:   connect_timeout: None
[0m21:05:19.686308 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:05:19.686447 [info ] [MainThread]:   retry_all: False
[0m21:05:19.686585 [info ] [MainThread]:   insecure_mode: False
[0m21:05:19.686722 [info ] [MainThread]:   reuse_connections: True
[0m21:05:19.686860 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m21:05:19.686996 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m21:05:19.687393 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m21:05:19.750433 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:05:19.777951 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:05:19.778244 [debug] [MainThread]: On debug: select 1 as id
[0m21:05:19.778412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:20.425895 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.647 seconds
[0m21:05:20.429010 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:05:20.429654 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:05:20.435247 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1342176, "process_in_blocks": "0", "process_kernel_time": 0.228157, "process_mem_max_rss": "151289856", "process_out_blocks": "0", "process_user_time": 1.153853}
[0m21:05:20.435824 [debug] [MainThread]: Command `dbt debug` succeeded at 21:05:20.435711 after 1.13 seconds
[0m21:05:20.436178 [debug] [MainThread]: Connection 'debug' was left open.
[0m21:05:20.436447 [debug] [MainThread]: On debug: Close
[0m21:05:20.533704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104618be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104950a00>]}
[0m21:05:20.535228 [debug] [MainThread]: Flushing usage events
[0m21:05:21.083260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:42.597074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e8550>]}


============================== 21:14:42.600825 | ec670e19-98e4-416a-a7c8-94658b20fae2 ==============================
[0m21:14:42.600825 [info ] [MainThread]: Running with dbt=1.11.3
[0m21:14:42.601169 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m21:14:42.817363 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:14:42.817673 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:14:42.817848 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:14:42.910274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec670e19-98e4-416a-a7c8-94658b20fae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f38d90>]}
[0m21:14:42.940546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec670e19-98e4-416a-a7c8-94658b20fae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb2020>]}
[0m21:14:42.941119 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m21:14:43.013185 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m21:14:43.065716 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:14:43.066054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec670e19-98e4-416a-a7c8-94658b20fae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f88a30>]}
[0m21:14:43.716318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec670e19-98e4-416a-a7c8-94658b20fae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111981e10>]}
[0m21:14:43.756583 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m21:14:43.757982 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m21:14:43.768544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec670e19-98e4-416a-a7c8-94658b20fae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111981120>]}
[0m21:14:43.768837 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m21:14:43.769028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec670e19-98e4-416a-a7c8-94658b20fae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111981f90>]}
[0m21:14:43.769730 [info ] [MainThread]: 
[0m21:14:43.769911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:43.770060 [info ] [MainThread]: 
[0m21:14:43.770319 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:14:43.773020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m21:14:43.810001 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m21:14:43.810295 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m21:14:43.810459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:44.652501 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.842 seconds
[0m21:14:44.656722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m21:14:44.657413 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "STAGE_STAGE"
"
[0m21:14:44.662776 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m21:14:44.663173 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
[0m21:14:44.753098 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24dde-0306-09f2-0004-85da0002deb6
[0m21:14:44.753606 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m21:14:44.754047 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m21:14:44.754334 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:14:44.755015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:44.755351 [debug] [MainThread]: Connection 'create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE' was left open.
[0m21:14:44.755642 [debug] [MainThread]: On create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m21:14:44.851977 [info ] [MainThread]: 
[0m21:14:44.853098 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m21:14:44.853829 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'AMAZON_REVIEW_ANALYTICS_DEV'.
[0m21:14:44.856999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3024018, "process_in_blocks": "0", "process_kernel_time": 0.224998, "process_mem_max_rss": "165265408", "process_out_blocks": "0", "process_user_time": 1.933542}
[0m21:14:44.857489 [debug] [MainThread]: Command `dbt run` failed at 21:14:44.857396 after 2.30 seconds
[0m21:14:44.857872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119835e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f1720>]}
[0m21:14:44.858370 [debug] [MainThread]: Flushing usage events
[0m21:14:45.327114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:50.170835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ac430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ac580>]}


============================== 02:37:50.174524 | 6aaadaec-ab2f-4147-9053-969a84d5cde7 ==============================
[0m02:37:50.174524 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:37:50.174856 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'profiles_dir': '/Users/elham/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'no_print': 'None', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False'}
[0m02:37:50.182840 [info ] [MainThread]: dbt version: 1.11.3
[0m02:37:50.183112 [info ] [MainThread]: python version: 3.10.19
[0m02:37:50.183284 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m02:37:50.183448 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m02:37:50.367382 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m02:37:50.367692 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m02:37:50.367870 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m02:37:50.398438 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m02:37:50.398709 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m02:37:50.398879 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m02:37:50.399222 [info ] [MainThread]: adapter type: snowflake
[0m02:37:50.399422 [info ] [MainThread]: adapter version: 1.11.1
[0m02:37:50.452888 [info ] [MainThread]: Configuration:
[0m02:37:50.453228 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:37:50.453399 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:37:50.453550 [info ] [MainThread]: Required dependencies:
[0m02:37:50.453759 [debug] [MainThread]: Executing "git --help"
[0m02:37:50.467776 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:37:50.468437 [debug] [MainThread]: STDERR: "b''"
[0m02:37:50.468664 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:37:50.468854 [info ] [MainThread]: Connection:
[0m02:37:50.469073 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m02:37:50.469227 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m02:37:50.469373 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m02:37:50.469528 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m02:37:50.469672 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m02:37:50.469812 [info ] [MainThread]:   schema: STAGE
[0m02:37:50.469950 [info ] [MainThread]:   authenticator: jwt
[0m02:37:50.470090 [info ] [MainThread]:   oauth_client_id: None
[0m02:37:50.470235 [info ] [MainThread]:   query_tag: None
[0m02:37:50.470374 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:37:50.470511 [info ] [MainThread]:   host: None
[0m02:37:50.470651 [info ] [MainThread]:   port: None
[0m02:37:50.470790 [info ] [MainThread]:   proxy_host: None
[0m02:37:50.470924 [info ] [MainThread]:   proxy_port: None
[0m02:37:50.471058 [info ] [MainThread]:   protocol: None
[0m02:37:50.471195 [info ] [MainThread]:   connect_retries: 1
[0m02:37:50.471332 [info ] [MainThread]:   connect_timeout: None
[0m02:37:50.471466 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:37:50.471597 [info ] [MainThread]:   retry_all: False
[0m02:37:50.471728 [info ] [MainThread]:   insecure_mode: False
[0m02:37:50.471861 [info ] [MainThread]:   reuse_connections: True
[0m02:37:50.471990 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m02:37:50.472121 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m02:37:50.472666 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m02:37:50.538975 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:37:50.565003 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:37:50.565278 [debug] [MainThread]: On debug: select 1 as id
[0m02:37:50.565472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:37:51.070519 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.505 seconds
[0m02:37:51.073049 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:37:51.073642 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:37:51.076720 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9453285, "process_in_blocks": "0", "process_kernel_time": 0.164706, "process_mem_max_rss": "151207936", "process_out_blocks": "0", "process_user_time": 1.134905}
[0m02:37:51.077311 [debug] [MainThread]: Command `dbt debug` succeeded at 02:37:51.077198 after 0.95 seconds
[0m02:37:51.077697 [debug] [MainThread]: Connection 'debug' was left open.
[0m02:37:51.077998 [debug] [MainThread]: On debug: Close
[0m02:37:51.155873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109235ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f87970>]}
[0m02:37:51.156855 [debug] [MainThread]: Flushing usage events
[0m02:37:51.611787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:58.575072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e8550>]}


============================== 02:37:58.578659 | ec0dc56d-e2c6-4c53-af34-00f83ca7752f ==============================
[0m02:37:58.578659 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:37:58.579094 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select staging', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m02:37:58.767536 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m02:37:58.767868 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m02:37:58.768044 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m02:37:58.860053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d34d90>]}
[0m02:37:58.890621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb2020>]}
[0m02:37:58.891122 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m02:37:58.961922 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:37:59.041052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:37:59.041324 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:37:59.041473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:37:59.061650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b9450>]}
[0m02:37:59.106099 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m02:37:59.107602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m02:37:59.118576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112ae90>]}
[0m02:37:59.118873 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m02:37:59.119062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111161270>]}
[0m02:37:59.119764 [info ] [MainThread]: 
[0m02:37:59.119946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:37:59.120095 [info ] [MainThread]: 
[0m02:37:59.120353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:37:59.122871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m02:37:59.151206 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m02:37:59.151476 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m02:37:59.151644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:59.616475 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.465 seconds
[0m02:37:59.618649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m02:37:59.619150 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "STAGE_STAGE"
"
[0m02:37:59.624299 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m02:37:59.624708 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
[0m02:37:59.718181 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m02:37:59.723059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m02:37:59.723666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m02:37:59.740651 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m02:37:59.741259 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m02:37:59.741657 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m02:37:59.741992 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m02:37:59.742277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:59.910463 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.168 seconds
[0m02:38:00.254069 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24f22-0306-11e3-0004-85da0003910e
[0m02:38:00.255266 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:38:00.255960 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:38:00.256359 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:38:00.257100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110adc160>]}
[0m02:38:00.260417 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m02:38:00.260842 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m02:38:00.261426 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m02:38:00.261988 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m02:38:00.262435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m02:38:00.262830 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m02:38:00.263177 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m02:38:00.263517 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m02:38:00.272487 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m02:38:00.275304 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m02:38:00.276550 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m02:38:00.282121 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m02:38:00.308970 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m02:38:00.310585 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m02:38:00.312102 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m02:38:00.312463 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m02:38:00.313152 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m02:38:00.313901 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m02:38:00.396001 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24f22-0306-11e3-0004-85da00039112
[0m02:38:00.396444 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m02:38:00.398323 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m02:38:00.400164 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10377da50>]}
[0m02:38:00.400801 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.14s]
[0m02:38:00.401352 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m02:38:00.401842 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m02:38:00.442111 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24f22-0306-09f2-0004-85da0003a10a
[0m02:38:00.442589 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m02:38:00.443868 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m02:38:00.444393 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0dc56d-e2c6-4c53-af34-00f83ca7752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c83880>]}
[0m02:38:00.445003 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.18s]
[0m02:38:00.445548 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m02:38:00.446020 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m02:38:00.447061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:38:00.447350 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m02:38:00.447617 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m02:38:00.503184 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m02:38:00.503789 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m02:38:00.568863 [info ] [MainThread]: 
[0m02:38:00.569656 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m02:38:00.570916 [debug] [MainThread]: Command end result
[0m02:38:00.638878 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m02:38:00.639903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m02:38:00.643398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m02:38:00.643626 [info ] [MainThread]: 
[0m02:38:00.643867 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m02:38:00.644068 [info ] [MainThread]: 
[0m02:38:00.644306 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m02:38:00.644534 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m02:38:00.644720 [info ] [MainThread]: 
[0m02:38:00.644937 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m02:38:00.645111 [info ] [MainThread]: 
[0m02:38:00.645325 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m02:38:00.645546 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m02:38:00.645719 [info ] [MainThread]: 
[0m02:38:00.645919 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m02:38:00.646083 [info ] [MainThread]: 
[0m02:38:00.646265 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m02:38:00.648008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1225264, "process_in_blocks": "0", "process_kernel_time": 0.225784, "process_mem_max_rss": "162611200", "process_out_blocks": "0", "process_user_time": 1.71988}
[0m02:38:00.648242 [debug] [MainThread]: Command `dbt run` failed at 02:38:00.648198 after 2.12 seconds
[0m02:38:00.648442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111168160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111168cd0>]}
[0m02:38:00.648639 [debug] [MainThread]: Flushing usage events
[0m02:38:01.085380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:05:06.830838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb8610>]}


============================== 04:05:06.834529 | 09df7e2a-4ab4-48a2-b16a-8208554739d3 ==============================
[0m04:05:06.834529 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:05:06.834895 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/elham/.dbt', 'version_check': 'True', 'invocation_command': 'dbt run --select staging', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m04:05:07.042883 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m04:05:07.043197 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m04:05:07.043374 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m04:05:07.137005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e7880>]}
[0m04:05:07.167858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f8850>]}
[0m04:05:07.168423 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m04:05:07.240763 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m04:05:07.321656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:05:07.321920 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m04:05:07.322078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:05:07.342433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a203fa0>]}
[0m04:05:07.387487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:05:07.389101 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:05:07.400522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a172770>]}
[0m04:05:07.400827 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m04:05:07.401028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a8580>]}
[0m04:05:07.401750 [info ] [MainThread]: 
[0m04:05:07.401951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:05:07.402111 [info ] [MainThread]: 
[0m04:05:07.402384 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:05:07.404870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m04:05:07.438520 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m04:05:07.438851 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m04:05:07.439019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:08.034846 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.596 seconds
[0m04:05:08.038011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m04:05:08.038701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m04:05:08.052100 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m04:05:08.054560 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m04:05:08.054920 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m04:05:08.055241 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m04:05:08.056352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:08.268764 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.213 seconds
[0m04:05:08.412387 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24f79-0306-108b-0004-85da00037fae
[0m04:05:08.413514 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m04:05:08.414242 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m04:05:08.414628 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:05:08.415421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bac130>]}
[0m04:05:08.418362 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m04:05:08.418762 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m04:05:08.419321 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m04:05:08.419850 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m04:05:08.420286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m04:05:08.420647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m04:05:08.420984 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m04:05:08.421308 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m04:05:08.430896 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m04:05:08.433720 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:05:08.434875 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m04:05:08.435232 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m04:05:08.467390 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m04:05:08.468900 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:05:08.470167 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m04:05:08.470795 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m04:05:08.471113 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m04:05:08.471427 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m04:05:08.553566 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24f79-0306-10cf-0004-85da0003893e
[0m04:05:08.553998 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m04:05:08.555785 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:05:08.557614 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fada0>]}
[0m04:05:08.558266 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.14s]
[0m04:05:08.558819 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m04:05:08.559311 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m04:05:08.574442 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24f79-0306-11e3-0004-85da00039192
[0m04:05:08.574734 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m04:05:08.576194 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:05:08.576793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df7e2a-4ab4-48a2-b16a-8208554739d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accd780>]}
[0m04:05:08.577450 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.16s]
[0m04:05:08.578029 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m04:05:08.578482 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m04:05:08.579483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:08.579774 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m04:05:08.580052 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m04:05:08.673670 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m04:05:08.674461 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m04:05:08.771508 [info ] [MainThread]: 
[0m04:05:08.772255 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m04:05:08.773107 [debug] [MainThread]: Command end result
[0m04:05:08.845311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:05:08.846439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:05:08.850508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m04:05:08.850719 [info ] [MainThread]: 
[0m04:05:08.850942 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:05:08.851128 [info ] [MainThread]: 
[0m04:05:08.851346 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m04:05:08.851557 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:05:08.851722 [info ] [MainThread]: 
[0m04:05:08.851916 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:05:08.852086 [info ] [MainThread]: 
[0m04:05:08.852281 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m04:05:08.852484 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:05:08.852647 [info ] [MainThread]: 
[0m04:05:08.852837 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:05:08.852995 [info ] [MainThread]: 
[0m04:05:08.853172 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m04:05:08.855027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.071704, "process_in_blocks": "0", "process_kernel_time": 0.252609, "process_mem_max_rss": "160612352", "process_out_blocks": "0", "process_user_time": 1.626976}
[0m04:05:08.855292 [debug] [MainThread]: Command `dbt run` failed at 04:05:08.855246 after 2.07 seconds
[0m04:05:08.855512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df7550>]}
[0m04:05:08.855741 [debug] [MainThread]: Flushing usage events
[0m04:05:09.382140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:18:09.956676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b08bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be4610>]}


============================== 04:18:09.960182 | a9bf6879-5cb7-4151-b1c0-a9c9da117864 ==============================
[0m04:18:09.960182 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:18:09.960557 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'introspect': 'True', 'empty': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_format': 'default'}
[0m04:18:09.969342 [info ] [MainThread]: dbt version: 1.11.3
[0m04:18:09.969578 [info ] [MainThread]: python version: 3.10.19
[0m04:18:09.969743 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m04:18:09.969898 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m04:18:10.178091 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m04:18:10.178408 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m04:18:10.178590 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m04:18:10.209635 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m04:18:10.209915 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m04:18:10.210085 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m04:18:10.210421 [info ] [MainThread]: adapter type: snowflake
[0m04:18:10.210621 [info ] [MainThread]: adapter version: 1.11.1
[0m04:18:10.263891 [info ] [MainThread]: Configuration:
[0m04:18:10.264209 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:18:10.264382 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:18:10.264541 [info ] [MainThread]: Required dependencies:
[0m04:18:10.264741 [debug] [MainThread]: Executing "git --help"
[0m04:18:10.279959 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:18:10.280644 [debug] [MainThread]: STDERR: "b''"
[0m04:18:10.280905 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:18:10.281098 [info ] [MainThread]: Connection:
[0m04:18:10.281321 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m04:18:10.281477 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m04:18:10.281625 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m04:18:10.281768 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m04:18:10.281907 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m04:18:10.282048 [info ] [MainThread]:   schema: STAGE
[0m04:18:10.282188 [info ] [MainThread]:   authenticator: jwt
[0m04:18:10.282324 [info ] [MainThread]:   oauth_client_id: None
[0m04:18:10.282461 [info ] [MainThread]:   query_tag: None
[0m04:18:10.282597 [info ] [MainThread]:   client_session_keep_alive: False
[0m04:18:10.282733 [info ] [MainThread]:   host: None
[0m04:18:10.282870 [info ] [MainThread]:   port: None
[0m04:18:10.283006 [info ] [MainThread]:   proxy_host: None
[0m04:18:10.283139 [info ] [MainThread]:   proxy_port: None
[0m04:18:10.283276 [info ] [MainThread]:   protocol: None
[0m04:18:10.283410 [info ] [MainThread]:   connect_retries: 1
[0m04:18:10.283543 [info ] [MainThread]:   connect_timeout: None
[0m04:18:10.283681 [info ] [MainThread]:   retry_on_database_errors: False
[0m04:18:10.283816 [info ] [MainThread]:   retry_all: False
[0m04:18:10.283946 [info ] [MainThread]:   insecure_mode: False
[0m04:18:10.284079 [info ] [MainThread]:   reuse_connections: True
[0m04:18:10.284214 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m04:18:10.284357 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m04:18:10.284726 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m04:18:10.351994 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m04:18:10.382021 [debug] [MainThread]: Using snowflake connection "debug"
[0m04:18:10.382290 [debug] [MainThread]: On debug: select 1 as id
[0m04:18:10.382445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:18:10.928601 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.546 seconds
[0m04:18:10.931379 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:18:10.931989 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:18:10.935662 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0209955, "process_in_blocks": "0", "process_kernel_time": 0.208881, "process_mem_max_rss": "151142400", "process_out_blocks": "0", "process_user_time": 1.133546}
[0m04:18:10.936188 [debug] [MainThread]: Command `dbt debug` succeeded at 04:18:10.936074 after 1.02 seconds
[0m04:18:10.936573 [debug] [MainThread]: Connection 'debug' was left open.
[0m04:18:10.936870 [debug] [MainThread]: On debug: Close
[0m04:18:11.005236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b08bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109965ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109489660>]}
[0m04:18:11.005812 [debug] [MainThread]: Flushing usage events
[0m04:18:11.520875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:18:33.213165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108980460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089805b0>]}


============================== 04:18:33.216634 | 3c8e588b-74bf-446b-97d3-aec08a3e49f2 ==============================
[0m04:18:33.216634 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:18:33.216961 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'invocation_command': 'dbt ls --select staging', 'partial_parse': 'True', 'quiet': 'False'}
[0m04:18:33.414777 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m04:18:33.415093 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m04:18:33.415271 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m04:18:33.508173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c8e588b-74bf-446b-97d3-aec08a3e49f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f06f50>]}
[0m04:18:33.538837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c8e588b-74bf-446b-97d3-aec08a3e49f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827a770>]}
[0m04:18:33.539398 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m04:18:33.607407 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m04:18:33.685341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:33.685602 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m04:18:33.685756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:33.705852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c8e588b-74bf-446b-97d3-aec08a3e49f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc57b0>]}
[0m04:18:33.750084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:18:33.751865 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:18:33.761913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c8e588b-74bf-446b-97d3-aec08a3e49f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3ea40>]}
[0m04:18:33.762230 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m04:18:33.762424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8e588b-74bf-446b-97d3-aec08a3e49f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6f580>]}
[0m04:18:33.762735 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_meta
[0m04:18:33.762904 [info ] [MainThread]: capstone_amazon_analytics.staging.stg_reviews
[0m04:18:33.764993 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.59255, "process_in_blocks": "0", "process_kernel_time": 0.169557, "process_mem_max_rss": "140705792", "process_out_blocks": "0", "process_user_time": 1.076016}
[0m04:18:33.765434 [debug] [MainThread]: Command `dbt ls` succeeded at 04:18:33.765379 after 0.59 seconds
[0m04:18:33.765657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109689bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827a770>]}
[0m04:18:33.765857 [debug] [MainThread]: Flushing usage events
[0m04:18:34.222616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:19:17.168676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff4610>]}


============================== 04:19:17.172276 | b3887d1a-9468-4e45-a4a9-a525e457cd9c ==============================
[0m04:19:17.172276 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:19:17.172610 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/elham/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select staging', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None'}
[0m04:19:17.378851 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m04:19:17.379158 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m04:19:17.379334 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m04:19:17.472679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108927880>]}
[0m04:19:17.503291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107930850>]}
[0m04:19:17.503915 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m04:19:17.572207 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m04:19:17.651201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:19:17.651463 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m04:19:17.651616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:19:17.671709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23ffa0>]}
[0m04:19:17.715154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:19:17.716683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:19:17.727660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ac1c0>]}
[0m04:19:17.727957 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m04:19:17.728154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e4580>]}
[0m04:19:17.728858 [info ] [MainThread]: 
[0m04:19:17.729049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:19:17.729205 [info ] [MainThread]: 
[0m04:19:17.729466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:19:17.731953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m04:19:17.767183 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m04:19:17.767473 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m04:19:17.767647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:18.323271 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.555 seconds
[0m04:19:18.326235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m04:19:18.326792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m04:19:18.339276 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m04:19:18.341682 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m04:19:18.342095 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m04:19:18.342509 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m04:19:18.343513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:18.534526 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24f87-0306-10cf-0004-85da000389ca
[0m04:19:18.534874 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m04:19:18.535173 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m04:19:18.535395 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:19:18.806993 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.463 seconds
[0m04:19:18.812099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b5210>]}
[0m04:19:18.816119 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m04:19:18.816529 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m04:19:18.817070 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m04:19:18.817682 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m04:19:18.818368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m04:19:18.818758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m04:19:18.819116 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m04:19:18.819448 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m04:19:18.828943 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m04:19:18.831731 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:19:18.832725 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m04:19:18.838995 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m04:19:18.866777 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m04:19:18.867248 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:19:18.868517 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m04:19:18.869225 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m04:19:18.869517 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m04:19:18.869844 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m04:19:18.955968 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24f87-0306-10cf-0004-85da000389ce
[0m04:19:18.956526 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m04:19:18.958410 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:19:18.960211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b38c820>]}
[0m04:19:18.960829 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.14s]
[0m04:19:18.961376 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m04:19:18.961881 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m04:19:18.981825 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24f87-0306-11e3-0004-85da000391f6
[0m04:19:18.982201 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m04:19:18.983794 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:19:18.984263 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3887d1a-9468-4e45-a4a9-a525e457cd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b414430>]}
[0m04:19:18.984833 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.17s]
[0m04:19:18.985355 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m04:19:18.985795 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m04:19:18.986772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:19:18.987067 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m04:19:18.987335 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m04:19:19.053099 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m04:19:19.053574 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m04:19:19.129422 [info ] [MainThread]: 
[0m04:19:19.130502 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m04:19:19.132517 [debug] [MainThread]: Command end result
[0m04:19:19.203334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:19:19.204475 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:19:19.208411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m04:19:19.208623 [info ] [MainThread]: 
[0m04:19:19.208847 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:19:19.209033 [info ] [MainThread]: 
[0m04:19:19.209252 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m04:19:19.209468 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:19:19.209635 [info ] [MainThread]: 
[0m04:19:19.209828 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:19:19.209989 [info ] [MainThread]: 
[0m04:19:19.210185 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m04:19:19.210385 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:19:19.210545 [info ] [MainThread]: 
[0m04:19:19.210732 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:19:19.210884 [info ] [MainThread]: 
[0m04:19:19.211059 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m04:19:19.212897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.08732, "process_in_blocks": "0", "process_kernel_time": 0.234193, "process_mem_max_rss": "161824768", "process_out_blocks": "0", "process_user_time": 1.632762}
[0m04:19:19.213158 [debug] [MainThread]: Command `dbt run` failed at 04:19:19.213112 after 2.09 seconds
[0m04:19:19.213378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e31de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e302b0>]}
[0m04:19:19.213603 [debug] [MainThread]: Flushing usage events
[0m04:19:19.661468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:26:30.517064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7c610>]}


============================== 04:26:30.520840 | 4f4923c8-e2d6-4e0a-b346-889bdf3cc280 ==============================
[0m04:26:30.520840 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:26:30.521190 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt clean', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'None'}
[0m04:26:30.586860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f4923c8-e2d6-4e0a-b346-889bdf3cc280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db7820>]}
[0m04:26:30.600735 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12746121, "process_in_blocks": "0", "process_kernel_time": 0.127665, "process_mem_max_rss": "112345088", "process_out_blocks": "0", "process_user_time": 0.743993}
[0m04:26:30.601079 [debug] [MainThread]: Command `dbt clean` succeeded at 04:26:30.601023 after 0.13 seconds
[0m04:26:30.601297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104771e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9e3e0>]}
[0m04:26:30.601504 [debug] [MainThread]: Flushing usage events
[0m04:26:31.132542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:26:38.300165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d8520>]}


============================== 04:26:38.303772 | be12435b-e649-4ece-b79f-2f8f603e51b9 ==============================
[0m04:26:38.303772 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:26:38.304094 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False'}
[0m04:26:38.312172 [info ] [MainThread]: dbt version: 1.11.3
[0m04:26:38.312393 [info ] [MainThread]: python version: 3.10.19
[0m04:26:38.312557 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m04:26:38.312715 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m04:26:38.524119 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m04:26:38.524443 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m04:26:38.524624 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m04:26:38.555626 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m04:26:38.555896 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m04:26:38.556069 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m04:26:38.556411 [info ] [MainThread]: adapter type: snowflake
[0m04:26:38.556627 [info ] [MainThread]: adapter version: 1.11.1
[0m04:26:38.610455 [info ] [MainThread]: Configuration:
[0m04:26:38.610779 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:26:38.610950 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:26:38.611109 [info ] [MainThread]: Required dependencies:
[0m04:26:38.611305 [debug] [MainThread]: Executing "git --help"
[0m04:26:38.624512 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:26:38.625123 [debug] [MainThread]: STDERR: "b''"
[0m04:26:38.625331 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:26:38.625525 [info ] [MainThread]: Connection:
[0m04:26:38.625743 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m04:26:38.625891 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m04:26:38.626032 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m04:26:38.626174 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m04:26:38.626311 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m04:26:38.626447 [info ] [MainThread]:   schema: STAGE
[0m04:26:38.626579 [info ] [MainThread]:   authenticator: jwt
[0m04:26:38.626714 [info ] [MainThread]:   oauth_client_id: None
[0m04:26:38.626845 [info ] [MainThread]:   query_tag: None
[0m04:26:38.626977 [info ] [MainThread]:   client_session_keep_alive: False
[0m04:26:38.627110 [info ] [MainThread]:   host: None
[0m04:26:38.627242 [info ] [MainThread]:   port: None
[0m04:26:38.627373 [info ] [MainThread]:   proxy_host: None
[0m04:26:38.627503 [info ] [MainThread]:   proxy_port: None
[0m04:26:38.627631 [info ] [MainThread]:   protocol: None
[0m04:26:38.627761 [info ] [MainThread]:   connect_retries: 1
[0m04:26:38.627890 [info ] [MainThread]:   connect_timeout: None
[0m04:26:38.628021 [info ] [MainThread]:   retry_on_database_errors: False
[0m04:26:38.628152 [info ] [MainThread]:   retry_all: False
[0m04:26:38.628283 [info ] [MainThread]:   insecure_mode: False
[0m04:26:38.628414 [info ] [MainThread]:   reuse_connections: True
[0m04:26:38.628545 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m04:26:38.628678 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m04:26:38.629044 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m04:26:38.694288 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m04:26:38.723075 [debug] [MainThread]: Using snowflake connection "debug"
[0m04:26:38.723344 [debug] [MainThread]: On debug: select 1 as id
[0m04:26:38.723499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:26:39.445990 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.722 seconds
[0m04:26:39.449032 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:26:39.449675 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:26:39.453228 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1932721, "process_in_blocks": "0", "process_kernel_time": 0.195402, "process_mem_max_rss": "151240704", "process_out_blocks": "0", "process_user_time": 1.14696}
[0m04:26:39.453741 [debug] [MainThread]: Command `dbt debug` succeeded at 04:26:39.453635 after 1.19 seconds
[0m04:26:39.454085 [debug] [MainThread]: Connection 'debug' was left open.
[0m04:26:39.454370 [debug] [MainThread]: On debug: Close
[0m04:26:39.538893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c148e0>]}
[0m04:26:39.539555 [debug] [MainThread]: Flushing usage events
[0m04:26:39.993489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:26:50.213690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104980580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049806d0>]}


============================== 04:26:50.216906 | 25010092-5fe5-44d1-ab91-13866e306105 ==============================
[0m04:26:50.216906 [info ] [MainThread]: Running with dbt=1.11.3
[0m04:26:50.217257 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select staging', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/elham/.dbt'}
[0m04:26:50.355025 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m04:26:50.355347 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m04:26:50.355529 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m04:26:50.446090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032c08e0>]}
[0m04:26:50.476745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427a380>]}
[0m04:26:50.477385 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m04:26:50.547955 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m04:26:50.548500 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:26:50.548724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105687820>]}
[0m04:26:51.222134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df97b0>]}
[0m04:26:51.263838 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:26:51.266245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:26:51.276531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d92ad0>]}
[0m04:26:51.276847 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m04:26:51.277047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d91d50>]}
[0m04:26:51.277740 [info ] [MainThread]: 
[0m04:26:51.277945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:26:51.278100 [info ] [MainThread]: 
[0m04:26:51.278361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:26:51.280834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m04:26:51.309138 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m04:26:51.309416 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m04:26:51.309581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:51.798320 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.489 seconds
[0m04:26:51.802290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m04:26:51.803083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m04:26:51.811422 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m04:26:51.813128 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m04:26:51.813402 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m04:26:51.813673 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m04:26:51.814420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:51.951934 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24f8e-0306-108b-0004-85da0003b046
[0m04:26:51.952236 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m04:26:51.952476 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m04:26:51.952647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:26:52.151257 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.337 seconds
[0m04:26:52.154819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105552c80>]}
[0m04:26:52.159316 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m04:26:52.159726 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m04:26:52.160272 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m04:26:52.160834 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m04:26:52.161311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m04:26:52.161687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m04:26:52.162059 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m04:26:52.162401 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m04:26:52.171145 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m04:26:52.173945 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:26:52.175081 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m04:26:52.175426 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m04:26:52.208115 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:26:52.209593 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m04:26:52.210973 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m04:26:52.211609 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m04:26:52.211923 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m04:26:52.212245 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m04:26:52.326645 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24f8e-0306-11e3-0004-85da000391fa
[0m04:26:52.327130 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m04:26:52.329295 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:26:52.331231 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24f8e-0306-09f2-0004-85da0003a22a
[0m04:26:52.331625 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m04:26:52.332239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4e080>]}
[0m04:26:52.332945 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.17s]
[0m04:26:52.333639 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m04:26:52.334499 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:26:52.334994 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m04:26:52.335452 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25010092-5fe5-44d1-ab91-13866e306105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4dff0>]}
[0m04:26:52.336538 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.17s]
[0m04:26:52.337129 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m04:26:52.337700 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m04:26:52.338757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:26:52.339057 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m04:26:52.339332 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m04:26:52.432853 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m04:26:52.433462 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m04:26:52.498012 [info ] [MainThread]: 
[0m04:26:52.498542 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m04:26:52.499333 [debug] [MainThread]: Command end result
[0m04:26:52.527257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m04:26:52.529012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m04:26:52.534958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m04:26:52.535312 [info ] [MainThread]: 
[0m04:26:52.535672 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:26:52.535961 [info ] [MainThread]: 
[0m04:26:52.536303 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m04:26:52.536644 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:26:52.536917 [info ] [MainThread]: 
[0m04:26:52.537222 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m04:26:52.537478 [info ] [MainThread]: 
[0m04:26:52.537785 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m04:26:52.538107 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:26:52.538363 [info ] [MainThread]: 
[0m04:26:52.538658 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m04:26:52.538908 [info ] [MainThread]: 
[0m04:26:52.539205 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m04:26:52.542281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3663166, "process_in_blocks": "0", "process_kernel_time": 0.180506, "process_mem_max_rss": "165412864", "process_out_blocks": "0", "process_user_time": 2.120748}
[0m04:26:52.542643 [debug] [MainThread]: Command `dbt run` failed at 04:26:52.542580 after 2.37 seconds
[0m04:26:52.542964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105615660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7ff70>]}
[0m04:26:52.543287 [debug] [MainThread]: Flushing usage events
[0m04:26:52.986636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:08:23.521993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077943a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077944f0>]}


============================== 05:08:23.525717 | 15d8b7b9-5e6f-4690-b336-d530467f69e5 ==============================
[0m05:08:23.525717 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:08:23.526080 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'empty': 'None'}
[0m05:08:23.534856 [info ] [MainThread]: dbt version: 1.11.3
[0m05:08:23.535070 [info ] [MainThread]: python version: 3.10.19
[0m05:08:23.535238 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m05:08:23.535401 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m05:08:23.751582 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:08:23.751899 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:08:23.752078 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:08:23.783360 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m05:08:23.783622 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m05:08:23.783790 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m05:08:23.784111 [info ] [MainThread]: adapter type: snowflake
[0m05:08:23.784267 [info ] [MainThread]: adapter version: 1.11.1
[0m05:08:23.837633 [info ] [MainThread]: Configuration:
[0m05:08:23.838007 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:08:23.838179 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:08:23.838348 [info ] [MainThread]: Required dependencies:
[0m05:08:23.838556 [debug] [MainThread]: Executing "git --help"
[0m05:08:23.873445 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:08:23.874106 [debug] [MainThread]: STDERR: "b''"
[0m05:08:23.874347 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:08:23.874552 [info ] [MainThread]: Connection:
[0m05:08:23.874779 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:08:23.874936 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:08:23.875080 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:08:23.875231 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:08:23.875374 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:08:23.875513 [info ] [MainThread]:   schema: STAGE
[0m05:08:23.875651 [info ] [MainThread]:   authenticator: jwt
[0m05:08:23.875790 [info ] [MainThread]:   oauth_client_id: None
[0m05:08:23.875925 [info ] [MainThread]:   query_tag: None
[0m05:08:23.876060 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:08:23.876195 [info ] [MainThread]:   host: None
[0m05:08:23.876349 [info ] [MainThread]:   port: None
[0m05:08:23.876489 [info ] [MainThread]:   proxy_host: None
[0m05:08:23.876623 [info ] [MainThread]:   proxy_port: None
[0m05:08:23.876756 [info ] [MainThread]:   protocol: None
[0m05:08:23.876891 [info ] [MainThread]:   connect_retries: 1
[0m05:08:23.877027 [info ] [MainThread]:   connect_timeout: None
[0m05:08:23.877162 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:08:23.877299 [info ] [MainThread]:   retry_all: False
[0m05:08:23.877436 [info ] [MainThread]:   insecure_mode: False
[0m05:08:23.877571 [info ] [MainThread]:   reuse_connections: True
[0m05:08:23.877717 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m05:08:23.877917 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m05:08:23.878424 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:08:23.944695 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:08:23.972693 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:08:23.972955 [debug] [MainThread]: On debug: select 1 as id
[0m05:08:23.973110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:08:24.757520 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.784 seconds
[0m05:08:24.758810 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:08:24.759218 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:08:24.763116 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.289157, "process_in_blocks": "0", "process_kernel_time": 0.227818, "process_mem_max_rss": "150880256", "process_out_blocks": "0", "process_user_time": 1.141166}
[0m05:08:24.763677 [debug] [MainThread]: Command `dbt debug` succeeded at 05:08:24.763567 after 1.29 seconds
[0m05:08:24.764021 [debug] [MainThread]: Connection 'debug' was left open.
[0m05:08:24.764303 [debug] [MainThread]: On debug: Close
[0m05:08:24.842364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849d3f0>]}
[0m05:08:24.842787 [debug] [MainThread]: Flushing usage events
[0m05:08:25.376535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:25:39.122292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c00be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd84c0>]}


============================== 05:25:39.126060 | 08406606-dc5b-419e-b029-305bf3522a8b ==============================
[0m05:25:39.126060 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:25:39.126422 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m05:25:39.335970 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:25:39.336288 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:25:39.336468 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:25:39.428943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105618850>]}
[0m05:25:39.459859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078af8b0>]}
[0m05:25:39.460459 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:25:39.528191 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:25:39.607125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:25:39.607531 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m05:25:39.744843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108159510>]}
[0m05:25:39.788044 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:25:39.789536 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:25:39.800315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed1810>]}
[0m05:25:39.800617 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m05:25:39.800819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93e80>]}
[0m05:25:39.801540 [info ] [MainThread]: 
[0m05:25:39.801734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:25:39.801888 [info ] [MainThread]: 
[0m05:25:39.802149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:39.804638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:25:39.838027 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:25:39.838419 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m05:25:39.838595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:41.196410 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.358 seconds
[0m05:25:41.201352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:25:41.202023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:25:41.216654 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:25:41.218702 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:25:41.219060 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m05:25:41.219374 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m05:25:41.220215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:41.378302 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24fc9-0306-108b-0004-85da0003b106
[0m05:25:41.378601 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:25:41.378858 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:25:41.379038 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:25:41.615566 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.395 seconds
[0m05:25:41.620333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cc100>]}
[0m05:25:41.625320 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:25:41.625826 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:25:41.626443 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:25:41.626957 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:25:41.627525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m05:25:41.627950 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m05:25:41.628327 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:25:41.628659 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:25:41.637410 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:25:41.640199 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:25:41.641317 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:25:41.641692 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:25:41.674491 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:25:41.675901 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:25:41.677089 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:25:41.677404 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m05:25:41.678109 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:25:41.678871 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m05:25:41.745307 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24fc9-0306-108b-0004-85da0003b10e
[0m05:25:41.745764 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m05:25:41.747573 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:25:41.749370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e8040>]}
[0m05:25:41.750038 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.12s]
[0m05:25:41.750608 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:25:41.751101 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m05:25:41.754077 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24fc9-0306-10cf-0004-85da00038a96
[0m05:25:41.754464 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m05:25:41.755696 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:25:41.756130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08406606-dc5b-419e-b029-305bf3522a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e9690>]}
[0m05:25:41.756676 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.13s]
[0m05:25:41.757177 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:25:41.757633 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m05:25:41.758654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:41.759011 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m05:25:41.759309 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:25:41.850860 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m05:25:41.851269 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:25:41.910892 [info ] [MainThread]: 
[0m05:25:41.911274 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m05:25:41.911750 [debug] [MainThread]: Command end result
[0m05:25:41.926784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:25:41.928200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:25:41.934269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m05:25:41.934604 [info ] [MainThread]: 
[0m05:25:41.934959 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m05:25:41.935255 [info ] [MainThread]: 
[0m05:25:41.935610 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m05:25:41.935959 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:25:41.936226 [info ] [MainThread]: 
[0m05:25:41.936531 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:25:41.936804 [info ] [MainThread]: 
[0m05:25:41.937120 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m05:25:41.937439 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:25:41.937700 [info ] [MainThread]: 
[0m05:25:41.938000 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:25:41.938251 [info ] [MainThread]: 
[0m05:25:41.938533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m05:25:41.941464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8647544, "process_in_blocks": "0", "process_kernel_time": 0.237354, "process_mem_max_rss": "165642240", "process_out_blocks": "0", "process_user_time": 1.720396}
[0m05:25:41.941979 [debug] [MainThread]: Command `dbt run` failed at 05:25:41.941894 after 2.87 seconds
[0m05:25:41.942351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c00be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078af8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109505900>]}
[0m05:25:41.942695 [debug] [MainThread]: Flushing usage events
[0m05:25:42.475887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:30:45.340615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103858bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049305e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104930730>]}


============================== 05:30:45.344385 | 26a4fe0f-8611-4844-b76d-87c358b56d39 ==============================
[0m05:30:45.344385 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:30:45.344749 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None'}
[0m05:30:45.552364 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:30:45.552703 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:30:45.552891 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:30:45.647763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a4fe0f-8611-4844-b76d-87c358b56d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101eeaec0>]}
[0m05:30:45.679982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26a4fe0f-8611-4844-b76d-87c358b56d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046aa650>]}
[0m05:30:45.680705 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:30:45.750720 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:30:45.832342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:45.832634 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m05:30:45.832799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:45.853383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a4fe0f-8611-4844-b76d-87c358b56d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b715a0>]}
[0m05:30:45.897473 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:30:45.898809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:30:45.910435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a4fe0f-8611-4844-b76d-87c358b56d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aea980>]}
[0m05:30:45.910775 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m05:30:45.910986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a4fe0f-8611-4844-b76d-87c358b56d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae92d0>]}
[0m05:30:45.911749 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:30:45.924697 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:30:45.925648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:30:45.927550 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/sources.json
[0m05:30:45.927728 [info ] [MainThread]: Done.
[0m05:30:45.929760 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.6393168, "process_in_blocks": "0", "process_kernel_time": 0.191624, "process_mem_max_rss": "142065664", "process_out_blocks": "0", "process_user_time": 1.105238}
[0m05:30:45.930074 [debug] [MainThread]: Command `dbt source freshness` succeeded at 05:30:45.930028 after 0.64 seconds
[0m05:30:45.930283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103858bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b526e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc0160>]}
[0m05:30:45.930484 [debug] [MainThread]: Flushing usage events
[0m05:30:46.465014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:30:51.357470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd44f0>]}


============================== 05:30:51.360831 | d2c3c32c-a260-4f64-b4ac-3c5ae7b09862 ==============================
[0m05:30:51.360831 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:30:51.361216 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'False', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select staging'}
[0m05:30:51.543799 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:30:51.544108 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:30:51.544287 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:30:51.635263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105717bb0>]}
[0m05:30:51.666732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106702a70>]}
[0m05:30:51.667360 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:30:51.735523 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:30:51.810208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:51.810464 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m05:30:51.810619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:51.830814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801d390>]}
[0m05:30:51.875116 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:30:51.876225 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:30:51.886963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8f6a0>]}
[0m05:30:51.887271 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m05:30:51.887472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc5210>]}
[0m05:30:51.888197 [info ] [MainThread]: 
[0m05:30:51.888387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:30:51.888547 [info ] [MainThread]: 
[0m05:30:51.888821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:30:51.891294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:30:51.925777 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:30:51.926062 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m05:30:51.926242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:52.641677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.715 seconds
[0m05:30:52.645186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:30:52.645875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:30:52.658701 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:30:52.661522 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:30:52.662005 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m05:30:52.662322 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m05:30:52.663214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:52.853969 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.191 seconds
[0m05:30:53.037508 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24fce-0306-108b-0004-85da0003b11a
[0m05:30:53.038774 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:30:53.039445 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:30:53.039968 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:30:53.040741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c8100>]}
[0m05:30:53.043549 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:30:53.043932 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:30:53.044486 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:30:53.045006 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:30:53.045468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m05:30:53.046049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m05:30:53.046452 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:30:53.046785 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:30:53.056437 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:30:53.059261 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:30:53.060207 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:30:53.080493 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:30:53.086955 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:30:53.089680 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:30:53.090748 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:30:53.091087 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m05:30:53.092175 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:30:53.092507 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m05:30:53.180324 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24fce-0306-11e3-0004-85da00039262
[0m05:30:53.180770 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m05:30:53.182538 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:30:53.184404 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c2b60>]}
[0m05:30:53.185138 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.14s]
[0m05:30:53.185687 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:30:53.186181 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m05:30:53.223528 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24fce-0306-09f2-0004-85da0003a312
[0m05:30:53.223964 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m05:30:53.225322 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:30:53.225813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c3c32c-a260-4f64-b4ac-3c5ae7b09862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cfe20>]}
[0m05:30:53.226419 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.18s]
[0m05:30:53.226959 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:30:53.227550 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m05:30:53.228621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:53.228912 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m05:30:53.229191 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:30:53.339533 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m05:30:53.340785 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:30:53.427363 [info ] [MainThread]: 
[0m05:30:53.428616 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m05:30:53.429618 [debug] [MainThread]: Command end result
[0m05:30:53.499544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:30:53.500698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:30:53.504690 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m05:30:53.504906 [info ] [MainThread]: 
[0m05:30:53.505145 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m05:30:53.505340 [info ] [MainThread]: 
[0m05:30:53.505567 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m05:30:53.505783 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:30:53.505947 [info ] [MainThread]: 
[0m05:30:53.506135 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:30:53.506296 [info ] [MainThread]: 
[0m05:30:53.506489 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m05:30:53.506688 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:30:53.506846 [info ] [MainThread]: 
[0m05:30:53.507027 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:30:53.507176 [info ] [MainThread]: 
[0m05:30:53.507348 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m05:30:53.509271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1935122, "process_in_blocks": "0", "process_kernel_time": 0.224481, "process_mem_max_rss": "162742272", "process_out_blocks": "0", "process_user_time": 1.657101}
[0m05:30:53.509563 [debug] [MainThread]: Command `dbt run` failed at 05:30:53.509511 after 2.19 seconds
[0m05:30:53.509802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcdcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fccc40>]}
[0m05:30:53.510033 [debug] [MainThread]: Flushing usage events
[0m05:30:53.948133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:23.467289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d90c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e68550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e686a0>]}


============================== 05:47:23.471274 | d55ec9d8-c47e-4de9-9765-34ce843dbb89 ==============================
[0m05:47:23.471274 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:47:23.471626 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True'}
[0m05:47:23.690573 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:47:23.690901 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:47:23.691082 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:47:23.785298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd55ec9d8-c47e-4de9-9765-34ce843dbb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102422f20>]}
[0m05:47:23.816205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd55ec9d8-c47e-4de9-9765-34ce843dbb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3e740>]}
[0m05:47:23.816881 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:47:23.887495 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:47:23.968432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:47:23.968961 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/sources/sources.yml
[0m05:47:24.163215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd55ec9d8-c47e-4de9-9765-34ce843dbb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e967d0>]}
[0m05:47:24.204547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:47:24.205902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:47:24.254868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd55ec9d8-c47e-4de9-9765-34ce843dbb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0f3a0>]}
[0m05:47:24.255211 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m05:47:24.255405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd55ec9d8-c47e-4de9-9765-34ce843dbb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0edd0>]}
[0m05:47:24.256176 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:47:24.269232 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:47:24.270110 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:47:24.271925 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/sources.json
[0m05:47:24.272080 [info ] [MainThread]: Done.
[0m05:47:24.274088 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.85509795, "process_in_blocks": "0", "process_kernel_time": 0.207985, "process_mem_max_rss": "149848064", "process_out_blocks": "0", "process_user_time": 1.30666}
[0m05:47:24.274365 [debug] [MainThread]: Command `dbt source freshness` succeeded at 05:47:24.274318 after 0.86 seconds
[0m05:47:24.274572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d90c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e36500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610d3f0>]}
[0m05:47:24.274761 [debug] [MainThread]: Flushing usage events
[0m05:47:24.827317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:30.224024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e48be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be84f0>]}


============================== 05:47:30.227488 | 9083e9d3-8327-463a-b090-0fbe343cfb07 ==============================
[0m05:47:30.227488 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:47:30.227861 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'empty': 'None', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/elham/.dbt', 'static_parser': 'True', 'invocation_command': 'dbt clean'}
[0m05:47:30.290476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9083e9d3-8327-463a-b090-0fbe343cfb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7ba90>]}
[0m05:47:30.302955 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12048421, "process_in_blocks": "0", "process_kernel_time": 0.112848, "process_mem_max_rss": "112164864", "process_out_blocks": "0", "process_user_time": 0.750218}
[0m05:47:30.303241 [debug] [MainThread]: Command `dbt clean` succeeded at 05:47:30.303191 after 0.12 seconds
[0m05:47:30.303443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e48be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d089d0>]}
[0m05:47:30.303642 [debug] [MainThread]: Flushing usage events
[0m05:47:30.747202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:35.351195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abc4f0>]}


============================== 05:47:35.354606 | 1843e75c-f3de-494a-be2a-c2b7e7fbd2ca ==============================
[0m05:47:35.354606 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:47:35.354955 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'debug': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'None', 'profiles_dir': '/Users/elham/.dbt', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True'}
[0m05:47:35.363100 [info ] [MainThread]: dbt version: 1.11.3
[0m05:47:35.363319 [info ] [MainThread]: python version: 3.10.19
[0m05:47:35.363482 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m05:47:35.363638 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m05:47:35.565914 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:47:35.566228 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:47:35.566410 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:47:35.597220 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m05:47:35.597487 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m05:47:35.597655 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m05:47:35.598014 [info ] [MainThread]: adapter type: snowflake
[0m05:47:35.598234 [info ] [MainThread]: adapter version: 1.11.1
[0m05:47:35.652219 [info ] [MainThread]: Configuration:
[0m05:47:35.652555 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:47:35.652728 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:47:35.652884 [info ] [MainThread]: Required dependencies:
[0m05:47:35.653095 [debug] [MainThread]: Executing "git --help"
[0m05:47:35.674172 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:47:35.674785 [debug] [MainThread]: STDERR: "b''"
[0m05:47:35.675003 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:47:35.675195 [info ] [MainThread]: Connection:
[0m05:47:35.675396 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:47:35.675546 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:47:35.675692 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:47:35.675833 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:47:35.675975 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:47:35.676117 [info ] [MainThread]:   schema: STAGE
[0m05:47:35.676258 [info ] [MainThread]:   authenticator: jwt
[0m05:47:35.676414 [info ] [MainThread]:   oauth_client_id: None
[0m05:47:35.676549 [info ] [MainThread]:   query_tag: None
[0m05:47:35.676685 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:47:35.676822 [info ] [MainThread]:   host: None
[0m05:47:35.676958 [info ] [MainThread]:   port: None
[0m05:47:35.677094 [info ] [MainThread]:   proxy_host: None
[0m05:47:35.677229 [info ] [MainThread]:   proxy_port: None
[0m05:47:35.677366 [info ] [MainThread]:   protocol: None
[0m05:47:35.677504 [info ] [MainThread]:   connect_retries: 1
[0m05:47:35.677637 [info ] [MainThread]:   connect_timeout: None
[0m05:47:35.677770 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:47:35.677905 [info ] [MainThread]:   retry_all: False
[0m05:47:35.678036 [info ] [MainThread]:   insecure_mode: False
[0m05:47:35.678170 [info ] [MainThread]:   reuse_connections: True
[0m05:47:35.678304 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m05:47:35.678547 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m05:47:35.678974 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:47:35.742750 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:47:35.771540 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:47:35.771861 [debug] [MainThread]: On debug: select 1 as id
[0m05:47:35.772042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:36.351447 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.579 seconds
[0m05:47:36.352514 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:47:36.352899 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:47:36.357027 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0481155, "process_in_blocks": "0", "process_kernel_time": 0.208684, "process_mem_max_rss": "152403968", "process_out_blocks": "0", "process_user_time": 1.152478}
[0m05:47:36.357519 [debug] [MainThread]: Command `dbt debug` succeeded at 05:47:36.357412 after 1.05 seconds
[0m05:47:36.357862 [debug] [MainThread]: Connection 'debug' was left open.
[0m05:47:36.358145 [debug] [MainThread]: On debug: Close
[0m05:47:36.425444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4b7f0>]}
[0m05:47:36.426082 [debug] [MainThread]: Flushing usage events
[0m05:47:36.889462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:41.886484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e8610>]}


============================== 05:47:41.889918 | 797a5618-e412-47cc-9f71-15743420fb59 ==============================
[0m05:47:41.889918 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:47:41.890236 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:47:42.071440 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:47:42.071748 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:47:42.071924 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:47:42.162226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111918a00>]}
[0m05:47:42.192839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffc850>]}
[0m05:47:42.193612 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m05:47:42.259731 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:47:42.260248 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:47:42.260470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11321d0f0>]}
[0m05:47:42.928882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143e9810>]}
[0m05:47:42.970286 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:47:42.971436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:47:42.982019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114382c20>]}
[0m05:47:42.982316 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m05:47:42.982511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140235b0>]}
[0m05:47:42.983207 [info ] [MainThread]: 
[0m05:47:42.983404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:47:42.983559 [info ] [MainThread]: 
[0m05:47:42.983815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:47:42.986351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:47:43.013076 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:47:43.013351 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m05:47:43.013510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:43.441658 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.428 seconds
[0m05:47:43.444631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:47:43.445125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:47:43.458070 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:47:43.460771 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:47:43.461123 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m05:47:43.461437 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m05:47:43.462563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:43.667249 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c24fdf-0306-10cf-0004-85da00038b1e
[0m05:47:43.667598 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:47:43.667981 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:47:43.668222 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:47:43.823834 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.361 seconds
[0m05:47:43.828115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdc130>]}
[0m05:47:43.831492 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:47:43.831884 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:47:43.832440 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:47:43.832959 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:47:43.833480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m05:47:43.833891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m05:47:43.834251 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:47:43.834594 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:47:43.844450 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:47:43.847243 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:47:43.848309 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:47:43.848675 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:47:43.879131 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:47:43.880409 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:47:43.881386 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:47:43.881614 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m05:47:43.882261 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:47:43.882488 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m05:47:43.959440 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c24fdf-0306-108b-0004-85da0003b162
[0m05:47:43.959879 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
[0m05:47:43.961860 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:47:43.963665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115537430>]}
[0m05:47:43.964309 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.13s]
[0m05:47:43.964861 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:47:43.965384 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m05:47:43.994986 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c24fdf-0306-10cf-0004-85da00038b22
[0m05:47:43.995508 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
[0m05:47:43.996824 [debug] [Thread-3 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:47:43.997341 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797a5618-e412-47cc-9f71-15743420fb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155269b0>]}
[0m05:47:43.997964 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.16s]
[0m05:47:43.998552 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:47:43.999039 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_reviews' to be skipped because of status 'error'.  Reason: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql.
[0m05:47:44.000112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:47:44.000470 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m05:47:44.000771 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:47:44.072299 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m05:47:44.072645 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:47:44.147813 [info ] [MainThread]: 
[0m05:47:44.148856 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m05:47:44.150309 [debug] [MainThread]: Command end result
[0m05:47:44.176300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m05:47:44.177979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m05:47:44.184099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m05:47:44.184477 [info ] [MainThread]: 
[0m05:47:44.184835 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m05:47:44.185144 [info ] [MainThread]: 
[0m05:47:44.185484 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m05:47:44.185829 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:47:44.186099 [info ] [MainThread]: 
[0m05:47:44.186412 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m05:47:44.186672 [info ] [MainThread]: 
[0m05:47:44.186982 [error] [MainThread]: [31mFailure in model stg_reviews (models/staging/stg_reviews.sql)[0m
[0m05:47:44.187301 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE' does not exist or not authorized.
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:47:44.187551 [info ] [MainThread]: 
[0m05:47:44.187855 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m05:47:44.188107 [info ] [MainThread]: 
[0m05:47:44.188383 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m05:47:44.191175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3445666, "process_in_blocks": "0", "process_kernel_time": 0.191535, "process_mem_max_rss": "170770432", "process_out_blocks": "0", "process_user_time": 2.127049}
[0m05:47:44.191594 [debug] [MainThread]: Command `dbt run` failed at 05:47:44.191521 after 2.35 seconds
[0m05:47:44.191936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111918a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c1cc0>]}
[0m05:47:44.192289 [debug] [MainThread]: Flushing usage events
[0m05:47:44.631320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:04:35.309419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cec610>]}


============================== 07:04:35.313006 | c289ea37-3c19-4730-968b-d4a0c31fd952 ==============================
[0m07:04:35.313006 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:04:35.313351 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/Users/elham/.dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt clean', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m07:04:35.379006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c289ea37-3c19-4730-968b-d4a0c31fd952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c26ec0>]}
[0m07:04:35.392159 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1257452, "process_in_blocks": "0", "process_kernel_time": 0.126189, "process_mem_max_rss": "111591424", "process_out_blocks": "0", "process_user_time": 0.742866}
[0m07:04:35.392528 [debug] [MainThread]: Command `dbt clean` succeeded at 07:04:35.392462 after 0.13 seconds
[0m07:04:35.392755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0a110>]}
[0m07:04:35.392982 [debug] [MainThread]: Flushing usage events
[0m07:04:35.942044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:04:41.714809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563bac0>]}


============================== 07:04:41.718352 | 63c19c52-ef7e-4477-a121-c38317d778b0 ==============================
[0m07:04:41.718352 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:04:41.718679 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True'}
[0m07:04:41.726869 [info ] [MainThread]: dbt version: 1.11.3
[0m07:04:41.727088 [info ] [MainThread]: python version: 3.10.19
[0m07:04:41.727254 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:04:41.727413 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:04:41.939587 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:04:41.939906 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:04:41.940081 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:04:41.971225 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:04:41.971503 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:04:41.971678 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:04:41.971987 [info ] [MainThread]: adapter type: snowflake
[0m07:04:41.972189 [info ] [MainThread]: adapter version: 1.11.1
[0m07:04:42.025900 [info ] [MainThread]: Configuration:
[0m07:04:42.026214 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:04:42.026386 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:04:42.026540 [info ] [MainThread]: Required dependencies:
[0m07:04:42.026754 [debug] [MainThread]: Executing "git --help"
[0m07:04:42.041368 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:04:42.041978 [debug] [MainThread]: STDERR: "b''"
[0m07:04:42.042194 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:04:42.042389 [info ] [MainThread]: Connection:
[0m07:04:42.042599 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m07:04:42.042860 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m07:04:42.043059 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m07:04:42.043222 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m07:04:42.043375 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m07:04:42.043527 [info ] [MainThread]:   schema: STAGE
[0m07:04:42.043674 [info ] [MainThread]:   authenticator: jwt
[0m07:04:42.043820 [info ] [MainThread]:   oauth_client_id: None
[0m07:04:42.043960 [info ] [MainThread]:   query_tag: None
[0m07:04:42.044102 [info ] [MainThread]:   client_session_keep_alive: False
[0m07:04:42.044243 [info ] [MainThread]:   host: None
[0m07:04:42.044382 [info ] [MainThread]:   port: None
[0m07:04:42.044529 [info ] [MainThread]:   proxy_host: None
[0m07:04:42.044670 [info ] [MainThread]:   proxy_port: None
[0m07:04:42.044807 [info ] [MainThread]:   protocol: None
[0m07:04:42.044948 [info ] [MainThread]:   connect_retries: 1
[0m07:04:42.045090 [info ] [MainThread]:   connect_timeout: None
[0m07:04:42.045230 [info ] [MainThread]:   retry_on_database_errors: False
[0m07:04:42.045371 [info ] [MainThread]:   retry_all: False
[0m07:04:42.045509 [info ] [MainThread]:   insecure_mode: False
[0m07:04:42.045652 [info ] [MainThread]:   reuse_connections: True
[0m07:04:42.045794 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m07:04:42.045934 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m07:04:42.046320 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:04:42.112715 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m07:04:42.143835 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:04:42.144124 [debug] [MainThread]: On debug: select 1 as id
[0m07:04:42.144284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:04:42.930352 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.786 seconds
[0m07:04:42.933122 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:04:42.934312 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:04:42.939457 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.265453, "process_in_blocks": "0", "process_kernel_time": 0.209243, "process_mem_max_rss": "150814720", "process_out_blocks": "0", "process_user_time": 1.275265}
[0m07:04:42.940100 [debug] [MainThread]: Command `dbt debug` succeeded at 07:04:42.939984 after 1.27 seconds
[0m07:04:42.940471 [debug] [MainThread]: Connection 'debug' was left open.
[0m07:04:42.940762 [debug] [MainThread]: On debug: Close
[0m07:04:43.144365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edd5d0>]}
[0m07:04:43.145025 [debug] [MainThread]: Flushing usage events
[0m07:04:43.609953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:05:06.911338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208e8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221e84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221e8610>]}


============================== 07:05:06.916411 | 3a3b666e-d989-44e2-8afc-67046359f960 ==============================
[0m07:05:06.916411 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:05:06.916786 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'introspect': 'True'}
[0m07:05:07.126577 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:05:07.126929 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:05:07.127104 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:05:07.220145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b18a00>]}
[0m07:05:07.250838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120200850>]}
[0m07:05:07.251357 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:05:07.318427 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:05:07.318906 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:05:07.319117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233250f0>]}
[0m07:05:07.991086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244e9810>]}
[0m07:05:08.032466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:05:08.033720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:05:08.044250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124482c20>]}
[0m07:05:08.044536 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m07:05:08.044722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12370f5b0>]}
[0m07:05:08.045422 [info ] [MainThread]: 
[0m07:05:08.045611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:05:08.045765 [info ] [MainThread]: 
[0m07:05:08.046020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:05:08.048531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:05:08.080565 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:05:08.080889 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:05:08.081070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:08.699882 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.618 seconds
[0m07:05:08.704672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m07:05:08.705099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m07:05:08.713932 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:05:08.715626 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:05:08.715849 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:05:08.716071 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:05:08.717140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:08.876221 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.160 seconds
[0m07:05:09.155710 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c2502d-0306-108b-0004-85da0003b272
[0m07:05:09.156634 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m07:05:09.157299 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:05:09.157776 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:05:09.158932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230dc130>]}
[0m07:05:09.162366 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m07:05:09.162812 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m07:05:09.163415 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m07:05:09.163947 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m07:05:09.164404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m07:05:09.164787 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m07:05:09.165149 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m07:05:09.165467 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m07:05:09.174329 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m07:05:09.177388 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:05:09.178688 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m07:05:09.178993 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m07:05:09.203043 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m07:05:09.205177 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:05:09.206130 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m07:05:09.206353 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
category as category,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m07:05:09.207174 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m07:05:09.207382 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m07:05:09.397735 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2502d-0306-11d0-0004-85da0003c056
[0m07:05:09.398863 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 0
invalid identifier 'CATEGORY'
[0m07:05:09.400948 [debug] [Thread-2 (]: Database Error in model stg_meta (models/staging/stg_meta.sql)
  000904 (42000): SQL compilation error: error line 20 at position 0
  invalid identifier 'CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m07:05:09.403004 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256c0550>]}
[0m07:05:09.403736 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model STAGE_STAGE.stg_meta ...................... [[31mERROR[0m in 0.24s]
[0m07:05:09.404301 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m07:05:09.404770 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.stg_meta' to be skipped because of status 'error'.  Reason: Database Error in model stg_meta (models/staging/stg_meta.sql)
  000904 (42000): SQL compilation error: error line 20 at position 0
  invalid identifier 'CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql.
[0m07:05:09.563987 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m07:05:09.588333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3b666e-d989-44e2-8afc-67046359f960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a12740>]}
[0m07:05:09.589161 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.42s]
[0m07:05:09.589718 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m07:05:09.590786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:09.591136 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m07:05:09.591433 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m07:05:09.659491 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m07:05:09.659964 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m07:05:09.767073 [info ] [MainThread]: 
[0m07:05:09.769137 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m07:05:09.770808 [debug] [MainThread]: Command end result
[0m07:05:09.797548 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:05:09.799479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:05:09.805504 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:05:09.805887 [info ] [MainThread]: 
[0m07:05:09.806256 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:05:09.806563 [info ] [MainThread]: 
[0m07:05:09.807022 [error] [MainThread]: [31mFailure in model stg_meta (models/staging/stg_meta.sql)[0m
[0m07:05:09.807482 [error] [MainThread]:   Database Error in model stg_meta (models/staging/stg_meta.sql)
  000904 (42000): SQL compilation error: error line 20 at position 0
  invalid identifier 'CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m07:05:09.807839 [info ] [MainThread]: 
[0m07:05:09.808283 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/stg_meta.sql
[0m07:05:09.808591 [info ] [MainThread]: 
[0m07:05:09.808911 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m07:05:09.811913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.945664, "process_in_blocks": "0", "process_kernel_time": 0.235582, "process_mem_max_rss": "163774464", "process_out_blocks": "0", "process_user_time": 2.189127}
[0m07:05:09.812412 [debug] [MainThread]: Command `dbt run` failed at 07:05:09.812326 after 2.95 seconds
[0m07:05:09.812776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208e8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b18a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125619a20>]}
[0m07:05:09.813096 [debug] [MainThread]: Flushing usage events
[0m07:05:10.281030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:47.014334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b04b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be0610>]}


============================== 07:16:47.018131 | 1004f65f-2a37-4517-89de-3196df787743 ==============================
[0m07:16:47.018131 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:16:47.018470 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/elham/.dbt'}
[0m07:16:47.085493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1004f65f-2a37-4517-89de-3196df787743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1f700>]}
[0m07:16:47.098229 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12907271, "process_in_blocks": "0", "process_kernel_time": 0.162785, "process_mem_max_rss": "114458624", "process_out_blocks": "0", "process_user_time": 0.804383}
[0m07:16:47.098522 [debug] [MainThread]: Command `dbt clean` succeeded at 07:16:47.098470 after 0.13 seconds
[0m07:16:47.098733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b04b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d59c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cffac0>]}
[0m07:16:47.098938 [debug] [MainThread]: Flushing usage events
[0m07:16:47.630691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:59.547542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ec610>]}


============================== 07:16:59.551526 | 50b9e360-35be-43a2-9123-9bf15128d374 ==============================
[0m07:16:59.551526 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:16:59.551859 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m07:16:59.560182 [info ] [MainThread]: dbt version: 1.11.3
[0m07:16:59.560393 [info ] [MainThread]: python version: 3.10.19
[0m07:16:59.560554 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m07:16:59.560705 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m07:16:59.804628 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:16:59.804975 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:16:59.805164 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:16:59.838096 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m07:16:59.838418 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m07:16:59.838587 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m07:16:59.838942 [info ] [MainThread]: adapter type: snowflake
[0m07:16:59.839099 [info ] [MainThread]: adapter version: 1.11.1
[0m07:16:59.892946 [info ] [MainThread]: Configuration:
[0m07:16:59.893286 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:16:59.893456 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:16:59.893605 [info ] [MainThread]: Required dependencies:
[0m07:16:59.893804 [debug] [MainThread]: Executing "git --help"
[0m07:16:59.908663 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:16:59.909322 [debug] [MainThread]: STDERR: "b''"
[0m07:16:59.909526 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:16:59.909711 [info ] [MainThread]: Connection:
[0m07:16:59.909915 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m07:16:59.910066 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m07:16:59.910208 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m07:16:59.910348 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m07:16:59.910488 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m07:16:59.910625 [info ] [MainThread]:   schema: STAGE
[0m07:16:59.910761 [info ] [MainThread]:   authenticator: jwt
[0m07:16:59.910900 [info ] [MainThread]:   oauth_client_id: None
[0m07:16:59.911042 [info ] [MainThread]:   query_tag: None
[0m07:16:59.911181 [info ] [MainThread]:   client_session_keep_alive: False
[0m07:16:59.911319 [info ] [MainThread]:   host: None
[0m07:16:59.911457 [info ] [MainThread]:   port: None
[0m07:16:59.911596 [info ] [MainThread]:   proxy_host: None
[0m07:16:59.911736 [info ] [MainThread]:   proxy_port: None
[0m07:16:59.911880 [info ] [MainThread]:   protocol: None
[0m07:16:59.912014 [info ] [MainThread]:   connect_retries: 1
[0m07:16:59.912157 [info ] [MainThread]:   connect_timeout: None
[0m07:16:59.912292 [info ] [MainThread]:   retry_on_database_errors: False
[0m07:16:59.912427 [info ] [MainThread]:   retry_all: False
[0m07:16:59.912564 [info ] [MainThread]:   insecure_mode: False
[0m07:16:59.912703 [info ] [MainThread]:   reuse_connections: True
[0m07:16:59.912837 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m07:16:59.912974 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m07:16:59.913376 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:16:59.978902 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m07:17:00.006985 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:17:00.007260 [debug] [MainThread]: On debug: select 1 as id
[0m07:17:00.007418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:00.589062 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.581 seconds
[0m07:17:00.592033 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:17:00.592834 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:17:00.597418 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0914884, "process_in_blocks": "0", "process_kernel_time": 0.212526, "process_mem_max_rss": "152207360", "process_out_blocks": "0", "process_user_time": 1.170078}
[0m07:17:00.597965 [debug] [MainThread]: Command `dbt debug` succeeded at 07:17:00.597848 after 1.09 seconds
[0m07:17:00.598323 [debug] [MainThread]: Connection 'debug' was left open.
[0m07:17:00.598624 [debug] [MainThread]: On debug: Close
[0m07:17:00.687579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c91660>]}
[0m07:17:00.688566 [debug] [MainThread]: Flushing usage events
[0m07:17:01.150205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:17:11.336816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea3c40>]}


============================== 07:17:11.340441 | 705b1e9d-16c1-4d3e-aaec-585cb7cc93e3 ==============================
[0m07:17:11.340441 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:17:11.340784 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/Users/elham/.dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select staging'}
[0m07:17:11.539823 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:17:11.540133 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:17:11.540314 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:17:11.630374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037eb1c0>]}
[0m07:17:11.660974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d41690>]}
[0m07:17:11.661766 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:17:11.730185 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:17:11.730733 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:17:11.730964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdcb50>]}
[0m07:17:12.419207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631d7b0>]}
[0m07:17:12.462018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:17:12.463376 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:17:12.474514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631ee00>]}
[0m07:17:12.474839 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m07:17:12.475030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631d900>]}
[0m07:17:12.475736 [info ] [MainThread]: 
[0m07:17:12.475932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:17:12.476090 [info ] [MainThread]: 
[0m07:17:12.476359 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:17:12.478868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:17:12.512624 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:17:12.512936 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:17:12.513119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:13.097949 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.585 seconds
[0m07:17:13.102136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m07:17:13.102805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:17:13.114127 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:17:13.116008 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:17:13.116625 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:17:13.116849 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:17:13.118153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:13.271862 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c25039-0306-11d0-0004-85da0003c06a
[0m07:17:13.272185 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m07:17:13.272446 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:17:13.272632 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:17:13.576469 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.458 seconds
[0m07:17:13.580416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106217ca0>]}
[0m07:17:13.585378 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m07:17:13.585856 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m07:17:13.586488 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m07:17:13.586993 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m07:17:13.587499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m07:17:13.587873 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m07:17:13.588275 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m07:17:13.589005 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m07:17:13.597511 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m07:17:13.600721 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:17:13.601872 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m07:17:13.602260 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m07:17:13.636004 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m07:17:13.637518 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:17:13.639006 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m07:17:13.639727 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m07:17:13.640019 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m07:17:13.640335 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m07:17:14.117218 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m07:17:14.118946 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m07:17:14.147120 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107481300>]}
[0m07:17:14.147562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '705b1e9d-16c1-4d3e-aaec-585cb7cc93e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107480340>]}
[0m07:17:14.148301 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.55s]
[0m07:17:14.148898 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.56s]
[0m07:17:14.149422 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m07:17:14.149866 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m07:17:14.150931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:14.151282 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m07:17:14.151577 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m07:17:14.211494 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m07:17:14.211990 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m07:17:14.276803 [info ] [MainThread]: 
[0m07:17:14.278067 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m07:17:14.279651 [debug] [MainThread]: Command end result
[0m07:17:14.306290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:17:14.308133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:17:14.314226 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:17:14.314581 [info ] [MainThread]: 
[0m07:17:14.314947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:17:14.315233 [info ] [MainThread]: 
[0m07:17:14.315540 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m07:17:14.318694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0252397, "process_in_blocks": "0", "process_kernel_time": 0.225038, "process_mem_max_rss": "162955264", "process_out_blocks": "0", "process_user_time": 2.159654}
[0m07:17:14.319187 [debug] [MainThread]: Command `dbt run` succeeded at 07:17:14.319106 after 3.03 seconds
[0m07:17:14.319538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104033a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102462e90>]}
[0m07:17:14.319898 [debug] [MainThread]: Flushing usage events
[0m07:17:14.773510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:03.085455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107048c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ec490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ec5e0>]}


============================== 09:37:03.088962 | 75bb8acb-4a52-418c-955a-4578c7c7ceab ==============================
[0m09:37:03.088962 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:37:03.089286 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/elham/.dbt', 'introspect': 'True', 'invocation_command': 'dbt debug'}
[0m09:37:03.097481 [info ] [MainThread]: dbt version: 1.11.3
[0m09:37:03.097712 [info ] [MainThread]: python version: 3.10.19
[0m09:37:03.097881 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m09:37:03.098041 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m09:37:03.321702 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:37:03.322036 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:37:03.322212 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:37:03.353603 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m09:37:03.353934 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m09:37:03.354107 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m09:37:03.354468 [info ] [MainThread]: adapter type: snowflake
[0m09:37:03.354627 [info ] [MainThread]: adapter version: 1.11.1
[0m09:37:03.409251 [info ] [MainThread]: Configuration:
[0m09:37:03.409590 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:37:03.409756 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:37:03.409903 [info ] [MainThread]: Required dependencies:
[0m09:37:03.410098 [debug] [MainThread]: Executing "git --help"
[0m09:37:03.424012 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:37:03.424600 [debug] [MainThread]: STDERR: "b''"
[0m09:37:03.424815 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:37:03.425006 [info ] [MainThread]: Connection:
[0m09:37:03.425205 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:37:03.425355 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:37:03.425501 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:37:03.425642 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:37:03.425781 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:37:03.425916 [info ] [MainThread]:   schema: STAGE
[0m09:37:03.426054 [info ] [MainThread]:   authenticator: jwt
[0m09:37:03.426298 [info ] [MainThread]:   oauth_client_id: None
[0m09:37:03.426497 [info ] [MainThread]:   query_tag: None
[0m09:37:03.426657 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:37:03.426807 [info ] [MainThread]:   host: None
[0m09:37:03.426953 [info ] [MainThread]:   port: None
[0m09:37:03.427091 [info ] [MainThread]:   proxy_host: None
[0m09:37:03.427234 [info ] [MainThread]:   proxy_port: None
[0m09:37:03.427371 [info ] [MainThread]:   protocol: None
[0m09:37:03.427507 [info ] [MainThread]:   connect_retries: 1
[0m09:37:03.427642 [info ] [MainThread]:   connect_timeout: None
[0m09:37:03.427778 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:37:03.427988 [info ] [MainThread]:   retry_all: False
[0m09:37:03.428141 [info ] [MainThread]:   insecure_mode: False
[0m09:37:03.428281 [info ] [MainThread]:   reuse_connections: True
[0m09:37:03.428417 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m09:37:03.428555 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m09:37:03.428931 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:37:03.492863 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:37:03.522428 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:37:03.522707 [debug] [MainThread]: On debug: select 1 as id
[0m09:37:03.522864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:04.062173 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.539 seconds
[0m09:37:04.065035 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:37:04.065799 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:37:04.070454 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0296092, "process_in_blocks": "0", "process_kernel_time": 0.202704, "process_mem_max_rss": "148914176", "process_out_blocks": "0", "process_user_time": 1.153053}
[0m09:37:04.070979 [debug] [MainThread]: Command `dbt debug` succeeded at 09:37:04.070864 after 1.03 seconds
[0m09:37:04.071352 [debug] [MainThread]: Connection 'debug' was left open.
[0m09:37:04.071804 [debug] [MainThread]: On debug: Close
[0m09:37:04.188463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107048c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bb010>]}
[0m09:37:04.189138 [debug] [MainThread]: Flushing usage events
[0m09:37:04.646252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:21.153728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108890310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108890460>]}


============================== 09:37:21.156788 | 7db72096-e8e5-483e-b8bb-f76836ec4cd3 ==============================
[0m09:37:21.156788 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:37:21.157124 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/elham/.dbt', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True'}
[0m09:37:21.303841 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:37:21.304154 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:37:21.304331 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:37:21.397198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e5690>]}
[0m09:37:21.427714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108160580>]}
[0m09:37:21.428276 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:37:21.498291 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m09:37:21.578262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:21.578529 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:37:21.578693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:21.599114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae1420>]}
[0m09:37:21.643195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:37:21.644806 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:37:21.655666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a51c30>]}
[0m09:37:21.655961 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m09:37:21.656158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a88700>]}
[0m09:37:21.656888 [info ] [MainThread]: 
[0m09:37:21.657075 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:21.657228 [info ] [MainThread]: 
[0m09:37:21.657494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:37:21.659991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:37:21.688187 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:37:21.688454 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m09:37:21.688620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:22.194253 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.505 seconds
[0m09:37:22.198578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:37:22.199229 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:37:22.212297 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:37:22.214764 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:37:22.215119 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m09:37:22.215498 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m09:37:22.216632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:22.422236 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c250c5-0306-11d0-0004-85da0003c38a
[0m09:37:22.422634 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m09:37:22.422964 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m09:37:22.423177 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:37:22.634061 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.417 seconds
[0m09:37:22.640371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109577a00>]}
[0m09:37:22.645125 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:37:22.645531 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:37:22.646161 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:37:22.646664 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:37:22.647276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m09:37:22.647676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m09:37:22.648025 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:37:22.648354 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:37:22.657663 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:37:22.660464 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:37:22.661493 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:37:22.661849 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:37:22.694512 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:37:22.694992 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:37:22.696243 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:37:22.696559 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m09:37:22.697209 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:37:22.698204 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m09:37:23.000293 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m09:37:23.026551 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m09:37:23.031451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac36a70>]}
[0m09:37:23.031814 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db72096-e8e5-483e-b8bb-f76836ec4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace7af0>]}
[0m09:37:23.032462 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.38s]
[0m09:37:23.033052 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.38s]
[0m09:37:23.033591 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:37:23.034054 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:37:23.035166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:23.035483 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m09:37:23.035769 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:37:23.091378 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m09:37:23.091865 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:37:23.315270 [info ] [MainThread]: 
[0m09:37:23.316209 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m09:37:23.317020 [debug] [MainThread]: Command end result
[0m09:37:23.388449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:37:23.389583 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:37:23.393895 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m09:37:23.394100 [info ] [MainThread]: 
[0m09:37:23.394330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:37:23.394503 [info ] [MainThread]: 
[0m09:37:23.394691 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:37:23.396886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.281024, "process_in_blocks": "0", "process_kernel_time": 0.186216, "process_mem_max_rss": "163463168", "process_out_blocks": "0", "process_user_time": 1.633972}
[0m09:37:23.397154 [debug] [MainThread]: Command `dbt run` succeeded at 09:37:23.397106 after 2.28 seconds
[0m09:37:23.397369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094690c0>]}
[0m09:37:23.397586 [debug] [MainThread]: Flushing usage events
[0m09:37:23.846719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:09.132422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188e8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3e85e0>]}


============================== 09:41:09.136495 | 51409733-4b11-42e4-9ad6-cafd346c39d3 ==============================
[0m09:41:09.136495 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:41:09.136877 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ls --resource-type source', 'log_format': 'default'}
[0m09:41:09.347492 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:41:09.347805 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:41:09.347985 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:41:09.440559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51409733-4b11-42e4-9ad6-cafd346c39d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c46ef0>]}
[0m09:41:09.470747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51409733-4b11-42e4-9ad6-cafd346c39d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a372ce0>]}
[0m09:41:09.471292 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:41:09.540175 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m09:41:09.617426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:41:09.617694 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:41:09.617852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:41:09.638066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51409733-4b11-42e4-9ad6-cafd346c39d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c441720>]}
[0m09:41:09.681216 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:41:09.682700 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:41:09.693119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51409733-4b11-42e4-9ad6-cafd346c39d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b527910>]}
[0m09:41:09.693426 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m09:41:09.693622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51409733-4b11-42e4-9ad6-cafd346c39d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7691e0>]}
[0m09:41:09.694042 [info ] [MainThread]: source:capstone_amazon_analytics.amazon_raw.CAPSTONE_AMAZON_META_RAW_TABLE
[0m09:41:09.694215 [info ] [MainThread]: source:capstone_amazon_analytics.amazon_raw.CAPSTONE_AMAZON_REVIEW_RAW_TABLE
[0m09:41:09.696260 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.60717326, "process_in_blocks": "0", "process_kernel_time": 0.194249, "process_mem_max_rss": "142147584", "process_out_blocks": "0", "process_user_time": 1.075961}
[0m09:41:09.696648 [debug] [MainThread]: Command `dbt ls` succeeded at 09:41:09.696594 after 0.61 seconds
[0m09:41:09.696861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188e8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7691e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a372ce0>]}
[0m09:41:09.697055 [debug] [MainThread]: Flushing usage events
[0m09:41:10.206221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:19.548358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106974610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106974760>]}


============================== 09:43:19.551972 | 5128f99e-47fa-4815-b033-7d05fad930db ==============================
[0m09:43:19.551972 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:43:19.552301 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/Users/elham/.dbt', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select staging', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True'}
[0m09:43:19.770283 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:43:19.770595 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:43:19.770771 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:43:19.863396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5128f99e-47fa-4815-b033-7d05fad930db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076568c0>]}
[0m09:43:19.893944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5128f99e-47fa-4815-b033-7d05fad930db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d7610>]}
[0m09:43:19.894634 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:43:19.965764 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m09:43:20.042689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:20.042954 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:43:20.043111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:20.063331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5128f99e-47fa-4815-b033-7d05fad930db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb9510>]}
[0m09:43:20.107260 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:43:20.108708 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:43:20.125086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5128f99e-47fa-4815-b033-7d05fad930db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bba320>]}
[0m09:43:20.125407 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m09:43:20.125605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5128f99e-47fa-4815-b033-7d05fad930db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb8100>]}
[0m09:43:20.126274 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:43:20.127301 [debug] [MainThread]: Command end result
[0m09:43:20.140074 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:43:20.140937 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:43:20.142889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m09:43:20.144632 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6375618, "process_in_blocks": "0", "process_kernel_time": 0.201756, "process_mem_max_rss": "143327232", "process_out_blocks": "0", "process_user_time": 1.098415}
[0m09:43:20.144919 [debug] [MainThread]: Command `dbt test` succeeded at 09:43:20.144873 after 0.64 seconds
[0m09:43:20.145149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107728130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076568c0>]}
[0m09:43:20.145341 [debug] [MainThread]: Flushing usage events
[0m09:43:20.669583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:42.440213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e8550>]}


============================== 09:44:42.443786 | 9cd97338-e7f3-4198-ba07-d784103b3b47 ==============================
[0m09:44:42.443786 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:44:42.444120 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True'}
[0m09:44:42.644993 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:44:42.645315 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:44:42.645492 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:44:42.735534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd97338-e7f3-4198-ba07-d784103b3b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d05690>]}
[0m09:44:42.766124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd97338-e7f3-4198-ba07-d784103b3b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db2020>]}
[0m09:44:42.767063 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:44:42.835811 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m09:44:42.911099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:42.911376 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:44:42.911523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:42.931762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cd97338-e7f3-4198-ba07-d784103b3b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0b9450>]}
[0m09:44:42.975244 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:44:42.976541 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:44:42.987924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cd97338-e7f3-4198-ba07-d784103b3b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a02ae90>]}
[0m09:44:42.988229 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m09:44:42.988419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd97338-e7f3-4198-ba07-d784103b3b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a061270>]}
[0m09:44:42.988724 [warn ] [MainThread]: The selection criterion 'mart' does not match any enabled nodes
[0m09:44:42.989266 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:44:42.990348 [debug] [MainThread]: Command end result
[0m09:44:43.003068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:44:43.003907 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:44:43.005683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m09:44:43.007420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.60768694, "process_in_blocks": "0", "process_kernel_time": 0.191497, "process_mem_max_rss": "141705216", "process_out_blocks": "0", "process_user_time": 1.088386}
[0m09:44:43.007706 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:43.007661 after 0.61 seconds
[0m09:44:43.007921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db2020>]}
[0m09:44:43.008112 [debug] [MainThread]: Flushing usage events
[0m09:44:43.540848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:27.377025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b884f0>]}


============================== 09:45:27.380734 | 7ccd2413-2993-408e-aa72-0c5f01a955b0 ==============================
[0m09:45:27.380734 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:45:27.381107 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'invocation_command': 'dbt run --select staging', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m09:45:27.579686 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:45:27.579989 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:45:27.580170 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:45:27.670693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034c7bb0>]}
[0m09:45:27.701125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b9720>]}
[0m09:45:27.702030 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:45:27.775499 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m09:45:27.855166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:45:27.855453 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:45:27.855609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:45:27.876062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ec1ae0>]}
[0m09:45:27.919391 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:45:27.920733 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:45:27.931963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d436a0>]}
[0m09:45:27.932259 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m09:45:27.932455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d79270>]}
[0m09:45:27.933184 [info ] [MainThread]: 
[0m09:45:27.933377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:45:27.933530 [info ] [MainThread]: 
[0m09:45:27.933799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:45:27.936320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:45:27.971261 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:45:27.971586 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m09:45:27.971771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:28.706078 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.734 seconds
[0m09:45:28.709241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:45:28.709837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:45:28.722457 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:45:28.724990 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:45:28.725362 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m09:45:28.725693 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m09:45:28.726497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:28.981559 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.256 seconds
[0m09:45:29.282232 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c250cd-0306-09f2-0004-85da0003a5ae
[0m09:45:29.283279 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m09:45:29.283932 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m09:45:29.284426 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:45:29.284950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577c100>]}
[0m09:45:29.286733 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:45:29.286978 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:45:29.287338 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:45:29.287738 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:45:29.288038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m09:45:29.288290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m09:45:29.288507 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:45:29.288705 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:45:29.294344 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:45:29.295990 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:45:29.296442 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:45:29.296633 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:45:29.311772 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:45:29.313749 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:45:29.314464 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:45:29.314955 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:45:29.315193 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m09:45:29.315444 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m09:45:29.545535 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m09:45:29.564379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26a40>]}
[0m09:45:29.564832 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.28s]
[0m09:45:29.565163 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:45:29.605253 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m09:45:29.606753 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ccd2413-2993-408e-aa72-0c5f01a955b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a43a0>]}
[0m09:45:29.607130 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m09:45:29.607440 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:45:29.608081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:29.608281 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m09:45:29.608468 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:45:30.015128 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m09:45:30.016319 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:45:30.111153 [info ] [MainThread]: 
[0m09:45:30.112411 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m09:45:30.113493 [debug] [MainThread]: Command end result
[0m09:45:30.169256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:45:30.170383 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:45:30.173988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m09:45:30.174209 [info ] [MainThread]: 
[0m09:45:30.174450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:45:30.174666 [info ] [MainThread]: 
[0m09:45:30.174867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:45:30.177086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8452826, "process_in_blocks": "0", "process_kernel_time": 0.23564, "process_mem_max_rss": "159531008", "process_out_blocks": "0", "process_user_time": 1.609658}
[0m09:45:30.177368 [debug] [MainThread]: Command `dbt run` succeeded at 09:45:30.177317 after 2.85 seconds
[0m09:45:30.177585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105946080>]}
[0m09:45:30.177808 [debug] [MainThread]: Flushing usage events
[0m09:45:30.649310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:49.498592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd0610>]}


============================== 09:45:49.502181 | e6c0e51d-ad9f-4926-b360-902d5501aac2 ==============================
[0m09:45:49.502181 [info ] [MainThread]: Running with dbt=1.11.3
[0m09:45:49.502492 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/elham/.dbt', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False'}
[0m09:45:49.701999 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m09:45:49.702315 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m09:45:49.702491 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m09:45:49.793722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fca00>]}
[0m09:45:49.824381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103510850>]}
[0m09:45:49.825182 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m09:45:49.895401 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m09:45:49.972031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:45:49.972298 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:45:49.972451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:45:49.992689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1bfa0>]}
[0m09:45:50.035938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:45:50.037739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:45:50.048528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8a770>]}
[0m09:45:50.048827 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m09:45:50.049024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0580>]}
[0m09:45:50.049747 [info ] [MainThread]: 
[0m09:45:50.049932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:45:50.050085 [info ] [MainThread]: 
[0m09:45:50.050344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:45:50.052846 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:45:50.085661 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:45:50.085967 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m09:45:50.086138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:50.679836 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.594 seconds
[0m09:45:50.682936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:45:50.683381 [debug] [ThreadPool]: Creating schema "database: "AMAZON_REVIEW_ANALYTICS_DEV"
schema: "STAGE_MART"
"
[0m09:45:50.687380 [debug] [ThreadPool]: Using snowflake connection "create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:45:50.687709 [debug] [ThreadPool]: On create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: create schema if not exists AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
[0m09:45:50.769681 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.082 seconds
[0m09:45:50.773287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:45:50.774121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:45:50.785417 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:45:50.787823 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:45:50.788064 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m09:45:50.788280 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m09:45:50.788816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:51.037798 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.249 seconds
[0m09:45:51.262443 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.473 seconds
[0m09:45:51.266847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2f4f0>]}
[0m09:45:51.270248 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:45:51.270675 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:45:51.271340 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:45:51.271942 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:45:51.272462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m09:45:51.272814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m09:45:51.273125 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:45:51.273406 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:45:51.281989 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:45:51.284938 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:45:51.285785 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:45:51.286154 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:45:51.322838 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:45:51.326287 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:45:51.327372 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:45:51.328001 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:45:51.328263 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
category,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m09:45:51.328548 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m09:45:51.522650 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c250cd-0306-108b-0004-85da0003b55e
[0m09:45:51.523403 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'CATEGORY'
[0m09:45:51.525368 [debug] [Thread-2 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m09:45:51.527381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd4370>]}
[0m09:45:51.528376 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.25s]
[0m09:45:51.528953 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:45:51.529451 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql.
[0m09:45:52.958395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.629 seconds
[0m09:45:53.035152 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c0e51d-ad9f-4926-b360-902d5501aac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd41f0>]}
[0m09:45:53.035688 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.76s]
[0m09:45:53.036059 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:45:53.036769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:53.036969 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m09:45:53.037149 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:45:53.116451 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m09:45:53.116872 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:45:53.289394 [info ] [MainThread]: 
[0m09:45:53.290647 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m09:45:53.292664 [debug] [MainThread]: Command end result
[0m09:45:53.320931 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m09:45:53.322714 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m09:45:53.329452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m09:45:53.329862 [info ] [MainThread]: 
[0m09:45:53.330212 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:45:53.330513 [info ] [MainThread]: 
[0m09:45:53.330870 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m09:45:53.331333 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m09:45:53.331644 [info ] [MainThread]: 
[0m09:45:53.332005 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/dim_products.sql
[0m09:45:53.332274 [info ] [MainThread]: 
[0m09:45:53.332570 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m09:45:53.335508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8797069, "process_in_blocks": "0", "process_kernel_time": 0.229975, "process_mem_max_rss": "159416320", "process_out_blocks": "0", "process_user_time": 1.656928}
[0m09:45:53.335883 [debug] [MainThread]: Command `dbt run` failed at 09:45:53.335817 after 3.88 seconds
[0m09:45:53.336201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e267a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e26f20>]}
[0m09:45:53.336501 [debug] [MainThread]: Flushing usage events
[0m09:45:53.827241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:08.188651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b48c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226e8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226e86d0>]}


============================== 10:05:08.192536 | adad012b-b477-446d-b481-b5219a32c382 ==============================
[0m10:05:08.192536 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:05:08.192879 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'debug': 'False', 'write_json': 'True', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True'}
[0m10:05:08.404890 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:05:08.405203 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:05:08.405389 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:05:08.497880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209788e0>]}
[0m10:05:08.528302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ee2380>]}
[0m10:05:08.528865 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:05:08.597211 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:05:08.674767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:05:08.675150 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m10:05:08.811359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bed5a0>]}
[0m10:05:08.854081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:05:08.856285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:05:08.868459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12442d330>]}
[0m10:05:08.868753 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:05:08.868941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12442d750>]}
[0m10:05:08.869651 [info ] [MainThread]: 
[0m10:05:08.869848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:05:08.869996 [info ] [MainThread]: 
[0m10:05:08.870270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:05:08.872733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:05:08.907081 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:05:08.907396 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:05:08.907563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:09.630204 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.722 seconds
[0m10:05:09.633848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m10:05:09.634500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m10:05:09.648055 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:05:09.650534 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:05:09.650893 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:05:09.651199 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:05:09.652306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:09.997753 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.346 seconds
[0m10:05:10.145882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.493 seconds
[0m10:05:10.151573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3fa0>]}
[0m10:05:10.155750 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m10:05:10.156204 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m10:05:10.156729 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m10:05:10.157246 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m10:05:10.157730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m10:05:10.158165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m10:05:10.158544 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m10:05:10.158900 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m10:05:10.167509 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m10:05:10.170309 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:05:10.171418 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m10:05:10.171787 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m10:05:10.204989 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m10:05:10.206372 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:05:10.207388 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m10:05:10.208079 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m10:05:10.208366 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
main_category as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m10:05:10.208680 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m10:05:10.497499 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m10:05:10.500191 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m10:05:10.532272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120979a50>]}
[0m10:05:10.532743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adad012b-b477-446d-b481-b5219a32c382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f467d0>]}
[0m10:05:10.533433 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.37s]
[0m10:05:10.534166 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.37s]
[0m10:05:10.534857 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m10:05:10.535424 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m10:05:10.536548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:10.536836 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m10:05:10.537108 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m10:05:10.610779 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m10:05:10.611419 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m10:05:10.744513 [info ] [MainThread]: 
[0m10:05:10.745009 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m10:05:10.745790 [debug] [MainThread]: Command end result
[0m10:05:10.773650 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:05:10.775258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:05:10.781762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:05:10.782108 [info ] [MainThread]: 
[0m10:05:10.782466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:05:10.782742 [info ] [MainThread]: 
[0m10:05:10.783031 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:05:10.785887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.642324, "process_in_blocks": "0", "process_kernel_time": 0.246438, "process_mem_max_rss": "167100416", "process_out_blocks": "0", "process_user_time": 1.770742}
[0m10:05:10.786323 [debug] [MainThread]: Command `dbt run` succeeded at 10:05:10.786246 after 2.64 seconds
[0m10:05:10.786660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b48c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f73c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e05660>]}
[0m10:05:10.787007 [debug] [MainThread]: Flushing usage events
[0m10:05:11.299771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:40.524240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107408c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de8550>]}


============================== 10:05:40.527882 | d680e7bb-b318-48c7-a47a-212a9c6dbfc8 ==============================
[0m10:05:40.527882 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:05:40.528218 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt run --select marts', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'static_parser': 'True', 'target_path': 'None'}
[0m10:05:40.733373 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:05:40.733683 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:05:40.733861 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:05:40.824028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107470d90>]}
[0m10:05:40.854349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b2020>]}
[0m10:05:40.855318 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:05:40.925124 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:05:41.003166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:05:41.003584 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m10:05:41.149234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114af9570>]}
[0m10:05:41.194963 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:05:41.196507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:05:41.208234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11462b490>]}
[0m10:05:41.208570 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:05:41.208775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114abe320>]}
[0m10:05:41.209495 [info ] [MainThread]: 
[0m10:05:41.209698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:05:41.209859 [info ] [MainThread]: 
[0m10:05:41.210127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:05:41.212827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:05:41.247485 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:05:41.247767 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:05:41.247951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:41.922112 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.674 seconds
[0m10:05:41.926440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m10:05:41.927016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m10:05:41.940154 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:05:41.942656 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:05:41.943012 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:05:41.943323 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:05:41.944489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:42.130831 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.187 seconds
[0m10:05:42.788713 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.844 seconds
[0m10:05:42.792937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136dc160>]}
[0m10:05:42.797451 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m10:05:42.797854 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m10:05:42.798400 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m10:05:42.798942 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m10:05:42.799382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m10:05:42.799750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m10:05:42.800096 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m10:05:42.800418 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m10:05:42.809329 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m10:05:42.812315 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:05:42.813186 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m10:05:42.813554 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m10:05:42.849585 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:05:42.852108 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m10:05:42.853280 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m10:05:42.853579 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m10:05:42.854743 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m10:05:42.855086 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
main_category,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m10:05:42.997085 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c250e1-0306-108b-0004-85da0003b56e
[0m10:05:42.997580 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'MAIN_CATEGORY'
[0m10:05:42.999328 [debug] [Thread-2 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:05:43.001156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11594e680>]}
[0m10:05:43.001786 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.20s]
[0m10:05:43.002484 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m10:05:43.002979 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql.
[0m10:05:45.348053 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.494 seconds
[0m10:05:45.375934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd680e7bb-b318-48c7-a47a-212a9c6dbfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562a770>]}
[0m10:05:45.376716 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.58s]
[0m10:05:45.377265 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m10:05:45.378331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:45.378680 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m10:05:45.378978 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m10:05:45.484646 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m10:05:45.485214 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m10:05:45.675832 [info ] [MainThread]: 
[0m10:05:45.677172 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m10:05:45.678220 [debug] [MainThread]: Command end result
[0m10:05:45.706597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:05:45.708188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:05:45.714513 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:05:45.714873 [info ] [MainThread]: 
[0m10:05:45.715214 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:05:45.715514 [info ] [MainThread]: 
[0m10:05:45.715883 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m10:05:45.716243 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:05:45.716508 [info ] [MainThread]: 
[0m10:05:45.716812 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:05:45.717071 [info ] [MainThread]: 
[0m10:05:45.717355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:05:45.720244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.2379894, "process_in_blocks": "0", "process_kernel_time": 0.237009, "process_mem_max_rss": "167198720", "process_out_blocks": "0", "process_user_time": 1.783234}
[0m10:05:45.720671 [debug] [MainThread]: Command `dbt run` failed at 10:05:45.720608 after 5.24 seconds
[0m10:05:45.720950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107408c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aa2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e04df0>]}
[0m10:05:45.721283 [debug] [MainThread]: Flushing usage events
[0m10:05:46.215232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:57.310974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e8550>]}


============================== 10:06:57.314648 | 7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5 ==============================
[0m10:06:57.314648 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:06:57.314983 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/elham/.dbt', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:06:57.525499 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:06:57.525820 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:06:57.526003 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:06:57.621628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0d690>]}
[0m10:06:57.652643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb2020>]}
[0m10:06:57.653356 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:06:57.722856 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:06:57.802620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:06:57.803022 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m10:06:57.944641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ff9570>]}
[0m10:06:57.986813 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:06:57.988273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:06:58.000340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d298a0>]}
[0m10:06:58.000647 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:06:58.000853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fbdd50>]}
[0m10:06:58.001577 [info ] [MainThread]: 
[0m10:06:58.001775 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:06:58.001933 [info ] [MainThread]: 
[0m10:06:58.002201 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:06:58.004684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:06:58.037779 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:06:58.038079 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:06:58.038246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:58.718104 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.680 seconds
[0m10:06:58.722801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m10:06:58.723278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m10:06:58.731442 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:06:58.732899 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:06:58.733109 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:06:58.733312 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:06:58.733634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:58.937387 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m10:06:59.199998 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.466 seconds
[0m10:06:59.205409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115568160>]}
[0m10:06:59.209490 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m10:06:59.209913 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m10:06:59.210541 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m10:06:59.211051 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m10:06:59.211485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m10:06:59.211864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m10:06:59.212212 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m10:06:59.212542 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m10:06:59.221140 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m10:06:59.223976 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:06:59.225038 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m10:06:59.225415 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m10:06:59.261665 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m10:06:59.263991 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:06:59.265164 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m10:06:59.265822 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m10:06:59.266113 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
main_category, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m10:06:59.266406 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m10:06:59.452504 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c250e2-0306-11d0-0004-85da0003c3a2
[0m10:06:59.452985 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'MAIN_CATEGORY'
[0m10:06:59.454932 [debug] [Thread-2 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:06:59.456884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110819a50>]}
[0m10:06:59.457576 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.24s]
[0m10:06:59.458133 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m10:06:59.458594 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql.
[0m10:07:00.715861 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.449 seconds
[0m10:07:00.743067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b94cfc2-dfde-40c7-a6f2-a9ad73871fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cda770>]}
[0m10:07:00.744052 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.53s]
[0m10:07:00.744778 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m10:07:00.745972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:00.746414 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m10:07:00.746724 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m10:07:00.834556 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m10:07:00.835070 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m10:07:00.992952 [info ] [MainThread]: 
[0m10:07:00.994065 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m10:07:00.995473 [debug] [MainThread]: Command end result
[0m10:07:01.021613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:07:01.023458 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:07:01.030094 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:07:01.030437 [info ] [MainThread]: 
[0m10:07:01.030878 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:07:01.031195 [info ] [MainThread]: 
[0m10:07:01.031558 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m10:07:01.031898 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:07:01.032177 [info ] [MainThread]: 
[0m10:07:01.032506 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:07:01.032771 [info ] [MainThread]: 
[0m10:07:01.033238 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:07:01.036841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7696416, "process_in_blocks": "0", "process_kernel_time": 0.246213, "process_mem_max_rss": "166133760", "process_out_blocks": "0", "process_user_time": 1.750611}
[0m10:07:01.037280 [debug] [MainThread]: Command `dbt run` failed at 10:07:01.037204 after 3.77 seconds
[0m10:07:01.037633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c48340>]}
[0m10:07:01.037969 [debug] [MainThread]: Flushing usage events
[0m10:07:01.545459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:57.958224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e8610>]}


============================== 10:09:57.961986 | f81c89c2-ccdd-486e-a2a8-5b439d4e699c ==============================
[0m10:09:57.961986 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:09:57.962343 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'version_check': 'True', 'debug': 'False'}
[0m10:09:58.027891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f81c89c2-ccdd-486e-a2a8-5b439d4e699c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105626ec0>]}
[0m10:09:58.041207 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12845762, "process_in_blocks": "0", "process_kernel_time": 0.132348, "process_mem_max_rss": "111771648", "process_out_blocks": "0", "process_user_time": 0.751473}
[0m10:09:58.041483 [debug] [MainThread]: Command `dbt clean` succeeded at 10:09:58.041432 after 0.13 seconds
[0m10:09:58.041675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590e110>]}
[0m10:09:58.041868 [debug] [MainThread]: Flushing usage events
[0m10:09:58.581794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:07.748063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108464b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109540520>]}


============================== 10:10:07.751666 | 54f9c50f-1dbf-4d03-9875-3ecb5b10335c ==============================
[0m10:10:07.751666 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:10:07.752002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'use_colors': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/elham/.dbt', 'indirect_selection': 'eager'}
[0m10:10:07.760334 [info ] [MainThread]: dbt version: 1.11.3
[0m10:10:07.760552 [info ] [MainThread]: python version: 3.10.19
[0m10:10:07.760715 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m10:10:07.760870 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m10:10:07.969523 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:10:07.969834 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:10:07.970012 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:10:08.000990 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m10:10:08.001268 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m10:10:08.001440 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m10:10:08.001750 [info ] [MainThread]: adapter type: snowflake
[0m10:10:08.001907 [info ] [MainThread]: adapter version: 1.11.1
[0m10:10:08.054832 [info ] [MainThread]: Configuration:
[0m10:10:08.055188 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:10:08.055363 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:10:08.055519 [info ] [MainThread]: Required dependencies:
[0m10:10:08.055720 [debug] [MainThread]: Executing "git --help"
[0m10:10:08.069081 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:10:08.069750 [debug] [MainThread]: STDERR: "b''"
[0m10:10:08.069965 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:10:08.070170 [info ] [MainThread]: Connection:
[0m10:10:08.070406 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m10:10:08.070556 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m10:10:08.070696 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m10:10:08.070838 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m10:10:08.070973 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m10:10:08.071116 [info ] [MainThread]:   schema: STAGE
[0m10:10:08.071254 [info ] [MainThread]:   authenticator: jwt
[0m10:10:08.071389 [info ] [MainThread]:   oauth_client_id: None
[0m10:10:08.071521 [info ] [MainThread]:   query_tag: None
[0m10:10:08.071656 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:10:08.071789 [info ] [MainThread]:   host: None
[0m10:10:08.071922 [info ] [MainThread]:   port: None
[0m10:10:08.072054 [info ] [MainThread]:   proxy_host: None
[0m10:10:08.072184 [info ] [MainThread]:   proxy_port: None
[0m10:10:08.072316 [info ] [MainThread]:   protocol: None
[0m10:10:08.072450 [info ] [MainThread]:   connect_retries: 1
[0m10:10:08.072579 [info ] [MainThread]:   connect_timeout: None
[0m10:10:08.072711 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:10:08.072846 [info ] [MainThread]:   retry_all: False
[0m10:10:08.072977 [info ] [MainThread]:   insecure_mode: False
[0m10:10:08.073107 [info ] [MainThread]:   reuse_connections: True
[0m10:10:08.073239 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:10:08.073371 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m10:10:08.073737 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:10:08.136988 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:10:08.166702 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:10:08.166960 [debug] [MainThread]: On debug: select 1 as id
[0m10:10:08.167164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:08.865079 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.698 seconds
[0m10:10:08.868102 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:10:08.868832 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:10:08.874710 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1692741, "process_in_blocks": "0", "process_kernel_time": 0.191134, "process_mem_max_rss": "151142400", "process_out_blocks": "0", "process_user_time": 1.141838}
[0m10:10:08.875314 [debug] [MainThread]: Command `dbt debug` succeeded at 10:10:08.875202 after 1.17 seconds
[0m10:10:08.875692 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:10:08.875983 [debug] [MainThread]: On debug: Close
[0m10:10:08.980953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108464b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de5630>]}
[0m10:10:08.982239 [debug] [MainThread]: Flushing usage events
[0m10:10:09.437482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:24.361174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204dcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fe8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fe86d0>]}


============================== 10:10:24.364655 | ed77a448-564e-453b-8d0c-f7d6ac99b65f ==============================
[0m10:10:24.364655 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:10:24.365002 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'empty': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None'}
[0m10:10:24.564572 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:10:24.564895 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:10:24.565078 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:10:24.654707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b608e0>]}
[0m10:10:24.684998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216e2380>]}
[0m10:10:24.685659 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:10:24.753919 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:10:24.754412 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:10:24.754636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e77820>]}
[0m10:10:25.419512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249e9810>]}
[0m10:10:25.460640 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:10:25.461934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:10:25.472721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124983940>]}
[0m10:10:25.473015 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:10:25.473207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249833a0>]}
[0m10:10:25.473908 [info ] [MainThread]: 
[0m10:10:25.474094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:25.474249 [info ] [MainThread]: 
[0m10:10:25.474498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:25.477015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:10:25.509480 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:10:25.509803 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:10:25.509973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:26.240511 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.730 seconds
[0m10:10:26.244307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m10:10:26.244930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m10:10:26.259790 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:10:26.262525 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:10:26.262904 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:10:26.263221 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:10:26.264348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:26.569452 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.306 seconds
[0m10:10:26.756938 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.492 seconds
[0m10:10:26.766141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107616770>]}
[0m10:10:26.769886 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m10:10:26.770316 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m10:10:26.770863 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m10:10:26.771423 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m10:10:26.771889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m10:10:26.772270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m10:10:26.772631 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m10:10:26.772959 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m10:10:26.781472 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m10:10:26.784477 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:10:26.785561 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m10:10:26.792245 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m10:10:26.816079 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m10:10:26.816633 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:10:26.818062 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m10:10:26.818841 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m10:10:26.819136 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
main_category as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m10:10:26.819472 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m10:10:27.061994 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m10:10:27.089089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066467d0>]}
[0m10:10:27.089842 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m10:10:27.090416 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m10:10:27.270409 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m10:10:27.276093 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed77a448-564e-453b-8d0c-f7d6ac99b65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ec9720>]}
[0m10:10:27.277170 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.50s]
[0m10:10:27.277872 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m10:10:27.279102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:27.279472 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m10:10:27.279819 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m10:10:27.421608 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m10:10:27.422747 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m10:10:27.518682 [info ] [MainThread]: 
[0m10:10:27.519638 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m10:10:27.521034 [debug] [MainThread]: Command end result
[0m10:10:27.547015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:10:27.548757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:10:27.554725 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:10:27.555071 [info ] [MainThread]: 
[0m10:10:27.555436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:27.555713 [info ] [MainThread]: 
[0m10:10:27.556009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:10:27.559507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2387652, "process_in_blocks": "0", "process_kernel_time": 0.220371, "process_mem_max_rss": "161185792", "process_out_blocks": "0", "process_user_time": 2.166017}
[0m10:10:27.560021 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:27.559936 after 3.24 seconds
[0m10:10:27.560382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204dcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066467d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e05660>]}
[0m10:10:27.560742 [debug] [MainThread]: Flushing usage events
[0m10:10:28.028022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:39.674441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a06d0>]}


============================== 10:10:39.678047 | ecde72a5-9665-4f47-9cf0-fca3900efe4b ==============================
[0m10:10:39.678047 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:10:39.678383 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt run --select marts', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m10:10:39.909907 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:10:39.910246 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:10:39.910436 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:10:40.008099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e88e0>]}
[0m10:10:40.041610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509e380>]}
[0m10:10:40.042315 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:10:40.115177 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:10:40.192053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:40.192334 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:10:40.192499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:40.212856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f14b0>]}
[0m10:10:40.256605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:10:40.258198 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:10:40.269389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106960250>]}
[0m10:10:40.269725 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:10:40.269936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065634f0>]}
[0m10:10:40.270673 [info ] [MainThread]: 
[0m10:10:40.270864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:40.271022 [info ] [MainThread]: 
[0m10:10:40.271304 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:40.274021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:10:40.304371 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:10:40.304729 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:10:40.304922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:40.902417 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.597 seconds
[0m10:10:40.906028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m10:10:40.906699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m10:10:40.919307 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:10:40.921781 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:10:40.922198 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:10:40.922512 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:10:40.923646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:41.125292 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.202 seconds
[0m10:10:41.383163 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.459 seconds
[0m10:10:41.388362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd7fa0>]}
[0m10:10:41.393411 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m10:10:41.393853 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m10:10:41.394441 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m10:10:41.394964 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m10:10:41.395410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m10:10:41.395788 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m10:10:41.396130 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m10:10:41.396446 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m10:10:41.406475 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m10:10:41.409352 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:10:41.410270 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m10:10:41.422708 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m10:10:41.440578 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:10:41.443070 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m10:10:41.444245 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m10:10:41.444558 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m10:10:41.445132 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m10:10:41.446109 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
main_category, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m10:10:41.734123 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c250e6-0306-09f2-0004-85da0003a5d2
[0m10:10:41.734587 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'MAIN_CATEGORY'
[0m10:10:41.736396 [debug] [Thread-2 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:10:41.738588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b45cf0>]}
[0m10:10:41.739289 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.34s]
[0m10:10:41.739843 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m10:10:41.740318 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql.
[0m10:10:43.439376 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.994 seconds
[0m10:10:43.471288 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecde72a5-9665-4f47-9cf0-fca3900efe4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2e7d0>]}
[0m10:10:43.472199 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.08s]
[0m10:10:43.472761 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m10:10:43.473852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:43.474208 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m10:10:43.474514 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m10:10:43.619612 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m10:10:43.620600 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m10:10:43.733026 [info ] [MainThread]: 
[0m10:10:43.734006 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m10:10:43.734894 [debug] [MainThread]: Command end result
[0m10:10:43.805880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:10:43.807031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:10:43.811189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:10:43.811418 [info ] [MainThread]: 
[0m10:10:43.811645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:10:43.811836 [info ] [MainThread]: 
[0m10:10:43.812060 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m10:10:43.812273 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:10:43.812442 [info ] [MainThread]: 
[0m10:10:43.812635 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:10:43.812795 [info ] [MainThread]: 
[0m10:10:43.812972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:10:43.814934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1825905, "process_in_blocks": "0", "process_kernel_time": 0.205923, "process_mem_max_rss": "162103296", "process_out_blocks": "0", "process_user_time": 1.69924}
[0m10:10:43.815222 [debug] [MainThread]: Command `dbt run` failed at 10:10:43.815169 after 4.18 seconds
[0m10:10:43.815451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a26c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a26e90>]}
[0m10:10:43.815668 [debug] [MainThread]: Flushing usage events
[0m10:10:44.305952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:30.233364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7c4f0>]}


============================== 10:13:30.237160 | 5ae8efb0-87e2-4794-89b0-072ffe49c2a8 ==============================
[0m10:13:30.237160 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:13:30.237494 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select staging full-refresh', 'profiles_dir': '/Users/elham/.dbt', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False'}
[0m10:13:30.447856 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:13:30.448184 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:13:30.448367 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:13:30.541783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd5690>]}
[0m10:13:30.572317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a530d0>]}
[0m10:13:30.572875 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:13:30.642307 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:13:30.720963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:30.721217 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:13:30.721372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:30.741640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c5390>]}
[0m10:13:30.785547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:13:30.787249 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:13:30.800606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106034c10>]}
[0m10:13:30.800926 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:13:30.801123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c5e0>]}
[0m10:13:30.801467 [warn ] [MainThread]: The selection criterion 'full-refresh' does not match any enabled nodes
[0m10:13:30.802093 [info ] [MainThread]: 
[0m10:13:30.802269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:30.802420 [info ] [MainThread]: 
[0m10:13:30.802691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:13:30.805331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:13:30.840064 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:13:30.840377 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:13:30.840554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:31.594687 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.754 seconds
[0m10:13:31.616542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m10:13:31.617677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m10:13:31.751369 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:13:31.764952 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:13:31.783491 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:13:31.785015 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:13:31.809315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:31.998525 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.211 seconds
[0m10:13:32.585217 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.776 seconds
[0m10:13:32.590865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10323d8d0>]}
[0m10:13:32.596130 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m10:13:32.596607 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m10:13:32.597306 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m10:13:32.597842 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m10:13:32.598319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m10:13:32.598702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m10:13:32.599104 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m10:13:32.599432 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m10:13:32.614897 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:13:32.611992 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m10:13:32.615847 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m10:13:32.616219 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m10:13:32.644853 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m10:13:32.642332 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:13:32.646335 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m10:13:32.647058 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m10:13:32.647363 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
main_category as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m10:13:32.647695 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m10:13:32.835199 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m10:13:32.836650 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m10:13:32.867566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169ae0>]}
[0m10:13:32.867993 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae8efb0-87e2-4794-89b0-072ffe49c2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169db0>]}
[0m10:13:32.868749 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.27s]
[0m10:13:32.869400 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.27s]
[0m10:13:32.869938 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m10:13:32.870408 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m10:13:32.871534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:32.871860 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m10:13:32.872157 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m10:13:32.982816 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m10:13:32.983335 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m10:13:33.089619 [info ] [MainThread]: 
[0m10:13:33.090865 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m10:13:33.092846 [debug] [MainThread]: Command end result
[0m10:13:33.175924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:13:33.177079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:13:33.181163 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:13:33.181360 [info ] [MainThread]: 
[0m10:13:33.181580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:33.181743 [info ] [MainThread]: 
[0m10:13:33.181941 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:13:33.184061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9936945, "process_in_blocks": "0", "process_kernel_time": 0.280422, "process_mem_max_rss": "156794880", "process_out_blocks": "0", "process_user_time": 1.657574}
[0m10:13:33.184306 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:33.184260 after 2.99 seconds
[0m10:13:33.184516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107146b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107146a70>]}
[0m10:13:33.184717 [debug] [MainThread]: Flushing usage events
[0m10:13:33.728178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:23.967609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e84c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5c580>]}


============================== 10:15:23.971411 | 0889b8e1-edba-432c-9561-47cc02ed5dbf ==============================
[0m10:15:23.971411 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:15:23.971728 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select marts', 'target_path': 'None'}
[0m10:15:24.211255 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:15:24.211574 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:15:24.211752 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:15:24.304528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e54e0>]}
[0m10:15:24.335434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5d120>]}
[0m10:15:24.336015 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:15:24.403426 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:15:24.481664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:24.481936 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:15:24.482093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:24.502386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a5480>]}
[0m10:15:24.545773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:15:24.547310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:15:24.559964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108115f90>]}
[0m10:15:24.560270 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:15:24.560470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081488b0>]}
[0m10:15:24.561209 [info ] [MainThread]: 
[0m10:15:24.561403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:24.561560 [info ] [MainThread]: 
[0m10:15:24.561824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:24.564300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:15:24.598649 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:15:24.598943 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:15:24.599113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:25.650078 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.051 seconds
[0m10:15:25.653471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m10:15:25.654089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m10:15:25.667689 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:15:25.670113 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:15:25.670491 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:15:25.670814 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:15:25.671441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:25.895026 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.224 seconds
[0m10:15:26.059315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.388 seconds
[0m10:15:26.064606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458ffa0>]}
[0m10:15:26.068857 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m10:15:26.069398 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m10:15:26.069932 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m10:15:26.070486 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m10:15:26.070940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m10:15:26.071320 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m10:15:26.071668 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m10:15:26.071987 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m10:15:26.082386 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m10:15:26.085161 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:15:26.086274 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m10:15:26.086628 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m10:15:26.121905 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m10:15:26.124242 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:15:26.125176 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m10:15:26.125842 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m10:15:26.126131 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
main_category, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m10:15:26.126423 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m10:15:26.277481 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c250eb-0306-10cf-0004-85da00038f96
[0m10:15:26.278020 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'MAIN_CATEGORY'
[0m10:15:26.279773 [debug] [Thread-2 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:15:26.282577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093502b0>]}
[0m10:15:26.283254 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.21s]
[0m10:15:26.283812 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m10:15:26.284359 [debug] [Thread-8 (]: Marking all children of 'model.capstone_amazon_analytics.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql.
[0m10:15:27.302941 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.176 seconds
[0m10:15:27.330766 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0889b8e1-edba-432c-9561-47cc02ed5dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e27a0>]}
[0m10:15:27.331596 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.26s]
[0m10:15:27.332234 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m10:15:27.333429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:27.333802 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m10:15:27.334103 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m10:15:27.414409 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m10:15:27.414877 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m10:15:27.493208 [info ] [MainThread]: 
[0m10:15:27.494123 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m10:15:27.494954 [debug] [MainThread]: Command end result
[0m10:15:27.564673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:15:27.565844 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:15:27.570069 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:15:27.570301 [info ] [MainThread]: 
[0m10:15:27.570529 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:15:27.570718 [info ] [MainThread]: 
[0m10:15:27.570953 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m10:15:27.571174 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'MAIN_CATEGORY'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:15:27.571352 [info ] [MainThread]: 
[0m10:15:27.571546 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/dim_products.sql
[0m10:15:27.571708 [info ] [MainThread]: 
[0m10:15:27.571886 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:15:27.573807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.651037, "process_in_blocks": "0", "process_kernel_time": 0.257442, "process_mem_max_rss": "159744000", "process_out_blocks": "0", "process_user_time": 1.674863}
[0m10:15:27.574111 [debug] [MainThread]: Command `dbt run` failed at 10:15:27.574059 after 3.65 seconds
[0m10:15:27.574342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e84c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108155450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108154d00>]}
[0m10:15:27.574567 [debug] [MainThread]: Flushing usage events
[0m10:15:28.061118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:38.580271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e50ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2c580>]}


============================== 10:17:38.584095 | 2495a8aa-7962-4033-8559-91bd1efb3c98 ==============================
[0m10:17:38.584095 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:17:38.584438 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt run --select staging', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m10:17:38.795829 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:17:38.796140 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:17:38.796324 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:17:38.894671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cd180>]}
[0m10:17:38.927768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2d180>]}
[0m10:17:38.928645 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:17:39.001075 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:17:39.094011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:17:39.094454 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m10:17:39.094689 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m10:17:39.243327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b5810>]}
[0m10:17:39.286407 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:17:39.288168 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:17:39.300300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11f1c0>]}
[0m10:17:39.300606 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:17:39.300808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11c730>]}
[0m10:17:39.301550 [info ] [MainThread]: 
[0m10:17:39.301748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:39.301902 [info ] [MainThread]: 
[0m10:17:39.302171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:17:39.304688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:17:39.338042 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:17:39.338399 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:17:39.338601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:40.012564 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.674 seconds
[0m10:17:40.016682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m10:17:40.017262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m10:17:40.030682 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:17:40.033090 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:17:40.033452 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:17:40.033777 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:17:40.034564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:40.220755 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.187 seconds
[0m10:17:40.444026 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.409 seconds
[0m10:17:40.448670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b201f0>]}
[0m10:17:40.451588 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m10:17:40.451975 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m10:17:40.452551 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m10:17:40.453146 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m10:17:40.453606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m10:17:40.454025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m10:17:40.454403 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m10:17:40.454750 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m10:17:40.463596 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m10:17:40.466437 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:17:40.467431 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m10:17:40.467809 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m10:17:40.499500 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m10:17:40.502953 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m10:17:40.504035 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m10:17:40.504388 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m10:17:40.505056 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m10:17:40.505810 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m10:17:40.832786 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m10:17:40.834784 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m10:17:40.871866 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786cb50>]}
[0m10:17:40.872238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2495a8aa-7962-4033-8559-91bd1efb3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b2800>]}
[0m10:17:40.872913 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.42s]
[0m10:17:40.873515 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.42s]
[0m10:17:40.874062 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m10:17:40.874521 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m10:17:40.875386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:40.875609 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m10:17:40.875819 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m10:17:40.963894 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m10:17:40.964412 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m10:17:41.051265 [info ] [MainThread]: 
[0m10:17:41.052389 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m10:17:41.053368 [debug] [MainThread]: Command end result
[0m10:17:41.079894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:17:41.081501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:17:41.087507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:17:41.087845 [info ] [MainThread]: 
[0m10:17:41.088125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:41.088353 [info ] [MainThread]: 
[0m10:17:41.088589 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:17:41.091548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.55568, "process_in_blocks": "0", "process_kernel_time": 0.255186, "process_mem_max_rss": "164610048", "process_out_blocks": "0", "process_user_time": 1.793091}
[0m10:17:41.091986 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:41.091907 after 2.56 seconds
[0m10:17:41.092347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e50ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cd180>]}
[0m10:17:41.092711 [debug] [MainThread]: Flushing usage events
[0m10:17:41.614446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:48.482930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a8610>]}


============================== 10:17:48.486372 | aebc3ec9-10b5-40ce-9af3-018a91cf9983 ==============================
[0m10:17:48.486372 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:17:48.486687 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt run --select marts', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/elham/.dbt', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:17:48.671905 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:17:48.672319 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:17:48.672507 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:17:48.763544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d8a00>]}
[0m10:17:48.794211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e4850>]}
[0m10:17:48.795033 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:17:48.862745 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:17:48.938785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:48.939054 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:17:48.939215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:48.959458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f13f0>]}
[0m10:17:49.002827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:17:49.003908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:17:49.014727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a262dd0>]}
[0m10:17:49.015034 [info ] [MainThread]: Found 4 models, 2 sources, 522 macros
[0m10:17:49.015229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a294580>]}
[0m10:17:49.015950 [info ] [MainThread]: 
[0m10:17:49.016135 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:49.016285 [info ] [MainThread]: 
[0m10:17:49.016554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:17:49.019066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m10:17:49.052173 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m10:17:49.052637 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m10:17:49.052811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:49.588321 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.535 seconds
[0m10:17:49.591426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m10:17:49.591994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m10:17:49.605604 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m10:17:49.608075 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m10:17:49.608428 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m10:17:49.608746 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m10:17:49.609958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:49.871330 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.262 seconds
[0m10:17:50.092896 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.483 seconds
[0m10:17:50.097569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9c130>]}
[0m10:17:50.101562 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m10:17:50.101983 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m10:17:50.102487 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m10:17:50.102988 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m10:17:50.103431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m10:17:50.103799 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m10:17:50.104163 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m10:17:50.104481 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m10:17:50.114217 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m10:17:50.116961 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:17:50.117867 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m10:17:50.118233 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m10:17:50.153379 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m10:17:50.155958 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m10:17:50.156870 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m10:17:50.157541 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m10:17:50.157840 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m10:17:50.158156 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m10:17:51.018960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m10:17:51.044997 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.886 seconds
[0m10:17:51.052221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e740>]}
[0m10:17:51.052607 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc3ec9-10b5-40ce-9af3-018a91cf9983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef4850>]}
[0m10:17:51.053209 [info ] [Thread-2 (]: 1 of 2 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m10:17:51.053830 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 0.95s]
[0m10:17:51.054377 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m10:17:51.054839 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m10:17:51.055980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:51.056316 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m10:17:51.056610 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m10:17:51.175495 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m10:17:51.176097 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m10:17:51.410549 [info ] [MainThread]: 
[0m10:17:51.411628 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m10:17:51.412960 [debug] [MainThread]: Command end result
[0m10:17:51.484346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m10:17:51.485527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m10:17:51.489758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m10:17:51.489987 [info ] [MainThread]: 
[0m10:17:51.490228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:51.490417 [info ] [MainThread]: 
[0m10:17:51.490612 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:17:51.492482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.050097, "process_in_blocks": "0", "process_kernel_time": 0.209803, "process_mem_max_rss": "161431552", "process_out_blocks": "0", "process_user_time": 1.670297}
[0m10:17:51.492782 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:51.492731 after 3.05 seconds
[0m10:17:51.493034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee4d90>]}
[0m10:17:51.493270 [debug] [MainThread]: Flushing usage events
[0m10:17:51.935391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:03.208472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107504b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e8550>]}


============================== 10:37:03.212307 | 233f0bf3-f7a7-4fb4-92f1-02e526e12f83 ==============================
[0m10:37:03.212307 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:37:03.212630 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt run --select staging', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m10:37:03.430263 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:37:03.430615 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:37:03.430806 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:37:03.523863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233f0bf3-f7a7-4fb4-92f1-02e526e12f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9046a0>]}
[0m10:37:03.554585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233f0bf3-f7a7-4fb4-92f1-02e526e12f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f49750>]}
[0m10:37:03.555345 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:37:03.643914 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:37:03.700830 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading capstone_amazon_analytics: staging/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 | - accepted_values:
    24 | values: [1, 2, 3, 4, 5]
    25 | 
    26 | - name: stg_meta
    27 | description: "Cleaned product metadata from raw product information"
    28 | 
    29 | columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 26, column 1
[0m10:37:03.703089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5383324, "process_in_blocks": "0", "process_kernel_time": 0.19936, "process_mem_max_rss": "138870784", "process_out_blocks": "0", "process_user_time": 1.052887}
[0m10:37:03.703521 [debug] [MainThread]: Command `dbt run` failed at 10:37:03.703465 after 0.54 seconds
[0m10:37:03.703745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107504b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c829570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c829450>]}
[0m10:37:03.703949 [debug] [MainThread]: Flushing usage events
[0m10:37:04.250712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:38.334916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e8580>]}


============================== 10:49:38.338579 | 4d92e6d7-a4be-4c69-b109-99643017f31a ==============================
[0m10:49:38.338579 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:49:38.338912 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select staging', 'debug': 'False', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/Users/elham/.dbt', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'fail_fast': 'False'}
[0m10:49:38.546151 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:49:38.546486 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:49:38.546684 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:49:38.638539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d92e6d7-a4be-4c69-b109-99643017f31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b7d4e0>]}
[0m10:49:38.669009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d92e6d7-a4be-4c69-b109-99643017f31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e9120>]}
[0m10:49:38.669694 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:49:38.737496 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:49:38.790659 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading capstone_amazon_analytics: staging/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 | - accepted_values:
    24 | values: [1, 2, 3, 4, 5]
    25 | 
    26 | - name: stg_meta
    27 | description: "Cleaned product metadata from raw product information"
    28 | 
    29 | columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 26, column 1
[0m10:49:38.792516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5011926, "process_in_blocks": "0", "process_kernel_time": 0.195059, "process_mem_max_rss": "140591104", "process_out_blocks": "0", "process_user_time": 1.01923}
[0m10:49:38.792956 [debug] [MainThread]: Command `dbt run` failed at 10:49:38.792898 after 0.50 seconds
[0m10:49:38.793177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b5db0>]}
[0m10:49:38.793383 [debug] [MainThread]: Flushing usage events
[0m10:49:39.338901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:24.657765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e86d0>]}


============================== 10:52:24.661448 | 829ec8df-3a39-4b5c-b7a1-351f3c3dc6a3 ==============================
[0m10:52:24.661448 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:52:24.661779 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'empty': 'False', 'profiles_dir': '/Users/elham/.dbt', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False'}
[0m10:52:24.874224 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:52:24.874536 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:52:24.874730 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:52:24.967827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '829ec8df-3a39-4b5c-b7a1-351f3c3dc6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c188e0>]}
[0m10:52:24.998592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '829ec8df-3a39-4b5c-b7a1-351f3c3dc6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e2380>]}
[0m10:52:24.999131 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:52:25.069875 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:52:25.124004 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading capstone_amazon_analytics: staging/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 | - accepted_values:
    24 | values: [1, 2, 3, 4, 5]
    25 | 
    26 | - name: stg_meta
    27 | description: "Cleaned product metadata from raw product information"
    28 | 
    29 | columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 26, column 1
[0m10:52:25.126044 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5140824, "process_in_blocks": "0", "process_kernel_time": 0.189268, "process_mem_max_rss": "136134656", "process_out_blocks": "0", "process_user_time": 1.014026}
[0m10:52:25.126540 [debug] [MainThread]: Command `dbt run` failed at 10:52:25.126475 after 0.51 seconds
[0m10:52:25.126766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111029de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102a140>]}
[0m10:52:25.126988 [debug] [MainThread]: Flushing usage events
[0m10:52:25.671218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:09.276742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a50c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2c490>]}


============================== 10:54:09.280559 | 0d18a3b7-aae0-4ba1-b640-81ce931f5caf ==============================
[0m10:54:09.280559 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:54:09.280899 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'profiles_dir': '/Users/elham/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True'}
[0m10:54:09.347702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d18a3b7-aae0-4ba1-b640-81ce931f5caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a67070>]}
[0m10:54:09.360297 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12937734, "process_in_blocks": "0", "process_kernel_time": 0.088611, "process_mem_max_rss": "113213440", "process_out_blocks": "0", "process_user_time": 0.747706}
[0m10:54:09.360580 [debug] [MainThread]: Command `dbt clean` succeeded at 10:54:09.360525 after 0.13 seconds
[0m10:54:09.360768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a50c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c48730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020aef50>]}
[0m10:54:09.360966 [debug] [MainThread]: Flushing usage events
[0m10:54:09.883600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:16.090162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a904c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a90610>]}


============================== 10:54:16.093556 | b7425adf-9293-41db-8f02-973b5b9d7cf9 ==============================
[0m10:54:16.093556 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:54:16.093920 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m10:54:16.102259 [info ] [MainThread]: dbt version: 1.11.3
[0m10:54:16.102482 [info ] [MainThread]: python version: 3.10.19
[0m10:54:16.102645 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m10:54:16.102800 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m10:54:16.316191 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:54:16.316516 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:54:16.316690 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:54:16.347887 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m10:54:16.348150 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m10:54:16.348319 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m10:54:16.348643 [info ] [MainThread]: adapter type: snowflake
[0m10:54:16.348838 [info ] [MainThread]: adapter version: 1.11.1
[0m10:54:16.402394 [info ] [MainThread]: Configuration:
[0m10:54:16.402714 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:54:16.402886 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:54:16.403037 [info ] [MainThread]: Required dependencies:
[0m10:54:16.403228 [debug] [MainThread]: Executing "git --help"
[0m10:54:16.417348 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:54:16.417981 [debug] [MainThread]: STDERR: "b''"
[0m10:54:16.418212 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:54:16.418409 [info ] [MainThread]: Connection:
[0m10:54:16.418610 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m10:54:16.418879 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m10:54:16.419069 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m10:54:16.419222 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m10:54:16.419371 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m10:54:16.419516 [info ] [MainThread]:   schema: STAGE
[0m10:54:16.419658 [info ] [MainThread]:   authenticator: jwt
[0m10:54:16.419817 [info ] [MainThread]:   oauth_client_id: None
[0m10:54:16.419956 [info ] [MainThread]:   query_tag: None
[0m10:54:16.420094 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:54:16.420230 [info ] [MainThread]:   host: None
[0m10:54:16.420366 [info ] [MainThread]:   port: None
[0m10:54:16.420501 [info ] [MainThread]:   proxy_host: None
[0m10:54:16.420636 [info ] [MainThread]:   proxy_port: None
[0m10:54:16.420771 [info ] [MainThread]:   protocol: None
[0m10:54:16.420906 [info ] [MainThread]:   connect_retries: 1
[0m10:54:16.421039 [info ] [MainThread]:   connect_timeout: None
[0m10:54:16.421171 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:54:16.421313 [info ] [MainThread]:   retry_all: False
[0m10:54:16.421447 [info ] [MainThread]:   insecure_mode: False
[0m10:54:16.421579 [info ] [MainThread]:   reuse_connections: True
[0m10:54:16.421711 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:54:16.421847 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m10:54:16.422221 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:54:16.486859 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:54:16.514465 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:54:16.514812 [debug] [MainThread]: On debug: select 1 as id
[0m10:54:16.515017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:17.114964 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.600 seconds
[0m10:54:17.118295 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:54:17.118945 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:54:17.122928 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0730153, "process_in_blocks": "0", "process_kernel_time": 0.184966, "process_mem_max_rss": "151961600", "process_out_blocks": "0", "process_user_time": 1.133793}
[0m10:54:17.123461 [debug] [MainThread]: Command `dbt debug` succeeded at 10:54:17.123350 after 1.07 seconds
[0m10:54:17.123841 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:54:17.124150 [debug] [MainThread]: On debug: Close
[0m10:54:17.241845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109799ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109339660>]}
[0m10:54:17.242535 [debug] [MainThread]: Flushing usage events
[0m10:54:17.697642 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:34.318912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f94c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c550>]}


============================== 10:55:34.322741 | 096bad34-4477-4f2f-a327-f6f0fc62e2f5 ==============================
[0m10:55:34.322741 [info ] [MainThread]: Running with dbt=1.11.3
[0m10:55:34.323095 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'profiles_dir': '/Users/elham/.dbt', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80'}
[0m10:55:34.535663 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:55:34.535970 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:55:34.536152 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:55:34.628808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '096bad34-4477-4f2f-a327-f6f0fc62e2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5690>]}
[0m10:55:34.659375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '096bad34-4477-4f2f-a327-f6f0fc62e2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936020>]}
[0m10:55:34.659985 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:55:34.729470 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m10:55:34.730038 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:55:34.730279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '096bad34-4477-4f2f-a327-f6f0fc62e2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea8e80>]}
[0m10:55:34.733208 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading capstone_amazon_analytics: staging/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 | - accepted_values:
    24 | values: [1, 2, 3, 4, 5]
    25 | 
    26 | - name: stg_meta
    27 | description: "Cleaned product metadata from raw product information"
    28 | 
    29 | columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 26, column 1
[0m10:55:34.735035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4605042, "process_in_blocks": "0", "process_kernel_time": 0.183428, "process_mem_max_rss": "136413184", "process_out_blocks": "0", "process_user_time": 0.948315}
[0m10:55:34.735456 [debug] [MainThread]: Command `dbt run` failed at 10:55:34.735402 after 0.46 seconds
[0m10:55:34.735668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f94c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eba8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2c220>]}
[0m10:55:34.735857 [debug] [MainThread]: Flushing usage events
[0m10:55:35.259852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:28.352176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b4610>]}


============================== 11:00:28.356015 | 73c83f60-eb4b-40fa-93e5-6a891c4c6c6c ==============================
[0m11:00:28.356015 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:00:28.356391 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'invocation_command': 'dbt parse', 'write_json': 'True', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'empty': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m11:00:28.577761 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:00:28.578087 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:00:28.578271 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:00:28.673687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c83f60-eb4b-40fa-93e5-6a891c4c6c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8ba60>]}
[0m11:00:28.704592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73c83f60-eb4b-40fa-93e5-6a891c4c6c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4a470>]}
[0m11:00:28.705136 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:00:28.774587 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:00:28.775131 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:00:28.775373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73c83f60-eb4b-40fa-93e5-6a891c4c6c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff4c10>]}
[0m11:00:28.778339 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading capstone_amazon_analytics: staging/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 | - accepted_values:
    24 | values: [1, 2, 3, 4, 5]
    25 | 
    26 | - name: stg_meta
    27 | description: "Cleaned product metadata from raw product information"
    28 | 
    29 | columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 26, column 1
[0m11:00:28.780163 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.4707818, "process_in_blocks": "0", "process_kernel_time": 0.186804, "process_mem_max_rss": "136413184", "process_out_blocks": "0", "process_user_time": 0.961003}
[0m11:00:28.780606 [debug] [MainThread]: Command `dbt parse` failed at 11:00:28.780550 after 0.47 seconds
[0m11:00:28.780832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a000b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06c550>]}
[0m11:00:28.781032 [debug] [MainThread]: Flushing usage events
[0m11:00:29.292019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:19.736659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a98be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b743a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b744f0>]}


============================== 11:05:19.740337 | d5f35f2e-b258-4a97-b5ae-562c46171c4e ==============================
[0m11:05:19.740337 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:05:19.740669 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/elham/.dbt', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt parse', 'version_check': 'True'}
[0m11:05:19.961771 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:05:19.962114 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:05:19.962294 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:05:20.055517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5f35f2e-b258-4a97-b5ae-562c46171c4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105749240>]}
[0m11:05:20.086101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5f35f2e-b258-4a97-b5ae-562c46171c4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580a830>]}
[0m11:05:20.086654 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:05:20.155561 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:05:20.156051 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:05:20.156270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5f35f2e-b258-4a97-b5ae-562c46171c4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105993fd0>]}
[0m11:05:20.804589 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_reviews' in
package 'capstone_amazon_analytics' (models/staging/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m11:05:20.804954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5f35f2e-b258-4a97-b5ae-562c46171c4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb3a00>]}
[0m11:05:20.935896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5f35f2e-b258-4a97-b5ae-562c46171c4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afd150>]}
[0m11:05:20.938307 [info ] [MainThread]: Performance info: /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/perf_info.json
[0m11:05:20.992609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:05:20.994073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:05:20.994445 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:05:20.996518 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.3066349, "process_in_blocks": "0", "process_kernel_time": 0.210579, "process_mem_max_rss": "152272896", "process_out_blocks": "0", "process_user_time": 1.759476}
[0m11:05:20.996783 [debug] [MainThread]: Command `dbt parse` succeeded at 11:05:20.996733 after 1.31 seconds
[0m11:05:20.996990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a98be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9b790>]}
[0m11:05:20.997191 [debug] [MainThread]: Flushing usage events
[0m11:05:21.524562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:13.166684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ebe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ebd30>]}


============================== 11:17:13.171880 | e1bb6edc-4596-4c69-ae30-c0706f7ecb84 ==============================
[0m11:17:13.171880 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:17:13.172214 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/Users/elham/.dbt', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_format': 'default', 'introspect': 'True'}
[0m11:17:13.384930 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:17:13.385243 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:17:13.385428 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:17:13.477692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1bb6edc-4596-4c69-ae30-c0706f7ecb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036c0850>]}
[0m11:17:13.508970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1bb6edc-4596-4c69-ae30-c0706f7ecb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056db7c0>]}
[0m11:17:13.509758 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m11:17:13.578608 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m11:17:13.668149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:13.668430 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:17:13.668591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:13.696768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1bb6edc-4596-4c69-ae30-c0706f7ecb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107974130>]}
[0m11:17:13.708938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1bb6edc-4596-4c69-ae30-c0706f7ecb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107926620>]}
[0m11:17:13.709239 [info ] [MainThread]: Found 4 models, 15 data tests, 2 sources, 522 macros
[0m11:17:13.709431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1bb6edc-4596-4c69-ae30-c0706f7ecb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107926530>]}
[0m11:17:13.710499 [info ] [MainThread]: 
[0m11:17:13.710702 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:13.710856 [info ] [MainThread]: 
[0m11:17:13.711114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:17:13.713655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:17:13.713936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:17:13.755851 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:17:13.756191 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:17:13.756385 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m11:17:13.756575 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m11:17:13.756760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:13.756919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:14.749813 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.993 seconds
[0m11:17:15.431467 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.674 seconds
[0m11:17:15.437184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1bb6edc-4596-4c69-ae30-c0706f7ecb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107924070>]}
[0m11:17:15.441431 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:17:15.441892 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:17:15.442397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m11:17:15.442816 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m11:17:15.443183 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:17:15.443526 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:17:15.453508 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:17:15.456438 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:17:15.457582 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:17:15.458263 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:17:15.458615 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:17:15.459248 [debug] [Thread-5 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:17:15.459793 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:17:15.460111 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:17:15.460430 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:17:15.460891 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m11:17:15.461260 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:17:15.461836 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06'
[0m11:17:15.462220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m11:17:15.462571 [debug] [Thread-5 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:17:15.462905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m11:17:15.463234 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:17:15.463562 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:17:15.466404 [debug] [Thread-5 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:17:15.466757 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:17:15.476684 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:17:15.483994 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:17:15.487626 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:17:15.488436 [debug] [Thread-5 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:17:15.489012 [debug] [Thread-5 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:17:15.489353 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:17:15.489640 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:17:15.489929 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:17:15.490187 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:17:15.490649 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m11:17:15.491111 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:17:15.491535 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:17:15.491970 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:17:15.492226 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:17:15.492520 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:17:15.492818 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:17:15.493113 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:17:15.497173 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:17:15.497525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m11:17:15.497840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.dim_products)
[0m11:17:15.498127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m11:17:15.498439 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:17:15.498707 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:17:15.498936 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:17:15.499149 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:17:15.503362 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:17:15.505319 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:17:15.507902 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:17:15.508353 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:17:15.508893 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m11:17:15.509181 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:17:15.509457 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m11:17:15.509677 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:17:15.509906 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:17:15.510253 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:17:15.510466 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m11:17:15.510843 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:17:15.511208 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:17:15.511442 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m11:17:15.514040 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m11:17:15.514285 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m11:17:15.514598 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m11:17:15.514855 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c, now test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660)
[0m11:17:15.515122 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da)
[0m11:17:15.515361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250)
[0m11:17:15.515580 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m11:17:15.515764 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m11:17:15.515960 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m11:17:15.516149 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m11:17:15.518528 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m11:17:15.518901 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m11:17:15.562114 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m11:17:15.564329 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m11:17:15.564689 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m11:17:15.565176 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376, now test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0)
[0m11:17:15.565381 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m11:17:15.567461 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m11:17:15.567783 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m11:17:15.568112 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m11:17:15.568303 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m11:17:15.568491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250, now test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691)
[0m11:17:15.568667 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m11:17:15.570740 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m11:17:15.570967 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m11:17:15.571146 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m11:17:15.571320 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m11:17:15.571700 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m11:17:15.572079 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m11:17:15.572290 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m11:17:15.572591 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m11:17:15.572797 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m11:17:15.573005 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m11:17:15.573313 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m11:17:15.573497 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m11:17:15.573700 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660, now test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m11:17:15.573895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da, now test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7)
[0m11:17:15.574137 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0, now test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m11:17:15.574324 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m11:17:15.574502 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m11:17:15.574673 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m11:17:15.576799 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m11:17:15.581055 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m11:17:15.583964 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m11:17:15.584424 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m11:17:15.584614 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m11:17:15.584816 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m11:17:15.585140 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m11:17:15.585457 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m11:17:15.585755 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m11:17:15.586311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:15.586474 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691' was left open.
[0m11:17:15.586631 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691: Close
[0m11:17:15.729295 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7' was left open.
[0m11:17:15.729764 [debug] [MainThread]: On test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7: Close
[0m11:17:15.980721 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m11:17:15.981606 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m11:17:15.985366 [debug] [MainThread]: Command end result
[0m11:17:16.071135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:17:16.072730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:17:16.077401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m11:17:16.079721 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:17:16.080027 [info ] [MainThread]: Building catalog
[0m11:17:16.086830 [debug] [ThreadPool]: Acquiring new snowflake connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema'
[0m11:17:16.095357 [debug] [ThreadPool]: Using snowflake connection "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"
[0m11:17:16.095809 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"} */
[0m11:17:16.096139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:19.941573 [debug] [ThreadPool]: SQL status: SUCCESS 35 in 3.845 seconds
[0m11:17:19.976339 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/catalog.json
[0m11:17:20.001913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m11:17:20.003534 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m11:17:20.003792 [info ] [MainThread]: Catalog written to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/catalog.json
[0m11:17:20.006519 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.8836207, "process_in_blocks": "0", "process_kernel_time": 0.266747, "process_mem_max_rss": "157138944", "process_out_blocks": "0", "process_user_time": 1.928868}
[0m11:17:20.006921 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:17:20.006851 after 6.88 seconds
[0m11:17:20.007185 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:17:20.007371 [debug] [MainThread]: Connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema' was left open.
[0m11:17:20.007558 [debug] [MainThread]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: Close
[0m11:17:20.073688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056626e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9e380>]}
[0m11:17:20.074157 [debug] [MainThread]: Flushing usage events
[0m11:17:20.625903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:53.465425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107410400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107410550>]}


============================== 11:21:53.469312 | ca5734eb-bbe0-4757-8ed7-2f1de3c77757 ==============================
[0m11:21:53.469312 [info ] [MainThread]: Running with dbt=1.11.3
[0m11:21:53.469650 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt docs serve', 'profiles_dir': '/Users/elham/.dbt', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None'}
[0m11:21:53.684376 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:21:53.684687 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:21:53.684876 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:21:53.778526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca5734eb-bbe0-4757-8ed7-2f1de3c77757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106569690>]}
[0m11:21:53.809444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca5734eb-bbe0-4757-8ed7-2f1de3c77757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a1720>]}
[0m12:14:33.678577 [error] [MainThread]: Encountered an error:

[0m12:14:33.685390 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/miniconda3/envs/capstone-dbt/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:14:33.705438 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 3160.4236, "process_in_blocks": "0", "process_kernel_time": 0.388289, "process_mem_max_rss": "134201344", "process_out_blocks": "0", "process_user_time": 1.292073}
[0m12:14:33.707626 [debug] [MainThread]: Command `dbt docs serve` failed at 12:14:33.707459 after 3160.43 seconds
[0m12:14:33.708318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108313340>]}
[0m12:14:33.708727 [debug] [MainThread]: Flushing usage events
[0m12:14:34.222040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:39.053614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089183a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089184f0>]}


============================== 12:28:39.057200 | 9b848178-0fad-474c-8abf-2be3eb82d3a7 ==============================
[0m12:28:39.057200 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:28:39.057551 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs'}
[0m12:28:39.065503 [info ] [MainThread]: dbt version: 1.11.3
[0m12:28:39.065726 [info ] [MainThread]: python version: 3.10.19
[0m12:28:39.065891 [info ] [MainThread]: python path: /opt/miniconda3/envs/capstone-dbt/bin/python3.10
[0m12:28:39.066048 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m12:28:39.265632 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:28:39.265940 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:28:39.266117 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:28:39.296734 [info ] [MainThread]: Using profiles dir at /Users/elham/.dbt
[0m12:28:39.297010 [info ] [MainThread]: Using profiles.yml file at /Users/elham/.dbt/profiles.yml
[0m12:28:39.297179 [info ] [MainThread]: Using dbt_project.yml file at /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/dbt_project.yml
[0m12:28:39.297493 [info ] [MainThread]: adapter type: snowflake
[0m12:28:39.297655 [info ] [MainThread]: adapter version: 1.11.1
[0m12:28:39.351248 [info ] [MainThread]: Configuration:
[0m12:28:39.351566 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:28:39.351734 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:28:39.351884 [info ] [MainThread]: Required dependencies:
[0m12:28:39.352083 [debug] [MainThread]: Executing "git --help"
[0m12:28:39.366753 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:28:39.367411 [debug] [MainThread]: STDERR: "b''"
[0m12:28:39.367625 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:28:39.367819 [info ] [MainThread]: Connection:
[0m12:28:39.368026 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m12:28:39.368174 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m12:28:39.368314 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m12:28:39.368452 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m12:28:39.368587 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m12:28:39.368729 [info ] [MainThread]:   schema: STAGE
[0m12:28:39.368861 [info ] [MainThread]:   authenticator: jwt
[0m12:28:39.368994 [info ] [MainThread]:   oauth_client_id: None
[0m12:28:39.369127 [info ] [MainThread]:   query_tag: None
[0m12:28:39.369261 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:28:39.369392 [info ] [MainThread]:   host: None
[0m12:28:39.369523 [info ] [MainThread]:   port: None
[0m12:28:39.369655 [info ] [MainThread]:   proxy_host: None
[0m12:28:39.369785 [info ] [MainThread]:   proxy_port: None
[0m12:28:39.369916 [info ] [MainThread]:   protocol: None
[0m12:28:39.370047 [info ] [MainThread]:   connect_retries: 1
[0m12:28:39.370179 [info ] [MainThread]:   connect_timeout: None
[0m12:28:39.370312 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:28:39.370446 [info ] [MainThread]:   retry_all: False
[0m12:28:39.370578 [info ] [MainThread]:   insecure_mode: False
[0m12:28:39.370712 [info ] [MainThread]:   reuse_connections: True
[0m12:28:39.370841 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:28:39.370972 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:28:39.371415 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:28:39.438510 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:28:39.461555 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:28:39.461817 [debug] [MainThread]: On debug: select 1 as id
[0m12:28:39.461985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:39.892374 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.430 seconds
[0m12:28:39.893571 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:28:39.893995 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:28:39.898215 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8846687, "process_in_blocks": "0", "process_kernel_time": 0.177565, "process_mem_max_rss": "151109632", "process_out_blocks": "0", "process_user_time": 1.142263}
[0m12:28:39.898729 [debug] [MainThread]: Command `dbt debug` succeeded at 12:28:39.898620 after 0.89 seconds
[0m12:28:39.899093 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:28:39.899459 [debug] [MainThread]: On debug: Close
[0m12:28:39.995663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b74a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a37f0>]}
[0m12:28:39.996222 [debug] [MainThread]: Flushing usage events
[0m12:28:40.484696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:04.537561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f58bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090303a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090304f0>]}


============================== 12:29:04.541091 | 9868ec6c-3175-4aaa-aed6-7680fb72229d ==============================
[0m12:29:04.541091 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:29:04.541414 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/Users/elham/.dbt', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False'}
[0m12:29:04.743402 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:29:04.743723 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:29:04.743899 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:29:04.837165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107973bb0>]}
[0m12:29:04.867798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108962a70>]}
[0m12:29:04.868385 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:29:04.938841 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m12:29:05.030684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:05.031113 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:29:05.031285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:05.061208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a8130>]}
[0m12:29:05.116937 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:29:05.118625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:29:05.130720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12ae00>]}
[0m12:29:05.131092 [info ] [MainThread]: Found 4 models, 15 data tests, 2 sources, 522 macros
[0m12:29:05.131344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12a110>]}
[0m12:29:05.132269 [info ] [MainThread]: 
[0m12:29:05.132477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:05.132639 [info ] [MainThread]: 
[0m12:29:05.132923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:05.135511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m12:29:05.170012 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m12:29:05.170338 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m12:29:05.170517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:05.767371 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.597 seconds
[0m12:29:05.770458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m12:29:05.771022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m12:29:05.785188 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m12:29:05.787635 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m12:29:05.787989 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m12:29:05.788295 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m12:29:05.789415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:05.993768 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.205 seconds
[0m12:29:06.301626 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.512 seconds
[0m12:29:06.307154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3fa0>]}
[0m12:29:06.311954 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m12:29:06.312350 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m12:29:06.312925 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m12:29:06.313445 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m12:29:06.313868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m12:29:06.314272 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m12:29:06.314633 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m12:29:06.314964 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m12:29:06.323361 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m12:29:06.326246 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m12:29:06.327296 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m12:29:06.333367 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m12:29:06.395628 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m12:29:06.399083 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m12:29:06.400115 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m12:29:06.400351 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m12:29:06.400912 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m12:29:06.401253 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m12:29:06.744119 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m12:29:06.746105 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m12:29:06.775411 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ea710>]}
[0m12:29:06.775778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9868ec6c-3175-4aaa-aed6-7680fb72229d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108928e20>]}
[0m12:29:06.776454 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.46s]
[0m12:29:06.777123 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.46s]
[0m12:29:06.777681 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m12:29:06.778145 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m12:29:06.779225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:06.779549 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m12:29:06.779833 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m12:29:06.854165 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m12:29:06.854628 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m12:29:06.996172 [info ] [MainThread]: 
[0m12:29:07.002625 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m12:29:07.003582 [debug] [MainThread]: Command end result
[0m12:29:07.125728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:29:07.129202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:29:07.140023 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m12:29:07.140462 [info ] [MainThread]: 
[0m12:29:07.141308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:07.141856 [info ] [MainThread]: 
[0m12:29:07.142778 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:29:07.159844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6644068, "process_in_blocks": "0", "process_kernel_time": 0.24429, "process_mem_max_rss": "161136640", "process_out_blocks": "0", "process_user_time": 1.686598}
[0m12:29:07.161013 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:07.160749 after 2.67 seconds
[0m12:29:07.161586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f58bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b367040>]}
[0m12:29:07.165639 [debug] [MainThread]: Flushing usage events
[0m12:29:07.778912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:25.302859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126e8550>]}


============================== 12:29:25.306354 | a7359ecd-6613-4627-ba25-a5ff0887f77c ==============================
[0m12:29:25.306354 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:29:25.306678 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select marts', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'printer_width': '80', 'quiet': 'False', 'debug': 'False'}
[0m12:29:25.505149 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:29:25.505475 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:29:25.505651 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:29:25.595516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d41690>]}
[0m12:29:25.626085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db2020>]}
[0m12:29:25.626992 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:29:25.699730 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m12:29:25.787841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:25.788114 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:29:25.788271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:25.816363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114678130>]}
[0m12:29:25.869687 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:29:25.871030 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:29:25.882511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7ec50>]}
[0m12:29:25.882819 [info ] [MainThread]: Found 4 models, 15 data tests, 2 sources, 522 macros
[0m12:29:25.883020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7e020>]}
[0m12:29:25.883853 [info ] [MainThread]: 
[0m12:29:25.884068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:25.884231 [info ] [MainThread]: 
[0m12:29:25.884506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:25.886931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m12:29:25.915186 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m12:29:25.915469 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m12:29:25.915637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:26.428751 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.513 seconds
[0m12:29:26.431635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m12:29:26.432171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m12:29:26.446210 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m12:29:26.449273 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m12:29:26.449651 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m12:29:26.449972 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m12:29:26.451053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:26.650583 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.200 seconds
[0m12:29:26.826643 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.375 seconds
[0m12:29:26.832489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113906290>]}
[0m12:29:26.836200 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m12:29:26.836611 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m12:29:26.837185 [info ] [Thread-2 (]: 1 of 2 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m12:29:26.837686 [info ] [Thread-3 (]: 2 of 2 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m12:29:26.838149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m12:29:26.838556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m12:29:26.838936 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m12:29:26.839269 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m12:29:26.848109 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m12:29:26.850980 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m12:29:26.852015 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m12:29:26.852384 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m12:29:26.920617 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m12:29:26.922497 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m12:29:26.923322 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m12:29:26.923799 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m12:29:26.924036 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m12:29:26.924277 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m12:29:28.079142 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.154 seconds
[0m12:29:28.107863 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.183 seconds
[0m12:29:28.109726 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e46770>]}
[0m12:29:28.110064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7359ecd-6613-4627-ba25-a5ff0887f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f34fa0>]}
[0m12:29:28.110738 [info ] [Thread-2 (]: 1 of 2 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.27s]
[0m12:29:28.111365 [info ] [Thread-3 (]: 2 of 2 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.27s]
[0m12:29:28.111910 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m12:29:28.112372 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m12:29:28.113485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:28.113786 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was left open.
[0m12:29:28.114061 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_products: Close
[0m12:29:28.175670 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m12:29:28.176112 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m12:29:28.277606 [info ] [MainThread]: 
[0m12:29:28.278502 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m12:29:28.279794 [debug] [MainThread]: Command end result
[0m12:29:28.309972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:29:28.311784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:29:28.317560 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m12:29:28.317939 [info ] [MainThread]: 
[0m12:29:28.318294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:28.318575 [info ] [MainThread]: 
[0m12:29:28.318867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:29:28.321815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0603614, "process_in_blocks": "0", "process_kernel_time": 0.197454, "process_mem_max_rss": "161234944", "process_out_blocks": "0", "process_user_time": 1.666889}
[0m12:29:28.322245 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:28.322172 after 3.06 seconds
[0m12:29:28.322596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146b38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146bbc10>]}
[0m12:29:28.322946 [debug] [MainThread]: Flushing usage events
[0m12:29:28.771147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:46.382900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8c700>]}


============================== 12:29:46.385960 | fcdba78f-b82f-4dd9-bed3-c89aabc678a5 ==============================
[0m12:29:46.385960 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:29:46.386284 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt test', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m12:29:46.514376 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:29:46.514693 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:29:46.514874 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:29:46.604056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcdba78f-b82f-4dd9-bed3-c89aabc678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035cc850>]}
[0m12:29:46.634612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcdba78f-b82f-4dd9-bed3-c89aabc678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058594e0>]}
[0m12:29:46.635050 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:29:46.698538 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m12:29:46.770631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:46.770893 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:29:46.771045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:46.799386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcdba78f-b82f-4dd9-bed3-c89aabc678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f04130>]}
[0m12:29:46.854179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:29:46.855274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:29:46.867048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcdba78f-b82f-4dd9-bed3-c89aabc678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae6440>]}
[0m12:29:46.867360 [info ] [MainThread]: Found 4 models, 15 data tests, 2 sources, 522 macros
[0m12:29:46.867552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdba78f-b82f-4dd9-bed3-c89aabc678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587f5b0>]}
[0m12:29:46.868657 [info ] [MainThread]: 
[0m12:29:46.868851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:46.869004 [info ] [MainThread]: 
[0m12:29:46.869270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:46.871895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m12:29:46.872207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m12:29:46.901943 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m12:29:46.902293 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m12:29:46.902574 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m12:29:46.902764 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m12:29:46.902938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:46.903089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:47.575368 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.672 seconds
[0m12:29:47.666855 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.764 seconds
[0m12:29:47.671822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdba78f-b82f-4dd9-bed3-c89aabc678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a40190>]}
[0m12:29:47.675009 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:29:47.675458 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m12:29:47.675893 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:29:47.676249 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:29:47.676616 [info ] [Thread-2 (]: 1 of 15 START test accepted_values_fct_reviews_rating__1__2__3__4__5 ........... [RUN]
[0m12:29:47.677085 [info ] [Thread-3 (]: 2 of 15 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ........... [RUN]
[0m12:29:47.677497 [info ] [Thread-4 (]: 3 of 15 START test not_null_dim_products_product_id ............................ [RUN]
[0m12:29:47.677893 [info ] [Thread-5 (]: 4 of 15 START test not_null_fct_reviews_product_id ............................. [RUN]
[0m12:29:47.678331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660)
[0m12:29:47.678704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m12:29:47.679161 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1'
[0m12:29:47.679588 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da'
[0m12:29:47.679921 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:29:47.680247 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m12:29:47.680566 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:29:47.680873 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:29:47.697515 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m12:29:47.747319 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m12:29:47.752524 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m12:29:47.755005 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m12:29:47.756401 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m12:29:47.756648 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:29:47.768640 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m12:29:47.770333 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m12:29:47.770530 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:29:47.770719 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:29:47.772989 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m12:29:47.774592 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m12:29:47.775239 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m12:29:47.775735 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m12:29:47.776172 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m12:29:47.776403 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
[0m12:29:47.776673 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"} */
[0m12:29:47.777092 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m12:29:47.777307 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"} */
[0m12:29:47.777858 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m12:29:47.778237 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:29:47.778744 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:29:48.061169 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c25171-0306-11d0-0004-85da0003c57e
[0m12:29:48.061605 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'RATING'
[0m12:29:48.063282 [debug] [Thread-2 (]: Database Error in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql
[0m12:29:48.063754 [error] [Thread-2 (]: 1 of 15 ERROR accepted_values_fct_reviews_rating__1__2__3__4__5 ................ [[31mERROR[0m in 0.39s]
[0m12:29:48.064230 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:29:48.064543 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:29:48.064928 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql.
[0m12:29:48.065226 [info ] [Thread-2 (]: 5 of 15 START test not_null_fct_reviews_rating ................................. [RUN]
[0m12:29:48.066013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660, now test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250)
[0m12:29:48.066296 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:29:48.069701 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m12:29:48.070280 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:29:48.072543 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m12:29:48.073279 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m12:29:48.073572 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"} */
[0m12:29:48.128283 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c25171-0306-108b-0004-85da0003b71e
[0m12:29:48.128819 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 7
invalid identifier 'RATING'
[0m12:29:48.130122 [debug] [Thread-2 (]: Database Error in test not_null_fct_reviews_rating (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql
[0m12:29:48.130613 [error] [Thread-2 (]: 5 of 15 ERROR not_null_fct_reviews_rating ...................................... [[31mERROR[0m in 0.06s]
[0m12:29:48.131124 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:29:48.131483 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:29:48.131825 [info ] [Thread-2 (]: 6 of 15 START test not_null_fct_reviews_review_id .............................. [RUN]
[0m12:29:48.132219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250, now test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0)
[0m12:29:48.132533 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:29:48.132907 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_reviews_rating (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql.
[0m12:29:48.136737 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m12:29:48.137679 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:29:48.141270 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m12:29:48.142134 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m12:29:48.142420 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"} */
[0m12:29:48.254612 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c25171-0306-10cf-0004-85da0003d14e
[0m12:29:48.255201 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 7
invalid identifier 'REVIEW_ID'
[0m12:29:48.256701 [debug] [Thread-2 (]: Database Error in test not_null_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql
[0m12:29:48.257262 [error] [Thread-2 (]: 6 of 15 ERROR not_null_fct_reviews_review_id ................................... [[31mERROR[0m in 0.12s]
[0m12:29:48.257810 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:29:48.258185 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m12:29:48.258627 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql.
[0m12:29:48.259020 [info ] [Thread-2 (]: 7 of 15 START test not_null_stg_meta_product_id ................................ [RUN]
[0m12:29:48.259527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m12:29:48.259871 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m12:29:48.264250 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m12:29:48.264971 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m12:29:48.267953 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m12:29:48.268904 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m12:29:48.269263 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
[0m12:29:48.324245 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m12:29:48.334226 [info ] [Thread-3 (]: 2 of 15 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 ................. [[32mPASS[0m in 0.66s]
[0m12:29:48.334852 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m12:29:48.335244 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m12:29:48.335663 [info ] [Thread-3 (]: 8 of 15 START test not_null_stg_reviews_product_id ............................. [RUN]
[0m12:29:48.336111 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m12:29:48.336467 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m12:29:48.340656 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m12:29:48.341518 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m12:29:48.344439 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m12:29:48.345662 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m12:29:48.348076 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m12:29:48.347429 [info ] [Thread-4 (]: 3 of 15 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.67s]
[0m12:29:48.348566 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
[0m12:29:48.349080 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:29:48.349697 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m12:29:48.350334 [info ] [Thread-4 (]: 9 of 15 START test not_null_stg_reviews_rating ................................. [RUN]
[0m12:29:48.351062 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m12:29:48.351458 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m12:29:48.356450 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m12:29:48.357268 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m12:29:48.360070 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m12:29:48.361026 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m12:29:48.361408 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
[0m12:29:48.448017 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m12:29:48.450107 [info ] [Thread-5 (]: 4 of 15 PASS not_null_fct_reviews_product_id ................................... [[32mPASS[0m in 0.77s]
[0m12:29:48.450663 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:29:48.451039 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m12:29:48.451482 [info ] [Thread-5 (]: 10 of 15 START test not_null_stg_reviews_review_id ............................. [RUN]
[0m12:29:48.451958 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m12:29:48.452347 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m12:29:48.456899 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m12:29:48.457586 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m12:29:48.460355 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m12:29:48.461278 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m12:29:48.461638 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
[0m12:29:48.623548 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m12:29:48.628202 [info ] [Thread-2 (]: 7 of 15 PASS not_null_stg_meta_product_id ...................................... [[32mPASS[0m in 0.37s]
[0m12:29:48.629050 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m12:29:48.629743 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:29:48.630367 [info ] [Thread-2 (]: 11 of 15 START test relationships_fct_reviews_product_id__product_id__ref_dim_products_  [RUN]
[0m12:29:48.630866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7)
[0m12:29:48.631256 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:29:48.639820 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m12:29:48.640707 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:29:48.643637 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m12:29:48.645009 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m12:29:48.647023 [info ] [Thread-5 (]: 10 of 15 PASS not_null_stg_reviews_review_id ................................... [[32mPASS[0m in 0.20s]
[0m12:29:48.648071 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m12:29:48.648595 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m12:29:48.649025 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    where product_id is not null
),

parent as (
    select product_id as to_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"} */
[0m12:29:48.649452 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:29:48.650147 [info ] [Thread-5 (]: 12 of 15 START test unique_dim_products_product_id ............................. [RUN]
[0m12:29:48.650821 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m12:29:48.651294 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:29:48.659040 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m12:29:48.660204 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:29:48.662849 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m12:29:48.663885 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m12:29:48.664198 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m12:29:48.704458 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m12:29:48.706524 [info ] [Thread-4 (]: 9 of 15 PASS not_null_stg_reviews_rating ....................................... [[32mPASS[0m in 0.36s]
[0m12:29:48.707073 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m12:29:48.707434 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:29:48.707858 [info ] [Thread-4 (]: 13 of 15 START test unique_fct_reviews_review_id ............................... [RUN]
[0m12:29:48.708316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691)
[0m12:29:48.708675 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:29:48.712888 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m12:29:48.713551 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:29:48.716277 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m12:29:48.717348 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m12:29:48.717739 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"} */
[0m12:29:48.826053 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c25171-0306-11d0-0004-85da0003c58a
[0m12:29:48.827070 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'REVIEW_ID'
[0m12:29:48.829085 [debug] [Thread-4 (]: Database Error in test unique_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql
[0m12:29:48.829696 [error] [Thread-4 (]: 13 of 15 ERROR unique_fct_reviews_review_id .................................... [[31mERROR[0m in 0.12s]
[0m12:29:48.830230 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:29:48.830605 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m12:29:48.831055 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691' to be skipped because of status 'error'.  Reason: Database Error in test unique_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql.
[0m12:29:48.831445 [info ] [Thread-4 (]: 14 of 15 START test unique_stg_meta_product_id ................................. [RUN]
[0m12:29:48.831971 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m12:29:48.832318 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m12:29:48.836633 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m12:29:48.837358 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m12:29:48.840183 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m12:29:48.841201 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m12:29:48.841560 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
[0m12:29:48.902376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m12:29:48.906208 [info ] [Thread-2 (]: 11 of 15 PASS relationships_fct_reviews_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.28s]
[0m12:29:48.906937 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:29:48.907366 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m12:29:48.907767 [info ] [Thread-2 (]: 15 of 15 START test unique_stg_reviews_review_id ............................... [RUN]
[0m12:29:48.908138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m12:29:48.908427 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m12:29:48.913686 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m12:29:48.914412 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m12:29:48.917226 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m12:29:48.918289 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m12:29:48.918675 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
[0m12:29:49.008565 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m12:29:49.013073 [info ] [Thread-3 (]: 8 of 15 PASS not_null_stg_reviews_product_id ................................... [[32mPASS[0m in 0.68s]
[0m12:29:49.013734 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m12:29:49.041898 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m12:29:49.045046 [info ] [Thread-2 (]: 15 of 15 PASS unique_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.14s]
[0m12:29:49.045672 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m12:29:49.101855 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m12:29:49.106755 [info ] [Thread-5 (]: 12 of 15 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.46s]
[0m12:29:49.108006 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:29:49.108918 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m12:29:49.110923 [info ] [Thread-4 (]: 14 of 15 PASS unique_stg_meta_product_id ....................................... [[32mPASS[0m in 0.28s]
[0m12:29:49.111471 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m12:29:49.112692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:49.113002 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was left open.
[0m12:29:49.113280 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m12:29:49.208351 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was left open.
[0m12:29:49.209759 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m12:29:49.359195 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was left open.
[0m12:29:49.360561 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m12:29:49.480723 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m12:29:49.481911 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:29:49.584797 [info ] [MainThread]: 
[0m12:29:49.585271 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m12:29:49.587706 [debug] [MainThread]: Command end result
[0m12:29:49.620004 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:29:49.621904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:29:49.629127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m12:29:49.629441 [info ] [MainThread]: 
[0m12:29:49.629764 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:29:49.630027 [info ] [MainThread]: 
[0m12:29:49.630348 [error] [MainThread]: [31mFailure in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)[0m
[0m12:29:49.630673 [error] [MainThread]:   Database Error in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql
[0m12:29:49.630912 [info ] [MainThread]: 
[0m12:29:49.631189 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql
[0m12:29:49.631422 [info ] [MainThread]: 
[0m12:29:49.631703 [error] [MainThread]: [31mFailure in test not_null_fct_reviews_rating (models/marts/schema.yml)[0m
[0m12:29:49.631992 [error] [MainThread]:   Database Error in test not_null_fct_reviews_rating (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql
[0m12:29:49.632218 [info ] [MainThread]: 
[0m12:29:49.632492 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql
[0m12:29:49.632811 [info ] [MainThread]: 
[0m12:29:49.633157 [error] [MainThread]: [31mFailure in test not_null_fct_reviews_review_id (models/marts/schema.yml)[0m
[0m12:29:49.633461 [error] [MainThread]:   Database Error in test not_null_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql
[0m12:29:49.633700 [info ] [MainThread]: 
[0m12:29:49.633970 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql
[0m12:29:49.634199 [info ] [MainThread]: 
[0m12:29:49.634473 [error] [MainThread]: [31mFailure in test unique_fct_reviews_review_id (models/marts/schema.yml)[0m
[0m12:29:49.634752 [error] [MainThread]:   Database Error in test unique_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql
[0m12:29:49.634975 [info ] [MainThread]: 
[0m12:29:49.635237 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql
[0m12:29:49.635472 [info ] [MainThread]: 
[0m12:29:49.635719 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=15
[0m12:29:49.638328 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.2929766, "process_in_blocks": "0", "process_kernel_time": 0.191136, "process_mem_max_rss": "168656896", "process_out_blocks": "0", "process_user_time": 2.160451}
[0m12:29:49.638796 [debug] [MainThread]: Command `dbt test` failed at 12:29:49.638722 after 3.29 seconds
[0m12:29:49.639114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058594e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744b700>]}
[0m12:29:49.639418 [debug] [MainThread]: Flushing usage events
[0m12:29:50.125759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:03.483584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a05e0>]}


============================== 12:58:03.487367 | 2742e437-aaf4-411f-87ee-5a99c7ead3cc ==============================
[0m12:58:03.487367 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:58:03.487718 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt test --select marts', 'write_json': 'True', 'empty': 'None', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m12:58:03.700509 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:58:03.700830 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:58:03.701006 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:58:03.798784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2742e437-aaf4-411f-87ee-5a99c7ead3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e0310>]}
[0m12:58:03.829421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2742e437-aaf4-411f-87ee-5a99c7ead3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108068a30>]}
[0m12:58:03.830103 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m12:58:03.900637 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m12:58:03.990478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:03.990743 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:58:03.990898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:04.018936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2742e437-aaf4-411f-87ee-5a99c7ead3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a18130>]}
[0m12:58:04.073274 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:58:04.074895 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:58:04.092882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2742e437-aaf4-411f-87ee-5a99c7ead3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099969b0>]}
[0m12:58:04.093219 [info ] [MainThread]: Found 4 models, 15 data tests, 2 sources, 522 macros
[0m12:58:04.093420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2742e437-aaf4-411f-87ee-5a99c7ead3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099970d0>]}
[0m12:58:04.094343 [info ] [MainThread]: 
[0m12:58:04.094536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:58:04.094691 [info ] [MainThread]: 
[0m12:58:04.094956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:04.097547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m12:58:04.097815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m12:58:04.135628 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m12:58:04.135978 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m12:58:04.136167 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m12:58:04.136356 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m12:58:04.136536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:04.136704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:05.084303 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.947 seconds
[0m12:58:05.085398 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.949 seconds
[0m12:58:05.091004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2742e437-aaf4-411f-87ee-5a99c7ead3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109996560>]}
[0m12:58:05.094359 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:58:05.094765 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:58:05.095152 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:58:05.095518 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:58:05.095907 [info ] [Thread-2 (]: 1 of 8 START test accepted_values_fct_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m12:58:05.096330 [info ] [Thread-3 (]: 2 of 8 START test not_null_dim_products_product_id ............................. [RUN]
[0m12:58:05.096768 [info ] [Thread-4 (]: 3 of 8 START test not_null_fct_reviews_product_id .............................. [RUN]
[0m12:58:05.097163 [info ] [Thread-5 (]: 4 of 8 START test not_null_fct_reviews_rating .................................. [RUN]
[0m12:58:05.097603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660)
[0m12:58:05.097973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m12:58:05.098396 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da'
[0m12:58:05.098789 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250'
[0m12:58:05.099154 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:58:05.099485 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:58:05.099812 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:58:05.100164 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:58:05.116066 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m12:58:05.124987 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:05.171556 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m12:58:05.173917 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m12:58:05.175275 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:58:05.175501 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:58:05.175730 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:58:05.181845 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:58:05.187947 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m12:58:05.189557 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m12:58:05.191117 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:05.193055 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m12:58:05.193683 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"
[0m12:58:05.194009 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250"} */
[0m12:58:05.194237 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:58:05.194690 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"
[0m12:58:05.261899 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660"} */
[0m12:58:05.263036 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:05.263262 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m12:58:05.264359 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m12:58:05.264570 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"} */
[0m12:58:05.264759 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:58:05.399676 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2518e-0306-10cf-0004-85da0003d196
[0m12:58:05.399992 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'RATING'
[0m12:58:05.401201 [debug] [Thread-2 (]: Database Error in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql
[0m12:58:05.401528 [error] [Thread-2 (]: 1 of 8 ERROR accepted_values_fct_reviews_rating__1__2__3__4__5 ................. [[31mERROR[0m in 0.30s]
[0m12:58:05.401870 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660
[0m12:58:05.402108 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:58:05.402399 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql.
[0m12:58:05.402652 [info ] [Thread-2 (]: 5 of 8 START test not_null_fct_reviews_review_id ............................... [RUN]
[0m12:58:05.403272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_fct_reviews_rating__1__2__3__4__5.d9d2f5d660, now test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0)
[0m12:58:05.403483 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:58:05.406231 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m12:58:05.406808 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:58:05.408436 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m12:58:05.409025 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"
[0m12:58:05.409238 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0"} */
[0m12:58:05.416942 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m12:58:05.422096 [info ] [Thread-3 (]: 2 of 8 PASS not_null_dim_products_product_id ................................... [[32mPASS[0m in 0.32s]
[0m12:58:05.422483 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m12:58:05.422731 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:58:05.423020 [info ] [Thread-3 (]: 6 of 8 START test relationships_fct_reviews_product_id__product_id__ref_dim_products_  [RUN]
[0m12:58:05.423316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1, now test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7)
[0m12:58:05.423554 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:58:05.428561 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m12:58:05.429270 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:58:05.430917 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m12:58:05.431630 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m12:58:05.431859 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    where product_id is not null
),

parent as (
    select product_id as to_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"} */
[0m12:58:05.516482 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m12:58:05.518466 [info ] [Thread-3 (]: 6 of 8 PASS relationships_fct_reviews_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.10s]
[0m12:58:05.519000 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m12:58:05.519293 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:58:05.519485 [info ] [Thread-3 (]: 7 of 8 START test unique_dim_products_product_id ............................... [RUN]
[0m12:58:05.519709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7, now test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m12:58:05.519893 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:58:05.523603 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:05.524391 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:58:05.526162 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:05.527015 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:05.527318 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m12:58:05.579314 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2518e-0306-108b-0004-85da0003b75e
[0m12:58:05.579817 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 7
invalid identifier 'REVIEW_ID'
[0m12:58:05.581091 [debug] [Thread-2 (]: Database Error in test not_null_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql
[0m12:58:05.581579 [error] [Thread-2 (]: 5 of 8 ERROR not_null_fct_reviews_review_id .................................... [[31mERROR[0m in 0.18s]
[0m12:58:05.582206 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0
[0m12:58:05.582605 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:58:05.582930 [info ] [Thread-2 (]: 8 of 8 START test unique_fct_reviews_review_id ................................. [RUN]
[0m12:58:05.583326 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql.
[0m12:58:05.583669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_review_id.17322b24f0, now test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691)
[0m12:58:05.584061 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:58:05.588147 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m12:58:05.590659 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:58:05.593378 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m12:58:05.594709 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"
[0m12:58:05.595044 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691"} */
[0m12:58:05.641405 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m12:58:05.643289 [info ] [Thread-3 (]: 7 of 8 PASS unique_dim_products_product_id ..................................... [[32mPASS[0m in 0.12s]
[0m12:58:05.643788 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m12:58:05.657654 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01c2518e-0306-09f2-0004-85da0003a72a
[0m12:58:05.658020 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 7
invalid identifier 'RATING'
[0m12:58:05.659290 [debug] [Thread-5 (]: Database Error in test not_null_fct_reviews_rating (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql
[0m12:58:05.659851 [error] [Thread-5 (]: 4 of 8 ERROR not_null_fct_reviews_rating ....................................... [[31mERROR[0m in 0.56s]
[0m12:58:05.660456 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250
[0m12:58:05.660922 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_reviews_rating (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql.
[0m12:58:05.688685 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2518e-0306-11d0-0004-85da0003c5c2
[0m12:58:05.689223 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'REVIEW_ID'
[0m12:58:05.690534 [debug] [Thread-2 (]: Database Error in test unique_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql
[0m12:58:05.691040 [error] [Thread-2 (]: 8 of 8 ERROR unique_fct_reviews_review_id ...................................... [[31mERROR[0m in 0.11s]
[0m12:58:05.691689 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691
[0m12:58:05.692326 [debug] [Thread-8 (]: Marking all children of 'test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691' to be skipped because of status 'error'.  Reason: Database Error in test unique_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql.
[0m12:58:05.779747 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m12:58:05.783372 [info ] [Thread-4 (]: 3 of 8 PASS not_null_fct_reviews_product_id .................................... [[32mPASS[0m in 0.68s]
[0m12:58:05.784134 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m12:58:05.785393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:05.785761 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691' was left open.
[0m12:58:05.786085 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_fct_reviews_review_id.f2accb4691: Close
[0m12:58:05.880041 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m12:58:05.881141 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:58:05.943850 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da' was left open.
[0m12:58:05.944882 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da: Close
[0m12:58:06.016373 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250' was left open.
[0m12:58:06.016910 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_fct_reviews_rating.e93f16e250: Close
[0m12:58:06.105447 [info ] [MainThread]: 
[0m12:58:06.106684 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m12:58:06.109848 [debug] [MainThread]: Command end result
[0m12:58:06.141376 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m12:58:06.143128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m12:58:06.150609 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m12:58:06.150970 [info ] [MainThread]: 
[0m12:58:06.151334 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:58:06.151612 [info ] [MainThread]: 
[0m12:58:06.151940 [error] [MainThread]: [31mFailure in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)[0m
[0m12:58:06.152276 [error] [MainThread]:   Database Error in test accepted_values_fct_reviews_rating__1__2__3__4__5 (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql
[0m12:58:06.152593 [info ] [MainThread]: 
[0m12:58:06.152938 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/accepted_values_fct_reviews_rating__1__2__3__4__5.sql
[0m12:58:06.153208 [info ] [MainThread]: 
[0m12:58:06.153505 [error] [MainThread]: [31mFailure in test not_null_fct_reviews_review_id (models/marts/schema.yml)[0m
[0m12:58:06.153816 [error] [MainThread]:   Database Error in test not_null_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql
[0m12:58:06.154069 [info ] [MainThread]: 
[0m12:58:06.154352 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_review_id.sql
[0m12:58:06.154592 [info ] [MainThread]: 
[0m12:58:06.154871 [error] [MainThread]: [31mFailure in test not_null_fct_reviews_rating (models/marts/schema.yml)[0m
[0m12:58:06.155155 [error] [MainThread]:   Database Error in test not_null_fct_reviews_rating (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'RATING'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql
[0m12:58:06.155382 [info ] [MainThread]: 
[0m12:58:06.155640 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/not_null_fct_reviews_rating.sql
[0m12:58:06.155865 [info ] [MainThread]: 
[0m12:58:06.156137 [error] [MainThread]: [31mFailure in test unique_fct_reviews_review_id (models/marts/schema.yml)[0m
[0m12:58:06.156414 [error] [MainThread]:   Database Error in test unique_fct_reviews_review_id (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql
[0m12:58:06.156640 [info ] [MainThread]: 
[0m12:58:06.156899 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/marts/schema.yml/unique_fct_reviews_review_id.sql
[0m12:58:06.157125 [info ] [MainThread]: 
[0m12:58:06.157381 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=8
[0m12:58:06.160182 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.723027, "process_in_blocks": "0", "process_kernel_time": 0.266919, "process_mem_max_rss": "168034304", "process_out_blocks": "0", "process_user_time": 2.04187}
[0m12:58:06.160550 [debug] [MainThread]: Command `dbt test` failed at 12:58:06.160485 after 2.72 seconds
[0m12:58:06.160857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093981f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797b580>]}
[0m12:58:06.161165 [debug] [MainThread]: Flushing usage events
[0m12:58:06.680265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:04.044195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c0820>]}


============================== 13:27:04.047710 | 788fbced-555d-4e96-83b8-cefe01deccc5 ==============================
[0m13:27:04.047710 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:27:04.048028 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'profiles_dir': '/Users/elham/.dbt', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --select marts', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default'}
[0m13:27:04.265560 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:27:04.265879 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:27:04.266060 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:27:04.359506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106646ef0>]}
[0m13:27:04.390035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904d240>]}
[0m13:27:04.390557 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m13:27:04.460179 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m13:27:04.551829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:04.552298 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/schema.yml
[0m13:27:04.722185 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_reviews' in
package 'capstone_amazon_analytics' (models/marts/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m13:27:04.722561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ca350>]}
[0m13:27:04.777078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5de410>]}
[0m13:27:04.868169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m13:27:04.869673 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m13:27:04.887377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d81f0>]}
[0m13:27:04.887710 [info ] [MainThread]: Found 4 models, 13 data tests, 2 sources, 522 macros
[0m13:27:04.887903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108261ba0>]}
[0m13:27:04.888741 [info ] [MainThread]: 
[0m13:27:04.888937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:04.889092 [info ] [MainThread]: 
[0m13:27:04.889371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:27:04.892080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m13:27:04.892384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m13:27:04.931976 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m13:27:04.932323 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m13:27:04.932508 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m13:27:04.932698 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m13:27:04.932869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:04.933024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:05.726690 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.794 seconds
[0m13:27:05.757920 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.825 seconds
[0m13:27:05.762453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '788fbced-555d-4e96-83b8-cefe01deccc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d9750>]}
[0m13:27:05.766388 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m13:27:05.766805 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m13:27:05.767186 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m13:27:05.767551 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m13:27:05.767906 [info ] [Thread-2 (]: 1 of 6 START test not_null_dim_products_product_id ............................. [RUN]
[0m13:27:05.768327 [info ] [Thread-3 (]: 2 of 6 START test not_null_fct_reviews_avg_rating .............................. [RUN]
[0m13:27:05.768702 [info ] [Thread-4 (]: 3 of 6 START test not_null_fct_reviews_product_id .............................. [RUN]
[0m13:27:05.769061 [info ] [Thread-5 (]: 4 of 6 START test not_null_fct_reviews_review_count ............................ [RUN]
[0m13:27:05.769476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m13:27:05.769848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d)
[0m13:27:05.770281 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da'
[0m13:27:05.770906 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71'
[0m13:27:05.771338 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m13:27:05.771691 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m13:27:05.772024 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m13:27:05.772342 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m13:27:05.785319 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m13:27:05.789415 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m13:27:05.794552 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m13:27:05.798505 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m13:27:05.799551 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m13:27:05.799869 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m13:27:05.800201 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m13:27:05.800515 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m13:27:05.819209 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m13:27:05.821624 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m13:27:05.823720 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m13:27:05.826351 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m13:27:05.827333 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m13:27:05.827906 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m13:27:05.828179 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where avg_rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"} */
[0m13:27:05.828669 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m13:27:05.829126 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m13:27:05.829382 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_count
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where review_count is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"} */
[0m13:27:05.829871 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m13:27:05.830350 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"} */
[0m13:27:05.830836 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:27:05.831392 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:27:06.031453 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m13:27:06.039785 [info ] [Thread-2 (]: 1 of 6 PASS not_null_dim_products_product_id ................................... [[32mPASS[0m in 0.27s]
[0m13:27:06.040157 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m13:27:06.040389 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m13:27:06.040647 [info ] [Thread-2 (]: 5 of 6 START test relationships_fct_reviews_product_id__product_id__ref_dim_products_  [RUN]
[0m13:27:06.040925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1, now test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7)
[0m13:27:06.041140 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m13:27:06.044283 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m13:27:06.044998 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m13:27:06.046566 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m13:27:06.047470 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m13:27:06.047699 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    where product_id is not null
),

parent as (
    select product_id as to_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"} */
[0m13:27:06.184596 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m13:27:06.187064 [info ] [Thread-2 (]: 5 of 6 PASS relationships_fct_reviews_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.15s]
[0m13:27:06.187664 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m13:27:06.188041 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m13:27:06.188467 [info ] [Thread-2 (]: 6 of 6 START test unique_dim_products_product_id ............................... [RUN]
[0m13:27:06.188912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7, now test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m13:27:06.189291 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m13:27:06.195733 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m13:27:06.196820 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m13:27:06.199671 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m13:27:06.200711 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m13:27:06.201120 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m13:27:06.296818 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m13:27:06.299753 [info ] [Thread-4 (]: 3 of 6 PASS not_null_fct_reviews_product_id .................................... [[32mPASS[0m in 0.53s]
[0m13:27:06.300349 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m13:27:06.323667 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m13:27:06.326589 [info ] [Thread-2 (]: 6 of 6 PASS unique_dim_products_product_id ..................................... [[32mPASS[0m in 0.14s]
[0m13:27:06.327198 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m13:27:06.498624 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m13:27:06.500921 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m13:27:06.503451 [info ] [Thread-3 (]: 2 of 6 PASS not_null_fct_reviews_avg_rating .................................... [[32mPASS[0m in 0.73s]
[0m13:27:06.505245 [info ] [Thread-5 (]: 4 of 6 PASS not_null_fct_reviews_review_count .................................. [[32mPASS[0m in 0.73s]
[0m13:27:06.505812 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m13:27:06.506291 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m13:27:06.507589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:06.507952 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m13:27:06.508255 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:27:06.580708 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d' was left open.
[0m13:27:06.581284 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d: Close
[0m13:27:06.656890 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da' was left open.
[0m13:27:06.658334 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da: Close
[0m13:27:06.732143 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71' was left open.
[0m13:27:06.733388 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71: Close
[0m13:27:06.809128 [info ] [MainThread]: 
[0m13:27:06.810289 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m13:27:06.811849 [debug] [MainThread]: Command end result
[0m13:27:06.843802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m13:27:06.845216 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m13:27:06.852293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m13:27:06.852666 [info ] [MainThread]: 
[0m13:27:06.853028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:06.853313 [info ] [MainThread]: 
[0m13:27:06.853607 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:27:06.854088 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:27:06.857010 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8556526, "process_in_blocks": "0", "process_kernel_time": 0.255254, "process_mem_max_rss": "171130880", "process_out_blocks": "0", "process_user_time": 2.190554}
[0m13:27:06.857377 [debug] [MainThread]: Command `dbt test` succeeded at 13:27:06.857311 after 2.86 seconds
[0m13:27:06.857683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c56b4f0>]}
[0m13:27:06.857991 [debug] [MainThread]: Flushing usage events
[0m13:27:07.388978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:03:36.673978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e8550>]}


============================== 07:03:36.677577 | 913097e1-7c9b-4de2-b8e2-9f4c9061033d ==============================
[0m07:03:36.677577 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:03:36.677913 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/elham/.dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False'}
[0m07:03:36.915349 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:03:36.915683 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:03:36.915872 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:03:37.009567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110141690>]}
[0m07:03:37.040151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b2020>]}
[0m07:03:37.040697 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:03:37.110876 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:03:37.203380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 2 files changed.
[0m07:03:37.203735 [debug] [MainThread]: Partial parsing: added file: capstone_amazon_analytics://models/marts/dim_date.sql
[0m07:03:37.203920 [debug] [MainThread]: Partial parsing: added file: capstone_amazon_analytics://models/marts/mart_product_kpi.sql
[0m07:03:37.204087 [debug] [MainThread]: Partial parsing: added file: capstone_amazon_analytics://models/marts/fct_reviews_granular.sql
[0m07:03:37.204297 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m07:03:37.204518 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m07:03:37.385208 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_reviews' in
package 'capstone_amazon_analytics' (models/staging/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m07:03:37.385606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113db0d60>]}
[0m07:03:37.439237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e74130>]}
[0m07:03:37.531889 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:03:37.533431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:03:37.546573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cf0b20>]}
[0m07:03:37.546889 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:03:37.547083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c5ed70>]}
[0m07:03:37.547889 [info ] [MainThread]: 
[0m07:03:37.548076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:03:37.548234 [info ] [MainThread]: 
[0m07:03:37.548501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:03:37.550972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:03:37.584889 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:03:37.585182 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:03:37.585353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:03:38.422061 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.836 seconds
[0m07:03:38.426271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m07:03:38.426956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:03:38.439987 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:03:38.442507 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:03:38.442878 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:03:38.443200 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:03:38.444488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:03:38.682544 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.239 seconds
[0m07:03:38.936136 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.491 seconds
[0m07:03:38.941123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106959f30>]}
[0m07:03:38.944758 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m07:03:38.945393 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m07:03:38.946066 [info ] [Thread-2 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m07:03:38.946605 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m07:03:38.947053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m07:03:38.947417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m07:03:38.947767 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m07:03:38.948083 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m07:03:38.956899 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m07:03:38.959739 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:03:38.960846 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m07:03:38.961225 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m07:03:38.993978 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m07:03:38.995877 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:03:38.997348 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m07:03:38.998060 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m07:03:38.998377 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m07:03:38.998700 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m07:03:39.376401 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.377 seconds
[0m07:03:39.405808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612a770>]}
[0m07:03:39.406647 [info ] [Thread-2 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.46s]
[0m07:03:39.407223 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m07:03:39.635510 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m07:03:39.640367 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '913097e1-7c9b-4de2-b8e2-9f4c9061033d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a593c0>]}
[0m07:03:39.641089 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.69s]
[0m07:03:39.641630 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m07:03:39.642728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:03:39.643028 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was left open.
[0m07:03:39.643316 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_meta: Close
[0m07:03:39.721845 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was left open.
[0m07:03:39.722706 [debug] [MainThread]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m07:03:39.816340 [info ] [MainThread]: 
[0m07:03:39.817496 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m07:03:39.819030 [debug] [MainThread]: Command end result
[0m07:03:39.851533 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:03:39.853259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:03:39.859630 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:03:39.859983 [info ] [MainThread]: 
[0m07:03:39.860341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:03:39.860621 [info ] [MainThread]: 
[0m07:03:39.860913 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m07:03:39.861396 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m07:03:39.873286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2447317, "process_in_blocks": "0", "process_kernel_time": 0.262635, "process_mem_max_rss": "165511168", "process_out_blocks": "0", "process_user_time": 1.929129}
[0m07:03:39.873736 [debug] [MainThread]: Command `dbt run` succeeded at 07:03:39.873654 after 3.25 seconds
[0m07:03:39.874004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101721a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117139c90>]}
[0m07:03:39.874222 [debug] [MainThread]: Flushing usage events
[0m07:03:40.418204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:05:38.338213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce8550>]}


============================== 07:05:38.341882 | 1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c ==============================
[0m07:05:38.341882 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:05:38.342205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '/Users/elham/.dbt', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt run --select fct_reviews_granular+', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'empty': 'False'}
[0m07:05:38.551237 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:05:38.551552 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:05:38.551742 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:05:38.644941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104541690>]}
[0m07:05:38.675512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b2020>]}
[0m07:05:38.676087 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:05:38.747205 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:05:38.838732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:05:38.838999 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:05:38.839153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:05:38.867611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108564130>]}
[0m07:05:38.922351 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:05:38.923846 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:05:38.936290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108537d60>]}
[0m07:05:38.936607 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:05:38.936804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108537eb0>]}
[0m07:05:38.937613 [info ] [MainThread]: 
[0m07:05:38.937800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:05:38.937953 [info ] [MainThread]: 
[0m07:05:38.938219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:05:38.940672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:05:38.974724 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:05:38.975011 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:05:38.975182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:39.958536 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.983 seconds
[0m07:05:39.963178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m07:05:39.963788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m07:05:39.976734 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:05:39.979227 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:05:39.979594 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:05:39.979904 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:05:39.980703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:40.252910 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.273 seconds
[0m07:05:40.777090 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.796 seconds
[0m07:05:40.782125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103440cd0>]}
[0m07:05:40.786105 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:05:40.786699 [info ] [Thread-2 (]: 1 of 3 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m07:05:40.787156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m07:05:40.787508 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:05:40.846580 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:05:40.847222 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:05:40.867282 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:05:40.868340 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:05:40.868594 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews_granular: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
    
    
    
    as (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */;
[0m07:05:42.107206 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.238 seconds
[0m07:05:42.133005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023b2770>]}
[0m07:05:42.133991 [info ] [Thread-2 (]: 1 of 3 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.34s]
[0m07:05:42.134756 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:05:42.135713 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m07:05:42.136134 [debug] [Thread-5 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:05:42.136627 [info ] [Thread-4 (]: 2 of 3 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m07:05:42.137084 [info ] [Thread-5 (]: 3 of 3 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m07:05:42.137583 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m07:05:42.138010 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.mart_product_kpi'
[0m07:05:42.138347 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m07:05:42.138672 [debug] [Thread-5 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m07:05:42.141810 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m07:05:42.144848 [debug] [Thread-5 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:05:42.145553 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m07:05:42.149604 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m07:05:42.149987 [debug] [Thread-5 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m07:05:42.152857 [debug] [Thread-5 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:05:42.153959 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m07:05:42.154400 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
    
    
    
    as (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */;
[0m07:05:42.154788 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:05:42.155929 [debug] [Thread-5 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:05:42.156374 [debug] [Thread-5 (]: On model.capstone_amazon_analytics.mart_product_kpi: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
    
    
    
    as (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */;
[0m07:05:42.235454 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m07:05:43.131875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m07:05:43.138023 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeb760>]}
[0m07:05:43.139005 [info ] [Thread-4 (]: 2 of 3 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.00s]
[0m07:05:43.139615 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m07:05:43.437569 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.202 seconds
[0m07:05:43.443317 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbac9aa-09c4-4e4e-856b-65a1d2d79b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eac490>]}
[0m07:05:43.444058 [info ] [Thread-5 (]: 3 of 3 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.31s]
[0m07:05:43.444616 [debug] [Thread-5 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:05:43.445710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:43.446003 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was left open.
[0m07:05:43.446427 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m07:05:43.550078 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART' was left open.
[0m07:05:43.551173 [debug] [MainThread]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m07:05:43.661694 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was left open.
[0m07:05:43.662766 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_date: Close
[0m07:05:44.055778 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was left open.
[0m07:05:44.056391 [debug] [MainThread]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m07:05:44.135942 [info ] [MainThread]: 
[0m07:05:44.136743 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m07:05:44.138699 [debug] [MainThread]: Command end result
[0m07:05:44.169887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:05:44.171745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:05:44.177843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:05:44.178206 [info ] [MainThread]: 
[0m07:05:44.178516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:05:44.178747 [info ] [MainThread]: 
[0m07:05:44.178986 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m07:05:44.181772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8890204, "process_in_blocks": "0", "process_kernel_time": 0.254054, "process_mem_max_rss": "164970496", "process_out_blocks": "0", "process_user_time": 2.085423}
[0m07:05:44.182196 [debug] [MainThread]: Command `dbt run` succeeded at 07:05:44.182121 after 5.89 seconds
[0m07:05:44.182493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045721a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de96c0>]}
[0m07:05:44.182784 [debug] [MainThread]: Flushing usage events
[0m07:05:44.690376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:07:36.527749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e85b0>]}


============================== 07:07:36.531754 | 25a4b1a7-111a-42fe-9a9d-55d7fbc6c715 ==============================
[0m07:07:36.531754 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:07:36.532096 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt compile', 'indirect_selection': 'eager'}
[0m07:07:36.742422 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:07:36.742747 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:07:36.742927 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:07:36.835813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25a4b1a7-111a-42fe-9a9d-55d7fbc6c715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aceef0>]}
[0m07:07:36.866480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25a4b1a7-111a-42fe-9a9d-55d7fbc6c715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767d690>]}
[0m07:07:36.867052 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:07:36.936816 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:07:37.029503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:07:37.029761 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:07:37.029921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:07:37.058323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25a4b1a7-111a-42fe-9a9d-55d7fbc6c715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e64130>]}
[0m07:07:37.113268 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:07:37.114747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:07:37.126035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25a4b1a7-111a-42fe-9a9d-55d7fbc6c715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e37fa0>]}
[0m07:07:37.126351 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:07:37.126547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25a4b1a7-111a-42fe-9a9d-55d7fbc6c715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da6a70>]}
[0m07:07:37.127609 [info ] [MainThread]: 
[0m07:07:37.127819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:07:37.127977 [info ] [MainThread]: 
[0m07:07:37.128250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:07:37.130928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m07:07:37.131252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:07:37.169387 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:07:37.169750 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:07:37.169943 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:07:37.170135 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:07:37.170315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:07:37.170474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:07:38.021608 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.851 seconds
[0m07:07:38.023808 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.853 seconds
[0m07:07:38.028684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25a4b1a7-111a-42fe-9a9d-55d7fbc6c715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d8100>]}
[0m07:07:38.031845 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m07:07:38.032256 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m07:07:38.032689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m07:07:38.033075 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m07:07:38.033470 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m07:07:38.033825 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m07:07:38.042499 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m07:07:38.045321 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:07:38.046631 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m07:07:38.047001 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m07:07:38.047609 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m07:07:38.048161 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m07:07:38.048795 [debug] [Thread-5 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m07:07:38.049136 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:07:38.049461 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:07:38.049873 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:07:38.050340 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m07:07:38.050843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m07:07:38.051281 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06'
[0m07:07:38.051628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m07:07:38.051955 [debug] [Thread-5 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m07:07:38.052278 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:07:38.052584 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:07:38.052882 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:07:38.055746 [debug] [Thread-5 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m07:07:38.101198 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:07:38.107686 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:07:38.112296 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:07:38.113638 [debug] [Thread-5 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m07:07:38.114020 [debug] [Thread-5 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m07:07:38.114225 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:07:38.114420 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:07:38.114652 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:07:38.115122 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:07:38.115298 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:07:38.115615 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:07:38.115825 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m07:07:38.116032 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:07:38.116368 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:07:38.116601 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:07:38.116813 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:07:38.117048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m07:07:38.117269 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m07:07:38.117471 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m07:07:38.119818 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:07:38.120053 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:07:38.120280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.dim_products)
[0m07:07:38.120469 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:07:38.122711 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:07:38.122942 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m07:07:38.126168 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:07:38.126377 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:07:38.128762 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m07:07:38.129190 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:07:38.129371 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:07:38.129647 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:07:38.129825 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:07:38.130199 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:07:38.130376 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m07:07:38.130582 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m07:07:38.130910 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:07:38.131107 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:07:38.131409 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m07:07:38.131581 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:07:38.131768 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:07:38.131962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m07:07:38.132150 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:07:38.134381 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:07:38.134616 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c, now test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d)
[0m07:07:38.134818 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:07:38.135019 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da)
[0m07:07:38.135246 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:07:38.137387 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:07:38.137606 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:07:38.139720 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m07:07:38.139937 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:07:38.142084 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m07:07:38.142506 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:07:38.142687 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:07:38.142929 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:07:38.143144 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:07:38.143520 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:07:38.143694 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:07:38.144010 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:07:38.144211 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71)
[0m07:07:38.144413 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m07:07:38.144718 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:07:38.144910 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:07:38.145097 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:07:38.145284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376, now model.capstone_amazon_analytics.dim_date)
[0m07:07:38.145476 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:07:38.145677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d, now model.capstone_amazon_analytics.mart_product_kpi)
[0m07:07:38.147872 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m07:07:38.148085 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m07:07:38.148295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da, now test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m07:07:38.148493 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m07:07:38.150844 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m07:07:38.151066 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:07:38.152730 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:07:38.152948 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:07:38.155092 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m07:07:38.155523 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:07:38.155711 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m07:07:38.155939 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m07:07:38.156143 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:07:38.156511 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m07:07:38.156686 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:07:38.156991 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:07:38.157216 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71, now test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7)
[0m07:07:38.157420 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:07:38.157734 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:07:38.157958 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:07:38.158156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_date, now test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m07:07:38.162437 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m07:07:38.162691 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:07:38.164838 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m07:07:38.165133 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:07:38.165495 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:07:38.165662 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:07:38.166031 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:07:38.166499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:07:38.166664 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m07:07:38.166822 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m07:07:38.261389 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1' was left open.
[0m07:07:38.261785 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1: Close
[0m07:07:38.365670 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7' was properly closed.
[0m07:07:38.366660 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m07:07:38.369523 [debug] [MainThread]: Command end result
[0m07:07:38.401074 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:07:38.402703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:07:38.410306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:07:38.413233 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9324924, "process_in_blocks": "0", "process_kernel_time": 0.251326, "process_mem_max_rss": "159612928", "process_out_blocks": "0", "process_user_time": 1.7257}
[0m07:07:38.413651 [debug] [MainThread]: Command `dbt compile` succeeded at 07:07:38.413579 after 1.93 seconds
[0m07:07:38.413974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c6650>]}
[0m07:07:38.414284 [debug] [MainThread]: Flushing usage events
[0m07:07:38.945169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:09:04.846531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e303a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e304f0>]}


============================== 07:09:04.850197 | cff481cc-ff88-4274-8912-80c2f0e38e42 ==============================
[0m07:09:04.850197 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:09:04.850517 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/elham/.dbt', 'invocation_command': 'dbt run --select dim_date', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'empty': 'False', 'cache_selected_only': 'False'}
[0m07:09:05.066684 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:09:05.066990 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:09:05.067167 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:09:05.160786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107773bb0>]}
[0m07:09:05.191664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875ea70>]}
[0m07:09:05.192212 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:09:05.265862 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:09:05.363602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:05.363877 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:09:05.364035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:05.393563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a124130>]}
[0m07:09:05.449752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:09:05.451475 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:09:05.464435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f5990>]}
[0m07:09:05.464779 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:09:05.464974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f5fc0>]}
[0m07:09:05.465755 [info ] [MainThread]: 
[0m07:09:05.465936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:05.466088 [info ] [MainThread]: 
[0m07:09:05.466356 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:09:05.466797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:09:05.501828 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:09:05.502142 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:09:05.502321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:06.178628 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.676 seconds
[0m07:09:06.186220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m07:09:06.186855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:09:06.199875 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:09:06.202490 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:09:06.202981 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:09:06.203416 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:09:06.204749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:06.375361 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.172 seconds
[0m07:09:06.621458 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.417 seconds
[0m07:09:06.625681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645ffa0>]}
[0m07:09:06.628529 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m07:09:06.628899 [info ] [Thread-2 (]: 1 of 1 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m07:09:06.629176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_date)
[0m07:09:06.629379 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m07:09:06.634277 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m07:09:06.635402 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m07:09:06.698716 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m07:09:06.699741 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m07:09:06.700003 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_date: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
    
    
    
    as (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */;
[0m07:09:08.242986 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.542 seconds
[0m07:09:08.274032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff481cc-ff88-4274-8912-80c2f0e38e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b6710>]}
[0m07:09:08.274985 [info ] [Thread-2 (]: 1 of 1 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.64s]
[0m07:09:08.275586 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m07:09:08.276730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:08.277093 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was left open.
[0m07:09:08.277400 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_date: Close
[0m07:09:08.372055 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE' was left open.
[0m07:09:08.372558 [debug] [MainThread]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m07:09:08.447669 [info ] [MainThread]: 
[0m07:09:08.448848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m07:09:08.450281 [debug] [MainThread]: Command end result
[0m07:09:08.482401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:09:08.484333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:09:08.490624 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:09:08.491001 [info ] [MainThread]: 
[0m07:09:08.491379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:09:08.491666 [info ] [MainThread]: 
[0m07:09:08.491961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m07:09:08.494769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.69061, "process_in_blocks": "0", "process_kernel_time": 0.245563, "process_mem_max_rss": "159023104", "process_out_blocks": "0", "process_user_time": 1.682545}
[0m07:09:08.495153 [debug] [MainThread]: Command `dbt run` succeeded at 07:09:08.495078 after 3.69 seconds
[0m07:09:08.495454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e55d0>]}
[0m07:09:08.495760 [debug] [MainThread]: Flushing usage events
[0m07:09:09.043906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:09:57.723371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180550>]}


============================== 07:09:57.727082 | 45e5f5f2-87f0-4c17-8dc4-27e65801616c ==============================
[0m07:09:57.727082 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:09:57.727421 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/elham/.dbt', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'version_check': 'True', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select mart_product_kpi', 'empty': 'False', 'send_anonymous_usage_stats': 'True'}
[0m07:09:57.942807 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:09:57.943122 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:09:57.943302 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:09:58.036701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ccd90>]}
[0m07:09:58.067304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4a020>]}
[0m07:09:58.067870 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:09:58.139428 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:09:58.231691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:58.231957 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:09:58.232112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:58.260684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108474130>]}
[0m07:09:58.315435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:09:58.317089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:09:58.329293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447d60>]}
[0m07:09:58.329610 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:09:58.329808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447eb0>]}
[0m07:09:58.330588 [info ] [MainThread]: 
[0m07:09:58.330770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:58.330922 [info ] [MainThread]: 
[0m07:09:58.331194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:09:58.331641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:09:58.369487 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:09:58.369772 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:09:58.369934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:58.969362 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.599 seconds
[0m07:09:58.976554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m07:09:58.977142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:09:58.990146 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:09:58.992661 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:09:58.993034 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:09:58.993365 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:09:58.994009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:59.191277 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.198 seconds
[0m07:09:59.439826 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.446 seconds
[0m07:09:59.444651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f3fa0>]}
[0m07:09:59.447989 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:09:59.448526 [info ] [Thread-2 (]: 1 of 1 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m07:09:59.448925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.mart_product_kpi)
[0m07:09:59.449164 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m07:09:59.454348 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:09:59.454965 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m07:09:59.511545 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:09:59.512672 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:09:59.512934 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
    
    
    
    as (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */;
[0m07:10:00.098890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m07:10:00.126512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e5f5f2-87f0-4c17-8dc4-27e65801616c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac1a50>]}
[0m07:10:00.127310 [info ] [Thread-2 (]: 1 of 1 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.68s]
[0m07:10:00.127947 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:10:00.129267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:00.129655 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was left open.
[0m07:10:00.129962 [debug] [MainThread]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m07:10:00.233737 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE' was left open.
[0m07:10:00.234054 [debug] [MainThread]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m07:10:00.360738 [info ] [MainThread]: 
[0m07:10:00.361642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m07:10:00.362778 [debug] [MainThread]: Command end result
[0m07:10:00.380900 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:10:00.382137 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:10:00.386026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:10:00.386266 [info ] [MainThread]: 
[0m07:10:00.386504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:00.386676 [info ] [MainThread]: 
[0m07:10:00.386899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m07:10:00.391088 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.710152, "process_in_blocks": "0", "process_kernel_time": 0.244526, "process_mem_max_rss": "160563200", "process_out_blocks": "0", "process_user_time": 1.635095}
[0m07:10:00.391486 [debug] [MainThread]: Command `dbt run` succeeded at 07:10:00.391430 after 2.71 seconds
[0m07:10:00.391731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fbbe0>]}
[0m07:10:00.391965 [debug] [MainThread]: Flushing usage events
[0m07:10:00.852820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:10:13.057613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104014be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ec460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ec5b0>]}


============================== 07:10:13.061056 | a0f3c66a-b627-4d9b-a98f-3a28925e3978 ==============================
[0m07:10:13.061056 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:10:13.061374 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/Users/elham/.dbt', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m07:10:13.265135 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:10:13.265461 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:10:13.265639 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:10:13.356019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102672ef0>]}
[0m07:10:13.386592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b55d0>]}
[0m07:10:13.387170 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:10:13.457365 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:10:13.547433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:10:13.547711 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:10:13.547871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:10:13.576462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e0130>]}
[0m07:10:13.629709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:10:13.631286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:10:13.642898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b3d60>]}
[0m07:10:13.643203 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:10:13.643395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b3e80>]}
[0m07:10:13.644356 [info ] [MainThread]: 
[0m07:10:13.644546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:10:13.644702 [info ] [MainThread]: 
[0m07:10:13.644965 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:10:13.647606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:10:13.648183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m07:10:13.682383 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:10:13.682739 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m07:10:13.682935 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:10:13.683144 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
[0m07:10:13.683353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:13.683534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:14.347472 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.664 seconds
[0m07:10:14.406334 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.723 seconds
[0m07:10:14.411830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m07:10:14.412458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m07:10:14.425620 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:10:14.427889 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:10:14.428269 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:10:14.428603 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:10:14.545685 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.116 seconds
[0m07:10:14.547526 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.119 seconds
[0m07:10:14.552779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271bfa0>]}
[0m07:10:14.556430 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m07:10:14.556823 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m07:10:14.557395 [info ] [Thread-2 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m07:10:14.557938 [info ] [Thread-3 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m07:10:14.558372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m07:10:14.558735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m07:10:14.559081 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m07:10:14.559393 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m07:10:14.569298 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m07:10:14.620874 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:10:14.622565 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m07:10:14.629119 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m07:10:14.639292 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m07:10:14.641085 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m07:10:14.641823 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m07:10:14.642342 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m07:10:14.642568 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_meta: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */;
[0m07:10:14.642800 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
  
  
  
  as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  )
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */;
[0m07:10:14.847445 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m07:10:14.876246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102672740>]}
[0m07:10:14.877064 [info ] [Thread-3 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m07:10:14.877703 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m07:10:14.878349 [debug] [Thread-5 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m07:10:14.878732 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:10:14.879165 [info ] [Thread-5 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m07:10:14.879635 [info ] [Thread-4 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m07:10:14.880133 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m07:10:14.880564 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m07:10:14.880916 [debug] [Thread-5 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m07:10:14.881234 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:10:14.885101 [debug] [Thread-5 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m07:10:14.887719 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:10:14.888676 [debug] [Thread-5 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m07:10:14.889057 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:10:14.910086 [debug] [Thread-5 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m07:10:14.912511 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:10:14.913466 [debug] [Thread-5 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m07:10:14.914023 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m07:10:14.914339 [debug] [Thread-5 (]: On model.capstone_amazon_analytics.fct_reviews: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    
    
    
    as (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */;
[0m07:10:14.914690 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews_granular: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
    
    
    
    as (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */;
[0m07:10:14.914980 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m07:10:14.915219 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:10:15.142879 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m07:10:15.144707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df2110>]}
[0m07:10:15.145170 [info ] [Thread-2 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m07:10:15.145561 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m07:10:15.145960 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m07:10:15.146333 [info ] [Thread-3 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m07:10:15.146650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m07:10:15.146903 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m07:10:15.149035 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m07:10:15.150600 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m07:10:15.153407 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m07:10:15.154068 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m07:10:15.154316 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.dim_products: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
    
    
    
    as (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */;
[0m07:10:15.933702 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m07:10:15.935811 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.021 seconds
[0m07:10:15.940372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcb4c0>]}
[0m07:10:15.942549 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df0160>]}
[0m07:10:15.943265 [info ] [Thread-3 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 0.79s]
[0m07:10:15.943987 [info ] [Thread-5 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m07:10:15.944596 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m07:10:15.945069 [debug] [Thread-5 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m07:10:17.160559 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.245 seconds
[0m07:10:17.166197 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107613be0>]}
[0m07:10:17.166981 [info ] [Thread-4 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.29s]
[0m07:10:17.167531 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m07:10:17.168254 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m07:10:17.168634 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:10:17.169104 [info ] [Thread-2 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m07:10:17.169538 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m07:10:17.169997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m07:10:17.170448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m07:10:17.170906 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m07:10:17.171326 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m07:10:17.174995 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m07:10:17.177806 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:10:17.178553 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m07:10:17.178907 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m07:10:17.181853 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:10:17.184714 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m07:10:17.186166 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m07:10:17.187265 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m07:10:17.187660 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
    
    
    
    as (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */;
[0m07:10:17.188137 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_date: create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
    
    
    
    as (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
    )

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */;
[0m07:10:17.672428 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m07:10:17.678192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764d390>]}
[0m07:10:17.679137 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m07:10:17.679881 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.51s]
[0m07:10:17.682075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f3c66a-b627-4d9b-a98f-3a28925e3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764cb80>]}
[0m07:10:17.682610 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m07:10:17.683182 [info ] [Thread-2 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.51s]
[0m07:10:17.683934 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m07:10:17.685065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:17.685407 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was left open.
[0m07:10:17.685700 [debug] [MainThread]: On model.capstone_amazon_analytics.dim_date: Close
[0m07:10:17.802423 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was left open.
[0m07:10:17.803737 [debug] [MainThread]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m07:10:17.892440 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was left open.
[0m07:10:17.893401 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m07:10:17.977035 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was left open.
[0m07:10:17.978162 [debug] [MainThread]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m07:10:18.174080 [info ] [MainThread]: 
[0m07:10:18.174559 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m07:10:18.175924 [debug] [MainThread]: Command end result
[0m07:10:18.206751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:10:18.208342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:10:18.215095 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:10:18.215488 [info ] [MainThread]: 
[0m07:10:18.215827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:18.216084 [info ] [MainThread]: 
[0m07:10:18.216366 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m07:10:18.219389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.201278, "process_in_blocks": "0", "process_kernel_time": 0.265448, "process_mem_max_rss": "165494784", "process_out_blocks": "0", "process_user_time": 2.10399}
[0m07:10:18.219789 [debug] [MainThread]: Command `dbt run` succeeded at 07:10:18.219720 after 5.20 seconds
[0m07:10:18.220100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104014be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e0a00>]}
[0m07:10:18.220408 [debug] [MainThread]: Flushing usage events
[0m07:10:18.776846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:10:28.667235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105494520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105494670>]}


============================== 07:10:28.670834 | 718b8588-8833-4e6c-ab84-0f02e41f31c3 ==============================
[0m07:10:28.670834 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:10:28.671173 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True'}
[0m07:10:28.850134 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:10:28.850439 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:10:28.850618 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:10:28.940932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '718b8588-8833-4e6c-ab84-0f02e41f31c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e0d90>]}
[0m07:10:28.971504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '718b8588-8833-4e6c-ab84-0f02e41f31c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052876d0>]}
[0m07:10:28.972279 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:10:29.039694 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:10:29.128789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:10:29.129065 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:10:29.129223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:10:29.157788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '718b8588-8833-4e6c-ab84-0f02e41f31c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106784130>]}
[0m07:10:29.212906 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:10:29.214255 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:10:29.229894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '718b8588-8833-4e6c-ab84-0f02e41f31c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038558d0>]}
[0m07:10:29.230236 [info ] [MainThread]: Found 7 models, 13 data tests, 2 sources, 522 macros
[0m07:10:29.230431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '718b8588-8833-4e6c-ab84-0f02e41f31c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062445b0>]}
[0m07:10:29.231550 [info ] [MainThread]: 
[0m07:10:29.231738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:10:29.231892 [info ] [MainThread]: 
[0m07:10:29.232156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:10:29.234851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m07:10:29.235147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:10:29.268090 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:10:29.268437 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:10:29.268665 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:10:29.268863 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:10:29.269040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:29.269193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:29.992381 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.723 seconds
[0m07:10:30.112634 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.843 seconds
[0m07:10:30.117094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '718b8588-8833-4e6c-ab84-0f02e41f31c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106089060>]}
[0m07:10:30.122390 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:10:30.122815 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:10:30.123225 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:10:30.123552 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:10:30.123935 [info ] [Thread-2 (]: 1 of 13 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ........... [RUN]
[0m07:10:30.124387 [info ] [Thread-3 (]: 2 of 13 START test not_null_dim_products_product_id ............................ [RUN]
[0m07:10:30.124771 [info ] [Thread-4 (]: 3 of 13 START test not_null_fct_reviews_avg_rating ............................. [RUN]
[0m07:10:30.125131 [info ] [Thread-5 (]: 4 of 13 START test not_null_fct_reviews_product_id ............................. [RUN]
[0m07:10:30.125585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m07:10:30.126029 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m07:10:30.126510 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d'
[0m07:10:30.126955 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da'
[0m07:10:30.127336 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:10:30.127674 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:10:30.127990 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:10:30.128313 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:10:30.189269 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:10:30.194264 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m07:10:30.196724 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m07:10:30.199109 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m07:10:30.200528 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:10:30.200806 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:10:30.213569 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:10:30.213858 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m07:10:30.215465 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:10:30.215653 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:10:30.217166 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m07:10:30.218852 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m07:10:30.219369 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m07:10:30.219873 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:10:30.220170 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1"} */
[0m07:10:30.220562 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"
[0m07:10:30.220804 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
[0m07:10:30.221172 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"
[0m07:10:30.221538 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where avg_rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d"} */
[0m07:10:30.222393 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da"} */
[0m07:10:30.222954 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:10:30.223174 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m07:10:30.358181 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m07:10:30.364508 [info ] [Thread-3 (]: 2 of 13 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.24s]
[0m07:10:30.364904 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1
[0m07:10:30.365139 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:10:30.365343 [info ] [Thread-3 (]: 5 of 13 START test not_null_fct_reviews_review_count ........................... [RUN]
[0m07:10:30.365584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_dim_products_product_id.c8aba288d1, now test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71)
[0m07:10:30.365825 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:10:30.368119 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m07:10:30.368674 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:10:30.370739 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m07:10:30.372693 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"
[0m07:10:30.372916 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_count
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
where review_count is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71"} */
[0m07:10:30.380506 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m07:10:30.382164 [info ] [Thread-2 (]: 1 of 13 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 ................. [[32mPASS[0m in 0.26s]
[0m07:10:30.383536 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:10:30.383774 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:10:30.384056 [info ] [Thread-2 (]: 6 of 13 START test not_null_stg_meta_product_id ................................ [RUN]
[0m07:10:30.384375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m07:10:30.384730 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:10:30.387149 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:10:30.387923 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:10:30.389477 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:10:30.390133 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:10:30.390340 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
[0m07:10:30.562395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m07:10:30.564547 [info ] [Thread-3 (]: 5 of 13 PASS not_null_fct_reviews_review_count ................................. [[32mPASS[0m in 0.20s]
[0m07:10:30.565142 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71
[0m07:10:30.565524 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:10:30.565940 [info ] [Thread-3 (]: 7 of 13 START test not_null_stg_reviews_product_id ............................. [RUN]
[0m07:10:30.566391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_review_count.01434b7a71, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m07:10:30.566752 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:10:30.571066 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:10:30.571733 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:10:30.574509 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:10:30.575432 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:10:30.575800 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
[0m07:10:30.616108 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m07:10:30.618147 [info ] [Thread-2 (]: 6 of 13 PASS not_null_stg_meta_product_id ...................................... [[32mPASS[0m in 0.23s]
[0m07:10:30.618719 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:10:30.619092 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:10:30.619505 [info ] [Thread-2 (]: 8 of 13 START test not_null_stg_reviews_rating ................................. [RUN]
[0m07:10:30.620002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m07:10:30.620405 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:10:30.623607 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:10:30.624146 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:10:30.626616 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:10:30.627180 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:10:30.627435 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
[0m07:10:30.686964 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m07:10:30.688307 [info ] [Thread-3 (]: 7 of 13 PASS not_null_stg_reviews_product_id ................................... [[32mPASS[0m in 0.12s]
[0m07:10:30.688651 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:10:30.688876 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:10:30.689075 [info ] [Thread-3 (]: 9 of 13 START test not_null_stg_reviews_review_id .............................. [RUN]
[0m07:10:30.689307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m07:10:30.689499 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:10:30.692066 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:10:30.695551 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:10:30.697247 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:10:30.697806 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:10:30.698014 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
[0m07:10:30.797427 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m07:10:30.802152 [info ] [Thread-5 (]: 4 of 13 PASS not_null_fct_reviews_product_id ................................... [[32mPASS[0m in 0.67s]
[0m07:10:30.803210 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da
[0m07:10:30.803896 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:10:30.804250 [info ] [Thread-5 (]: 10 of 13 START test relationships_fct_reviews_product_id__product_id__ref_dim_products_  [RUN]
[0m07:10:30.804590 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_product_id.b0f89002da, now test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7)
[0m07:10:30.804815 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:10:30.811837 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m07:10:30.813036 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m07:10:30.815032 [info ] [Thread-2 (]: 8 of 13 PASS not_null_stg_reviews_rating ....................................... [[32mPASS[0m in 0.19s]
[0m07:10:30.815640 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:10:30.816066 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:10:30.816478 [info ] [Thread-2 (]: 11 of 13 START test unique_dim_products_product_id ............................. [RUN]
[0m07:10:30.816841 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:10:30.817278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m07:10:30.818230 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m07:10:30.821127 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m07:10:30.821525 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:10:30.823194 [info ] [Thread-4 (]: 3 of 13 PASS not_null_fct_reviews_avg_rating ................................... [[32mPASS[0m in 0.70s]
[0m07:10:30.830592 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m07:10:30.831194 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d
[0m07:10:30.832182 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"
[0m07:10:30.832643 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:10:30.833149 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
    where product_id is not null
),

parent as (
    select product_id as to_field
    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7"} */
[0m07:10:30.833556 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:10:30.833880 [info ] [Thread-4 (]: 12 of 13 START test unique_stg_meta_product_id ................................. [RUN]
[0m07:10:30.837309 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m07:10:30.838080 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_avg_rating.b2c372352d, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m07:10:30.839556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m07:10:30.840291 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:10:30.841649 [info ] [Thread-3 (]: 9 of 13 PASS not_null_stg_reviews_review_id .................................... [[32mPASS[0m in 0.15s]
[0m07:10:30.842147 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m07:10:30.846049 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:10:30.846637 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:10:30.847033 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985"} */
[0m07:10:30.847489 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:10:30.848098 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:10:30.848424 [info ] [Thread-3 (]: 13 of 13 START test unique_stg_reviews_review_id ............................... [RUN]
[0m07:10:30.851235 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:10:30.851851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m07:10:30.852404 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:10:30.856131 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:10:30.857000 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:10:30.857340 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
[0m07:10:30.857817 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:10:30.859890 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:10:30.861067 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:10:30.861308 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
[0m07:10:30.961876 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m07:10:30.964041 [info ] [Thread-5 (]: 10 of 13 PASS relationships_fct_reviews_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.16s]
[0m07:10:30.964641 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7
[0m07:10:30.976597 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m07:10:30.978610 [info ] [Thread-2 (]: 11 of 13 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.16s]
[0m07:10:30.979324 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985
[0m07:10:30.998960 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m07:10:31.000700 [info ] [Thread-3 (]: 13 of 13 PASS unique_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.15s]
[0m07:10:31.001255 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:10:31.048280 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m07:10:31.050583 [info ] [Thread-4 (]: 12 of 13 PASS unique_stg_meta_product_id ....................................... [[32mPASS[0m in 0.21s]
[0m07:10:31.051148 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:10:31.052269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:31.052622 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m07:10:31.052922 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m07:10:31.183273 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was left open.
[0m07:10:31.184491 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m07:10:31.258685 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was left open.
[0m07:10:31.259884 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m07:10:31.344477 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7' was left open.
[0m07:10:31.345850 [debug] [MainThread]: On test.capstone_amazon_analytics.relationships_fct_reviews_product_id__product_id__ref_dim_products_.b5f53004f7: Close
[0m07:10:31.424999 [info ] [MainThread]: 
[0m07:10:31.426410 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m07:10:31.429890 [debug] [MainThread]: Command end result
[0m07:10:31.462137 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:10:31.463935 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:10:31.471965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:10:31.472291 [info ] [MainThread]: 
[0m07:10:31.472611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:31.472874 [info ] [MainThread]: 
[0m07:10:31.473151 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m07:10:31.476008 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8518305, "process_in_blocks": "0", "process_kernel_time": 0.212067, "process_mem_max_rss": "166182912", "process_out_blocks": "0", "process_user_time": 2.099841}
[0m07:10:31.476354 [debug] [MainThread]: Command `dbt test` succeeded at 07:10:31.476299 after 2.85 seconds
[0m07:10:31.476581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052876d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d1ff0>]}
[0m07:10:31.476807 [debug] [MainThread]: Flushing usage events
[0m07:10:32.001884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:05.270392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbcb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109094610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109094760>]}


============================== 07:35:05.274030 | 38c3f402-2d3f-409a-afbb-83f88d07174e ==============================
[0m07:35:05.274030 [info ] [MainThread]: Running with dbt=1.11.3
[0m07:35:05.274388 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'invocation_command': 'dbt test', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'partial_parse': 'True'}
[0m07:35:05.483250 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m07:35:05.483563 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m07:35:05.483741 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m07:35:05.576969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d71c0>]}
[0m07:35:05.607557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109094fd0>]}
[0m07:35:05.608076 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m07:35:05.674265 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m07:35:05.742241 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 39, column 1 in file
`models/marts/schema.yml`
[0m07:35:05.742558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2957e0>]}
[0m07:35:05.768136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:35:05.768595 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/schema.yml
[0m07:35:05.991137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b114100>]}
[0m07:35:06.082256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:35:06.083838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:35:06.100860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c1f60>]}
[0m07:35:06.101187 [info ] [MainThread]: Found 7 models, 11 data tests, 2 sources, 522 macros
[0m07:35:06.101389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c10c0>]}
[0m07:35:06.102429 [info ] [MainThread]: 
[0m07:35:06.102630 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:35:06.102788 [info ] [MainThread]: 
[0m07:35:06.103056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:35:06.105748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m07:35:06.106024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m07:35:06.143427 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m07:35:06.143733 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m07:35:06.143969 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m07:35:06.144179 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m07:35:06.144349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:06.144506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:06.881704 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.737 seconds
[0m07:35:06.916526 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.772 seconds
[0m07:35:06.919529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c3f402-2d3f-409a-afbb-83f88d07174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c7fa0>]}
[0m07:35:06.923241 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:35:06.923650 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675
[0m07:35:06.924055 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af
[0m07:35:06.924406 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e
[0m07:35:06.924783 [info ] [Thread-2 (]: 1 of 11 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ........... [RUN]
[0m07:35:06.925246 [info ] [Thread-3 (]: 2 of 11 START test not_null_fct_reviews_granular_product_id .................... [RUN]
[0m07:35:06.925691 [info ] [Thread-4 (]: 3 of 11 START test not_null_fct_reviews_granular_rating ........................ [RUN]
[0m07:35:06.926082 [info ] [Thread-5 (]: 4 of 11 START test not_null_fct_reviews_granular_review_id ..................... [RUN]
[0m07:35:06.926562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m07:35:06.926952 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675)
[0m07:35:06.927413 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af'
[0m07:35:06.927939 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e'
[0m07:35:06.928291 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:35:06.928642 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675
[0m07:35:06.928974 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af
[0m07:35:06.929283 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e
[0m07:35:06.944957 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:35:06.952968 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675"
[0m07:35:06.957906 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af"
[0m07:35:06.961800 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e"
[0m07:35:06.962987 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675
[0m07:35:06.968625 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:35:06.968997 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af
[0m07:35:06.982775 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e
[0m07:35:06.985264 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675"
[0m07:35:06.985724 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:35:06.987337 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af"
[0m07:35:06.989228 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e"
[0m07:35:06.990043 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675"
[0m07:35:06.990451 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af"
[0m07:35:06.990663 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675"} */
[0m07:35:06.991118 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m07:35:06.991497 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e"
[0m07:35:06.991719 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af"} */
[0m07:35:06.992113 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
[0m07:35:06.992496 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e"} */
[0m07:35:06.992873 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:35:06.993284 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m07:35:07.437583 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m07:35:07.451098 [info ] [Thread-2 (]: 1 of 11 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 ................. [[32mPASS[0m in 0.52s]
[0m07:35:07.451875 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m07:35:07.452287 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:35:07.452724 [info ] [Thread-2 (]: 5 of 11 START test not_null_stg_meta_product_id ................................ [RUN]
[0m07:35:07.453207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m07:35:07.453594 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:35:07.457641 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:35:07.458633 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:35:07.461511 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:35:07.462707 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m07:35:07.463071 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
[0m07:35:07.642823 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m07:35:07.644694 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m07:35:07.648276 [info ] [Thread-4 (]: 3 of 11 PASS not_null_fct_reviews_granular_rating .............................. [[32mPASS[0m in 0.72s]
[0m07:35:07.652112 [info ] [Thread-3 (]: 2 of 11 PASS not_null_fct_reviews_granular_product_id .......................... [[32mPASS[0m in 0.72s]
[0m07:35:07.653346 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m07:35:07.653845 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af
[0m07:35:07.654335 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675
[0m07:35:07.656044 [info ] [Thread-5 (]: 4 of 11 PASS not_null_fct_reviews_granular_review_id ........................... [[32mPASS[0m in 0.73s]
[0m07:35:07.656493 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:35:07.656960 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:35:07.657493 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e
[0m07:35:07.657851 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_reviews_product_id ............................. [RUN]
[0m07:35:07.658219 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_reviews_rating ................................. [RUN]
[0m07:35:07.658589 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:35:07.659016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_granular_rating.f6228976af, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m07:35:07.659407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_granular_product_id.ce48782675, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m07:35:07.659788 [info ] [Thread-5 (]: 8 of 11 START test not_null_stg_reviews_review_id .............................. [RUN]
[0m07:35:07.660153 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:35:07.660491 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:35:07.660855 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_fct_reviews_granular_review_id.b027793a2e, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m07:35:07.665657 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:35:07.669811 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:35:07.670205 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:35:07.675597 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:35:07.676247 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:35:07.676636 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:35:07.679389 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:35:07.679749 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:35:07.681933 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:35:07.684714 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:35:07.685738 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m07:35:07.686483 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m07:35:07.686879 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
[0m07:35:07.687278 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
[0m07:35:07.687911 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m07:35:07.689266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m07:35:07.690451 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
[0m07:35:07.692756 [info ] [Thread-2 (]: 5 of 11 PASS not_null_stg_meta_product_id ...................................... [[32mPASS[0m in 0.24s]
[0m07:35:07.694182 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m07:35:07.694709 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314
[0m07:35:07.695318 [info ] [Thread-2 (]: 9 of 11 START test unique_fct_reviews_granular_review_id ....................... [RUN]
[0m07:35:07.695705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314)
[0m07:35:07.696084 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314
[0m07:35:07.701495 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314"
[0m07:35:07.702583 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314
[0m07:35:07.705590 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314"
[0m07:35:07.706607 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314"
[0m07:35:07.706927 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314"} */
[0m07:35:07.812760 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m07:35:07.814091 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_reviews_rating ....................................... [[32mPASS[0m in 0.15s]
[0m07:35:07.814416 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m07:35:07.814886 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:35:07.815421 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_meta_product_id ................................. [RUN]
[0m07:35:07.816015 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m07:35:07.816501 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:35:07.819314 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:35:07.819836 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:35:07.821397 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:35:07.822501 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m07:35:07.822977 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
[0m07:35:07.853369 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m07:35:07.854761 [info ] [Thread-4 (]: 6 of 11 PASS not_null_stg_reviews_product_id ................................... [[32mPASS[0m in 0.20s]
[0m07:35:07.855101 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m07:35:07.855326 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:35:07.855590 [info ] [Thread-4 (]: 11 of 11 START test unique_stg_reviews_review_id ............................... [RUN]
[0m07:35:07.855907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m07:35:07.856131 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:35:07.859729 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:35:07.860702 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:35:07.863159 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:35:07.864134 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m07:35:07.864426 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
[0m07:35:07.914649 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m07:35:07.915994 [info ] [Thread-5 (]: 8 of 11 PASS not_null_stg_reviews_review_id .................................... [[32mPASS[0m in 0.26s]
[0m07:35:07.916319 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m07:35:07.922015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m07:35:07.923065 [info ] [Thread-2 (]: 9 of 11 PASS unique_fct_reviews_granular_review_id ............................. [[32mPASS[0m in 0.23s]
[0m07:35:07.923368 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314
[0m07:35:08.006532 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m07:35:08.010068 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m07:35:08.013453 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_meta_product_id ....................................... [[32mPASS[0m in 0.20s]
[0m07:35:08.015737 [info ] [Thread-4 (]: 11 of 11 PASS unique_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.16s]
[0m07:35:08.016311 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m07:35:08.016779 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m07:35:08.017999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:08.018303 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314' was left open.
[0m07:35:08.018592 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_fct_reviews_granular_review_id.f1c0492314: Close
[0m07:35:08.127815 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was left open.
[0m07:35:08.129074 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m07:35:08.209796 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was left open.
[0m07:35:08.211118 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m07:35:08.327681 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was left open.
[0m07:35:08.328764 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m07:35:08.407895 [info ] [MainThread]: 
[0m07:35:08.408468 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m07:35:08.410172 [debug] [MainThread]: Command end result
[0m07:35:08.439722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m07:35:08.441571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m07:35:08.448966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m07:35:08.449359 [info ] [MainThread]: 
[0m07:35:08.449736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:35:08.450041 [info ] [MainThread]: 
[0m07:35:08.450343 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m07:35:08.450838 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m07:35:08.453825 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.2273605, "process_in_blocks": "0", "process_kernel_time": 0.2663, "process_mem_max_rss": "173883392", "process_out_blocks": "0", "process_user_time": 2.272684}
[0m07:35:08.454199 [debug] [MainThread]: Command `dbt test` succeeded at 07:35:08.454132 after 3.23 seconds
[0m07:35:08.454501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbcb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba2f8b0>]}
[0m07:35:08.454809 [debug] [MainThread]: Flushing usage events
[0m07:35:08.981808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:07:49.201647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b4700>]}


============================== 08:07:49.205221 | 62d71077-710a-48b8-954e-7770ec09f00c ==============================
[0m08:07:49.205221 [info ] [MainThread]: Running with dbt=1.11.3
[0m08:07:49.205565 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt test', 'profiles_dir': '/Users/elham/.dbt', 'quiet': 'False', 'target_path': 'None'}
[0m08:07:49.414935 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:07:49.415263 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:07:49.415445 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:07:49.508512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef4850>]}
[0m08:07:49.539328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061814e0>]}
[0m08:07:49.539858 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m08:07:49.607873 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m08:07:49.673568 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 39, column 1 in file
`models/marts/schema.yml`
[0m08:07:49.673902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a41f0>]}
[0m08:07:49.701626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:07:49.702112 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/schema.yml
[0m08:07:49.929376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762e0e0>]}
[0m08:07:50.021447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m08:07:50.022995 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m08:07:50.039808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076281f0>]}
[0m08:07:50.040146 [info ] [MainThread]: Found 7 models, 9 data tests, 2 sources, 522 macros
[0m08:07:50.040341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107629120>]}
[0m08:07:50.041333 [info ] [MainThread]: 
[0m08:07:50.041528 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:50.041685 [info ] [MainThread]: 
[0m08:07:50.041948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:07:50.044613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m08:07:50.044904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m08:07:50.083121 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m08:07:50.083448 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m08:07:50.083687 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m08:07:50.083884 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m08:07:50.084060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:50.084219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:51.365483 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.281 seconds
[0m08:07:51.367482 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.283 seconds
[0m08:07:51.372190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62d71077-710a-48b8-954e-7770ec09f00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762b6a0>]}
[0m08:07:51.375671 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:07:51.376084 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2
[0m08:07:51.376503 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:07:51.376829 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:07:51.377181 [info ] [Thread-2 (]: 1 of 9 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m08:07:51.377640 [info ] [Thread-3 (]: 2 of 9 START test not_null_dim_date_date_day ................................... [RUN]
[0m08:07:51.378208 [info ] [Thread-4 (]: 3 of 9 START test not_null_stg_meta_product_id ................................. [RUN]
[0m08:07:51.378612 [info ] [Thread-5 (]: 4 of 9 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m08:07:51.379058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m08:07:51.379466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2)
[0m08:07:51.379940 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m08:07:51.380387 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef'
[0m08:07:51.380746 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:07:51.381075 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2
[0m08:07:51.381442 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:07:51.381777 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:07:51.397425 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:07:51.405544 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2"
[0m08:07:51.409391 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:07:51.412776 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:07:51.413716 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2
[0m08:07:51.419689 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:07:51.425916 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:07:51.432530 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:07:51.432861 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2"
[0m08:07:51.435162 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:07:51.436836 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:07:51.438394 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:07:51.439461 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2"
[0m08:07:51.439957 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:07:51.440383 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:07:51.440606 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
where date_day is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2"} */
[0m08:07:51.440988 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:07:51.441219 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
[0m08:07:51.441454 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
[0m08:07:51.441856 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
[0m08:07:51.442641 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m08:07:51.443170 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:07:51.832654 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m08:07:51.842114 [info ] [Thread-2 (]: 1 of 9 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.46s]
[0m08:07:51.843210 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:07:51.843703 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:07:51.844257 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_reviews_rating .................................. [RUN]
[0m08:07:51.844921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m08:07:51.845421 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:07:51.850350 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:07:51.851071 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:07:51.854162 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:07:51.855073 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:07:51.855440 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
[0m08:07:51.926894 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m08:07:51.929344 [info ] [Thread-5 (]: 4 of 9 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.55s]
[0m08:07:51.929940 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:07:51.930319 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:07:51.930750 [info ] [Thread-5 (]: 6 of 9 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m08:07:51.931222 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m08:07:51.931588 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:07:51.935929 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:07:51.936591 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:07:51.939347 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:07:51.940261 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:07:51.940638 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
[0m08:07:51.980819 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m08:07:51.982063 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.14s]
[0m08:07:51.982392 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:07:51.982601 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199
[0m08:07:51.982791 [info ] [Thread-2 (]: 7 of 9 START test unique_dim_date_date_day ..................................... [RUN]
[0m08:07:51.983020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199)
[0m08:07:51.983203 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199
[0m08:07:51.986765 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199"
[0m08:07:51.987251 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199
[0m08:07:51.989432 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199"
[0m08:07:51.990027 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199"
[0m08:07:51.990242 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199"} */
[0m08:07:51.991427 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m08:07:51.993497 [info ] [Thread-4 (]: 3 of 9 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.61s]
[0m08:07:51.994182 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:07:51.994465 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:07:51.994714 [info ] [Thread-4 (]: 8 of 9 START test unique_stg_meta_product_id ................................... [RUN]
[0m08:07:51.994946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m08:07:51.995140 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:07:51.999093 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m08:07:51.999939 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:07:52.002644 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m08:07:52.003525 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m08:07:52.003900 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
[0m08:07:52.037950 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m08:07:52.039642 [info ] [Thread-5 (]: 6 of 9 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.11s]
[0m08:07:52.040193 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:07:52.040571 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:07:52.040919 [info ] [Thread-5 (]: 9 of 9 START test unique_stg_reviews_review_id ................................. [RUN]
[0m08:07:52.041378 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m08:07:52.041790 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:07:52.045282 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:07:52.045677 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:07:52.047574 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:07:52.048754 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:07:52.049159 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
[0m08:07:52.151599 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m08:07:52.155742 [info ] [Thread-5 (]: 9 of 9 PASS unique_stg_reviews_review_id ....................................... [[32mPASS[0m in 0.11s]
[0m08:07:52.156536 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:07:52.220560 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m08:07:52.224993 [info ] [Thread-4 (]: 8 of 9 PASS unique_stg_meta_product_id ......................................... [[32mPASS[0m in 0.23s]
[0m08:07:52.225695 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:07:52.589908 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m08:07:52.591325 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m08:07:52.595303 [info ] [Thread-2 (]: 7 of 9 PASS unique_dim_date_date_day ........................................... [[32mPASS[0m in 0.61s]
[0m08:07:52.597385 [info ] [Thread-3 (]: 2 of 9 PASS not_null_dim_date_date_day ......................................... [[32mPASS[0m in 1.22s]
[0m08:07:52.597998 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199
[0m08:07:52.598389 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2
[0m08:07:52.599367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:52.599622 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199' was left open.
[0m08:07:52.599845 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_dim_date_date_day.d56fd19199: Close
[0m08:07:52.728088 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2' was left open.
[0m08:07:52.729327 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_dim_date_date_day.e3f312efb2: Close
[0m08:07:52.822806 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was left open.
[0m08:07:52.823959 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m08:07:52.937525 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was left open.
[0m08:07:52.938737 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m08:07:53.011577 [info ] [MainThread]: 
[0m08:07:53.012652 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m08:07:53.015825 [debug] [MainThread]: Command end result
[0m08:07:53.047701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m08:07:53.049368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m08:07:53.056398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m08:07:53.056701 [info ] [MainThread]: 
[0m08:07:53.057034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:07:53.057294 [info ] [MainThread]: 
[0m08:07:53.057569 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m08:07:53.058017 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:07:53.060030 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9018767, "process_in_blocks": "0", "process_kernel_time": 0.273219, "process_mem_max_rss": "168919040", "process_out_blocks": "0", "process_user_time": 2.271613}
[0m08:07:53.060350 [debug] [MainThread]: Command `dbt test` succeeded at 08:07:53.060303 after 3.90 seconds
[0m08:07:53.060575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080271f0>]}
[0m08:07:53.060796 [debug] [MainThread]: Flushing usage events
[0m08:07:53.582009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:09:38.480166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d06a0>]}


============================== 08:09:38.483674 | ce6764c1-9c00-41cb-a4f4-bd09cf8167ae ==============================
[0m08:09:38.483674 [info ] [MainThread]: Running with dbt=1.11.3
[0m08:09:38.484020 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'log_path': '/Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/logs', 'warn_error': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/elham/.dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m08:09:38.696879 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:09:38.697204 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:09:38.697387 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:09:38.791064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d108e0>]}
[0m08:09:38.821864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c775e0>]}
[0m08:09:38.822439 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m08:09:38.890844 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m08:09:38.957914 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 39, column 1 in file
`models/marts/schema.yml`
[0m08:09:38.958229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5bd150>]}
[0m08:09:38.984235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:09:38.984645 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/schema.yml
[0m08:09:39.211862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44c100>]}
[0m08:09:39.304062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m08:09:39.305911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m08:09:39.322665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b354850>]}
[0m08:09:39.322997 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 522 macros
[0m08:09:39.323195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107793940>]}
[0m08:09:39.324271 [info ] [MainThread]: 
[0m08:09:39.324468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:09:39.324625 [info ] [MainThread]: 
[0m08:09:39.324889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:09:39.327591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m08:09:39.327892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m08:09:39.365589 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m08:09:39.365928 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m08:09:39.366122 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */;
[0m08:09:39.366323 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */;
[0m08:09:39.366494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:39.366651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:40.246977 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.880 seconds
[0m08:09:40.286352 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.920 seconds
[0m08:09:40.292433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6764c1-9c00-41cb-a4f4-bd09cf8167ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c7610>]}
[0m08:09:40.296843 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:09:40.297270 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m08:09:40.297662 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m08:09:40.298006 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m08:09:40.298382 [info ] [Thread-2 (]: 1 of 12 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ........... [RUN]
[0m08:09:40.298821 [info ] [Thread-3 (]: 2 of 12 START test not_null_mart_product_kpi_avg_rating ........................ [RUN]
[0m08:09:40.299220 [info ] [Thread-4 (]: 3 of 12 START test not_null_mart_product_kpi_first_review_date ................. [RUN]
[0m08:09:40.299651 [info ] [Thread-5 (]: 4 of 12 START test not_null_mart_product_kpi_product_id ........................ [RUN]
[0m08:09:40.300122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m08:09:40.300535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7)
[0m08:09:40.301025 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc'
[0m08:09:40.301479 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527'
[0m08:09:40.301832 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:09:40.302170 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m08:09:40.302493 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m08:09:40.302813 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m08:09:40.319179 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:09:40.327594 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"
[0m08:09:40.331479 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"
[0m08:09:40.335121 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"
[0m08:09:40.335961 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:09:40.336305 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m08:09:40.353814 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:09:40.355966 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"
[0m08:09:40.356223 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m08:09:40.356449 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m08:09:40.359110 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"
[0m08:09:40.361010 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"
[0m08:09:40.361619 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"
[0m08:09:40.362166 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:09:40.362465 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where avg_rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"} */
[0m08:09:40.362791 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
[0m08:09:40.363391 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"
[0m08:09:40.363815 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"
[0m08:09:40.364396 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_review_date
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where first_review_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"} */
[0m08:09:40.365104 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"} */
[0m08:09:40.365649 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:09:40.366287 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m08:09:40.646377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m08:09:40.654670 [info ] [Thread-2 (]: 1 of 12 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 ................. [[32mPASS[0m in 0.35s]
[0m08:09:40.655173 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:09:40.655483 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m08:09:40.655840 [info ] [Thread-2 (]: 5 of 12 START test not_null_mart_product_kpi_review_count ...................... [RUN]
[0m08:09:40.656210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca)
[0m08:09:40.656508 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m08:09:40.659818 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"
[0m08:09:40.660354 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m08:09:40.662349 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"
[0m08:09:40.663043 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"
[0m08:09:40.663308 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_count
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where review_count is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"} */
[0m08:09:40.867870 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m08:09:40.872378 [info ] [Thread-3 (]: 2 of 12 PASS not_null_mart_product_kpi_avg_rating .............................. [[32mPASS[0m in 0.57s]
[0m08:09:40.873107 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m08:09:40.873500 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:09:40.873964 [info ] [Thread-3 (]: 6 of 12 START test not_null_stg_meta_product_id ................................ [RUN]
[0m08:09:40.874464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m08:09:40.874841 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:09:40.879534 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:09:40.880679 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:09:40.884707 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:09:40.885973 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:09:40.886346 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
[0m08:09:40.899832 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m08:09:40.900535 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m08:09:40.902597 [info ] [Thread-4 (]: 3 of 12 PASS not_null_mart_product_kpi_first_review_date ....................... [[32mPASS[0m in 0.60s]
[0m08:09:40.904208 [info ] [Thread-5 (]: 4 of 12 PASS not_null_mart_product_kpi_product_id .............................. [[32mPASS[0m in 0.60s]
[0m08:09:40.904740 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m08:09:40.905207 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m08:09:40.905568 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:09:40.905993 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:09:40.906401 [info ] [Thread-4 (]: 7 of 12 START test not_null_stg_reviews_product_id ............................. [RUN]
[0m08:09:40.906761 [info ] [Thread-5 (]: 8 of 12 START test not_null_stg_reviews_rating ................................. [RUN]
[0m08:09:40.907142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m08:09:40.907488 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m08:09:40.907818 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:09:40.908120 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:09:40.912505 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:09:40.916535 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:09:40.917342 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:09:40.920009 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:09:40.920311 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:09:40.922767 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:09:40.923611 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:09:40.923983 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
[0m08:09:40.925000 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:09:40.925559 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
[0m08:09:40.981430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m08:09:40.983428 [info ] [Thread-2 (]: 5 of 12 PASS not_null_mart_product_kpi_review_count ............................ [[32mPASS[0m in 0.33s]
[0m08:09:40.983980 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m08:09:40.984356 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:09:40.984763 [info ] [Thread-2 (]: 9 of 12 START test not_null_stg_reviews_review_id .............................. [RUN]
[0m08:09:40.985199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m08:09:40.985551 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:09:40.990933 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:09:40.991635 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:09:40.994312 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:09:40.995229 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:09:40.995536 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
[0m08:09:41.042832 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m08:09:41.044333 [info ] [Thread-3 (]: 6 of 12 PASS not_null_stg_meta_product_id ...................................... [[32mPASS[0m in 0.17s]
[0m08:09:41.044726 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:09:41.044984 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m08:09:41.045453 [info ] [Thread-3 (]: 10 of 12 START test unique_mart_product_kpi_product_id ......................... [RUN]
[0m08:09:41.046195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055)
[0m08:09:41.046777 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m08:09:41.053321 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"
[0m08:09:41.054084 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m08:09:41.056913 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"
[0m08:09:41.058025 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"
[0m08:09:41.058398 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"} */
[0m08:09:41.060378 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m08:09:41.062439 [info ] [Thread-5 (]: 8 of 12 PASS not_null_stg_reviews_rating ....................................... [[32mPASS[0m in 0.15s]
[0m08:09:41.063379 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:09:41.063857 [debug] [Thread-5 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:09:41.064248 [info ] [Thread-5 (]: 11 of 12 START test unique_stg_meta_product_id ................................. [RUN]
[0m08:09:41.064653 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m08:09:41.064984 [debug] [Thread-5 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:09:41.069106 [debug] [Thread-5 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m08:09:41.069824 [debug] [Thread-5 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:09:41.072637 [debug] [Thread-5 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m08:09:41.073647 [debug] [Thread-5 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m08:09:41.074015 [debug] [Thread-5 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
[0m08:09:41.090428 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m08:09:41.092110 [info ] [Thread-2 (]: 9 of 12 PASS not_null_stg_reviews_review_id .................................... [[32mPASS[0m in 0.11s]
[0m08:09:41.092639 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:09:41.092943 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:09:41.093248 [info ] [Thread-2 (]: 12 of 12 START test unique_stg_reviews_review_id ............................... [RUN]
[0m08:09:41.093544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m08:09:41.093777 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:09:41.097491 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:09:41.098312 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:09:41.100369 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:09:41.101083 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:09:41.101341 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
[0m08:09:41.155197 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m08:09:41.156519 [info ] [Thread-4 (]: 7 of 12 PASS not_null_stg_reviews_product_id ................................... [[32mPASS[0m in 0.25s]
[0m08:09:41.156836 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:09:41.170408 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m08:09:41.171388 [info ] [Thread-5 (]: 11 of 12 PASS unique_stg_meta_product_id ....................................... [[32mPASS[0m in 0.11s]
[0m08:09:41.171695 [debug] [Thread-5 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m08:09:41.210269 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m08:09:41.211512 [info ] [Thread-3 (]: 10 of 12 PASS unique_mart_product_kpi_product_id ............................... [[32mPASS[0m in 0.17s]
[0m08:09:41.211842 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m08:09:41.217374 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m08:09:41.219278 [info ] [Thread-2 (]: 12 of 12 PASS unique_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.13s]
[0m08:09:41.219605 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:09:41.220314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:09:41.220483 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was left open.
[0m08:09:41.220638 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m08:09:41.284699 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055' was left open.
[0m08:09:41.285746 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055: Close
[0m08:09:41.366266 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was left open.
[0m08:09:41.367540 [debug] [MainThread]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m08:09:41.480299 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was left open.
[0m08:09:41.481621 [debug] [MainThread]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m08:09:41.556835 [info ] [MainThread]: 
[0m08:09:41.557435 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m08:09:41.560081 [debug] [MainThread]: Command end result
[0m08:09:41.590605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/manifest.json
[0m08:09:41.592453 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/semantic_manifest.json
[0m08:09:41.599944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/elham/neueFische/Capstone Project/capstone-amazon-review-analytics/dbt/target/run_results.json
[0m08:09:41.600296 [info ] [MainThread]: 
[0m08:09:41.600649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:09:41.600935 [info ] [MainThread]: 
[0m08:09:41.601221 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m08:09:41.601706 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:09:41.604379 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.167307, "process_in_blocks": "0", "process_kernel_time": 0.27814, "process_mem_max_rss": "173588480", "process_out_blocks": "0", "process_user_time": 2.297755}
[0m08:09:41.604752 [debug] [MainThread]: Command `dbt test` succeeded at 08:09:41.604684 after 3.17 seconds
[0m08:09:41.605056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085aaec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d108e0>]}
[0m08:09:41.605373 [debug] [MainThread]: Flushing usage events
[0m08:09:42.125938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:33.747172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87515f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87515f30>]}


============================== 11:54:33.759061 | 8aea4737-7257-4af2-aeaf-98906467f60d ==============================
[0m11:54:33.759061 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:54:33.759704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:33.835301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aea4737-7257-4af2-aeaf-98906467f60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897ca6b0>]}
[0m11:54:33.855755 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:54:33.857244 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:54:33.858062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13880304, "process_user_time": 1.138982, "process_kernel_time": 0.230401, "process_mem_max_rss": "97764", "process_in_blocks": "8640", "process_out_blocks": "3435"}
[0m11:54:33.858500 [debug] [MainThread]: Command `dbt deps` succeeded at 11:54:33.858433 after 0.14 seconds
[0m11:54:33.858839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87512890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874d57b0>]}
[0m11:54:33.859167 [debug] [MainThread]: Flushing usage events
[0m12:12:29.349478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886b1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86245ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86245e40>]}


============================== 12:12:29.361076 | b793f0c2-9086-45ee-93f1-a25f238deb48 ==============================
[0m12:12:29.361076 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:12:29.361563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:12:29.431296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b793f0c2-9086-45ee-93f1-a25f238deb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865eb490>]}
[0m12:12:29.450792 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:12:29.452640 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:12:29.453452 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13218704, "process_user_time": 1.143303, "process_kernel_time": 0.205694, "process_mem_max_rss": "97632", "process_out_blocks": "3435", "process_in_blocks": "0"}
[0m12:12:29.453890 [debug] [MainThread]: Command `dbt deps` succeeded at 12:12:29.453834 after 0.13 seconds
[0m12:12:29.454210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886b1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86441480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86205540>]}
[0m12:12:29.454531 [debug] [MainThread]: Flushing usage events
[0m12:25:29.131655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbaf970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf29ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf29e70>]}


============================== 12:25:29.144577 | 1dbdc527-9f2d-4700-8f1e-a813b8928118 ==============================
[0m12:25:29.144577 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:25:29.145136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:29.213209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbdc527-9f2d-4700-8f1e-a813b8928118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0cfee0>]}
[0m12:25:29.234688 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:25:29.236363 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:25:29.237016 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13584517, "process_user_time": 1.140429, "process_kernel_time": 0.334713, "process_mem_max_rss": "97800", "process_out_blocks": "3435", "process_in_blocks": "0"}
[0m12:25:29.237374 [debug] [MainThread]: Command `dbt deps` succeeded at 12:25:29.237324 after 0.14 seconds
[0m12:25:29.237670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbaf970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd76950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd21540>]}
[0m12:25:29.237961 [debug] [MainThread]: Flushing usage events
[0m13:34:05.193624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae86ae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac92de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac92de10>]}


============================== 13:34:05.230845 | 0492d9fd-ef27-48f6-b7dc-1bc466734102 ==============================
[0m13:34:05.230845 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:34:05.231471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:34:05.319817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0492d9fd-ef27-48f6-b7dc-1bc466734102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf223eb0>]}
[0m13:34:05.348583 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:34:05.351078 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:34:05.351795 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1926515, "process_user_time": 1.202794, "process_kernel_time": 0.787137, "process_mem_max_rss": "97768", "process_out_blocks": "3435", "process_in_blocks": "0"}
[0m13:34:05.352235 [debug] [MainThread]: Command `dbt deps` succeeded at 13:34:05.352164 after 0.19 seconds
[0m13:34:05.352550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae86ae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc0c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac770c70>]}
[0m13:34:05.352855 [debug] [MainThread]: Flushing usage events
[0m14:15:27.145171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fff370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83729f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83729ea0>]}


============================== 14:15:27.181744 | 92ccd375-1f5c-49a0-a32b-4ba5f447a0b0 ==============================
[0m14:15:27.181744 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:15:27.182373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:27.306913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ccd375-1f5c-49a0-a32b-4ba5f447a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b1dc90>]}
[0m14:15:27.334898 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:15:27.336765 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:15:27.338695 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2239657, "process_user_time": 1.254123, "process_kernel_time": 1.496661, "process_mem_max_rss": "97672", "process_out_blocks": "3435", "process_in_blocks": "0"}
[0m14:15:27.339084 [debug] [MainThread]: Command `dbt deps` succeeded at 14:15:27.339032 after 0.22 seconds
[0m14:15:27.339423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fff370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83576920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83521930>]}
[0m14:15:27.339764 [debug] [MainThread]: Flushing usage events
[0m14:37:53.615473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814603a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f856230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f856140>]}


============================== 14:37:53.619706 | 0a28c031-7ddc-4fe4-b034-6eb5324046fd ==============================
[0m14:37:53.619706 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:37:53.620276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m14:37:55.784693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6512dc00>]}
[0m14:37:55.821119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe35cc0>]}
[0m14:37:55.821974 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m14:37:55.915057 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:37:56.017898 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:37:56.018717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e014b0>]}
[0m14:37:56.621511 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:37:56.622089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64b23460>]}
[0m14:37:56.894260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f7749a0>]}
[0m14:37:56.972363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fab5a80>]}
[0m14:37:56.972935 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m14:37:56.973521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a28c031-7ddc-4fe4-b034-6eb5324046fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fab7310>]}
[0m14:37:56.975096 [info ] [MainThread]: 
[0m14:37:56.975781 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:37:56.979009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m14:37:56.988689 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m14:37:56.989087 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m14:37:56.989363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:56.990239 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m14:37:56.990513 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:37:56.990785 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m14:37:56.991025 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:37:56.991333 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m14:37:56.992132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:56.992404 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m14:37:56.992638 [info ] [MainThread]: 
[0m14:37:56.992915 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:37:56.993377 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AMAZON_REVIEW_ANALYTICS_DEV"
  Database Error
    [Errno 2] No such file or directory: '/run/secrets/dbt_svc_private_key.pem'
[0m14:37:56.994254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4139614, "process_user_time": 3.759217, "process_kernel_time": 1.663272, "process_mem_max_rss": "195704", "process_in_blocks": "1736", "process_out_blocks": "17338", "command_success": false}
[0m14:37:56.994677 [debug] [MainThread]: Command `dbt run` failed at 14:37:56.994612 after 3.41 seconds
[0m14:37:56.994943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814603a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fab76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fac9780>]}
[0m14:37:56.995245 [debug] [MainThread]: Flushing usage events
[0m15:38:30.046419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa550b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa310e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa310e0e0>]}


============================== 15:38:30.061893 | 3a5256bd-9e3a-4bbc-b5df-21c619456555 ==============================
[0m15:38:30.061893 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:38:30.062366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m15:38:31.850061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a5256bd-9e3a-4bbc-b5df-21c619456555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b68610>]}
[0m15:38:31.879318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a5256bd-9e3a-4bbc-b5df-21c619456555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa362f160>]}
[0m15:38:31.879948 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:38:31.964056 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:38:32.089674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:32.090116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:32.122533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a5256bd-9e3a-4bbc-b5df-21c619456555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e929b0>]}
[0m15:38:32.238020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a5256bd-9e3a-4bbc-b5df-21c619456555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8350c640>]}
[0m15:38:32.238693 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m15:38:32.239104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a5256bd-9e3a-4bbc-b5df-21c619456555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8350cca0>]}
[0m15:38:32.240626 [info ] [MainThread]: 
[0m15:38:32.241163 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:32.244807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m15:38:32.257525 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m15:38:32.257902 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m15:38:32.258153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:32.258551 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m15:38:32.258850 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:32.259100 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:38:32.259341 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:32.259613 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m15:38:32.259993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:32.260285 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m15:38:32.260526 [info ] [MainThread]: 
[0m15:38:32.260818 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m15:38:32.261298 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AMAZON_REVIEW_ANALYTICS_DEV"
  Database Error
    [Errno 2] No such file or directory: '/run/secrets/dbt_svc_private_key.pem'
[0m15:38:32.262610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2468426, "process_user_time": 3.045278, "process_kernel_time": 1.756621, "process_mem_max_rss": "190424", "process_out_blocks": "19870", "command_success": false, "process_in_blocks": "0"}
[0m15:38:32.263163 [debug] [MainThread]: Command `dbt run` failed at 15:38:32.263094 after 2.25 seconds
[0m15:38:32.263462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa550b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8350cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834ca710>]}
[0m15:38:32.263746 [debug] [MainThread]: Flushing usage events
[0m15:45:11.208830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2124370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0526200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05261a0>]}


============================== 15:45:11.216137 | f89cd794-9e5f-4333-8a69-4d7bf472ecb7 ==============================
[0m15:45:11.216137 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:45:11.216714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:11.852689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f89cd794-9e5f-4333-8a69-4d7bf472ecb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cbbbb0>]}
[0m15:45:11.881183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f89cd794-9e5f-4333-8a69-4d7bf472ecb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb088ae90>]}
[0m15:45:11.881793 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:45:11.953193 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:45:12.136115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:12.136652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:12.172734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f89cd794-9e5f-4333-8a69-4d7bf472ecb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948a9990>]}
[0m15:45:12.256030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f89cd794-9e5f-4333-8a69-4d7bf472ecb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94eec7c0>]}
[0m15:45:12.256580 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m15:45:12.257018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f89cd794-9e5f-4333-8a69-4d7bf472ecb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0526140>]}
[0m15:45:12.258576 [info ] [MainThread]: 
[0m15:45:12.259124 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:12.262649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m15:45:12.272201 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m15:45:12.272624 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m15:45:12.272863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:12.276193 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m15:45:12.276616 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:45:12.276904 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:45:12.277145 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:45:12.277452 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m15:45:12.277914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:12.278263 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m15:45:12.278527 [info ] [MainThread]: 
[0m15:45:12.278864 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m15:45:12.279437 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AMAZON_REVIEW_ANALYTICS_DEV"
  Database Error
    [Errno 2] No such file or directory: '/secrets/dbt_svc_private_key.pem'
[0m15:45:12.280370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1038224, "process_user_time": 2.455658, "process_kernel_time": 0.497713, "process_mem_max_rss": "188604", "process_out_blocks": "1022", "command_success": false, "process_in_blocks": "0"}
[0m15:45:12.280873 [debug] [MainThread]: Command `dbt run` failed at 15:45:12.280801 after 1.10 seconds
[0m15:45:12.281189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2124370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94866aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948ccfa0>]}
[0m15:45:12.281486 [debug] [MainThread]: Flushing usage events
[0m15:46:28.388468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b688310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a3a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a3a140>]}


============================== 15:46:28.392693 | a4f49e8f-8397-4ac3-8dc1-344378073625 ==============================
[0m15:46:28.392693 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:46:28.393467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:46:28.898035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a452e30>]}
[0m15:46:28.926033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b67760>]}
[0m15:46:28.926619 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m15:46:28.983670 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:46:29.109413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:29.109823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:29.138153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e0d930>]}
[0m15:46:29.209846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e1a0b0>]}
[0m15:46:29.210313 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m15:46:29.210673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e18460>]}
[0m15:46:29.212078 [info ] [MainThread]: 
[0m15:46:29.212741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:46:29.215979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m15:46:29.225914 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m15:46:29.226371 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m15:46:29.226658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:30.419164 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.192 seconds
[0m15:46:30.422728 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m15:46:30.554112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m15:46:30.555762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m15:46:30.566558 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m15:46:30.569242 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m15:46:30.569856 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m15:46:30.570349 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m15:46:30.570884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:30.571338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:31.089988 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.519 seconds
[0m15:46:31.092639 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m15:46:31.091080 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.520 seconds
[0m15:46:31.096003 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m15:46:31.172903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b78c8e0>]}
[0m15:46:31.173685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:31.174160 [info ] [MainThread]: 
[0m15:46:31.181532 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m15:46:31.182067 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m15:46:31.182577 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m15:46:31.183256 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m15:46:31.183900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m15:46:31.184666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m15:46:31.185200 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m15:46:31.185827 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m15:46:31.193907 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m15:46:31.197785 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m15:46:31.201371 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m15:46:31.223691 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m15:46:31.226392 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m15:46:31.229910 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m15:46:31.244359 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m15:46:31.245768 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m15:46:31.247005 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m15:46:31.247923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:31.247605 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m15:46:31.248413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:31.916470 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m15:46:31.918762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m15:46:31.954617 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m15:46:31.955621 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m15:46:32.021640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78915c90>]}
[0m15:46:32.022633 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.84s]
[0m15:46:32.023775 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m15:46:32.038112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f49e8f-8397-4ac3-8dc1-344378073625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79361f30>]}
[0m15:46:32.038925 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.85s]
[0m15:46:32.039713 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m15:46:32.041596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:32.042168 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m15:46:32.042619 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m15:46:32.043255 [info ] [MainThread]: 
[0m15:46:32.043806 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m15:46:32.045029 [debug] [MainThread]: Command end result
[0m15:46:32.085005 [info ] [MainThread]: 
[0m15:46:32.085803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:32.086234 [info ] [MainThread]: 
[0m15:46:32.086703 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:46:32.088067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7027283, "process_user_time": 3.187265, "process_kernel_time": 0.35369, "process_mem_max_rss": "198264", "process_in_blocks": "1528", "process_out_blocks": "4177"}
[0m15:46:32.088692 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:32.088596 after 3.70 seconds
[0m15:46:32.089228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b688310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a01f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a452e30>]}
[0m15:46:32.089710 [debug] [MainThread]: Flushing usage events
[0m16:00:07.024639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8351c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8191e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8191e1a0>]}


============================== 16:00:07.029231 | df8096c8-f230-4b4b-a84d-fea9b5fc566a ==============================
[0m16:00:07.029231 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:07.030003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:07.616659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8353fa60>]}
[0m16:00:07.647929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff622801c0>]}
[0m16:00:07.648694 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:00:07.709115 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:00:07.856410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:07.856796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:07.884873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61c719f0>]}
[0m16:00:07.956543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62256f50>]}
[0m16:00:07.957010 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:00:07.957582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62256d70>]}
[0m16:00:07.959232 [info ] [MainThread]: 
[0m16:00:07.959769 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:07.963461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:00:07.972537 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:00:07.972854 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:00:07.973112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:09.076430 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.103 seconds
[0m16:00:09.079132 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:00:09.258422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:00:09.259401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m16:00:09.268923 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:00:09.272047 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:00:09.272705 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:00:09.273254 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:00:09.273822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:09.274269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.124932 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.851 seconds
[0m16:00:11.129519 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:00:11.525813 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.251 seconds
[0m16:00:11.528603 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:00:11.671500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8195b670>]}
[0m16:00:11.672666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:11.673243 [info ] [MainThread]: 
[0m16:00:11.684188 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:00:11.684871 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:00:11.685225 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:00:11.686049 [info ] [Thread-1 (]: 1 of 5 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:00:11.686694 [info ] [Thread-2 (]: 2 of 5 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:00:11.687310 [info ] [Thread-3 (]: 3 of 5 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:00:11.687933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m16:00:11.688454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m16:00:11.688992 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:00:11.689435 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:00:11.689863 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:00:11.690274 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:00:11.697002 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:00:11.698999 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:00:11.701984 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:00:11.704335 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:00:11.724724 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:00:11.725466 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:00:11.725826 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:00:11.729011 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:00:11.731330 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:00:11.732059 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:00:11.733127 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:00:11.733816 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:00:11.734055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:11.734546 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:00:11.734827 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:00:11.735325 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:00:11.739631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:11.740053 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:00:13.413843 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.673 seconds
[0m16:00:13.449121 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.709 seconds
[0m16:00:13.455762 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:00:13.458369 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:00:13.557278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b1b0a0>]}
[0m16:00:13.560691 [info ] [Thread-2 (]: 2 of 5 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m16:00:13.562566 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:00:13.601440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61afd9c0>]}
[0m16:00:13.602447 [info ] [Thread-3 (]: 3 of 5 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.91s]
[0m16:00:13.603600 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:00:13.605538 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:00:13.606397 [info ] [Thread-4 (]: 4 of 5 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:00:13.607325 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m16:00:13.608160 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:00:13.616088 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:00:13.621723 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:00:13.628570 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:00:13.631248 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:00:13.631756 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:00:13.632490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:14.502550 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m16:00:14.508471 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:00:14.916508 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b1b1f0>]}
[0m16:00:14.918349 [info ] [Thread-4 (]: 4 of 5 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.31s]
[0m16:00:14.919493 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:00:15.093409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.359 seconds
[0m16:00:15.098963 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:00:15.224189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b1b610>]}
[0m16:00:15.226260 [info ] [Thread-1 (]: 1 of 5 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 3.54s]
[0m16:00:15.227449 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:00:15.229231 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:00:15.230169 [info ] [Thread-3 (]: 5 of 5 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:00:15.231086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:00:15.232392 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:00:15.239302 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:00:15.241915 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:00:15.245702 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:00:15.248445 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:00:15.249024 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:00:15.249584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:21.105623 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.855 seconds
[0m16:00:21.112194 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:00:21.756003 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df8096c8-f230-4b4b-a84d-fea9b5fc566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff622e36d0>]}
[0m16:00:21.757518 [info ] [Thread-3 (]: 5 of 5 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 6.52s]
[0m16:00:21.758855 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:00:21.762622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:21.763392 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:00:21.763979 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:00:21.764514 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:00:21.765087 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:00:21.766859 [info ] [MainThread]: 
[0m16:00:21.767881 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.81 seconds (13.81s).
[0m16:00:21.770725 [debug] [MainThread]: Command end result
[0m16:00:21.815451 [info ] [MainThread]: 
[0m16:00:21.816593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:21.817141 [info ] [MainThread]: 
[0m16:00:21.818180 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:00:21.821229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.826041, "process_user_time": 3.560765, "process_kernel_time": 0.731443, "process_mem_max_rss": "199380", "process_out_blocks": "2049", "process_in_blocks": "0"}
[0m16:00:21.822168 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:21.822069 after 14.83 seconds
[0m16:00:21.822797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8351c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff622801c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62256f50>]}
[0m16:00:21.823136 [debug] [MainThread]: Flushing usage events
[0m16:00:47.077335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21303d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb053e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb053e170>]}


============================== 16:00:47.080965 | dc05c5b1-d8e7-4b51-acd5-e16f6479fb83 ==============================
[0m16:00:47.080965 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:47.081505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:47.580174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc05c5b1-d8e7-4b51-acd5-e16f6479fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cc7bb0>]}
[0m16:00:47.608359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc05c5b1-d8e7-4b51-acd5-e16f6479fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08a3700>]}
[0m16:00:47.608941 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:00:47.667377 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:00:47.792167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:47.792543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:47.820754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc05c5b1-d8e7-4b51-acd5-e16f6479fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948b1990>]}
[0m16:00:47.920446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc05c5b1-d8e7-4b51-acd5-e16f6479fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948e0f70>]}
[0m16:00:47.920922 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:00:47.921249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc05c5b1-d8e7-4b51-acd5-e16f6479fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9487c310>]}
[0m16:00:47.922666 [info ] [MainThread]: 
[0m16:00:47.923248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:47.926655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m16:00:47.927134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m16:00:47.937278 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:00:47.939427 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:00:47.939757 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:00:47.940072 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:00:47.940365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:47.940694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:48.724274 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.783 seconds
[0m16:00:48.728570 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:00:48.751252 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.811 seconds
[0m16:00:48.754831 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:00:48.845975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc05c5b1-d8e7-4b51-acd5-e16f6479fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948e33d0>]}
[0m16:00:48.847425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:48.848674 [info ] [MainThread]: 
[0m16:00:48.861367 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m16:00:48.861966 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m16:00:48.862434 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m16:00:48.862987 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m16:00:48.863688 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ........... [RUN]
[0m16:00:48.864566 [info ] [Thread-2 (]: 2 of 12 START test not_null_mart_product_kpi_avg_rating ........................ [RUN]
[0m16:00:48.865301 [info ] [Thread-3 (]: 3 of 12 START test not_null_mart_product_kpi_first_review_date ................. [RUN]
[0m16:00:48.866087 [info ] [Thread-4 (]: 4 of 12 START test not_null_mart_product_kpi_product_id ........................ [RUN]
[0m16:00:48.868942 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527'
[0m16:00:48.867563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7)
[0m16:00:48.868306 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc'
[0m16:00:48.866915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m16:00:48.869497 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m16:00:48.870075 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m16:00:48.870612 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m16:00:48.871143 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m16:00:48.892253 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"
[0m16:00:48.896294 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"
[0m16:00:48.900059 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"
[0m16:00:48.908826 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m16:00:48.913937 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m16:00:48.914421 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m16:00:48.933063 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m16:00:48.936021 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"
[0m16:00:48.939378 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m16:00:48.939872 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m16:00:48.942227 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"
[0m16:00:48.945738 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"
[0m16:00:48.949008 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"
[0m16:00:48.950252 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where product_id is null



      
    ) dbt_internal_test
[0m16:00:48.951801 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m16:00:48.952235 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:48.952711 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"
[0m16:00:48.953248 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"
[0m16:00:48.953563 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m16:00:48.954162 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_review_date
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where first_review_date is null



      
    ) dbt_internal_test
[0m16:00:48.957980 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where avg_rating is null



      
    ) dbt_internal_test
[0m16:00:48.958539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:48.958840 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:00:48.959349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:49.401384 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m16:00:49.429437 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7: Close
[0m16:00:49.431364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m16:00:49.437160 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m16:00:49.495549 [info ] [Thread-2 (]: 2 of 12 PASS not_null_mart_product_kpi_avg_rating .............................. [[32mPASS[0m in 0.63s]
[0m16:00:49.496573 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7
[0m16:00:49.497156 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m16:00:49.497787 [info ] [Thread-2 (]: 5 of 12 START test not_null_mart_product_kpi_review_count ...................... [RUN]
[0m16:00:49.498373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_avg_rating.a366154fa7, now test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca)
[0m16:00:49.501097 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m16:00:49.500761 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 ................. [[32mPASS[0m in 0.63s]
[0m16:00:49.507950 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m16:00:49.508421 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m16:00:49.507286 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"
[0m16:00:49.508984 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_meta_product_id ................................ [RUN]
[0m16:00:49.510112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c)
[0m16:00:49.510600 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m16:00:49.511014 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m16:00:49.514719 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m16:00:49.521418 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"
[0m16:00:49.524172 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m16:00:49.526706 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m16:00:49.527446 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"
[0m16:00:49.528090 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_count
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where review_count is null



      
    ) dbt_internal_test
[0m16:00:49.528596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:49.529319 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m16:00:49.531110 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m16:00:49.533816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:50.044144 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m16:00:50.048835 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc: Close
[0m16:00:50.057430 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m16:00:50.059976 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527: Close
[0m16:00:50.114719 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m16:00:50.118651 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca: Close
[0m16:00:50.121814 [info ] [Thread-3 (]: 3 of 12 PASS not_null_mart_product_kpi_first_review_date ....................... [[32mPASS[0m in 1.25s]
[0m16:00:50.123789 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc
[0m16:00:50.124454 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m16:00:50.125096 [info ] [Thread-3 (]: 7 of 12 START test not_null_stg_reviews_product_id ............................. [RUN]
[0m16:00:50.125902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_first_review_date.a236429dcc, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m16:00:50.126499 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m16:00:50.132196 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m16:00:50.135154 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m16:00:50.138723 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m16:00:50.140494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m16:00:50.142913 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m16:00:50.144479 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m16:00:50.146981 [info ] [Thread-4 (]: 4 of 12 PASS not_null_mart_product_kpi_product_id .............................. [[32mPASS[0m in 1.28s]
[0m16:00:50.149041 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m16:00:50.149899 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527
[0m16:00:50.150464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:50.152254 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m16:00:50.154189 [info ] [Thread-4 (]: 8 of 12 START test not_null_stg_reviews_rating ................................. [RUN]
[0m16:00:50.159990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_product_id.50259c1527, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m16:00:50.163871 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m16:00:50.168345 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m16:00:50.169419 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m16:00:50.171463 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m16:00:50.172671 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m16:00:50.172953 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m16:00:50.173270 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:50.193857 [info ] [Thread-2 (]: 5 of 12 PASS not_null_mart_product_kpi_review_count ............................ [[32mPASS[0m in 0.70s]
[0m16:00:50.194519 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca
[0m16:00:50.195961 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m16:00:50.197092 [info ] [Thread-2 (]: 9 of 12 START test not_null_stg_reviews_review_id .............................. [RUN]
[0m16:00:50.197605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_product_kpi_review_count.7d860a38ca, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m16:00:50.201217 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m16:00:50.207201 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m16:00:50.209988 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m16:00:50.211701 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m16:00:50.213448 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m16:00:50.213734 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m16:00:50.214015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:50.267319 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_meta_product_id ...................................... [[32mPASS[0m in 0.76s]
[0m16:00:50.269334 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m16:00:50.270761 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m16:00:50.274976 [info ] [Thread-1 (]: 10 of 12 START test unique_mart_product_kpi_product_id ......................... [RUN]
[0m16:00:50.275435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055)
[0m16:00:50.277100 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m16:00:50.282957 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"
[0m16:00:50.284530 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m16:00:50.286343 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"
[0m16:00:50.287334 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"
[0m16:00:50.287662 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:00:50.287959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:50.631542 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m16:00:50.633860 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m16:00:50.715933 [info ] [Thread-3 (]: 7 of 12 PASS not_null_stg_reviews_product_id ................................... [[32mPASS[0m in 0.59s]
[0m16:00:50.717283 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m16:00:50.717949 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m16:00:50.718497 [info ] [Thread-3 (]: 11 of 12 START test unique_stg_meta_product_id ................................. [RUN]
[0m16:00:50.719680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m16:00:50.720583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m16:00:50.721099 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m16:00:50.723089 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055: Close
[0m16:00:50.728537 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m16:00:50.734286 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m16:00:50.737717 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m16:00:50.739463 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m16:00:50.739863 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:00:50.740188 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:00:50.781286 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m16:00:50.784251 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m16:00:50.826372 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m16:00:50.829994 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m16:00:50.840666 [info ] [Thread-1 (]: 10 of 12 PASS unique_mart_product_kpi_product_id ............................... [[32mPASS[0m in 0.57s]
[0m16:00:50.841992 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055
[0m16:00:50.842424 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m16:00:50.842923 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_reviews_review_id ............................... [RUN]
[0m16:00:50.843528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_mart_product_kpi_product_id.526f55f055, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m16:00:50.843994 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m16:00:50.847612 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m16:00:50.849200 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m16:00:50.851278 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m16:00:50.853176 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m16:00:50.853869 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:00:50.854237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:50.858003 [info ] [Thread-4 (]: 8 of 12 PASS not_null_stg_reviews_rating ....................................... [[32mPASS[0m in 0.70s]
[0m16:00:50.864920 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m16:00:50.943897 [info ] [Thread-2 (]: 9 of 12 PASS not_null_stg_reviews_review_id .................................... [[32mPASS[0m in 0.75s]
[0m16:00:50.944988 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m16:00:51.202177 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m16:00:51.207634 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m16:00:51.385578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m16:00:51.389357 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m16:00:51.447843 [info ] [Thread-3 (]: 11 of 12 PASS unique_stg_meta_product_id ....................................... [[32mPASS[0m in 0.73s]
[0m16:00:51.450417 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m16:00:51.465026 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.62s]
[0m16:00:51.465878 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m16:00:51.468812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:51.469368 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m16:00:51.469659 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m16:00:51.469951 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was properly closed.
[0m16:00:51.470215 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m16:00:51.470670 [info ] [MainThread]: 
[0m16:00:51.471242 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m16:00:51.473087 [debug] [MainThread]: Command end result
[0m16:00:51.519978 [info ] [MainThread]: 
[0m16:00:51.520940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:51.521502 [info ] [MainThread]: 
[0m16:00:51.522126 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m16:00:51.528266 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.482831, "process_user_time": 4.061284, "process_kernel_time": 0.442994, "process_mem_max_rss": "201960", "process_out_blocks": "2097", "process_in_blocks": "0"}
[0m16:00:51.530420 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:51.530232 after 4.49 seconds
[0m16:00:51.531561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21303d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cebf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9487c670>]}
[0m16:00:51.532228 [debug] [MainThread]: Flushing usage events
[0m16:16:27.013123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a08dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96132050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96131ff0>]}


============================== 16:16:27.070391 | a5b03e30-50e9-4e85-85de-a99feaf6b796 ==============================
[0m16:16:27.070391 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:16:27.070865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:29.396645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5ff310>]}
[0m16:16:29.428380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fe7c40>]}
[0m16:16:29.429148 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:16:29.506963 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:16:29.650804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:29.651230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:29.687043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76db1390>]}
[0m16:16:29.804743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76514280>]}
[0m16:16:29.805199 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:16:29.805528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765142b0>]}
[0m16:16:29.806762 [info ] [MainThread]: 
[0m16:16:29.807263 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:29.810556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:16:29.811088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:16:29.820217 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:16:29.821883 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:16:29.822204 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:16:29.822529 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:16:29.822846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:29.823174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:31.016115 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.192 seconds
[0m16:16:31.028873 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:16:31.117268 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.294 seconds
[0m16:16:31.122584 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:16:31.221514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:16:31.222844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:16:31.233196 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:16:31.236194 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:16:31.236856 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:16:31.237394 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:16:31.237928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:31.238385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:31.667779 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.430 seconds
[0m16:16:31.673589 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:16:31.671262 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.433 seconds
[0m16:16:31.677907 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:16:31.791442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff764f20b0>]}
[0m16:16:31.792637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:31.793366 [info ] [MainThread]: 
[0m16:16:31.803472 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:16:31.804383 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:16:31.805188 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:16:31.806050 [info ] [Thread-2 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:16:31.806794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m16:16:31.807470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m16:16:31.808452 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:16:31.809135 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:16:31.818096 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:16:31.821193 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:16:31.823451 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:16:31.824023 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:16:31.848989 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:16:31.851640 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:16:31.853717 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:16:31.854841 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:16:31.855239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:31.854537 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:16:31.855754 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:16:31.858957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:16:32.418061 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m16:16:32.445382 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:16:32.543549 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b506d0>]}
[0m16:16:32.544652 [info ] [Thread-2 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.73s]
[0m16:16:32.546306 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:16:32.547827 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:16:32.548363 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:16:32.549094 [info ] [Thread-4 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:16:32.550741 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m16:16:32.551292 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:16:32.549893 [info ] [Thread-3 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:16:32.555595 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:16:32.556133 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:16:32.554900 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:16:32.559154 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:16:32.561147 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:16:32.561707 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:16:32.585906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m16:16:32.586692 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:16:32.589454 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:16:32.592027 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:16:32.595748 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:16:32.596889 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:16:32.597313 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:16:32.596560 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:16:32.597884 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:16:32.599152 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:16:32.649457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7597d630>]}
[0m16:16:32.652179 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.84s]
[0m16:16:32.652655 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:16:32.653228 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:16:32.654114 [info ] [Thread-2 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:16:32.655095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m16:16:32.656054 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:16:32.657989 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:16:32.662758 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:16:32.665347 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:16:32.668791 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:16:32.669128 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:16:32.669472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:16:33.914508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m16:16:33.922695 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:16:34.041760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff759ed120>]}
[0m16:16:34.044202 [info ] [Thread-3 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.49s]
[0m16:16:34.045522 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:16:34.047344 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:16:34.048133 [info ] [Thread-1 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:16:34.048945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m16:16:34.049543 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:16:34.054314 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:16:34.056081 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:16:34.059666 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:16:34.061572 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:16:34.062120 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:16:34.062610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:34.557623 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.888 seconds
[0m16:16:34.562639 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:16:34.637453 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.040 seconds
[0m16:16:34.642476 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:16:34.749905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75901d20>]}
[0m16:16:34.751412 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.20s]
[0m16:16:34.753323 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:16:34.773516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7597dcc0>]}
[0m16:16:34.774477 [info ] [Thread-2 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.12s]
[0m16:16:34.775247 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:16:34.776033 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:16:34.776714 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:16:34.777787 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:16:34.778415 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:16:34.782764 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:16:34.784384 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:16:34.788100 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:16:34.790671 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:16:34.791335 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:16:34.791852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:16:34.865224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m16:16:34.874463 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:16:34.958899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff759ed150>]}
[0m16:16:34.959690 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.91s]
[0m16:16:34.960332 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:16:36.011311 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.219 seconds
[0m16:16:36.015400 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:16:36.133884 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b03e30-50e9-4e85-85de-a99feaf6b796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5ffeb0>]}
[0m16:16:36.136534 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.36s]
[0m16:16:36.138406 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:16:36.140853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:36.141526 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:16:36.142057 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:16:36.142521 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:16:36.143155 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:16:36.143814 [info ] [MainThread]: 
[0m16:16:36.144443 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m16:16:36.146214 [debug] [MainThread]: Command end result
[0m16:16:36.192997 [info ] [MainThread]: 
[0m16:16:36.193593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:36.194042 [info ] [MainThread]: 
[0m16:16:36.194568 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:16:36.196693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.219374, "process_user_time": 5.282725, "process_kernel_time": 1.532942, "process_mem_max_rss": "205064", "process_out_blocks": "24941", "process_in_blocks": "0"}
[0m16:16:36.197552 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:36.197436 after 9.22 seconds
[0m16:16:36.198074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a08dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fe7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7593a1d0>]}
[0m16:16:36.198453 [debug] [MainThread]: Flushing usage events
[0m16:19:56.452361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840a43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8243a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8243a170>]}


============================== 16:19:56.459134 | 5963d113-6b88-4940-90f7-9a8acaa748ae ==============================
[0m16:19:56.459134 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:19:56.459577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:19:57.012028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62c33bb0>]}
[0m16:19:57.040172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827a3700>]}
[0m16:19:57.040749 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:19:57.102235 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:19:57.231450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:57.231840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:57.264563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62821990>]}
[0m16:19:57.337503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827a1780>]}
[0m16:19:57.337957 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:19:57.338407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827a1870>]}
[0m16:19:57.340009 [info ] [MainThread]: 
[0m16:19:57.340560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:19:57.343938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:19:57.344734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:19:57.353746 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:19:57.355340 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:19:57.355648 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:19:57.355973 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:19:57.356266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:57.356557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:57.882787 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.526 seconds
[0m16:19:57.884892 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:19:57.898242 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.542 seconds
[0m16:19:57.900173 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:19:58.010846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:19:58.011737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:19:58.018516 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:19:58.020407 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:19:58.020908 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:19:58.021270 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:19:58.021651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:58.021976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:58.380970 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.359 seconds
[0m16:19:58.384472 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:19:58.401409 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.379 seconds
[0m16:19:58.403398 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:19:58.527057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a54c10>]}
[0m16:19:58.528349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:19:58.529348 [info ] [MainThread]: 
[0m16:19:58.543469 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:19:58.544540 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:19:58.545222 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:19:58.546113 [info ] [Thread-3 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:19:58.546887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m16:19:58.547628 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.stg_reviews'
[0m16:19:58.548184 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:19:58.548819 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:19:58.558053 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:19:58.562805 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:19:58.564634 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:19:58.574209 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:19:58.596054 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:19:58.596510 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:19:58.597930 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:19:58.598338 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:19:58.599322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:58.599028 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:19:58.599834 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:19:58.602317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:19:59.685951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.086 seconds
[0m16:19:59.717676 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:19:59.798206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d73820>]}
[0m16:19:59.799360 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.25s]
[0m16:19:59.800725 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:19:59.802409 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:19:59.803255 [info ] [Thread-2 (]: 3 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:19:59.804022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m16:19:59.804663 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:19:59.809593 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:19:59.811347 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:19:59.837395 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:19:59.839246 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:19:59.839732 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:19:59.840232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:00.433717 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.831 seconds
[0m16:20:00.438266 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:20:00.568481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d73bb0>]}
[0m16:20:00.569971 [info ] [Thread-3 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 2.02s]
[0m16:20:00.572039 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:20:00.575121 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:20:00.575801 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:00.576765 [info ] [Thread-1 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:20:00.577635 [info ] [Thread-4 (]: 5 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:20:00.578520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.fct_reviews)
[0m16:20:00.583171 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:20:00.583966 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:20:00.584546 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:00.589324 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:20:00.592783 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:20:00.601136 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:20:00.601711 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:00.604844 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:20:00.608362 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:20:00.610791 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:20:00.611518 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:20:00.612898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:00.612349 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:20:00.613696 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:20:00.616307 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:01.947326 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.331 seconds
[0m16:20:01.952745 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:20:02.033282 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61316b30>]}
[0m16:20:02.036179 [info ] [Thread-4 (]: 5 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.45s]
[0m16:20:02.037840 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:02.039169 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:20:02.039927 [info ] [Thread-3 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:20:02.040696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_date)
[0m16:20:02.041269 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:20:02.046467 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:20:02.048216 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:20:02.052166 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:20:02.054090 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:20:02.054602 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:20:02.055057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:02.109378 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.269 seconds
[0m16:20:02.111571 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:20:02.206288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d73820>]}
[0m16:20:02.207056 [info ] [Thread-2 (]: 3 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.40s]
[0m16:20:02.207769 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:20:02.208471 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:02.208974 [info ] [Thread-4 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:20:02.209454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:20:02.209787 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:02.212214 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:20:02.213053 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:02.215197 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:20:02.216384 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:20:02.216725 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:20:02.217033 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:02.224936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.612 seconds
[0m16:20:02.228517 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:20:02.320406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61314850>]}
[0m16:20:02.321159 [info ] [Thread-1 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.74s]
[0m16:20:02.321875 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:20:02.908763 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m16:20:02.915418 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:20:02.985200 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a21c00>]}
[0m16:20:02.987414 [info ] [Thread-3 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.94s]
[0m16:20:02.988808 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:20:03.076041 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m16:20:03.081413 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:20:03.165471 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5963d113-6b88-4940-90f7-9a8acaa748ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d73820>]}
[0m16:20:03.166562 [info ] [Thread-4 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.96s]
[0m16:20:03.167652 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:03.172955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:03.173963 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:20:03.176375 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:20:03.176948 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:20:03.177371 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:20:03.178536 [info ] [MainThread]: 
[0m16:20:03.179969 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m16:20:03.184230 [debug] [MainThread]: Command end result
[0m16:20:03.230693 [info ] [MainThread]: 
[0m16:20:03.231307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:03.231709 [info ] [MainThread]: 
[0m16:20:03.232260 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:20:03.239641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8211083, "process_user_time": 3.891231, "process_kernel_time": 0.380003, "process_mem_max_rss": "199984", "process_out_blocks": "2068", "process_in_blocks": "0"}
[0m16:20:03.241732 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:03.241556 after 6.82 seconds
[0m16:20:03.242496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840a43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62e65000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825e1990>]}
[0m16:20:03.242931 [debug] [MainThread]: Flushing usage events
[0m16:20:06.349529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b50340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f4a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f49ff0>]}


============================== 16:20:06.352895 | ab73d180-439d-43c0-af13-2cc52e67b0fe ==============================
[0m16:20:06.352895 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:20:06.353462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:20:06.421886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab73d180-439d-43c0-af13-2cc52e67b0fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940f1420>]}
[0m16:20:06.432334 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:20:06.433507 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:20:06.434143 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11413588, "process_user_time": 0.993194, "process_kernel_time": 0.110132, "process_mem_max_rss": "93020", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m16:20:06.434538 [debug] [MainThread]: Command `dbt deps` succeeded at 16:20:06.434483 after 0.11 seconds
[0m16:20:06.434827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b50340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940f1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940f2950>]}
[0m16:20:06.435100 [debug] [MainThread]: Flushing usage events
[0m16:20:08.349685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f148340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d556170>]}


============================== 16:20:08.353003 | bf822c6f-1489-4744-b0da-cd9bf07d8890 ==============================
[0m16:20:08.353003 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:20:08.353571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/mart', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:08.905164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf822c6f-1489-4744-b0da-cd9bf07d8890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f177ee0>]}
[0m16:20:08.933087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf822c6f-1489-4744-b0da-cd9bf07d8890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6f8f70>]}
[0m16:20:08.933696 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:20:09.000006 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:20:09.265731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:09.266322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:09.299371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf822c6f-1489-4744-b0da-cd9bf07d8890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8a9960>]}
[0m16:20:09.384652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf822c6f-1489-4744-b0da-cd9bf07d8890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f160340>]}
[0m16:20:09.385245 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:20:09.385764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf822c6f-1489-4744-b0da-cd9bf07d8890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb8b280>]}
[0m16:20:09.387136 [warn ] [MainThread]: The selection criterion 'path:models/mart' does not match any enabled nodes
[0m16:20:09.388096 [info ] [MainThread]: 
[0m16:20:09.388431 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:20:09.389789 [debug] [MainThread]: Command end result
[0m16:20:09.412902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0913439, "process_user_time": 2.427488, "process_kernel_time": 0.204592, "process_mem_max_rss": "188388", "process_out_blocks": "1985", "process_in_blocks": "0"}
[0m16:20:09.413429 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:09.413361 after 1.09 seconds
[0m16:20:09.413791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f148340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db3a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f160340>]}
[0m16:20:09.414120 [debug] [MainThread]: Flushing usage events
[0m16:20:12.487441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bee8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2561a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a256140>]}


============================== 16:20:12.493749 | 9adc80df-cac2-49a3-af35-2f1701791dfa ==============================
[0m16:20:12.493749 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:20:12.494585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:12.979986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf17eb0>]}
[0m16:20:13.008417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9ad8a0>]}
[0m16:20:13.009053 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:20:13.072206 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:20:13.199523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:13.199994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:13.260297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a6a9930>]}
[0m16:20:13.355307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b929c90>]}
[0m16:20:13.355849 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:20:13.356334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf45d20>]}
[0m16:20:13.358086 [info ] [MainThread]: 
[0m16:20:13.358705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:13.362264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:20:13.362729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:20:13.371695 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:20:13.373261 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:20:13.373607 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:20:13.373933 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:20:13.374230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:13.374522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:13.779085 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.404 seconds
[0m16:20:13.781141 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:20:13.799678 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.425 seconds
[0m16:20:13.801383 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:20:13.879434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:20:13.882220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:20:13.892481 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:20:13.895182 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:20:13.895933 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:20:13.896659 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:20:13.897234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:13.897809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:14.324243 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.426 seconds
[0m16:20:14.328889 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:20:14.337969 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.441 seconds
[0m16:20:14.340011 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:20:14.448371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf45d20>]}
[0m16:20:14.449398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:14.450269 [info ] [MainThread]: 
[0m16:20:14.463813 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:20:14.464851 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:20:14.465671 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:20:14.466586 [info ] [Thread-2 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:20:14.467510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m16:20:14.468169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m16:20:14.468704 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:20:14.469295 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:20:14.478644 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:20:14.483052 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:20:14.484709 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:20:14.505030 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:20:14.510458 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:20:14.513137 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:20:14.514749 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:20:14.515217 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:20:14.516306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:14.515972 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:20:14.516904 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:20:14.520166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:15.153512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m16:20:15.154806 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m16:20:15.185948 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:20:15.187949 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:20:15.259544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a4db8b0>]}
[0m16:20:15.260707 [info ] [Thread-2 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m16:20:15.261765 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:20:15.262834 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:20:15.263422 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:15.264257 [info ] [Thread-4 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:20:15.265059 [info ] [Thread-3 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:20:15.265925 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m16:20:15.266729 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:20:15.267431 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:20:15.268047 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:15.271524 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:20:15.275618 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:20:15.277328 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:20:15.277708 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:15.296738 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:20:15.299376 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:20:15.300051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a53fe50>]}
[0m16:20:15.301258 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m16:20:15.302547 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:20:15.302012 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:20:15.303066 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:20:15.303656 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:20:15.304713 [info ] [Thread-2 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:20:15.304289 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:20:15.303921 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:20:15.305837 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:15.305519 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:20:15.305165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m16:20:15.311010 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:20:15.313947 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:20:15.314662 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:20:15.316608 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:20:15.317462 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:20:15.317763 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:20:15.318065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:16.177298 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.872 seconds
[0m16:20:16.181034 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:20:16.285974 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m16:20:16.289772 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:20:16.324529 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b37400>]}
[0m16:20:16.325795 [info ] [Thread-3 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.06s]
[0m16:20:16.326963 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:20:16.328581 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:20:16.329517 [info ] [Thread-1 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:20:16.330255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m16:20:16.330803 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:20:16.337341 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:20:16.339055 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:20:16.342478 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:20:16.345036 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:20:16.345640 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:20:16.346253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.420018 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b77f70>]}
[0m16:20:16.423352 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.15s]
[0m16:20:16.424078 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:20:16.999020 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.680 seconds
[0m16:20:17.005824 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:20:17.122521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a4e4670>]}
[0m16:20:17.124899 [info ] [Thread-2 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.82s]
[0m16:20:17.126012 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:20:17.127136 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:17.127906 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:20:17.128673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:20:17.129315 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:17.133419 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:20:17.134819 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:17.138692 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:20:17.140938 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:20:17.141556 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:20:17.142106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:17.196422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m16:20:17.199318 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:20:17.375140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b34910>]}
[0m16:20:17.376183 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.04s]
[0m16:20:17.377085 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:20:18.022429 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m16:20:18.029271 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:20:18.120211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adc80df-cac2-49a3-af35-2f1701791dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b84ee0>]}
[0m16:20:18.122877 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.99s]
[0m16:20:18.124303 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:20:18.126463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:18.127056 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:20:18.127558 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:20:18.128007 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:20:18.128478 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:20:18.129069 [info ] [MainThread]: 
[0m16:20:18.129615 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m16:20:18.131485 [debug] [MainThread]: Command end result
[0m16:20:18.175614 [info ] [MainThread]: 
[0m16:20:18.176323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:18.176746 [info ] [MainThread]: 
[0m16:20:18.177235 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:20:18.180158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.733811, "process_user_time": 3.878496, "process_kernel_time": 0.246986, "process_mem_max_rss": "199884", "process_out_blocks": "2069", "process_in_blocks": "0"}
[0m16:20:18.181612 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:18.181504 after 5.74 seconds
[0m16:20:18.182402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b129960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9ad8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b92b220>]}
[0m16:20:18.183098 [debug] [MainThread]: Flushing usage events
[0m16:23:28.199270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c0a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93946110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939460b0>]}


============================== 16:23:28.215282 | a9496e53-954c-457d-9a0b-fea9aeaefecc ==============================
[0m16:23:28.215282 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:23:28.215819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:30.202018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9496e53-954c-457d-9a0b-fea9aeaefecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a0f6a0>]}
[0m16:23:30.232973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9496e53-954c-457d-9a0b-fea9aeaefecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79410e50>]}
[0m16:23:30.233753 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:23:30.316875 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:23:30.422246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:30.422805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:30.454635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9496e53-954c-457d-9a0b-fea9aeaefecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff782ebc40>]}
[0m16:23:30.592584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9496e53-954c-457d-9a0b-fea9aeaefecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7982c6a0>]}
[0m16:23:30.593293 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:23:30.593634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9496e53-954c-457d-9a0b-fea9aeaefecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7982d120>]}
[0m16:23:30.597077 [info ] [MainThread]: 
[0m16:23:30.597658 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:30.601562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:23:30.602122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:23:30.613095 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:23:30.616791 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:30.617351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:30.617993 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:30.618522 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:30.619165 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:23:30.619757 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:30.620424 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m16:23:30.616035 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:23:30.621375 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:30.621623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:30.621966 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:30.622247 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:30.622576 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:23:30.622860 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:30.623167 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m16:23:30.623662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:30.623947 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m16:23:30.624171 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m16:23:30.624479 [info ] [MainThread]: 
[0m16:23:30.624885 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m16:23:30.625350 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AMAZON_REVIEW_ANALYTICS_DEV"
  Database Error
    [Errno 2] No such file or directory: '/run/secrets/dbt_svc_private_key.pem'
[0m16:23:30.626635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.45768, "process_user_time": 3.556574, "process_kernel_time": 0.620273, "process_mem_max_rss": "190796", "process_out_blocks": "19816", "command_success": false, "process_in_blocks": "0"}
[0m16:23:30.627276 [debug] [MainThread]: Command `dbt run` failed at 16:23:30.627168 after 2.46 seconds
[0m16:23:30.627670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c0a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79267580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c8aec0>]}
[0m16:23:30.628001 [debug] [MainThread]: Flushing usage events
[0m16:23:32.109036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b742170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b742110>]}


============================== 16:23:32.112475 | 4b90f862-a61f-444a-b8fa-f75793e97834 ==============================
[0m16:23:32.112475 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:23:32.112951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:23:32.584305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b90f862-a61f-444a-b8fa-f75793e97834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd815d0>]}
[0m16:23:32.637178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b90f862-a61f-444a-b8fa-f75793e97834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b77ee60>]}
[0m16:23:32.638281 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:23:32.704562 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:23:32.831666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:32.832036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:32.860540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b90f862-a61f-444a-b8fa-f75793e97834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb45900>]}
[0m16:23:32.972591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b90f862-a61f-444a-b8fa-f75793e97834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b8e41f0>]}
[0m16:23:32.973014 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:23:32.973414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b90f862-a61f-444a-b8fa-f75793e97834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d17f7c0>]}
[0m16:23:32.974912 [info ] [MainThread]: 
[0m16:23:32.975386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:32.979488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:23:32.979989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:23:32.988909 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:23:32.990439 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:23:32.990743 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:32.991061 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:32.991361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:32.991676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:32.992048 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:32.992425 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:23:32.992678 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:32.992969 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:32.993262 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:23:32.993576 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:23:32.993840 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:32.994128 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:23:32.994507 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m16:23:32.994852 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: No close available on handle
[0m16:23:32.995543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:32.995804 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m16:23:32.996035 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV' was properly closed.
[0m16:23:32.996301 [info ] [MainThread]: 
[0m16:23:32.996568 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m16:23:32.996920 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AMAZON_REVIEW_ANALYTICS_DEV"
  Database Error
    [Errno 2] No such file or directory: '/run/secrets/dbt_svc_private_key.pem'
[0m16:23:32.997604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9178507, "process_user_time": 2.470397, "process_kernel_time": 0.196302, "process_mem_max_rss": "188544", "process_out_blocks": "1024", "command_success": false, "process_in_blocks": "0"}
[0m16:23:32.997989 [debug] [MainThread]: Command `dbt run` failed at 16:23:32.997934 after 0.92 seconds
[0m16:23:32.998276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb104c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb77c40>]}
[0m16:23:32.998572 [debug] [MainThread]: Flushing usage events
[0m16:25:25.532421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ac02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e520b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e52050>]}


============================== 16:25:25.537207 | a267561b-4ce2-4dd2-a74e-e06d1961bed5 ==============================
[0m16:25:25.537207 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:25:25.537850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:25:26.168671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954615a0>]}
[0m16:25:26.197494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9446cd90>]}
[0m16:25:26.198156 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:25:26.256273 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:25:26.382963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:26.383333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:26.411475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff782458a0>]}
[0m16:25:26.480929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940bd3c0>]}
[0m16:25:26.481402 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:25:26.481713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940bdb10>]}
[0m16:25:26.483230 [info ] [MainThread]: 
[0m16:25:26.483685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:26.487740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:25:26.488503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:25:26.498211 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:25:26.499853 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:25:26.500186 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:25:26.500486 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:25:26.500748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:26.500997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:27.601097 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.100 seconds
[0m16:25:27.603030 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:25:27.669647 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.169 seconds
[0m16:25:27.674386 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:25:27.758693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:25:27.759532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:25:27.769455 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:25:27.772187 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:25:27.772681 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:25:27.773155 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:25:27.773613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:27.774044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:28.266288 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.492 seconds
[0m16:25:28.269854 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:25:28.332523 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.559 seconds
[0m16:25:28.335018 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:25:28.755840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bc54e0>]}
[0m16:25:28.758002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:28.758977 [info ] [MainThread]: 
[0m16:25:28.769575 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:25:28.770494 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:25:28.771299 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:25:28.772095 [info ] [Thread-2 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:25:28.772888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m16:25:28.773538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m16:25:28.774156 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:25:28.775140 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:25:28.784211 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:25:28.787417 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:25:28.789604 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:25:28.790186 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:25:28.820762 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:25:28.821253 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:25:28.823087 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:25:28.823803 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:25:28.824205 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:25:28.824661 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:25:28.825104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:28.825472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:29.526746 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m16:25:29.527712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m16:25:29.543897 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:25:29.545905 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:25:29.732049 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7882a530>]}
[0m16:25:29.733348 [info ] [Thread-2 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m16:25:29.734373 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:25:29.735626 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:25:29.736000 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:29.736527 [info ] [Thread-4 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:25:29.737071 [info ] [Thread-3 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:25:29.737697 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m16:25:29.738192 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:25:29.738591 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:25:29.738950 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:29.742094 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:25:29.744174 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:25:29.745789 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:25:29.746059 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:29.760329 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:25:29.762190 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:25:29.763538 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:25:29.764048 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:25:29.764350 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:25:29.764705 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:25:29.765022 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:25:29.765340 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:25:29.835358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73569660>]}
[0m16:25:29.836461 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.06s]
[0m16:25:29.838368 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:25:29.843453 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:25:29.844156 [info ] [Thread-2 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:25:29.844987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m16:25:29.846235 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:25:29.848128 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:25:29.851978 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:25:29.854878 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:25:29.855912 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:25:29.856229 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:25:29.856487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:30.964590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.108 seconds
[0m16:25:30.967244 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.202 seconds
[0m16:25:30.968382 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m16:25:30.971517 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:25:30.974007 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:25:30.976492 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:25:31.082831 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff735f4130>]}
[0m16:25:31.084848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b1bf70>]}
[0m16:25:31.085826 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff735cf670>]}
[0m16:25:31.086783 [info ] [Thread-3 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.34s]
[0m16:25:31.087754 [info ] [Thread-2 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.24s]
[0m16:25:31.088606 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.35s]
[0m16:25:31.089520 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:31.090280 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:25:31.090991 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:25:31.091980 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:25:31.092834 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:31.094461 [info ] [Thread-1 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:25:31.095312 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:25:31.096043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m16:25:31.096727 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:25:31.097260 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:25:31.097799 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:31.101618 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:25:31.104968 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:25:31.107278 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:25:31.107866 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:31.111090 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:25:31.114261 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:25:31.116289 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:25:31.116841 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:25:31.118060 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:25:31.118695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:31.119416 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:25:31.121481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:25:31.919068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m16:25:31.939129 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:25:32.022904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cc9870>]}
[0m16:25:32.024910 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.93s]
[0m16:25:32.026412 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:25:32.029505 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m16:25:32.032220 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:25:32.141004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a267561b-4ce2-4dd2-a74e-e06d1961bed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff735cf670>]}
[0m16:25:32.143591 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.04s]
[0m16:25:32.144606 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:32.147614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:32.148193 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:25:32.148671 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:25:32.149138 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:25:32.149602 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:25:32.150262 [info ] [MainThread]: 
[0m16:25:32.150879 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m16:25:32.152660 [debug] [MainThread]: Command end result
[0m16:25:32.198742 [info ] [MainThread]: 
[0m16:25:32.199270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:32.199636 [info ] [MainThread]: 
[0m16:25:32.200063 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:25:32.201949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7144995, "process_user_time": 4.268409, "process_kernel_time": 0.520513, "process_mem_max_rss": "203520", "process_out_blocks": "6173", "process_in_blocks": "0"}
[0m16:25:32.202894 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:32.202756 after 6.72 seconds
[0m16:25:32.203583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ac02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cf47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9446cd90>]}
[0m16:25:32.204062 [debug] [MainThread]: Flushing usage events
[0m16:25:34.814491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83310370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8171e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8171e020>]}


============================== 16:25:34.818372 | 4b41d5c0-8b86-478b-bb3e-bde43c626739 ==============================
[0m16:25:34.818372 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:25:34.818830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m16:25:34.884996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b41d5c0-8b86-478b-bb3e-bde43c626739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83333eb0>]}
[0m16:25:34.896204 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:25:34.897731 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:25:34.898304 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.112241626, "process_user_time": 0.976258, "process_kernel_time": 0.122906, "process_mem_max_rss": "92964", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m16:25:34.898715 [debug] [MainThread]: Command `dbt deps` succeeded at 16:25:34.898638 after 0.11 seconds
[0m16:25:34.898996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83310370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8171efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818c7490>]}
[0m16:25:34.899265 [debug] [MainThread]: Flushing usage events
[0m16:25:37.683449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88070340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8643e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8643e140>]}


============================== 16:25:37.686798 | a01de27c-4ae8-41d1-bb1a-297ada7edf92 ==============================
[0m16:25:37.686798 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:25:37.687399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/mart', 'send_anonymous_usage_stats': 'True'}
[0m16:25:38.205663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a01de27c-4ae8-41d1-bb1a-297ada7edf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66dd6e30>]}
[0m16:25:38.233953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a01de27c-4ae8-41d1-bb1a-297ada7edf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8656f760>]}
[0m16:25:38.234521 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:25:38.291593 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:25:38.436285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:38.436691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:38.467461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a01de27c-4ae8-41d1-bb1a-297ada7edf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66791930>]}
[0m16:25:38.547921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a01de27c-4ae8-41d1-bb1a-297ada7edf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6679c910>]}
[0m16:25:38.548386 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:25:38.548786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01de27c-4ae8-41d1-bb1a-297ada7edf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6679c880>]}
[0m16:25:38.549668 [warn ] [MainThread]: The selection criterion 'path:models/mart' does not match any enabled nodes
[0m16:25:38.550847 [info ] [MainThread]: 
[0m16:25:38.551321 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:25:38.553123 [debug] [MainThread]: Command end result
[0m16:25:38.579660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92442936, "process_user_time": 2.271094, "process_kernel_time": 0.200936, "process_mem_max_rss": "188392", "process_out_blocks": "1985", "process_in_blocks": "0"}
[0m16:25:38.580121 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:38.580063 after 0.92 seconds
[0m16:25:38.580406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88070340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872b1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff667dee60>]}
[0m16:25:38.580674 [debug] [MainThread]: Flushing usage events
[0m16:25:42.118285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59221d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5922170>]}


============================== 16:25:42.121850 | 1b396b9e-ca42-4ecd-ac37-009171ae6be3 ==============================
[0m16:25:42.121850 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:25:42.122346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:42.729766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7533e80>]}
[0m16:25:42.760185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a53580>]}
[0m16:25:42.760882 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:25:42.829301 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:25:42.968883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:42.969341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:42.997835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c75960>]}
[0m16:25:43.079962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ac4760>]}
[0m16:25:43.080590 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:25:43.080979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ac4220>]}
[0m16:25:43.082435 [info ] [MainThread]: 
[0m16:25:43.082967 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:43.086375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:25:43.086935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:25:43.096504 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:25:43.098210 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:25:43.098571 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:25:43.098928 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:25:43.099273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:43.099606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:43.506965 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.407 seconds
[0m16:25:43.508225 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.409 seconds
[0m16:25:43.511021 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:25:43.512902 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:25:43.625660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:25:43.626802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:25:43.635935 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:25:43.638257 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:25:43.638773 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:25:43.639235 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:25:43.639655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:43.640041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:44.146166 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.506 seconds
[0m16:25:44.151268 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:25:44.175294 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.536 seconds
[0m16:25:44.179279 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:25:44.305484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e35c30>]}
[0m16:25:44.307595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:44.308570 [info ] [MainThread]: 
[0m16:25:44.325239 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:25:44.326137 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:25:44.327026 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:25:44.327846 [info ] [Thread-3 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:25:44.328583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m16:25:44.329291 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.stg_reviews'
[0m16:25:44.329913 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:25:44.330439 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:25:44.339782 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:25:44.344978 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:25:44.347046 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:25:44.347532 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:25:44.377234 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:25:44.379562 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:25:44.380927 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:25:44.381317 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:25:44.382028 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:25:44.382302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:25:44.382678 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:25:44.383311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:45.250612 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m16:25:45.287403 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:25:45.288465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.905 seconds
[0m16:25:45.294075 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:25:45.359797 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ab7fd0>]}
[0m16:25:45.361577 [info ] [Thread-3 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.03s]
[0m16:25:45.363038 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:25:45.365019 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:25:45.365915 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:45.366962 [info ] [Thread-2 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:25:45.367850 [info ] [Thread-4 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:25:45.368880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m16:25:45.369637 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:25:45.370314 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:25:45.370931 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:45.375777 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:25:45.380851 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:25:45.383737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa671a5c0>]}
[0m16:25:45.386507 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.05s]
[0m16:25:45.387036 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:25:45.387899 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:25:45.388325 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:45.408497 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:25:45.409129 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:25:45.411380 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:25:45.412271 [info ] [Thread-3 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:25:45.413205 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:25:45.413857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m16:25:45.414347 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:25:45.414903 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:25:45.415271 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:25:45.415645 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:45.416017 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:25:45.418116 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:25:45.418827 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:25:45.426809 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:25:45.428865 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:25:45.433753 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:25:45.434222 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:25:45.434507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:25:46.320773 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.885 seconds
[0m16:25:46.327817 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:25:46.362916 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m16:25:46.365745 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:25:46.409264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85167e20>]}
[0m16:25:46.410534 [info ] [Thread-3 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m16:25:46.412140 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:25:46.423081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85aa0b50>]}
[0m16:25:46.424021 [info ] [Thread-2 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.05s]
[0m16:25:46.424851 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:25:46.632511 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.214 seconds
[0m16:25:46.635409 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:25:46.721065 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8513f640>]}
[0m16:25:46.722708 [info ] [Thread-4 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.35s]
[0m16:25:46.723868 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:25:46.725959 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:25:46.726453 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:46.727223 [info ] [Thread-1 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:25:46.728045 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:25:46.728850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m16:25:46.729509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:25:46.730150 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:25:46.730732 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:46.735992 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:25:46.741377 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:25:46.743403 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:25:46.743947 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:46.747298 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:25:46.750176 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:25:46.752464 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:25:46.753049 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:25:46.754321 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:25:46.754941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:46.755584 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:25:46.756799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:25:47.734265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.979 seconds
[0m16:25:47.736303 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.979 seconds
[0m16:25:47.741379 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:25:47.746094 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:25:47.828284 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8517ffd0>]}
[0m16:25:47.829836 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.10s]
[0m16:25:47.830923 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:25:47.845518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b396b9e-ca42-4ecd-ac37-009171ae6be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85abe680>]}
[0m16:25:47.849526 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.12s]
[0m16:25:47.850597 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:25:47.864297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:47.866094 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:25:47.867443 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:25:47.868453 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:25:47.870349 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m16:25:47.874370 [info ] [MainThread]: 
[0m16:25:47.877817 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m16:25:47.886963 [debug] [MainThread]: Command end result
[0m16:25:47.945208 [info ] [MainThread]: 
[0m16:25:47.946960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:47.948151 [info ] [MainThread]: 
[0m16:25:47.949114 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:25:47.957438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8715053, "process_user_time": 4.186524, "process_kernel_time": 0.38096, "process_mem_max_rss": "199816", "process_out_blocks": "2068", "process_in_blocks": "0"}
[0m16:25:47.959206 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:47.959035 after 5.87 seconds
[0m16:25:47.960227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c97730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a53580>]}
[0m16:25:47.960710 [debug] [MainThread]: Flushing usage events
[0m16:27:19.802058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fe0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8033e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8033e140>]}


============================== 16:27:19.806649 | 62d07fc8-1586-40b0-80ac-aa3af24f8bc7 ==============================
[0m16:27:19.806649 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:27:19.807244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:27:20.536633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82003eb0>]}
[0m16:27:20.570230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a8d8a0>]}
[0m16:27:20.571116 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:27:20.634514 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:27:20.766450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:20.766959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:20.796925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64765930>]}
[0m16:27:20.868625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a15c90>]}
[0m16:27:20.869148 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:27:20.869524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82031d20>]}
[0m16:27:20.871059 [info ] [MainThread]: 
[0m16:27:20.871705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:27:20.876153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:27:20.876759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:27:20.885914 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:27:20.887510 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:27:20.887864 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:27:20.888176 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:27:20.888480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:20.888793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:21.653300 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.764 seconds
[0m16:27:21.657850 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:27:21.781602 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.893 seconds
[0m16:27:21.785631 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:27:21.882097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:27:21.883262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:27:21.893893 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:27:21.898342 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:27:21.899328 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:27:21.899985 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:27:21.900706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:21.901333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:22.585847 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.684 seconds
[0m16:27:22.590896 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:27:22.603267 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.703 seconds
[0m16:27:22.605493 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:27:22.723327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fed630>]}
[0m16:27:22.724377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:27:22.725401 [info ] [MainThread]: 
[0m16:27:22.737387 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:27:22.738226 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:27:22.739059 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:27:22.739875 [info ] [Thread-2 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:27:22.740611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m16:27:22.741208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m16:27:22.741760 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:27:22.742345 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:27:22.752237 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:27:22.756569 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:27:22.758394 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:27:22.758850 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:27:22.786359 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:27:22.786797 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:27:22.788329 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:27:22.788759 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:27:22.789215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:27:22.789886 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:27:22.793663 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:27:22.797616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:23.245421 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m16:27:23.274399 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:27:23.361072 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645a2b90>]}
[0m16:27:23.362586 [info ] [Thread-2 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:27:23.363352 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:27:23.364276 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:27:23.364846 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:23.365614 [info ] [Thread-4 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:27:23.366367 [info ] [Thread-3 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:27:23.367154 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m16:27:23.368070 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:27:23.368796 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:27:23.369510 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:23.374819 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:27:23.379516 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:27:23.381596 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:27:23.397745 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:23.408479 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:27:23.410877 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:27:23.412316 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:27:23.412676 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:27:23.413162 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:27:23.413482 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:27:23.413859 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:27:23.417661 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:27:23.477504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m16:27:23.482945 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:27:23.547130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645abd90>]}
[0m16:27:23.547997 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m16:27:23.548543 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:27:23.549343 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:27:23.549756 [info ] [Thread-2 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:27:23.550159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m16:27:23.550490 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:27:23.552594 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:27:23.553341 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:27:23.555280 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:27:23.556121 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:27:23.556439 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:27:23.556711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:27:24.622737 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m16:27:24.628055 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:27:24.643570 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.226 seconds
[0m16:27:24.646295 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:27:24.709425 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6455d9f0>]}
[0m16:27:24.710478 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.34s]
[0m16:27:24.711339 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:27:24.753916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645f1150>]}
[0m16:27:24.754940 [info ] [Thread-3 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.39s]
[0m16:27:24.755789 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:24.756735 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:27:24.757392 [info ] [Thread-1 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:27:24.758057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m16:27:24.758676 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:27:24.762411 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:27:24.764767 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:27:24.769431 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:27:24.771576 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:27:24.772156 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:27:24.772636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:25.442935 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.886 seconds
[0m16:27:25.448508 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:27:25.509358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m16:27:25.515576 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:27:25.545759 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6443e7d0>]}
[0m16:27:25.548110 [info ] [Thread-2 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.00s]
[0m16:27:25.549342 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:27:25.550340 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:25.551072 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:27:25.551755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:27:25.552303 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:25.556241 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:27:25.557678 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:25.560952 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:27:25.563055 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:27:25.563656 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:27:25.564224 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:27:25.588659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645f3fa0>]}
[0m16:27:25.589916 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m16:27:25.592862 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:27:26.464205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m16:27:26.469993 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:27:26.564846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d07fc8-1586-40b0-80ac-aa3af24f8bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6443e890>]}
[0m16:27:26.565953 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.01s]
[0m16:27:26.566829 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:26.568865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:26.569486 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:27:26.570035 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:27:26.570484 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:27:26.570874 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:27:26.571438 [info ] [MainThread]: 
[0m16:27:26.571973 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m16:27:26.573684 [debug] [MainThread]: Command end result
[0m16:27:26.613651 [info ] [MainThread]: 
[0m16:27:26.614133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:26.614507 [info ] [MainThread]: 
[0m16:27:26.614904 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:27:26.616061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8469462, "process_user_time": 4.038997, "process_kernel_time": 0.578444, "process_mem_max_rss": "199704", "process_out_blocks": "2069", "process_in_blocks": "0"}
[0m16:27:26.616691 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:26.616610 after 6.85 seconds
[0m16:27:26.617078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fe0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81211960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811ea920>]}
[0m16:27:26.617414 [debug] [MainThread]: Flushing usage events
[0m16:27:29.755255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8451a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8451a050>]}


============================== 16:27:29.759568 | 2655d675-0581-4fe2-bfd1-1d6ec8749931 ==============================
[0m16:27:29.759568 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:27:29.760127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:27:29.830816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2655d675-0581-4fe2-bfd1-1d6ec8749931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846c3cd0>]}
[0m16:27:29.837203 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:27:29.839808 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:27:29.841237 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.118616916, "process_user_time": 1.217543, "process_kernel_time": 0.134949, "process_mem_max_rss": "92992", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m16:27:29.841713 [debug] [MainThread]: Command `dbt deps` succeeded at 16:27:29.841643 after 0.12 seconds
[0m16:27:29.842039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8451b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846c3f40>]}
[0m16:27:29.842362 [debug] [MainThread]: Flushing usage events
[0m16:27:32.355053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e30370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5242200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb52421a0>]}


============================== 16:27:32.358414 | fe5a2398-62c4-467b-a518-9d96c6247d85 ==============================
[0m16:27:32.358414 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:27:32.359016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/mart', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:27:32.873452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe5a2398-62c4-467b-a518-9d96c6247d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999c3bb0>]}
[0m16:27:32.901949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe5a2398-62c4-467b-a518-9d96c6247d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55a2e90>]}
[0m16:27:32.902573 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:27:32.962254 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:27:33.086626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:33.087013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:33.117506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe5a2398-62c4-467b-a518-9d96c6247d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995b1990>]}
[0m16:27:33.193682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe5a2398-62c4-467b-a518-9d96c6247d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bf47c0>]}
[0m16:27:33.194167 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:27:33.194471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5a2398-62c4-467b-a518-9d96c6247d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5242140>]}
[0m16:27:33.195234 [warn ] [MainThread]: The selection criterion 'path:models/mart' does not match any enabled nodes
[0m16:27:33.195966 [info ] [MainThread]: 
[0m16:27:33.196252 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:27:33.197461 [debug] [MainThread]: Command end result
[0m16:27:33.219663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.89196885, "process_user_time": 2.28361, "process_kernel_time": 0.187596, "process_mem_max_rss": "188312", "process_out_blocks": "1985", "process_in_blocks": "0"}
[0m16:27:33.220151 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:33.220085 after 0.89 seconds
[0m16:27:33.220447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e30370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6071960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c21780>]}
[0m16:27:33.220731 [debug] [MainThread]: Flushing usage events
[0m16:27:35.473826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832102e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8160e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8160e050>]}


============================== 16:27:35.477412 | 5f62c14a-a552-4e4e-9703-57afb86f3d4d ==============================
[0m16:27:35.477412 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:27:35.477960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:27:35.951399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bb15a0>]}
[0m16:27:35.980070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b5cd90>]}
[0m16:27:35.980680 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m16:27:36.043789 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:27:36.170558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:36.170951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:36.199274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff619658a0>]}
[0m16:27:36.272947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8187d3c0>]}
[0m16:27:36.273503 [info ] [MainThread]: Found 7 models, 12 data tests, 2 sources, 459 macros
[0m16:27:36.273909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8187db10>]}
[0m16:27:36.275323 [info ] [MainThread]: 
[0m16:27:36.275862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:27:36.279823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:27:36.280431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m16:27:36.290691 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:27:36.292491 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m16:27:36.292880 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:27:36.293241 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m16:27:36.293533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:36.293803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:36.714126 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.420 seconds
[0m16:27:36.715834 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.422 seconds
[0m16:27:36.718200 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:27:36.719818 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m16:27:36.790638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m16:27:36.791848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m16:27:36.801330 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m16:27:36.804481 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m16:27:36.805128 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m16:27:36.805714 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m16:27:36.806361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:36.806890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:37.862362 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.055 seconds
[0m16:27:37.871469 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m16:27:37.880674 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.074 seconds
[0m16:27:37.882460 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m16:27:38.002122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8187dc60>]}
[0m16:27:38.005370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:27:38.006415 [info ] [MainThread]: 
[0m16:27:38.028992 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m16:27:38.029675 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m16:27:38.031056 [info ] [Thread-1 (]: 1 of 7 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m16:27:38.032024 [info ] [Thread-2 (]: 2 of 7 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m16:27:38.032918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m16:27:38.033630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m16:27:38.034316 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m16:27:38.034939 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m16:27:38.049018 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m16:27:38.053201 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:27:38.055540 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m16:27:38.055888 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m16:27:38.078313 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m16:27:38.080749 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m16:27:38.082372 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m16:27:38.083013 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m16:27:38.083250 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m16:27:38.083606 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m16:27:38.083972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:38.084318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:27:38.774452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m16:27:38.834480 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m16:27:38.885349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m16:27:38.887613 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m16:27:38.906227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6051a980>]}
[0m16:27:38.906975 [info ] [Thread-2 (]: 2 of 7 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.87s]
[0m16:27:38.907667 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m16:27:38.908533 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m16:27:38.908992 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:38.909561 [info ] [Thread-4 (]: 3 of 7 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m16:27:38.910098 [info ] [Thread-3 (]: 4 of 7 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m16:27:38.910696 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews'
[0m16:27:38.911224 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m16:27:38.911667 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m16:27:38.912072 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:38.914851 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:27:38.920757 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:27:38.922686 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m16:27:38.937274 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m16:27:38.937608 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:38.939883 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:27:38.940646 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m16:27:38.941002 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m16:27:38.941503 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m16:27:38.941819 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:27:38.942142 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m16:27:38.946139 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:27:39.073569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f74dc0>]}
[0m16:27:39.074298 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.04s]
[0m16:27:39.074858 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m16:27:39.075469 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m16:27:39.075911 [info ] [Thread-2 (]: 5 of 7 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m16:27:39.076352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.dim_products)
[0m16:27:39.076711 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m16:27:39.078807 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m16:27:39.079608 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m16:27:39.081582 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m16:27:39.082546 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m16:27:39.082856 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m16:27:39.083152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:27:39.735938 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m16:27:39.744117 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m16:27:39.810960 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f80e20>]}
[0m16:27:39.812291 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 0.90s]
[0m16:27:39.813959 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m16:27:40.186917 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.241 seconds
[0m16:27:40.190306 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m16:27:40.202359 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m16:27:40.205369 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m16:27:40.273958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f754e0>]}
[0m16:27:40.275683 [info ] [Thread-3 (]: 4 of 7 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.36s]
[0m16:27:40.276809 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m16:27:40.278594 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m16:27:40.279802 [info ] [Thread-1 (]: 6 of 7 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m16:27:40.281014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.dim_date)
[0m16:27:40.282291 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m16:27:40.289909 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m16:27:40.293489 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f74dc0>]}
[0m16:27:40.294846 [info ] [Thread-2 (]: 5 of 7 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.22s]
[0m16:27:40.295696 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m16:27:40.296658 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m16:27:40.302993 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m16:27:40.304735 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:40.307152 [info ] [Thread-3 (]: 7 of 7 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m16:27:40.308797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_product_kpi)
[0m16:27:40.310112 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m16:27:40.310634 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:40.311428 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m16:27:40.317955 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:27:40.319099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:40.324763 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:40.329779 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:27:40.335853 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m16:27:40.337001 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m16:27:40.337628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:27:41.110412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m16:27:41.115729 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m16:27:41.170882 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m16:27:41.173973 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m16:27:41.220587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f80a00>]}
[0m16:27:41.221614 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.94s]
[0m16:27:41.222490 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m16:27:41.240130 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f62c14a-a552-4e4e-9703-57afb86f3d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60fa5ab0>]}
[0m16:27:41.241030 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.93s]
[0m16:27:41.241887 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m16:27:41.244458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:41.245071 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m16:27:41.245552 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m16:27:41.245987 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m16:27:41.246458 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m16:27:41.247168 [info ] [MainThread]: 
[0m16:27:41.247820 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m16:27:41.249578 [debug] [MainThread]: Command end result
[0m16:27:41.294064 [info ] [MainThread]: 
[0m16:27:41.294594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:41.294985 [info ] [MainThread]: 
[0m16:27:41.295429 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:27:41.299224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.854022, "process_user_time": 4.648464, "process_kernel_time": 0.261611, "process_mem_max_rss": "199892", "process_out_blocks": "2069", "process_in_blocks": "0"}
[0m16:27:41.303659 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:41.303563 after 5.86 seconds
[0m16:27:41.304344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832102e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82439450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b5cd90>]}
[0m16:27:41.304696 [debug] [MainThread]: Flushing usage events
[0m19:26:35.153014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4856200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa48561a0>]}


============================== 19:26:35.159046 | 39b74539-b2c5-470a-87be-d3103c8497f2 ==============================
[0m19:26:35.159046 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:26:35.159590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:26:36.310295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6483a60>]}
[0m19:26:36.339841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891d41c0>]}
[0m19:26:36.340831 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:26:36.413126 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:26:36.571331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:26:36.571887 [debug] [MainThread]: Partial parsing: added file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m19:26:36.572313 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/schema.yml
[0m19:26:36.720652 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:26:36.721212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d3a6e0>]}
[0m19:26:36.839575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887ecfd0>]}
[0m19:26:36.934279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891d5780>]}
[0m19:26:36.934797 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m19:26:36.935175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b87340>]}
[0m19:26:36.936505 [info ] [MainThread]: 
[0m19:26:36.937010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:36.941370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m19:26:36.952710 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m19:26:36.953108 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m19:26:36.953359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:37.610065 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.656 seconds
[0m19:26:37.613687 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m19:26:37.686520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m19:26:37.688130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m19:26:37.701650 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m19:26:37.704132 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m19:26:37.704914 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m19:26:37.705533 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m19:26:37.706124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:37.706608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:38.086706 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.380 seconds
[0m19:26:38.089332 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m19:26:38.153124 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.446 seconds
[0m19:26:38.156698 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m19:26:38.250211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891d60e0>]}
[0m19:26:38.251931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:38.252700 [info ] [MainThread]: 
[0m19:26:38.276433 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m19:26:38.277517 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m19:26:38.278136 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:26:38.279510 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m19:26:38.280461 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m19:26:38.281318 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m19:26:38.282167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m19:26:38.282851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m19:26:38.283594 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m19:26:38.284276 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m19:26:38.284864 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m19:26:38.285431 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:26:38.294394 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m19:26:38.297154 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:26:38.300351 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:26:38.303741 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m19:26:38.319995 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m19:26:38.320359 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:26:38.328768 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m19:26:38.330846 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:26:38.333505 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:26:38.335713 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:26:38.336177 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m19:26:38.336817 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m19:26:38.337465 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m19:26:38.337164 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:26:38.337449 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m19:26:38.337788 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m19:26:38.338283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:38.338667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:26:39.689954 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.351 seconds
[0m19:26:39.691327 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.354 seconds
[0m19:26:39.692138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.354 seconds
[0m19:26:39.730559 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m19:26:39.731888 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m19:26:39.733977 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m19:26:39.812839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88163610>]}
[0m19:26:39.814012 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.53s]
[0m19:26:39.815132 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:26:39.816509 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m19:26:39.817241 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m19:26:39.818016 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m19:26:39.818523 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m19:26:39.821808 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m19:26:39.823010 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m19:26:39.826505 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m19:26:39.828159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88144340>]}
[0m19:26:39.828787 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.55s]
[0m19:26:39.830426 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m19:26:39.829978 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m19:26:39.831057 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m19:26:39.831453 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:26:39.831952 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:26:39.832529 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:26:39.833288 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m19:26:39.834144 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m19:26:39.835388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m19:26:39.841076 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:26:39.840691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m19:26:39.843473 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:26:39.844064 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m19:26:39.845174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88163550>]}
[0m19:26:39.847653 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:26:39.848452 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:26:39.848219 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.56s]
[0m19:26:39.854019 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:26:39.854514 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m19:26:39.855042 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m19:26:39.857295 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:26:39.859988 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:26:39.860361 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (select
r.product_id,
r.rating,
r.review_timestamp,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
extract(year from review_timestamp) as review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m19:26:39.860836 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:26:39.861823 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:26:39.863484 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m19:26:39.865477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:40.229226 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c258ee-0306-15cb-0004-85da0004b03a
[0m19:26:40.230591 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 1 unexpected ','.
[0m19:26:40.231341 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m19:26:40.317376 [debug] [Thread-3 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 1 unexpected ','.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m19:26:40.318335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881cd030>]}
[0m19:26:40.319279 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.48s]
[0m19:26:40.320462 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:26:40.462702 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m19:26:40.468118 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m19:26:40.517600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m19:26:40.521441 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m19:26:40.558612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c3f010>]}
[0m19:26:40.559615 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.74s]
[0m19:26:40.560666 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m19:26:40.593299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b74539-b2c5-470a-87be-d3103c8497f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881ce1a0>]}
[0m19:26:40.594327 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.75s]
[0m19:26:40.595221 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:26:40.597649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:40.598173 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m19:26:40.598643 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m19:26:40.599071 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m19:26:40.599512 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m19:26:40.600082 [info ] [MainThread]: 
[0m19:26:40.600686 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m19:26:40.602410 [debug] [MainThread]: Command end result
[0m19:26:40.653769 [info ] [MainThread]: 
[0m19:26:40.654302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:26:40.654772 [info ] [MainThread]: 
[0m19:26:40.655205 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 1 unexpected ','.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m19:26:40.655687 [info ] [MainThread]: 
[0m19:26:40.656978 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:26:40.661919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.546866, "process_user_time": 4.012736, "process_kernel_time": 1.849636, "process_mem_max_rss": "207484", "process_out_blocks": "3002", "command_success": false, "process_in_blocks": "0"}
[0m19:26:40.662957 [debug] [MainThread]: Command `dbt run` failed at 19:26:40.662884 after 5.55 seconds
[0m19:26:40.663406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6483a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88034430>]}
[0m19:26:40.663740 [debug] [MainThread]: Flushing usage events
[0m19:29:02.397174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbf8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0261a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e026140>]}


============================== 19:29:02.402764 | 65318e1a-592a-43c3-acce-5899142fc9ae ==============================
[0m19:29:02.402764 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:29:02.403321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:03.883365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e98ee30>]}
[0m19:29:03.913845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e153760>]}
[0m19:29:03.914515 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:29:03.988804 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:29:04.124435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:04.125062 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m19:29:04.263196 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:29:04.263909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e46baf0>]}
[0m19:29:04.368403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dbecfa0>]}
[0m19:29:04.442489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e18bca0>]}
[0m19:29:04.443048 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m19:29:04.443418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e18a350>]}
[0m19:29:04.445014 [info ] [MainThread]: 
[0m19:29:04.445539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:04.449083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m19:29:04.458624 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m19:29:04.459058 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m19:29:04.459354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:05.011754 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.552 seconds
[0m19:29:05.014796 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m19:29:05.094060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m19:29:05.095642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m19:29:05.104086 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m19:29:05.107287 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m19:29:05.108092 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m19:29:05.108644 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m19:29:05.109133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:05.109590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:05.483837 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.374 seconds
[0m19:29:05.486469 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m19:29:05.525080 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.416 seconds
[0m19:29:05.527361 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m19:29:05.590454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd088e0>]}
[0m19:29:05.591464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:29:05.592059 [info ] [MainThread]: 
[0m19:29:05.602907 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m19:29:05.603935 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m19:29:05.604531 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:05.605816 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m19:29:05.606674 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m19:29:05.607627 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m19:29:05.608491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m19:29:05.609279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m19:29:05.610131 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m19:29:05.610766 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m19:29:05.611431 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m19:29:05.612018 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:05.621090 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m19:29:05.624126 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:29:05.627399 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:29:05.629440 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m19:29:05.652402 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:05.655096 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m19:29:05.655482 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m19:29:05.657786 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:29:05.661204 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:29:05.662124 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m19:29:05.662697 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m19:29:05.663320 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:29:05.663584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:05.664171 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m19:29:05.664499 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m19:29:05.668679 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m19:29:05.669351 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:29:05.669886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:06.736222 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.066 seconds
[0m19:29:06.738218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.075 seconds
[0m19:29:06.739012 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m19:29:06.766794 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m19:29:06.769056 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m19:29:06.771505 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m19:29:06.829961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf4c310>]}
[0m19:29:06.831010 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.22s]
[0m19:29:06.832327 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m19:29:06.835470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf0da20>]}
[0m19:29:06.836559 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m19:29:06.837624 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m19:29:06.872990 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d727e50>]}
[0m19:29:06.874005 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.26s]
[0m19:29:06.874913 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:06.876275 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m19:29:06.877116 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:06.876750 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:06.877777 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m19:29:06.879075 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m19:29:06.879900 [info ] [Thread-1 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m19:29:06.880738 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m19:29:06.881343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m19:29:06.882889 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:06.882447 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m19:29:06.881904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m19:29:06.889363 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:06.888845 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m19:29:06.886133 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:29:06.892035 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:29:06.894202 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m19:29:06.894517 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:06.896863 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m19:29:06.897199 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:06.899376 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:29:06.902945 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:29:06.903870 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m19:29:06.904743 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m19:29:06.905780 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:29:06.906063 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:29:06.906848 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:29:06.907205 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m19:29:06.907884 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_timestamp,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

)

aggregated as (

select
brand,
extract(year from review_timestamp) as review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m19:29:06.913647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:06.913305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:07.314246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c258f1-0306-13c9-0004-85da00049b8e
[0m19:29:07.315239 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected 'aggregated'.
syntax error line 19 at position 36 unexpected 'as'.
[0m19:29:07.315954 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m19:29:07.422753 [debug] [Thread-1 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'aggregated'.
  syntax error line 19 at position 36 unexpected 'as'.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m19:29:07.423805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e9bb070>]}
[0m19:29:07.424818 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.54s]
[0m19:29:07.425740 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:07.643111 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m19:29:07.649074 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m19:29:07.693963 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.787 seconds
[0m19:29:07.698597 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m19:29:07.732828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cfa4040>]}
[0m19:29:07.733908 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.85s]
[0m19:29:07.734848 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:07.797470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65318e1a-592a-43c3-acce-5899142fc9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d75a350>]}
[0m19:29:07.799948 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.92s]
[0m19:29:07.801495 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m19:29:07.804570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:07.805139 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m19:29:07.805611 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m19:29:07.806058 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m19:29:07.806578 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m19:29:07.807261 [info ] [MainThread]: 
[0m19:29:07.807999 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m19:29:07.809621 [debug] [MainThread]: Command end result
[0m19:29:07.865981 [info ] [MainThread]: 
[0m19:29:07.866597 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:29:07.866968 [info ] [MainThread]: 
[0m19:29:07.867517 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'aggregated'.
  syntax error line 19 at position 36 unexpected 'as'.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m19:29:07.867914 [info ] [MainThread]: 
[0m19:29:07.868331 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:29:07.870242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.506066, "process_user_time": 4.421029, "process_kernel_time": 0.687765, "process_mem_max_rss": "207180", "process_out_blocks": "3004", "command_success": false, "process_in_blocks": "0"}
[0m19:29:07.870873 [debug] [MainThread]: Command `dbt run` failed at 19:29:07.870800 after 5.51 seconds
[0m19:29:07.871359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbf8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf677c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e153760>]}
[0m19:29:07.871753 [debug] [MainThread]: Flushing usage events
[0m19:29:23.762707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4203a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99822230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998221d0>]}


============================== 19:29:23.766282 | 1e1fc430-45d6-4330-aab1-07a7c87406e4 ==============================
[0m19:29:23.766282 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:29:23.766790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'send_anonymous_usage_stats': 'True'}
[0m19:29:24.280618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f86f50>]}
[0m19:29:24.308710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a157a30>]}
[0m19:29:24.309284 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:29:24.366855 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:29:24.506848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:24.507422 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m19:29:24.663858 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:29:24.664533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a188e50>]}
[0m19:29:24.826231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff797e9030>]}
[0m19:29:24.910741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b370d0>]}
[0m19:29:24.911198 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m19:29:24.911521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e81060>]}
[0m19:29:24.912929 [info ] [MainThread]: 
[0m19:29:24.914628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:24.918780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m19:29:24.936671 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m19:29:24.937137 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m19:29:24.937416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:25.386138 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.449 seconds
[0m19:29:25.388952 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m19:29:25.457409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m19:29:25.458305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m19:29:25.471749 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m19:29:25.477001 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m19:29:25.477615 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m19:29:25.478188 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m19:29:25.478696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:25.479157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:25.875441 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.397 seconds
[0m19:29:25.881077 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m19:29:25.878649 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.399 seconds
[0m19:29:25.886059 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m19:29:25.955292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5267d0>]}
[0m19:29:25.956273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:29:25.957135 [info ] [MainThread]: 
[0m19:29:25.985390 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m19:29:25.985980 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m19:29:25.986528 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:25.987759 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m19:29:25.988509 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m19:29:25.989407 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m19:29:25.990116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m19:29:25.990588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m19:29:25.991143 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m19:29:25.991785 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m19:29:25.992273 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m19:29:25.992817 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:26.001066 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m19:29:26.003734 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:29:26.006596 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:29:26.008275 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m19:29:26.008658 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m19:29:26.019494 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:26.039633 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m19:29:26.043884 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:29:26.045745 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:29:26.047370 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m19:29:26.048176 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m19:29:26.048677 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m19:29:26.049790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:26.049485 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m19:29:26.049255 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:29:26.052846 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m19:29:26.052457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:26.054408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:29:26.807509 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m19:29:26.830119 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m19:29:26.859090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m19:29:26.861414 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m19:29:26.901863 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b09a20>]}
[0m19:29:26.902830 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 0.91s]
[0m19:29:26.903871 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:29:26.904790 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m19:29:26.905475 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m19:29:26.906185 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m19:29:26.906659 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m19:29:26.909953 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m19:29:26.912625 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m19:29:26.915280 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m19:29:26.916705 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m19:29:26.917230 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m19:29:26.917711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:29:26.948309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b63580>]}
[0m19:29:26.950618 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m19:29:26.951150 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m19:29:26.956053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m19:29:26.960538 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m19:29:27.043013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79323a00>]}
[0m19:29:27.044292 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.05s]
[0m19:29:27.045492 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m19:29:27.046238 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:27.046535 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:27.046946 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m19:29:27.047477 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m19:29:27.047947 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m19:29:27.048331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m19:29:27.048681 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:27.049028 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:27.051472 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:29:27.054549 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:29:27.055510 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:27.057537 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:29:27.057880 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:27.059770 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:29:27.060642 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:29:27.061008 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_timestamp,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
extract(year from review_timestamp) as review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m19:29:27.062238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:29:27.062006 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:29:27.062715 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m19:29:27.065440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:27.735305 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m19:29:27.739401 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m19:29:27.742192 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m19:29:27.744577 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m19:29:27.806884 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m19:29:27.811392 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m19:29:27.823105 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b8cbe0>]}
[0m19:29:27.824413 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.92s]
[0m19:29:27.825374 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m19:29:28.052429 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78bcc250>]}
[0m19:29:28.053618 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.00s]
[0m19:29:28.054576 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:29:28.087051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1fc430-45d6-4330-aab1-07a7c87406e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78734d60>]}
[0m19:29:28.088052 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.04s]
[0m19:29:28.088890 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:29:28.090736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:28.091310 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m19:29:28.091728 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m19:29:28.092188 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m19:29:28.092622 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m19:29:28.093206 [info ] [MainThread]: 
[0m19:29:28.093819 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m19:29:28.095445 [debug] [MainThread]: Command end result
[0m19:29:28.141023 [info ] [MainThread]: 
[0m19:29:28.141523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:28.141916 [info ] [MainThread]: 
[0m19:29:28.142300 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:29:28.143902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.409852, "process_user_time": 3.745365, "process_kernel_time": 0.658692, "process_mem_max_rss": "206488", "process_out_blocks": "3001", "process_in_blocks": "0"}
[0m19:29:28.144447 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:28.144383 after 4.41 seconds
[0m19:29:28.144812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4203a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79aae4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f86f50>]}
[0m19:29:28.145096 [debug] [MainThread]: Flushing usage events
[0m19:42:02.440657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf4e0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf4e080>]}


============================== 19:42:02.447703 | 1865efcc-72ed-422d-ae46-20af5217b148 ==============================
[0m19:42:02.447703 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:42:02.448411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:42:02.462867 [info ] [MainThread]: dbt version: 1.8.3
[0m19:42:02.463662 [info ] [MainThread]: python version: 3.10.14
[0m19:42:02.464111 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:42:02.464536 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m19:42:03.588240 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m19:42:03.589197 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m19:42:03.589804 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m19:42:03.590531 [info ] [MainThread]: adapter type: snowflake
[0m19:42:03.590929 [info ] [MainThread]: adapter version: 1.8.2
[0m19:42:03.699576 [info ] [MainThread]: Configuration:
[0m19:42:03.701110 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:42:03.701966 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:42:03.702494 [info ] [MainThread]: Required dependencies:
[0m19:42:03.703566 [debug] [MainThread]: Executing "git --help"
[0m19:42:03.710286 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:42:03.710773 [info ] [MainThread]: Connection:
[0m19:42:03.711135 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m19:42:03.711548 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m19:42:03.711908 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m19:42:03.712310 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m19:42:03.712644 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m19:42:03.713395 [info ] [MainThread]:   schema: STAGE
[0m19:42:03.713883 [info ] [MainThread]:   authenticator: jwt
[0m19:42:03.714172 [info ] [MainThread]:   oauth_client_id: None
[0m19:42:03.714422 [info ] [MainThread]:   query_tag: None
[0m19:42:03.714690 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:42:03.714956 [info ] [MainThread]:   host: None
[0m19:42:03.715397 [info ] [MainThread]:   port: None
[0m19:42:03.716056 [info ] [MainThread]:   proxy_host: None
[0m19:42:03.716563 [info ] [MainThread]:   proxy_port: None
[0m19:42:03.717323 [info ] [MainThread]:   protocol: None
[0m19:42:03.722133 [info ] [MainThread]:   connect_retries: 1
[0m19:42:03.725167 [info ] [MainThread]:   connect_timeout: None
[0m19:42:03.728227 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:42:03.729006 [info ] [MainThread]:   retry_all: False
[0m19:42:03.729267 [info ] [MainThread]:   insecure_mode: False
[0m19:42:03.729501 [info ] [MainThread]:   reuse_connections: None
[0m19:42:03.729943 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:42:03.813372 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:42:03.814245 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:42:03.814504 [debug] [MainThread]: On debug: select 1 as id
[0m19:42:03.814737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:04.499201 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.684 seconds
[0m19:42:04.503120 [debug] [MainThread]: On debug: Close
[0m19:42:04.605224 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:42:04.608467 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:42:04.609730 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m19:42:04.614311 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.2228413, "process_user_time": 2.683578, "process_kernel_time": 1.409825, "process_mem_max_rss": "187076", "process_out_blocks": "17", "command_success": false, "process_in_blocks": "0"}
[0m19:42:04.615433 [debug] [MainThread]: Command `dbt debug` failed at 19:42:04.615237 after 2.22 seconds
[0m19:42:04.616108 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:42:04.616685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71e05fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0ef3d0>]}
[0m19:42:04.617324 [debug] [MainThread]: Flushing usage events
[0m20:13:02.983513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa560d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3725f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3725ed0>]}


============================== 20:13:03.002664 | 0318c82e-7835-4bfb-adb8-8a9845702c3e ==============================
[0m20:13:03.002664 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:13:03.003237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m20:13:03.023628 [info ] [MainThread]: dbt version: 1.8.3
[0m20:13:03.024040 [info ] [MainThread]: python version: 3.10.14
[0m20:13:03.024296 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:13:03.024548 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m20:13:04.149223 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m20:13:04.149937 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m20:13:04.150349 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m20:13:04.150945 [info ] [MainThread]: adapter type: snowflake
[0m20:13:04.151457 [info ] [MainThread]: adapter version: 1.8.2
[0m20:13:04.242946 [info ] [MainThread]: Configuration:
[0m20:13:04.243459 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:13:04.243766 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:13:04.244070 [info ] [MainThread]: Required dependencies:
[0m20:13:04.244332 [debug] [MainThread]: Executing "git --help"
[0m20:13:04.262912 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:13:04.263389 [debug] [MainThread]: STDERR: "b''"
[0m20:13:04.263666 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:13:04.263911 [info ] [MainThread]: Connection:
[0m20:13:04.264184 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m20:13:04.264477 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m20:13:04.264711 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m20:13:04.264945 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m20:13:04.265190 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m20:13:04.265448 [info ] [MainThread]:   schema: STAGE
[0m20:13:04.265707 [info ] [MainThread]:   authenticator: jwt
[0m20:13:04.265960 [info ] [MainThread]:   oauth_client_id: None
[0m20:13:04.266202 [info ] [MainThread]:   query_tag: None
[0m20:13:04.266480 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:13:04.266745 [info ] [MainThread]:   host: None
[0m20:13:04.266987 [info ] [MainThread]:   port: None
[0m20:13:04.267234 [info ] [MainThread]:   proxy_host: None
[0m20:13:04.267475 [info ] [MainThread]:   proxy_port: None
[0m20:13:04.267699 [info ] [MainThread]:   protocol: None
[0m20:13:04.267945 [info ] [MainThread]:   connect_retries: 1
[0m20:13:04.268172 [info ] [MainThread]:   connect_timeout: None
[0m20:13:04.268401 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:13:04.268649 [info ] [MainThread]:   retry_all: False
[0m20:13:04.268887 [info ] [MainThread]:   insecure_mode: False
[0m20:13:04.269113 [info ] [MainThread]:   reuse_connections: None
[0m20:13:04.269482 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:13:04.332514 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:13:04.333127 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:13:04.333397 [debug] [MainThread]: On debug: select 1 as id
[0m20:13:04.333833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:05.425740 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.092 seconds
[0m20:13:05.427174 [debug] [MainThread]: On debug: Close
[0m20:13:05.501338 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:13:05.503149 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:13:05.505119 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.5521605, "process_user_time": 3.152492, "process_kernel_time": 0.524576, "process_mem_max_rss": "190100", "process_out_blocks": "20973", "process_in_blocks": "0"}
[0m20:13:05.505970 [debug] [MainThread]: Command `dbt debug` succeeded at 20:13:05.505847 after 2.55 seconds
[0m20:13:05.506541 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:13:05.507059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa560d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b4a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f087c0>]}
[0m20:13:05.507632 [debug] [MainThread]: Flushing usage events
[0m20:13:08.476692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9238c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9073a0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9073a080>]}


============================== 20:13:08.480109 | fe58d396-62fa-43e3-8359-9e7ff023b37e ==============================
[0m20:13:08.480109 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:13:08.480589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:13:08.559166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe58d396-62fa-43e3-8359-9e7ff023b37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90913a00>]}
[0m20:13:08.565875 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:13:08.567214 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:13:08.567909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11938525, "process_user_time": 1.003103, "process_kernel_time": 0.105115, "process_mem_max_rss": "93024", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m20:13:08.568327 [debug] [MainThread]: Command `dbt deps` succeeded at 20:13:08.568268 after 0.12 seconds
[0m20:13:08.568607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9238c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90913a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90910a90>]}
[0m20:13:08.568880 [debug] [MainThread]: Flushing usage events
[0m20:13:10.508076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d543a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9715a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9715a1a0>]}


============================== 20:13:10.511497 | c63d44c2-a2f7-4ccd-925c-fcae136880e9 ==============================
[0m20:13:10.511497 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:13:10.512076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:11.208840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7789bbb0>]}
[0m20:13:11.256557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974baec0>]}
[0m20:13:11.258169 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:13:11.381137 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:13:11.523300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:11.523714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:11.553372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774b10f0>]}
[0m20:13:11.628237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774e9d20>]}
[0m20:13:11.628772 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m20:13:11.629156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774e9db0>]}
[0m20:13:11.630453 [info ] [MainThread]: 
[0m20:13:11.630921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:11.633991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m20:13:11.644736 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m20:13:11.652683 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m20:13:11.653012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:12.047179 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.394 seconds
[0m20:13:12.051867 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m20:13:12.130246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m20:13:12.131546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m20:13:12.141414 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m20:13:12.144139 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m20:13:12.144811 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m20:13:12.145394 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m20:13:12.146167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:12.146701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:12.533391 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.387 seconds
[0m20:13:12.536085 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m20:13:12.569666 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.423 seconds
[0m20:13:12.571850 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m20:13:12.638658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77a6fd60>]}
[0m20:13:12.639621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:12.640251 [info ] [MainThread]: 
[0m20:13:12.651609 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m20:13:12.652456 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m20:13:12.653279 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m20:13:12.654114 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m20:13:12.654846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m20:13:12.655669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m20:13:12.656244 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m20:13:12.656878 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m20:13:12.666069 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m20:13:12.669118 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m20:13:12.671430 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m20:13:12.671965 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m20:13:12.699766 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m20:13:12.700125 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m20:13:12.702106 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m20:13:12.702945 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m20:13:12.703722 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
review_id as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m20:13:12.704100 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:12.703262 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m20:13:12.704581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:13.244459 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m20:13:13.247911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m20:13:13.290640 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m20:13:13.293534 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m20:13:13.365323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77a6e620>]}
[0m20:13:13.366167 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.71s]
[0m20:13:13.366846 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m20:13:13.375317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63d44c2-a2f7-4ccd-925c-fcae136880e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff772eace0>]}
[0m20:13:13.376021 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m20:13:13.376601 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m20:13:13.377826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:13.378259 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m20:13:13.378629 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m20:13:13.378990 [info ] [MainThread]: 
[0m20:13:13.379345 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m20:13:13.380061 [debug] [MainThread]: Command end result
[0m20:13:13.408407 [info ] [MainThread]: 
[0m20:13:13.408852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:13.409181 [info ] [MainThread]: 
[0m20:13:13.409526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:13:13.410517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9304519, "process_user_time": 3.212262, "process_kernel_time": 0.278884, "process_mem_max_rss": "196504", "process_out_blocks": "1998", "process_in_blocks": "0"}
[0m20:13:13.410951 [debug] [MainThread]: Command `dbt run` succeeded at 20:13:13.410890 after 2.93 seconds
[0m20:13:13.411264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d543a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9773a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974baec0>]}
[0m20:13:13.411564 [debug] [MainThread]: Flushing usage events
[0m20:13:15.638431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbd4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf461a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf46140>]}


============================== 20:13:15.641785 | d8d2bdd7-8755-4c3f-a11b-adabf2f43eba ==============================
[0m20:13:15.641785 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:13:15.642290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:16.135148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809aae30>]}
[0m20:13:16.163718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c073760>]}
[0m20:13:16.164326 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:13:16.223943 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:13:16.378867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:16.379557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:16.409501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8035d090>]}
[0m20:13:16.483996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803899f0>]}
[0m20:13:16.484464 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m20:13:16.484769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803899c0>]}
[0m20:13:16.486058 [info ] [MainThread]: 
[0m20:13:16.486542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:16.489860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m20:13:16.503025 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m20:13:16.503519 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m20:13:16.503861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:16.884745 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.381 seconds
[0m20:13:16.887681 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m20:13:17.009049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m20:13:17.009975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m20:13:17.021157 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m20:13:17.024250 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m20:13:17.024911 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m20:13:17.025522 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m20:13:17.026106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:17.026631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:17.421427 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.395 seconds
[0m20:13:17.424521 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m20:13:17.441594 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.415 seconds
[0m20:13:17.443733 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m20:13:17.539762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dce48e0>]}
[0m20:13:17.541139 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:17.541904 [info ] [MainThread]: 
[0m20:13:17.554264 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m20:13:17.554905 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m20:13:17.555462 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:17.556477 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m20:13:17.557409 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m20:13:17.558209 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m20:13:17.559036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m20:13:17.559714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m20:13:17.560468 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m20:13:17.561114 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m20:13:17.561777 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m20:13:17.562439 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:17.572936 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m20:13:17.577061 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m20:13:17.582428 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m20:13:17.585093 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m20:13:17.585539 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m20:13:17.585948 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:17.613016 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m20:13:17.618106 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m20:13:17.620252 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m20:13:17.621902 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m20:13:17.622492 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m20:13:17.623744 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m20:13:17.623357 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m20:13:17.622879 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m20:13:17.624083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:17.624459 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_timestamp

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m20:13:17.624870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:17.625373 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:13:18.978870 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m20:13:18.981637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.357 seconds
[0m20:13:18.984158 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m20:13:19.015190 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m20:13:19.015841 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m20:13:19.018390 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m20:13:19.084769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801daf50>]}
[0m20:13:19.087738 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.52s]
[0m20:13:19.086748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8016a470>]}
[0m20:13:19.090079 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 1.53s]
[0m20:13:19.090815 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m20:13:19.089239 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m20:13:19.120082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803194b0>]}
[0m20:13:19.121029 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.56s]
[0m20:13:19.121874 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:19.123226 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m20:13:19.123959 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:19.125699 [info ] [Thread-1 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m20:13:19.124967 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m20:13:19.124437 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:19.127916 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m20:13:19.127236 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m20:13:19.126466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m20:13:19.129738 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:19.129143 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m20:13:19.128542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m20:13:19.133084 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m20:13:19.137837 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m20:13:19.138500 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:19.142581 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m20:13:19.143332 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:19.144477 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m20:13:19.147358 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m20:13:19.147949 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:19.150628 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m20:13:19.153832 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m20:13:19.155185 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m20:13:19.156031 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_timestamp,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
extract(year from review_timestamp) as review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m20:13:19.156978 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m20:13:19.158730 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m20:13:19.158249 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m20:13:19.157305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:19.159125 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:13:19.159571 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m20:13:19.163603 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:19.927906 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m20:13:19.934228 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m20:13:19.957932 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m20:13:19.960942 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m20:13:19.966064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m20:13:19.969098 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m20:13:20.006427 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80052e00>]}
[0m20:13:20.007814 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.88s]
[0m20:13:20.009016 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m20:13:20.026788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801cbfd0>]}
[0m20:13:20.027778 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 0.90s]
[0m20:13:20.028583 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:20.074927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d2bdd7-8755-4c3f-a11b-adabf2f43eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801d86d0>]}
[0m20:13:20.076154 [info ] [Thread-1 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 0.95s]
[0m20:13:20.077525 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:20.079643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:20.080117 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m20:13:20.080508 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m20:13:20.080854 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m20:13:20.081159 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m20:13:20.081656 [info ] [MainThread]: 
[0m20:13:20.082253 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m20:13:20.083894 [debug] [MainThread]: Command end result
[0m20:13:20.128957 [info ] [MainThread]: 
[0m20:13:20.129564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:20.129994 [info ] [MainThread]: 
[0m20:13:20.130464 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:13:20.132621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5225577, "process_user_time": 3.543163, "process_kernel_time": 0.258566, "process_mem_max_rss": "199112", "process_out_blocks": "2042", "process_in_blocks": "0"}
[0m20:13:20.133542 [debug] [MainThread]: Command `dbt run` succeeded at 20:13:20.133443 after 4.52 seconds
[0m20:13:20.134181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbd4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce09480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80045990>]}
[0m20:13:20.134673 [debug] [MainThread]: Flushing usage events
[0m20:13:22.642283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb88370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af521a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af52140>]}


============================== 20:13:22.645804 | 3e3c26c4-844f-4c8c-9f35-68c1d595ae65 ==============================
[0m20:13:22.645804 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:13:22.646279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m20:13:23.147752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e3c26c4-844f-4c8c-9f35-68c1d595ae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbb7eb0>]}
[0m20:13:23.176014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e3c26c4-844f-4c8c-9f35-68c1d595ae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f63d8a0>]}
[0m20:13:23.176649 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:13:23.235444 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:13:23.368893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:23.369308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:23.399870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e3c26c4-844f-4c8c-9f35-68c1d595ae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b2b5090>]}
[0m20:13:23.482921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e3c26c4-844f-4c8c-9f35-68c1d595ae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b263670>]}
[0m20:13:23.483384 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m20:13:23.483755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e3c26c4-844f-4c8c-9f35-68c1d595ae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b278430>]}
[0m20:13:23.485098 [info ] [MainThread]: 
[0m20:13:23.485531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:23.488765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m20:13:23.489295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m20:13:23.499546 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m20:13:23.501651 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m20:13:23.501961 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m20:13:23.502303 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m20:13:23.502637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:23.502959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:23.895017 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.392 seconds
[0m20:13:23.896218 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.394 seconds
[0m20:13:23.900791 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m20:13:23.898771 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m20:13:24.258723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e3c26c4-844f-4c8c-9f35-68c1d595ae65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b263460>]}
[0m20:13:24.260635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:24.261647 [info ] [MainThread]: 
[0m20:13:24.299886 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:24.302619 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:24.304616 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:24.305026 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:24.305603 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m20:13:24.306324 [info ] [Thread-2 (]: 2 of 9 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m20:13:24.307514 [info ] [Thread-3 (]: 3 of 9 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m20:13:24.308109 [info ] [Thread-4 (]: 4 of 9 START test not_null_stg_meta_product_id ................................. [RUN]
[0m20:13:24.309154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m20:13:24.309691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m20:13:24.310177 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m20:13:24.310653 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m20:13:24.311027 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:24.311414 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:24.312525 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:24.313146 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:24.326989 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m20:13:24.334600 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m20:13:24.338490 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m20:13:24.342562 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m20:13:24.345130 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:24.357891 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:24.360633 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m20:13:24.363652 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m20:13:24.364131 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:24.363938 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:24.366298 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m20:13:24.368091 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m20:13:24.368828 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m20:13:24.369275 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m20:13:24.370190 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m20:13:24.370662 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m20:13:24.371175 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m20:13:24.371559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:24.371976 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m20:13:24.372353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:24.372760 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m20:13:24.373497 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m20:13:24.374170 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:13:24.378527 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:13:24.803217 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m20:13:24.814494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m20:13:24.819597 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m20:13:24.817529 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m20:13:24.855067 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m20:13:24.857368 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m20:13:24.882069 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.57s]
[0m20:13:24.889163 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:24.888509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m20:13:24.885159 [info ] [Thread-4 (]: 4 of 9 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.57s]
[0m20:13:24.892845 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:24.892078 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m20:13:24.889820 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:24.893460 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:24.896959 [info ] [Thread-4 (]: 6 of 9 START test not_null_stg_reviews_rating .................................. [RUN]
[0m20:13:24.897920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m20:13:24.898555 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:24.895535 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m20:13:24.904618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m20:13:24.905218 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:24.903823 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m20:13:24.911795 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m20:13:24.914897 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:24.919613 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m20:13:24.920090 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:24.924312 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m20:13:24.925758 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m20:13:24.926361 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m20:13:24.926999 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:24.927530 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m20:13:24.928852 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m20:13:24.932396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:24.941792 [info ] [Thread-3 (]: 3 of 9 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.63s]
[0m20:13:24.943245 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:24.943908 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:24.944435 [info ] [Thread-3 (]: 7 of 9 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m20:13:24.945133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m20:13:24.945627 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:24.949937 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m20:13:24.951240 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:24.953684 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m20:13:24.958269 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m20:13:24.958652 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m20:13:24.958905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:24.983706 [info ] [Thread-2 (]: 2 of 9 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.67s]
[0m20:13:24.984606 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:24.987515 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:24.987845 [info ] [Thread-2 (]: 8 of 9 START test unique_stg_meta_product_id ................................... [RUN]
[0m20:13:24.988226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m20:13:24.990713 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:24.995428 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m20:13:24.996262 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:24.998176 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m20:13:25.007010 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m20:13:25.007365 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:13:25.007679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:25.415587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m20:13:25.419553 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m20:13:25.426215 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m20:13:25.427713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m20:13:25.429982 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m20:13:25.432345 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m20:13:25.492962 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m20:13:25.499127 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m20:13:25.504326 [info ] [Thread-2 (]: 8 of 9 PASS unique_stg_meta_product_id ......................................... [[32mPASS[0m in 0.52s]
[0m20:13:25.507126 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:25.510965 [info ] [Thread-4 (]: 6 of 9 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.61s]
[0m20:13:25.513089 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:25.516204 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:25.518565 [info ] [Thread-2 (]: 9 of 9 START test unique_stg_reviews_review_id ................................. [RUN]
[0m20:13:25.520192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m20:13:25.520781 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:25.531838 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m20:13:25.535323 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.63s]
[0m20:13:25.536212 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:25.536732 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:25.539652 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m20:13:25.540897 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m20:13:25.541355 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:13:25.541796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:25.565638 [info ] [Thread-3 (]: 7 of 9 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.62s]
[0m20:13:25.566486 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:25.973219 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m20:13:25.978717 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m20:13:26.052926 [info ] [Thread-2 (]: 9 of 9 PASS unique_stg_reviews_review_id ....................................... [[32mPASS[0m in 0.53s]
[0m20:13:26.054518 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:26.057434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:26.058461 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m20:13:26.058935 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m20:13:26.059307 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m20:13:26.059738 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m20:13:26.060324 [info ] [MainThread]: 
[0m20:13:26.060905 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m20:13:26.062874 [debug] [MainThread]: Command end result
[0m20:13:26.109319 [info ] [MainThread]: 
[0m20:13:26.109944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:26.110429 [info ] [MainThread]: 
[0m20:13:26.110890 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:13:26.112801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.499262, "process_user_time": 3.847584, "process_kernel_time": 0.29838, "process_mem_max_rss": "200912", "process_out_blocks": "2055", "process_in_blocks": "0"}
[0m20:13:26.113581 [debug] [MainThread]: Command `dbt test` succeeded at 20:13:26.113500 after 3.50 seconds
[0m20:13:26.114051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb88370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bdc9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b11acb0>]}
[0m20:13:26.114524 [debug] [MainThread]: Flushing usage events
[0m20:13:28.595453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb303c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb143a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb143a170>]}


============================== 20:13:28.599422 | d2bbd684-a52e-4ece-a57c-4386617d744a ==============================
[0m20:13:28.599422 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:13:28.599863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:13:29.124237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2bbd684-a52e-4ece-a57c-4386617d744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17a1060>]}
[0m20:13:29.152750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2bbd684-a52e-4ece-a57c-4386617d744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb156faf0>]}
[0m20:13:29.153325 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m20:13:29.210773 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:13:29.335357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:29.335761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:29.365371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2bbd684-a52e-4ece-a57c-4386617d744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957ad120>]}
[0m20:13:29.373649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2bbd684-a52e-4ece-a57c-4386617d744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb156f490>]}
[0m20:13:29.374005 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m20:13:29.374333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2bbd684-a52e-4ece-a57c-4386617d744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15e0040>]}
[0m20:13:29.375622 [info ] [MainThread]: 
[0m20:13:29.376071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:29.380349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m20:13:29.380917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m20:13:29.395185 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m20:13:29.396818 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m20:13:29.397180 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m20:13:29.397509 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m20:13:29.397803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:29.398123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:29.808648 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.411 seconds
[0m20:13:29.810790 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.413 seconds
[0m20:13:29.813523 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m20:13:29.815612 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m20:13:29.884646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2bbd684-a52e-4ece-a57c-4386617d744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d97d30>]}
[0m20:13:29.885415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:29.885928 [info ] [MainThread]: 
[0m20:13:29.893857 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m20:13:29.894749 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m20:13:29.895504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m20:13:29.896171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m20:13:29.896705 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m20:13:29.897264 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m20:13:29.905759 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m20:13:29.907757 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m20:13:29.908959 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m20:13:29.909677 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m20:13:29.910026 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m20:13:29.910854 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m20:13:29.911207 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m20:13:29.911563 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:29.913144 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m20:13:29.912322 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m20:13:29.912698 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_products'
[0m20:13:29.914011 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m20:13:29.913411 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:29.913722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.fct_reviews)
[0m20:13:29.925280 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m20:13:29.915890 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m20:13:29.924798 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m20:13:29.911850 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:29.927063 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m20:13:29.928081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m20:13:29.928531 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m20:13:29.928938 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:29.929239 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:29.929575 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m20:13:29.929988 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m20:13:29.930548 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m20:13:29.935404 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:29.934642 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m20:13:29.935019 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:29.934095 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m20:13:29.935779 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m20:13:29.936154 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:29.936510 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m20:13:29.938118 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:29.937490 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:29.937772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m20:13:29.937023 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:29.940296 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m20:13:29.940992 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m20:13:29.941366 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:29.947653 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m20:13:29.948454 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:29.951958 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m20:13:29.952329 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:29.953050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m20:13:29.953581 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:29.954157 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m20:13:29.954589 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:29.954862 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:29.955443 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m20:13:29.955830 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:29.956591 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m20:13:29.959812 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m20:13:29.960335 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:29.960916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m20:13:29.961329 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m20:13:29.963016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.dim_date)
[0m20:13:29.962306 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:29.962662 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:29.961986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m20:13:29.968039 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:29.967061 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m20:13:29.967726 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m20:13:29.963317 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m20:13:29.970803 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m20:13:29.971597 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:29.973869 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m20:13:29.974335 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:29.975016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m20:13:29.975540 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:29.977115 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m20:13:29.976430 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m20:13:29.976666 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:29.976056 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m20:13:29.977433 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:29.980412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c, now model.capstone_amazon_analytics.mart_product_kpi)
[0m20:13:29.979939 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m20:13:29.977902 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m20:13:29.980682 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:29.981372 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:29.983691 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m20:13:29.983204 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m20:13:29.984186 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:29.984438 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:29.984876 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m20:13:29.985238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_date, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001)
[0m20:13:29.985505 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:29.985775 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:29.986172 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:29.986704 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m20:13:29.989823 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m20:13:29.992689 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m20:13:29.993845 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:29.994616 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m20:13:29.994164 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:29.995128 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m20:13:29.995796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:29.996060 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m20:13:29.996282 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001' was properly closed.
[0m20:13:29.996490 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d' was properly closed.
[0m20:13:29.996690 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m20:13:29.998008 [debug] [MainThread]: Command end result
[0m20:13:30.090678 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:13:30.091149 [info ] [MainThread]: Building catalog
[0m20:13:30.098670 [debug] [ThreadPool]: Acquiring new snowflake connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema'
[0m20:13:30.109870 [debug] [ThreadPool]: Using snowflake connection "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"
[0m20:13:30.110533 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:13:30.111017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:35.767301 [debug] [ThreadPool]: SQL status: SUCCESS 59 in 5.655 seconds
[0m20:13:35.800744 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: Close
[0m20:13:35.942445 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m20:13:35.945826 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.385608, "process_user_time": 2.787842, "process_kernel_time": 0.283714, "process_mem_max_rss": "197684", "process_out_blocks": "5067", "process_in_blocks": "0"}
[0m20:13:35.946819 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:13:35.946701 after 7.39 seconds
[0m20:13:35.947158 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:13:35.947384 [debug] [MainThread]: Connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema' was properly closed.
[0m20:13:35.947708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17a1060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959693c0>]}
[0m20:13:35.948131 [debug] [MainThread]: Flushing usage events
[0m00:57:15.005397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb22230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb221d0>]}


============================== 00:57:15.011370 | dcb51053-a4b8-4b85-84f3-a22358c0465e ==============================
[0m00:57:15.011370 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:57:15.011897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:57:16.619325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702b2f50>]}
[0m00:57:16.653109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70487a30>]}
[0m00:57:16.654074 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m00:57:16.744206 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:57:16.987887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:57:16.988498 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m00:57:17.155801 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:57:17.156363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bfc7be0>]}
[0m00:57:17.329955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb28d60>]}
[0m00:57:17.426084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701ad090>]}
[0m00:57:17.426554 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 459 macros
[0m00:57:17.426919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701ad060>]}
[0m00:57:17.428296 [info ] [MainThread]: 
[0m00:57:17.428833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:57:17.431901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m00:57:17.447428 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m00:57:17.447867 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m00:57:17.448191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:18.600044 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.151 seconds
[0m00:57:18.603743 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m00:57:18.720170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m00:57:18.722019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m00:57:18.734131 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m00:57:18.737808 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m00:57:18.738431 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m00:57:18.738970 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m00:57:18.739501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:57:18.739993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:19.233321 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.493 seconds
[0m00:57:19.236119 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m00:57:19.274346 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.535 seconds
[0m00:57:19.277126 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m00:57:19.350151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8227d0>]}
[0m00:57:19.351397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:57:19.352000 [info ] [MainThread]: 
[0m00:57:19.387397 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m00:57:19.387993 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m00:57:19.388716 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m00:57:19.389369 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m00:57:19.390030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m00:57:19.391029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m00:57:19.391570 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m00:57:19.392157 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m00:57:19.400774 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m00:57:19.406502 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m00:57:19.430847 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m00:57:19.432865 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m00:57:19.433219 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m00:57:19.433621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:57:19.444072 [debug] [Thread-2 (]: Compilation Error in model stg_reviews (models/staging/stg_reviews.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:57:19.446590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b029300>]}
[0m00:57:19.447433 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.05s]
[0m00:57:19.448283 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m00:57:20.041627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m00:57:20.071102 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m00:57:20.135354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb51053-a4b8-4b85-84f3-a22358c0465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70486650>]}
[0m00:57:20.136349 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.75s]
[0m00:57:20.137313 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m00:57:20.139133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:20.139670 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m00:57:20.140206 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m00:57:20.140773 [info ] [MainThread]: 
[0m00:57:20.141353 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m00:57:20.142491 [debug] [MainThread]: Command end result
[0m00:57:20.197608 [info ] [MainThread]: 
[0m00:57:20.198170 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:57:20.198661 [info ] [MainThread]: 
[0m00:57:20.205935 [error] [MainThread]:   Compilation Error in model stg_reviews (models/staging/stg_reviews.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:57:20.206311 [info ] [MainThread]: 
[0m00:57:20.206774 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:57:20.210200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.237906, "process_user_time": 3.596983, "process_kernel_time": 2.091456, "process_mem_max_rss": "203784", "process_in_blocks": "16", "process_out_blocks": "4879", "command_success": false}
[0m00:57:20.210756 [debug] [MainThread]: Command `dbt run` failed at 00:57:20.210690 after 5.24 seconds
[0m00:57:20.211145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b0c7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b0c70a0>]}
[0m00:57:20.211484 [debug] [MainThread]: Flushing usage events
[0m01:00:23.524666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba984340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d3a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d39fc0>]}


============================== 01:00:23.529677 | 4dcfb7aa-75f8-49de-830a-dd7a40538fcd ==============================
[0m01:00:23.529677 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:00:23.530236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:00:23.603920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dcfb7aa-75f8-49de-830a-dd7a40538fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e6fd60>]}
[0m01:00:23.613864 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:23.619883 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:23.620757 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12976742, "process_user_time": 1.070738, "process_kernel_time": 0.167645, "process_mem_max_rss": "92932", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m01:00:23.621203 [debug] [MainThread]: Command `dbt deps` succeeded at 01:00:23.621145 after 0.13 seconds
[0m01:00:23.621490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba984340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e6fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e6e530>]}
[0m01:00:23.621806 [debug] [MainThread]: Flushing usage events
[0m01:07:56.447786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3b43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a73e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a73e050>]}


============================== 01:07:56.454383 | dd6f5df2-b19d-4c75-ba65-0a1b642bff74 ==============================
[0m01:07:56.454383 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:07:56.455030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:07:56.535108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6f5df2-b19d-4c75-ba65-0a1b642bff74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8e7cd0>]}
[0m01:07:56.560018 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:07:56.562281 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:07:56.563070 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14812033, "process_user_time": 1.152343, "process_kernel_time": 0.303191, "process_mem_max_rss": "94496", "process_out_blocks": "323", "process_in_blocks": "0"}
[0m01:07:56.563460 [debug] [MainThread]: Command `dbt deps` succeeded at 01:07:56.563405 after 0.15 seconds
[0m01:07:56.563750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3b43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8e7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6a3580>]}
[0m01:07:56.564085 [debug] [MainThread]: Flushing usage events
[0m01:13:15.182228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90456a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf32020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf31fc0>]}


============================== 01:13:15.203300 | f527fe7f-4f5d-4d3a-a1ff-fb70e6f811ca ==============================
[0m01:13:15.203300 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:13:15.203726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:13:15.282831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f527fe7f-4f5d-4d3a-a1ff-fb70e6f811ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc1aec0>]}
[0m01:13:15.305961 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i668dvk5'
[0m01:13:15.306392 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:13:15.513649 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:13:15.516109 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:13:15.592500 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:13:15.605289 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m01:13:15.608226 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mzjbavl8'
[0m01:13:15.611435 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:13:16.060406 [info ] [MainThread]: Installed from version 1.1.1
[0m01:13:16.061067 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:13:16.061735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f527fe7f-4f5d-4d3a-a1ff-fb70e6f811ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d54b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf17be0>]}
[0m01:13:16.062153 [info ] [MainThread]: 
[0m01:13:16.062606 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:13:16.063998 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.91331196, "process_user_time": 1.321417, "process_kernel_time": 0.618599, "process_mem_max_rss": "97804", "process_out_blocks": "4231", "process_in_blocks": "0"}
[0m01:13:16.064587 [debug] [MainThread]: Command `dbt deps` succeeded at 01:13:16.064509 after 0.91 seconds
[0m01:13:16.064936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90456a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d54b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c139c30>]}
[0m01:13:16.065302 [debug] [MainThread]: Flushing usage events
[0m01:14:09.192462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae130370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac53e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac53e170>]}


============================== 01:14:09.197849 | b1045edd-7556-4b05-8c77-af5181890b3b ==============================
[0m01:14:09.197849 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:14:09.198520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m01:14:10.520758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913e2440>]}
[0m01:14:10.552041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb50e20>]}
[0m01:14:10.552771 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:14:10.625615 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:14:10.711457 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:14:10.712001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c5e70>]}
[0m01:14:11.408284 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:14:11.408844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90edfee0>]}
[0m01:14:11.642103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9297d030>]}
[0m01:14:11.724021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915b2b00>]}
[0m01:14:11.724528 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m01:14:11.724863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915b3a00>]}
[0m01:14:11.726210 [info ] [MainThread]: 
[0m01:14:11.726726 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:11.729782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m01:14:11.738708 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m01:14:11.739087 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m01:14:11.739354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:12.745485 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.006 seconds
[0m01:14:12.749100 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m01:14:12.859789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m01:14:12.862264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m01:14:12.872939 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m01:14:12.878641 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m01:14:12.879546 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m01:14:12.880084 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m01:14:12.881036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:12.881992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:13.419072 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.538 seconds
[0m01:14:13.422875 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m01:14:13.426015 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.544 seconds
[0m01:14:13.428378 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m01:14:13.506394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae243e20>]}
[0m01:14:13.507507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:13.508211 [info ] [MainThread]: 
[0m01:14:13.529958 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m01:14:13.530338 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m01:14:13.531380 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m01:14:13.531906 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m01:14:13.532418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m01:14:13.533109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m01:14:13.533425 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m01:14:13.533777 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m01:14:13.540224 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m01:14:13.543154 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m01:14:13.544756 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m01:14:13.545068 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m01:14:13.565113 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m01:14:13.568343 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m01:14:13.570348 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m01:14:13.571305 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m01:14:13.571632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:13.571062 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m01:14:13.572099 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(unixReviewTime as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m01:14:13.576187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:14:14.081529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m01:14:14.124075 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m01:14:14.349572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91dfba90>]}
[0m01:14:14.350968 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.82s]
[0m01:14:14.352059 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m01:14:14.463177 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c25fea-0306-1845-0004-85da0005a026
[0m01:14:14.463939 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 182
invalid identifier 'UNIXREVIEWTIME'
[0m01:14:14.464688 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m01:14:14.533685 [debug] [Thread-2 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  000904 (42000): SQL compilation error: error line 14 at position 182
  invalid identifier 'UNIXREVIEWTIME'
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m01:14:14.534994 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1045edd-7556-4b05-8c77-af5181890b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae241690>]}
[0m01:14:14.536177 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 1.00s]
[0m01:14:14.537355 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m01:14:14.540747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:14.541400 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m01:14:14.541978 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m01:14:14.543211 [info ] [MainThread]: 
[0m01:14:14.544050 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m01:14:14.546410 [debug] [MainThread]: Command end result
[0m01:14:14.596721 [info ] [MainThread]: 
[0m01:14:14.597231 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:14:14.597665 [info ] [MainThread]: 
[0m01:14:14.598108 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  000904 (42000): SQL compilation error: error line 14 at position 182
  invalid identifier 'UNIXREVIEWTIME'
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m01:14:14.598515 [info ] [MainThread]: 
[0m01:14:14.598906 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:14:14.600736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4461927, "process_user_time": 5.374572, "process_kernel_time": 0.978386, "process_mem_max_rss": "206664", "process_out_blocks": "21217", "command_success": false, "process_in_blocks": "0"}
[0m01:14:14.601622 [debug] [MainThread]: Command `dbt run` failed at 01:14:14.601530 after 5.45 seconds
[0m01:14:14.602152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92843df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb50e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901cbb80>]}
[0m01:14:14.602597 [debug] [MainThread]: Flushing usage events
[0m01:24:01.899320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963b4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9473a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9473a0b0>]}


============================== 01:24:01.908233 | 3e5f5ccb-0fa6-457a-8256-b27af4af3ec0 ==============================
[0m01:24:01.908233 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:24:01.908771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:01.982063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e5f5ccb-0fa6-457a-8256-b27af4af3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963dfeb0>]}
[0m01:24:02.043770 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5hk7y2og'
[0m01:24:02.044335 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:24:03.219629 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:24:03.243922 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:24:03.542021 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:24:03.575961 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:24:04.184236 [info ] [MainThread]: Installed from version 1.1.1
[0m01:24:04.185142 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:24:04.185931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e5f5ccb-0fa6-457a-8256-b27af4af3ec0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d094e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94693d00>]}
[0m01:24:04.186567 [info ] [MainThread]: 
[0m01:24:04.187003 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:24:04.193336 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3245728, "process_user_time": 2.000672, "process_kernel_time": 0.551276, "process_mem_max_rss": "94948", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m01:24:04.194291 [debug] [MainThread]: Command `dbt deps` succeeded at 01:24:04.194170 after 2.33 seconds
[0m01:24:04.194810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963b4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d60160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d094e0>]}
[0m01:24:04.195117 [debug] [MainThread]: Flushing usage events
[0m01:24:48.628937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd84370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1462c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c146230>]}


============================== 01:24:48.634426 | d0092e65-94cf-424e-9748-e1c576edeac8 ==============================
[0m01:24:48.634426 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:24:48.634997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m01:24:49.306846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddb3eb0>]}
[0m01:24:49.341582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b28940>]}
[0m01:24:49.342216 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:24:49.420860 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:24:49.577563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:49.578169 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m01:24:49.726396 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:24:49.726963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80719c00>]}
[0m01:24:49.841881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8026c130>]}
[0m01:24:49.924127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806243d0>]}
[0m01:24:49.924950 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m01:24:49.925419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80624460>]}
[0m01:24:49.927065 [info ] [MainThread]: 
[0m01:24:49.927723 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:24:49.932616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m01:24:49.946056 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m01:24:49.946653 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m01:24:49.946974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:50.525033 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.578 seconds
[0m01:24:50.529370 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m01:24:50.618725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m01:24:50.620068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m01:24:50.630726 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m01:24:50.634061 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m01:24:50.634704 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m01:24:50.635308 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m01:24:50.636058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:50.636587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:51.033465 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.397 seconds
[0m01:24:51.035421 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.399 seconds
[0m01:24:51.038153 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m01:24:51.039960 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m01:24:51.129641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80419780>]}
[0m01:24:51.130647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:24:51.131524 [info ] [MainThread]: 
[0m01:24:51.151891 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m01:24:51.152722 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m01:24:51.153616 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m01:24:51.154486 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m01:24:51.155292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m01:24:51.156366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m01:24:51.156971 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m01:24:51.157549 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m01:24:51.167227 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m01:24:51.172284 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m01:24:51.174590 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m01:24:51.175205 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m01:24:51.202947 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m01:24:51.205973 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m01:24:51.208211 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m01:24:51.208944 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m01:24:51.209215 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m01:24:51.209629 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m01:24:51.210050 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:24:51.210385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:52.629316 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.410 seconds
[0m01:24:52.625791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.415 seconds
[0m01:24:52.708956 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m01:24:52.709456 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m01:24:52.784778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80aca620>]}
[0m01:24:52.785566 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0092e65-94cf-424e-9748-e1c576edeac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db2df30>]}
[0m01:24:52.786734 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.63s]
[0m01:24:52.787678 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.62s]
[0m01:24:52.790583 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m01:24:52.791357 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m01:24:52.795812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:52.796303 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m01:24:52.796659 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m01:24:52.797291 [info ] [MainThread]: 
[0m01:24:52.797795 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m01:24:52.799265 [debug] [MainThread]: Command end result
[0m01:24:52.846384 [info ] [MainThread]: 
[0m01:24:52.846886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:24:52.847355 [info ] [MainThread]: 
[0m01:24:52.847827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:24:52.851172 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2543855, "process_user_time": 3.983042, "process_kernel_time": 0.774966, "process_mem_max_rss": "204272", "process_out_blocks": "3690", "process_in_blocks": "0"}
[0m01:24:52.852906 [debug] [MainThread]: Command `dbt run` succeeded at 01:24:52.852788 after 4.26 seconds
[0m01:24:52.853877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd84370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c725d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80388b20>]}
[0m01:24:52.854331 [debug] [MainThread]: Flushing usage events
[0m01:25:12.173481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e24a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e24a140>]}


============================== 01:25:12.177174 | d203affc-a753-46d5-a92e-4d5d3470da2e ==============================
[0m01:25:12.177174 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:25:12.177718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:25:12.685464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd203affc-a753-46d5-a92e-4d5d3470da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe7be80>]}
[0m01:25:12.714578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd203affc-a753-46d5-a92e-4d5d3470da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eb86620>]}
[0m01:25:12.715156 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:25:12.777957 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:25:12.962971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:12.963391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:12.994271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd203affc-a753-46d5-a92e-4d5d3470da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5e9240>]}
[0m01:25:13.098265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd203affc-a753-46d5-a92e-4d5d3470da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e61fa30>]}
[0m01:25:13.098983 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m01:25:13.099386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd203affc-a753-46d5-a92e-4d5d3470da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5bab00>]}
[0m01:25:13.101073 [info ] [MainThread]: 
[0m01:25:13.101845 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:13.105962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m01:25:13.106986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m01:25:13.119224 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m01:25:13.121246 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m01:25:13.121661 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m01:25:13.121982 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m01:25:13.122304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:13.122637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:13.645363 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.523 seconds
[0m01:25:13.649130 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m01:25:13.788852 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.666 seconds
[0m01:25:13.791334 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m01:25:13.900556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd203affc-a753-46d5-a92e-4d5d3470da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eb87850>]}
[0m01:25:13.901771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:25:13.902446 [info ] [MainThread]: 
[0m01:25:13.919829 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m01:25:13.920480 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m01:25:13.921030 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m01:25:13.921604 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m01:25:13.922129 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m01:25:13.923043 [info ] [Thread-2 (]: 2 of 9 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m01:25:13.923763 [info ] [Thread-3 (]: 3 of 9 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m01:25:13.924465 [info ] [Thread-4 (]: 4 of 9 START test not_null_stg_meta_product_id ................................. [RUN]
[0m01:25:13.925366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m01:25:13.926025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m01:25:13.926755 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m01:25:13.927409 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m01:25:13.928017 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m01:25:13.928540 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m01:25:13.929079 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m01:25:13.929661 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m01:25:13.948107 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m01:25:13.956999 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m01:25:13.961587 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m01:25:13.965651 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m01:25:13.969359 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m01:25:13.976767 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m01:25:13.984859 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m01:25:13.985227 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m01:25:13.987295 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m01:25:13.987724 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m01:25:13.990430 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m01:25:13.992834 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m01:25:13.993645 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m01:25:13.994870 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m01:25:13.995126 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m01:25:13.995556 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m01:25:13.996089 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m01:25:13.996366 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m01:25:13.996706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:13.997047 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m01:25:13.997362 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m01:25:13.997672 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:25:13.998228 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:25:13.998720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:25:14.823728 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m01:25:14.827680 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m01:25:14.841574 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m01:25:14.845063 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m01:25:14.846002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m01:25:14.848102 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m01:25:14.850186 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m01:25:14.854930 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m01:25:14.926331 [info ] [Thread-2 (]: 2 of 9 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 1.00s]
[0m01:25:14.929467 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m01:25:14.930206 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m01:25:14.931056 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m01:25:14.931854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m01:25:14.932430 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m01:25:14.938123 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m01:25:14.939473 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m01:25:14.943009 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m01:25:14.945353 [info ] [Thread-4 (]: 4 of 9 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 1.02s]
[0m01:25:14.946495 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m01:25:14.947244 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m01:25:14.947807 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m01:25:14.948357 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m01:25:14.948867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:25:14.949380 [info ] [Thread-4 (]: 6 of 9 START test not_null_stg_reviews_rating .................................. [RUN]
[0m01:25:14.950515 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m01:25:14.955032 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m01:25:14.960732 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m01:25:14.966941 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m01:25:14.971964 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m01:25:14.972706 [info ] [Thread-3 (]: 3 of 9 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 1.05s]
[0m01:25:14.973900 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m01:25:14.975122 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m01:25:14.975739 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m01:25:14.976735 [info ] [Thread-3 (]: 7 of 9 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m01:25:14.978155 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m01:25:14.978777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m01:25:14.979413 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 1.05s]
[0m01:25:14.979826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:25:14.980715 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m01:25:14.981836 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m01:25:14.986078 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m01:25:14.986851 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m01:25:14.990734 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_meta_product_id ................................... [RUN]
[0m01:25:14.991515 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m01:25:14.991933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m01:25:14.995882 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m01:25:14.996337 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m01:25:15.001047 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m01:25:15.002031 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m01:25:15.003014 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m01:25:15.003376 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m01:25:15.003577 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:25:15.005596 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m01:25:15.013205 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m01:25:15.013892 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:25:15.014300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:15.553320 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m01:25:15.558347 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m01:25:15.604717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m01:25:15.607548 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m01:25:15.646099 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.71s]
[0m01:25:15.647245 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m01:25:15.647976 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m01:25:15.648695 [info ] [Thread-2 (]: 9 of 9 START test unique_stg_reviews_review_id ................................. [RUN]
[0m01:25:15.649457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m01:25:15.650171 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m01:25:15.656187 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m01:25:15.657462 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m01:25:15.661262 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m01:25:15.662957 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m01:25:15.663513 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:25:15.664077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:25:15.704961 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_meta_product_id ......................................... [[32mPASS[0m in 0.71s]
[0m01:25:15.706148 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m01:25:15.722175 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m01:25:15.727809 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m01:25:15.759583 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m01:25:15.761602 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m01:25:15.841435 [info ] [Thread-4 (]: 6 of 9 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.89s]
[0m01:25:15.842439 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m01:25:15.859979 [info ] [Thread-3 (]: 7 of 9 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.88s]
[0m01:25:15.860853 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m01:25:16.064911 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m01:25:16.068529 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m01:25:16.161951 [info ] [Thread-2 (]: 9 of 9 PASS unique_stg_reviews_review_id ....................................... [[32mPASS[0m in 0.51s]
[0m01:25:16.163782 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m01:25:16.166308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:16.166973 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m01:25:16.167445 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was properly closed.
[0m01:25:16.167930 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m01:25:16.168402 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m01:25:16.169040 [info ] [MainThread]: 
[0m01:25:16.169717 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m01:25:16.171744 [debug] [MainThread]: Command end result
[0m01:25:16.222682 [info ] [MainThread]: 
[0m01:25:16.223203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:16.223530 [info ] [MainThread]: 
[0m01:25:16.223905 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:25:16.225532 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.0821276, "process_user_time": 3.832633, "process_kernel_time": 0.384166, "process_mem_max_rss": "202320", "process_out_blocks": "2534", "process_in_blocks": "0"}
[0m01:25:16.226242 [debug] [MainThread]: Command `dbt test` succeeded at 01:25:16.226147 after 4.08 seconds
[0m01:25:16.226763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0629b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5bb4f0>]}
[0m01:25:16.227242 [debug] [MainThread]: Flushing usage events
[0m01:50:35.293833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d944400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd42260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd42200>]}


============================== 01:50:35.298084 | 6e014752-07de-4151-816e-02de74c3b116 ==============================
[0m01:50:35.298084 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:50:35.298789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:50:35.904650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bee4ca0>]}
[0m01:50:35.936480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff706f4d90>]}
[0m01:50:35.937132 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m01:50:36.000065 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:50:36.147467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:50:36.147817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:50:36.176615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7012d300>]}
[0m01:50:36.253160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d385d20>]}
[0m01:50:36.253860 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m01:50:36.254167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6edf90>]}
[0m01:50:36.255458 [info ] [MainThread]: 
[0m01:50:36.256204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:50:36.259684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m01:50:36.276610 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m01:50:36.276991 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m01:50:36.277216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:36.812712 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.535 seconds
[0m01:50:36.816193 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m01:50:36.927520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m01:50:36.929983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m01:50:36.942816 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m01:50:36.946449 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m01:50:36.947148 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m01:50:36.947787 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m01:50:36.948502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:36.949034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:37.459770 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.511 seconds
[0m01:50:37.464628 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m01:50:37.471077 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.522 seconds
[0m01:50:37.473134 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m01:50:37.542559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d95e860>]}
[0m01:50:37.543913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:50:37.544965 [info ] [MainThread]: 
[0m01:50:37.557311 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m01:50:37.557862 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m01:50:37.558659 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m01:50:37.559519 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m01:50:37.560330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m01:50:37.560994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m01:50:37.561631 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m01:50:37.562222 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m01:50:37.571546 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m01:50:37.586612 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m01:50:37.588377 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m01:50:37.606449 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m01:50:37.612573 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m01:50:37.615304 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m01:50:37.617330 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m01:50:37.618343 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m01:50:37.618619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:37.618100 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m01:50:37.619033 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
cast(review_time as timestamp) as review_timestamp
from source
where review_id is not null

)

select *
from renamed
  );
[0m01:50:37.621578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:50:38.194316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m01:50:38.222000 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m01:50:38.275029 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m01:50:38.277650 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m01:50:38.300022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ab4fc40>]}
[0m01:50:38.300961 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.74s]
[0m01:50:38.302011 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m01:50:38.381339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e014752-07de-4151-816e-02de74c3b116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5ab3d0>]}
[0m01:50:38.382935 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.82s]
[0m01:50:38.383855 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m01:50:38.385692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:50:38.386220 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m01:50:38.386722 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m01:50:38.387306 [info ] [MainThread]: 
[0m01:50:38.387850 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m01:50:38.388928 [debug] [MainThread]: Command end result
[0m01:50:38.439498 [info ] [MainThread]: 
[0m01:50:38.440069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:50:38.440586 [info ] [MainThread]: 
[0m01:50:38.440997 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:50:38.442023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.178773, "process_user_time": 3.074265, "process_kernel_time": 0.495456, "process_mem_max_rss": "197636", "process_out_blocks": "2480", "process_in_blocks": "0"}
[0m01:50:38.442492 [debug] [MainThread]: Command `dbt run` succeeded at 01:50:38.442436 after 3.18 seconds
[0m01:50:38.442776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d944400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c327b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb8b9a0>]}
[0m01:50:38.443087 [debug] [MainThread]: Flushing usage events
[0m03:41:30.711353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45243a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2926290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2926230>]}


============================== 03:41:30.717526 | f637f6b4-46e4-4e22-ba0b-008c14a66438 ==============================
[0m03:41:30.717526 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:41:30.718155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:41:32.071688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832aa2f0>]}
[0m03:41:32.102533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832aaf20>]}
[0m03:41:32.103148 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:41:32.179691 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:41:32.363825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:41:32.364433 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m03:41:32.540442 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:41:32.540966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b1b190>]}
[0m03:41:32.688485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829f0100>]}
[0m03:41:32.781404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82daada0>]}
[0m03:41:32.781907 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m03:41:32.782304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82daab00>]}
[0m03:41:32.783688 [info ] [MainThread]: 
[0m03:41:32.784158 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:41:32.787179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m03:41:32.798723 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m03:41:32.799123 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m03:41:32.799365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:33.649041 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.849 seconds
[0m03:41:33.652418 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m03:41:33.720833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m03:41:33.721776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m03:41:33.737360 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m03:41:33.740466 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m03:41:33.741088 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m03:41:33.741629 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m03:41:33.742225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:33.742706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:34.122567 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.380 seconds
[0m03:41:34.126543 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m03:41:34.191100 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.449 seconds
[0m03:41:34.194781 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m03:41:34.303158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8324fd30>]}
[0m03:41:34.304475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:41:34.305211 [info ] [MainThread]: 
[0m03:41:34.332699 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m03:41:34.333667 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m03:41:34.334522 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m03:41:34.335387 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m03:41:34.336168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m03:41:34.337252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m03:41:34.337832 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m03:41:34.338408 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m03:41:34.347582 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m03:41:34.352192 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:41:34.354224 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m03:41:34.361278 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m03:41:34.377634 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m03:41:34.380992 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:41:34.382840 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m03:41:34.383888 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m03:41:34.384214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:34.383634 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m03:41:34.384695 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,

to_timestamp(review_time, 'MM DD, YYYY') as review_timestamp,
year(to_timestamp(review_time, 'MM DD, YYYY')) as review_year


from source
where review_id is not null

)

select *
from renamed
  );
[0m03:41:34.388968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:41:34.799556 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2607d-0306-1875-0004-85da0005b4de
[0m03:41:34.800660 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 20 at position 0
too many arguments for function [TO_TIMESTAMP(SOURCE.REVIEW_TIME, 'MM DD, YYYY')] expected 1, got 2
[0m03:41:34.801328 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m03:41:35.003772 [debug] [Thread-2 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  000939 (22023): SQL compilation error: error line 20 at position 0
  too many arguments for function [TO_TIMESTAMP(SOURCE.REVIEW_TIME, 'MM DD, YYYY')] expected 1, got 2
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m03:41:35.006886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42c1fc0>]}
[0m03:41:35.007923 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.67s]
[0m03:41:35.008946 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m03:41:35.449111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.065 seconds
[0m03:41:35.479733 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m03:41:35.569549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f637f6b4-46e4-4e22-ba0b-008c14a66438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8324e650>]}
[0m03:41:35.570681 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.23s]
[0m03:41:35.571618 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m03:41:35.575810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:35.576357 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m03:41:35.576858 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m03:41:35.577503 [info ] [MainThread]: 
[0m03:41:35.578080 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m03:41:35.579159 [debug] [MainThread]: Command end result
[0m03:41:35.630719 [info ] [MainThread]: 
[0m03:41:35.631181 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:41:35.631558 [info ] [MainThread]: 
[0m03:41:35.631992 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  000939 (22023): SQL compilation error: error line 20 at position 0
  too many arguments for function [TO_TIMESTAMP(SOURCE.REVIEW_TIME, 'MM DD, YYYY')] expected 1, got 2
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m03:41:35.632340 [info ] [MainThread]: 
[0m03:41:35.632764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m03:41:35.635922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9600654, "process_user_time": 3.636805, "process_kernel_time": 2.685438, "process_mem_max_rss": "204964", "process_out_blocks": "3694", "command_success": false, "process_in_blocks": "0"}
[0m03:41:35.636944 [debug] [MainThread]: Command `dbt run` failed at 03:41:35.636855 after 4.96 seconds
[0m03:41:35.637548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45243a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832aaf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829a9ea0>]}
[0m03:41:35.638508 [debug] [MainThread]: Flushing usage events
[0m03:43:28.924405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2fb43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1346200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13461a0>]}


============================== 03:43:28.928745 | b480faae-4949-4701-8a92-8bf5da66f4e6 ==============================
[0m03:43:28.928745 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:43:28.929301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:43:29.513534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d7a560>]}
[0m03:43:29.544262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d44cd0>]}
[0m03:43:29.544903 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:43:29.610934 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:43:29.774546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:43:29.775112 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m03:43:29.903977 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:43:29.904530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b79480>]}
[0m03:43:30.110545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954c0130>]}
[0m03:43:30.253878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958835e0>]}
[0m03:43:30.254423 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m03:43:30.254953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958824a0>]}
[0m03:43:30.257108 [info ] [MainThread]: 
[0m03:43:30.257907 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:43:30.261256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m03:43:30.273874 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m03:43:30.282317 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m03:43:30.282652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:30.807133 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.519 seconds
[0m03:43:30.846469 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m03:43:31.420703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m03:43:31.416733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m03:43:31.495058 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m03:43:31.495789 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m03:43:31.496708 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m03:43:31.497033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:31.496208 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m03:43:31.501234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:32.008097 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.510 seconds
[0m03:43:32.020017 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m03:43:32.072691 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.571 seconds
[0m03:43:32.075763 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m03:43:32.155022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d17d30>]}
[0m03:43:32.157049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:43:32.157766 [info ] [MainThread]: 
[0m03:43:32.176686 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m03:43:32.177072 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m03:43:32.177877 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m03:43:32.178375 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m03:43:32.178925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m03:43:32.179639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m03:43:32.180031 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m03:43:32.180424 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m03:43:32.189426 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m03:43:32.195027 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:43:32.196514 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m03:43:32.203447 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m03:43:32.217366 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m03:43:32.219604 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:43:32.220963 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m03:43:32.221340 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m03:43:32.222242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:32.221993 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m03:43:32.227178 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,

to_timestamp_ntz(review_time, 'MM DD, YYYY') as review_timestamp,
year(to_timestamp_ntz(review_time, 'MM DD, YYYY')) as review_year


from source
where review_id is not null

)

select *
from renamed
  );
[0m03:43:32.227453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:43:32.741097 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2607f-0306-1845-0004-85da0005a632
[0m03:43:32.741926 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 20 at position 0
too many arguments for function [TO_TIMESTAMP_NTZ(SOURCE.REVIEW_TIME, 'MM DD, YYYY')] expected 1, got 2
[0m03:43:32.742760 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m03:43:32.820998 [debug] [Thread-2 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  000939 (22023): SQL compilation error: error line 20 at position 0
  too many arguments for function [TO_TIMESTAMP_NTZ(SOURCE.REVIEW_TIME, 'MM DD, YYYY')] expected 1, got 2
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m03:43:32.825828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949cb6a0>]}
[0m03:43:32.826826 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.64s]
[0m03:43:32.827997 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m03:43:32.851327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m03:43:32.882827 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m03:43:33.000254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b480faae-4949-4701-8a92-8bf5da66f4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d16650>]}
[0m03:43:33.002051 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.82s]
[0m03:43:33.003440 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m03:43:33.005733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:33.006359 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m03:43:33.006861 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m03:43:33.007546 [info ] [MainThread]: 
[0m03:43:33.008169 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m03:43:33.009495 [debug] [MainThread]: Command end result
[0m03:43:33.065780 [info ] [MainThread]: 
[0m03:43:33.066323 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:43:33.066696 [info ] [MainThread]: 
[0m03:43:33.067101 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  000939 (22023): SQL compilation error: error line 20 at position 0
  too many arguments for function [TO_TIMESTAMP_NTZ(SOURCE.REVIEW_TIME, 'MM DD, YYYY')] expected 1, got 2
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m03:43:33.067454 [info ] [MainThread]: 
[0m03:43:33.067859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m03:43:33.074217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.181542, "process_user_time": 4.142453, "process_kernel_time": 0.741155, "process_mem_max_rss": "204940", "process_out_blocks": "3694", "command_success": false, "process_in_blocks": "0"}
[0m03:43:33.075781 [debug] [MainThread]: Command `dbt run` failed at 03:43:33.075687 after 4.18 seconds
[0m03:43:33.076469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21f63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d7a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95743d30>]}
[0m03:43:33.076856 [debug] [MainThread]: Flushing usage events
[0m03:49:12.040150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad23c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab63a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab63a110>]}


============================== 03:49:12.044597 | 0945021e-675c-4efe-8de2-18649b7ca7be ==============================
[0m03:49:12.044597 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:49:12.045206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m03:49:12.631344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad267ee0>]}
[0m03:49:12.665122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf7cc40>]}
[0m03:49:12.666054 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:49:12.732378 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:49:12.889676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:49:12.890249 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m03:49:13.024900 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:49:13.025527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba025c0>]}
[0m03:49:13.132209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b728130>]}
[0m03:49:13.206140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8badeb00>]}
[0m03:49:13.206566 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m03:49:13.206923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8badece0>]}
[0m03:49:13.208205 [info ] [MainThread]: 
[0m03:49:13.209161 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:49:13.212356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m03:49:13.220558 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m03:49:13.220877 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m03:49:13.221130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:13.732791 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.511 seconds
[0m03:49:13.737858 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m03:49:13.824613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m03:49:13.825691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m03:49:13.837525 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m03:49:13.840610 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m03:49:13.841503 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m03:49:13.842263 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m03:49:13.843007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:13.843620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:14.256369 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.412 seconds
[0m03:49:14.261605 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m03:49:14.268943 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.425 seconds
[0m03:49:14.272170 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m03:49:14.336488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf532e0>]}
[0m03:49:14.337956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:49:14.338766 [info ] [MainThread]: 
[0m03:49:14.353027 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m03:49:14.353615 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m03:49:14.354588 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m03:49:14.355487 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m03:49:14.356357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m03:49:14.357415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m03:49:14.358097 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m03:49:14.358691 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m03:49:14.368637 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m03:49:14.373050 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:49:14.374847 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m03:49:14.375190 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m03:49:14.399165 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:49:14.401751 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m03:49:14.403711 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m03:49:14.404651 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  -- parse string date safely

    TRY_TO_DATE(review_time, 'MM DD, YYYY') as review_date,



    -- derive year in staging

    YEAR(TRY_TO_DATE(review_time, 'MM DD, YYYY')) as review_year

from source
where review_id is not null

)

select *
from renamed
  );
[0m03:49:14.405060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:49:14.404377 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m03:49:14.406601 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m03:49:14.408546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:14.758233 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c26085-0306-1875-0004-85da0005b4f6
[0m03:49:14.759206 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types TIMESTAMP_NTZ(9) and DATE
[0m03:49:14.760044 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m03:49:14.833176 [debug] [Thread-2 (]: Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types TIMESTAMP_NTZ(9) and DATE
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m03:49:14.836732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6ee7d0>]}
[0m03:49:14.837910 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model STAGE_STAGE.stg_reviews ................... [[31mERROR[0m in 0.48s]
[0m03:49:14.838992 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m03:49:14.877798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m03:49:14.905728 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m03:49:14.983218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0945021e-675c-4efe-8de2-18649b7ca7be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf525c0>]}
[0m03:49:14.984345 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m03:49:14.985330 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m03:49:14.987537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:14.988072 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m03:49:14.988519 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m03:49:14.989082 [info ] [MainThread]: 
[0m03:49:14.989693 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m03:49:14.990883 [debug] [MainThread]: Command end result
[0m03:49:15.039716 [info ] [MainThread]: 
[0m03:49:15.040237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:15.040740 [info ] [MainThread]: 
[0m03:49:15.041243 [error] [MainThread]:   Database Error in model stg_reviews (models/staging/stg_reviews.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types TIMESTAMP_NTZ(9) and DATE
  compiled code at target/run/capstone_amazon_analytics/models/staging/stg_reviews.sql
[0m03:49:15.041774 [info ] [MainThread]: 
[0m03:49:15.042189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m03:49:15.043906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.048308, "process_user_time": 3.351977, "process_kernel_time": 0.471088, "process_mem_max_rss": "204932", "process_out_blocks": "3695", "command_success": false, "process_in_blocks": "0"}
[0m03:49:15.044630 [debug] [MainThread]: Command `dbt run` failed at 03:49:15.044533 after 3.05 seconds
[0m03:49:15.045112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad23c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf7cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad298a60>]}
[0m03:49:15.045560 [debug] [MainThread]: Flushing usage events
[0m03:54:02.773399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70521d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7052170>]}


============================== 03:54:02.778638 | e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc ==============================
[0m03:54:02.778638 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:54:02.779297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:03.423913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71bbdf0>]}
[0m03:54:03.453270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97998d60>]}
[0m03:54:03.453845 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m03:54:03.519928 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:54:03.677104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:54:03.677800 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m03:54:03.814898 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:54:03.815409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977c05e0>]}
[0m03:54:03.934830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97140100>]}
[0m03:54:04.017888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973a28f0>]}
[0m03:54:04.018460 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m03:54:04.018944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973a2ec0>]}
[0m03:54:04.020561 [info ] [MainThread]: 
[0m03:54:04.021215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:54:04.024916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m03:54:04.047228 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m03:54:04.047936 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m03:54:04.048415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:04.618742 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.570 seconds
[0m03:54:04.622922 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m03:54:04.714798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m03:54:04.717029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m03:54:04.731563 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m03:54:04.732276 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m03:54:04.732814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:04.728632 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m03:54:04.733687 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m03:54:04.737308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:05.118662 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.386 seconds
[0m03:54:05.122851 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m03:54:05.150290 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.413 seconds
[0m03:54:05.152603 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m03:54:05.227127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f6bb80>]}
[0m03:54:05.228349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:54:05.228906 [info ] [MainThread]: 
[0m03:54:05.246845 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m03:54:05.247370 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m03:54:05.248102 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m03:54:05.248766 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m03:54:05.249478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m03:54:05.250467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m03:54:05.250879 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m03:54:05.251313 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m03:54:05.261407 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m03:54:05.266664 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:54:05.268386 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m03:54:05.289739 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m03:54:05.297193 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m03:54:05.300446 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m03:54:05.302293 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m03:54:05.303630 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m03:54:05.303947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:05.303367 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m03:54:05.304513 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time_raw,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m03:54:05.308304 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:54:05.768880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m03:54:05.791288 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m03:54:05.803096 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m03:54:05.800819 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m03:54:05.901523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f302e0>]}
[0m03:54:05.902789 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.65s]
[0m03:54:05.905214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52e5cfd-e5db-4f86-b8dc-52cbfa4bb2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97966680>]}
[0m03:54:05.906151 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m03:54:05.906985 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.66s]
[0m03:54:05.908362 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m03:54:05.910470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:05.911215 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m03:54:05.911691 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m03:54:05.912333 [info ] [MainThread]: 
[0m03:54:05.912977 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m03:54:05.914246 [debug] [MainThread]: Command end result
[0m03:54:05.964257 [info ] [MainThread]: 
[0m03:54:05.964771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:54:05.965197 [info ] [MainThread]: 
[0m03:54:05.965678 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:54:05.970414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2322497, "process_user_time": 3.420869, "process_kernel_time": 0.860513, "process_mem_max_rss": "204056", "process_out_blocks": "3698", "process_in_blocks": "0"}
[0m03:54:05.973141 [debug] [MainThread]: Command `dbt run` succeeded at 03:54:05.973008 after 3.24 seconds
[0m03:54:05.973769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9711f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970fb160>]}
[0m03:54:05.974135 [debug] [MainThread]: Flushing usage events
[0m04:34:54.055853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2822200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28221a0>]}


============================== 04:34:54.061612 | db6be031-e59a-413b-b046-853e8c6484b6 ==============================
[0m04:34:54.061612 [info ] [MainThread]: Running with dbt=1.8.3
[0m04:34:54.062362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:34:55.079043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8317a560>]}
[0m04:34:55.109804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83144cd0>]}
[0m04:34:55.110508 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m04:34:55.195614 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m04:34:55.391287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m04:34:55.392222 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews_granular.sql
[0m04:34:55.392572 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m04:34:55.392872 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_product_kpi.sql
[0m04:34:55.393176 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m04:34:55.393475 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m04:34:55.550654 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:34:55.551326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f7bb50>]}
[0m04:34:55.673797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825bce20>]}
[0m04:34:55.761106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c75420>]}
[0m04:34:55.761604 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m04:34:55.761944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c75480>]}
[0m04:34:55.763462 [info ] [MainThread]: 
[0m04:34:55.764065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:34:55.767089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m04:34:55.776862 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m04:34:55.777206 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m04:34:55.777427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:56.599606 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.822 seconds
[0m04:34:56.602884 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m04:34:56.715265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m04:34:56.717110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m04:34:56.732048 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m04:34:56.736854 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m04:34:56.737612 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m04:34:56.739162 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m04:34:56.741028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:56.742072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:57.183878 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.441 seconds
[0m04:34:57.188293 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m04:34:57.234365 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.493 seconds
[0m04:34:57.236849 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m04:34:57.313718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83117d30>]}
[0m04:34:57.314834 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:34:57.315551 [info ] [MainThread]: 
[0m04:34:57.327803 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m04:34:57.328381 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m04:34:57.329162 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m04:34:57.329976 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m04:34:57.330793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m04:34:57.331616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m04:34:57.332098 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m04:34:57.332495 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m04:34:57.341335 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m04:34:57.355494 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:34:57.357396 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m04:34:57.357770 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m04:34:57.380785 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m04:34:57.383457 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m04:34:57.385526 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m04:34:57.386687 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time_raw,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m04:34:57.387053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:34:57.386341 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m04:34:57.387484 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m04:34:57.391021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:58.126338 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m04:34:58.128253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m04:34:58.161207 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m04:34:58.162409 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m04:34:58.224649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa362afb0>]}
[0m04:34:58.225712 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.89s]
[0m04:34:58.226809 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m04:34:58.231305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db6be031-e59a-413b-b046-853e8c6484b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83116650>]}
[0m04:34:58.232215 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.90s]
[0m04:34:58.233028 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m04:34:58.235259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:58.235781 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m04:34:58.236263 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m04:34:58.236847 [info ] [MainThread]: 
[0m04:34:58.237703 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m04:34:58.238796 [debug] [MainThread]: Command end result
[0m04:34:58.282207 [info ] [MainThread]: 
[0m04:34:58.282688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:58.283096 [info ] [MainThread]: 
[0m04:34:58.283532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:34:58.284995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.267024, "process_user_time": 3.598259, "process_kernel_time": 1.507622, "process_mem_max_rss": "204428", "process_out_blocks": "3699", "process_in_blocks": "0"}
[0m04:34:58.285566 [debug] [MainThread]: Command `dbt run` succeeded at 04:34:58.285494 after 4.27 seconds
[0m04:34:58.285962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d36590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8317a560>]}
[0m04:34:58.286301 [debug] [MainThread]: Flushing usage events
[0m05:27:52.561991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f83c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc36050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc35ff0>]}


============================== 05:27:52.570888 | 3a7f1220-39ac-4153-ab4a-ed04e4fc5d85 ==============================
[0m05:27:52.570888 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:27:52.571461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:52.582730 [info ] [MainThread]: dbt version: 1.8.3
[0m05:27:52.583209 [info ] [MainThread]: python version: 3.10.14
[0m05:27:52.583535 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:27:52.583846 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:27:54.368822 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m05:27:54.370038 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m05:27:54.370466 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:27:54.371367 [info ] [MainThread]: adapter type: snowflake
[0m05:27:54.371748 [info ] [MainThread]: adapter version: 1.8.2
[0m05:27:54.453931 [info ] [MainThread]: Configuration:
[0m05:27:54.454639 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:27:54.455303 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:27:54.455717 [info ] [MainThread]: Required dependencies:
[0m05:27:54.456142 [debug] [MainThread]: Executing "git --help"
[0m05:27:54.533409 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:27:54.535319 [debug] [MainThread]: STDERR: "b''"
[0m05:27:54.535629 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:27:54.535943 [info ] [MainThread]: Connection:
[0m05:27:54.536222 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:27:54.536519 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:27:54.536848 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:27:54.537109 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:27:54.537346 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:27:54.537595 [info ] [MainThread]:   schema: STAGE
[0m05:27:54.537913 [info ] [MainThread]:   authenticator: jwt
[0m05:27:54.538181 [info ] [MainThread]:   oauth_client_id: None
[0m05:27:54.538457 [info ] [MainThread]:   query_tag: None
[0m05:27:54.538723 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:27:54.538992 [info ] [MainThread]:   host: None
[0m05:27:54.539269 [info ] [MainThread]:   port: None
[0m05:27:54.539481 [info ] [MainThread]:   proxy_host: None
[0m05:27:54.539777 [info ] [MainThread]:   proxy_port: None
[0m05:27:54.540092 [info ] [MainThread]:   protocol: None
[0m05:27:54.540414 [info ] [MainThread]:   connect_retries: 1
[0m05:27:54.540673 [info ] [MainThread]:   connect_timeout: None
[0m05:27:54.540898 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:27:54.541113 [info ] [MainThread]:   retry_all: False
[0m05:27:54.541410 [info ] [MainThread]:   insecure_mode: False
[0m05:27:54.541701 [info ] [MainThread]:   reuse_connections: None
[0m05:27:54.542220 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:27:54.700816 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:27:54.702925 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:27:54.704139 [debug] [MainThread]: On debug: select 1 as id
[0m05:27:54.707197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:27:55.872006 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.165 seconds
[0m05:27:55.874081 [debug] [MainThread]: On debug: Close
[0m05:27:55.956421 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:27:55.958253 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:27:55.960409 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4348743, "process_user_time": 2.765771, "process_kernel_time": 2.157363, "process_mem_max_rss": "187000", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m05:27:55.961216 [debug] [MainThread]: Command `dbt debug` succeeded at 05:27:55.961085 after 3.44 seconds
[0m05:27:55.961750 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:27:55.962150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f83c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea46f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e3b0c70>]}
[0m05:27:55.962525 [debug] [MainThread]: Flushing usage events
[0m05:27:58.642444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78302b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c31f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c31f30>]}


============================== 05:27:58.646001 | 8f7c3b9a-3728-40a1-a796-ed20effad7c8 ==============================
[0m05:27:58.646001 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:27:58.646550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:58.775855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f7c3b9a-3728-40a1-a796-ed20effad7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb785ff10>]}
[0m05:27:58.875951 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r7nddym8'
[0m05:27:58.876475 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:27:59.037894 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:27:59.039491 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:27:59.157796 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:27:59.164047 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:27:59.994239 [info ] [MainThread]: Installed from version 1.1.1
[0m05:28:00.006518 [info ] [MainThread]: Updated version available: 1.3.3
[0m05:28:00.013910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8f7c3b9a-3728-40a1-a796-ed20effad7c8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71dc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b8fd30>]}
[0m05:28:00.022328 [info ] [MainThread]: 
[0m05:28:00.027441 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:28:00.034758 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4244059, "process_user_time": 1.323233, "process_kernel_time": 0.41288, "process_mem_max_rss": "95100", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m05:28:00.039925 [debug] [MainThread]: Command `dbt deps` succeeded at 05:28:00.039682 after 1.43 seconds
[0m05:28:00.040933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78302b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c317b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71dc760>]}
[0m05:28:00.041485 [debug] [MainThread]: Flushing usage events
[0m05:28:02.789435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1126200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11261a0>]}


============================== 05:28:02.793590 | 8ba474e4-28eb-4ce4-8e75-7ff005f6baea ==============================
[0m05:28:02.793590 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:28:02.794262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:28:03.659565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aea560>]}
[0m05:28:03.696686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ac3d00>]}
[0m05:28:03.697406 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:28:03.781168 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:28:04.167875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:28:04.168417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:28:04.207321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954f52a0>]}
[0m05:28:04.320874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955d7760>]}
[0m05:28:04.321358 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:28:04.321840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955d5330>]}
[0m05:28:04.323871 [info ] [MainThread]: 
[0m05:28:04.324399 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:28:04.328704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:28:04.339380 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:28:04.339774 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:28:04.340045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:04.788012 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.448 seconds
[0m05:28:04.791620 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:28:05.337544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:28:05.339208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:28:05.351706 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:28:05.356048 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:28:05.356731 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:28:05.357334 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:28:05.358043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:28:05.358923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:05.986318 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.628 seconds
[0m05:28:05.989631 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:28:06.071582 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.713 seconds
[0m05:28:06.074185 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:28:06.142707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a8fd30>]}
[0m05:28:06.143792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:28:06.144613 [info ] [MainThread]: 
[0m05:28:06.157000 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:28:06.157620 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:28:06.158609 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:28:06.159703 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:28:06.160841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m05:28:06.161965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m05:28:06.162697 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:28:06.164227 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:28:06.173307 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:28:06.188028 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:28:06.190125 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:28:06.199758 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:28:06.211739 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:28:06.214103 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:28:06.215931 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:28:06.217139 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m05:28:06.217467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:06.216910 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:28:06.217978 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time_raw,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m05:28:06.221674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:28:06.867497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m05:28:06.870847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m05:28:06.904342 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:28:06.905182 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:28:06.975496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a8e650>]}
[0m05:28:06.978086 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m05:28:06.977080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba474e4-28eb-4ce4-8e75-7ff005f6baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954b2ad0>]}
[0m05:28:06.979736 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:28:06.981235 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.82s]
[0m05:28:06.982519 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:28:06.984360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:28:06.984934 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m05:28:06.985478 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m05:28:06.986083 [info ] [MainThread]: 
[0m05:28:06.986668 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m05:28:06.987737 [debug] [MainThread]: Command end result
[0m05:28:07.031223 [info ] [MainThread]: 
[0m05:28:07.031720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:28:07.032069 [info ] [MainThread]: 
[0m05:28:07.032472 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:28:07.034028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.277863, "process_user_time": 3.434966, "process_kernel_time": 0.814267, "process_mem_max_rss": "197596", "process_out_blocks": "2487", "process_in_blocks": "0"}
[0m05:28:07.034656 [debug] [MainThread]: Command `dbt run` succeeded at 05:28:07.034579 after 4.28 seconds
[0m05:28:07.035043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aea560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f4a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94969570>]}
[0m05:28:07.035455 [debug] [MainThread]: Flushing usage events
[0m05:28:09.336305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a70220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e42080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e42020>]}


============================== 05:28:09.340154 | 62c5fba8-521d-4175-ac48-7b24a6882d4e ==============================
[0m05:28:09.340154 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:28:09.340812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:28:09.865234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677e14b0>]}
[0m05:28:09.895273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677b0b80>]}
[0m05:28:09.895859 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:28:09.964891 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:28:10.113369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:28:10.113776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:28:10.142707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff671e9120>]}
[0m05:28:10.219843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff672cd210>]}
[0m05:28:10.220430 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:28:10.220914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff672cd270>]}
[0m05:28:10.222677 [info ] [MainThread]: 
[0m05:28:10.223200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:28:10.226655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:28:10.237426 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:28:10.237892 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:28:10.238182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:10.661922 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.424 seconds
[0m05:28:10.666019 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:28:10.747686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:28:10.749040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:28:10.759329 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:28:10.763152 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:28:10.763899 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:28:10.764459 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:28:10.765045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:10.765608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:28:11.262295 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.497 seconds
[0m05:28:11.267040 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:28:11.263896 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.498 seconds
[0m05:28:11.271525 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:28:11.348425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677872b0>]}
[0m05:28:11.349255 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:28:11.349802 [info ] [MainThread]: 
[0m05:28:11.360239 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m05:28:11.361113 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m05:28:11.361604 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:28:11.362497 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m05:28:11.363307 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m05:28:11.364103 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m05:28:11.364974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m05:28:11.365671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m05:28:11.366525 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m05:28:11.367143 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m05:28:11.367768 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m05:28:11.368403 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:28:11.378312 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m05:28:11.382728 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:28:11.387159 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:28:11.389764 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m05:28:11.390316 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m05:28:11.397468 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:28:11.416247 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m05:28:11.418596 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:28:11.420896 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:28:11.422723 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m05:28:11.423311 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m05:28:11.424481 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
--categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m05:28:11.424112 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:28:11.423612 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m05:28:11.424815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:11.425164 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
--review_timestamp
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m05:28:11.425501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:28:11.425958 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:28:13.060213 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c260e8-0306-198a-0004-85da0005e1e6
[0m05:28:13.065017 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 0
invalid identifier 'REVIEW_TIMESTAMP'
[0m05:28:13.069220 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m05:28:13.168650 [debug] [Thread-2 (]: Database Error in model fct_reviews (models/marts/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 9 at position 0
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/fct_reviews.sql
[0m05:28:13.175175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d4b400>]}
[0m05:28:13.179192 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model STAGE_MART.fct_reviews ................... [[31mERROR[0m in 1.80s]
[0m05:28:13.181920 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m05:28:14.448801 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.023 seconds
[0m05:28:14.469409 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m05:28:14.562316 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d4b7f0>]}
[0m05:28:14.563330 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.20s]
[0m05:28:14.564331 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:28:14.565952 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m05:28:14.566696 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m05:28:14.567549 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m05:28:14.568125 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m05:28:14.573727 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m05:28:14.575891 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m05:28:14.580852 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m05:28:14.582510 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m05:28:14.582939 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m05:28:14.583387 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:28:14.976352 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c260e8-0306-1845-0004-85da0005a8a6
[0m05:28:14.978035 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 5
invalid identifier 'REVIEW_TIMESTAMP'
[0m05:28:14.979070 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m05:28:15.043317 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:28:15.044166 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6539b7f0>]}
[0m05:28:15.045049 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 0.48s]
[0m05:28:15.046021 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m05:28:26.275959 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c260e8-0306-198a-0004-85da0005e1ea
[0m05:28:26.280031 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
[0m05:28:26.282474 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m05:28:26.375054 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:28:26.377789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c5fba8-521d-4175-ac48-7b24a6882d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff653802b0>]}
[0m05:28:26.381543 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 15.01s]
[0m05:28:26.383791 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m05:28:26.390458 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:28:26.391346 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:28:26.392464 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m05:28:26.393298 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m05:28:26.394134 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:28:26.394793 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:28:26.402963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:28:26.404026 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m05:28:26.404451 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m05:28:26.404799 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m05:28:26.405188 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m05:28:26.407674 [info ] [MainThread]: 
[0m05:28:26.408446 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 16.18 seconds (16.18s).
[0m05:28:26.410399 [debug] [MainThread]: Command end result
[0m05:28:26.459788 [info ] [MainThread]: 
[0m05:28:26.460441 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:28:26.460846 [info ] [MainThread]: 
[0m05:28:26.461355 [error] [MainThread]:   Database Error in model fct_reviews (models/marts/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 9 at position 0
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/fct_reviews.sql
[0m05:28:26.461736 [info ] [MainThread]: 
[0m05:28:26.462129 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:28:26.462514 [info ] [MainThread]: 
[0m05:28:26.462970 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:28:26.463310 [info ] [MainThread]: 
[0m05:28:26.463760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m05:28:26.466829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.160444, "process_user_time": 4.759853, "process_kernel_time": 0.595741, "process_mem_max_rss": "200852", "process_out_blocks": "2507", "command_success": false, "process_in_blocks": "0"}
[0m05:28:26.467801 [debug] [MainThread]: Command `dbt run` failed at 05:28:26.467719 after 17.16 seconds
[0m05:28:26.468362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a70220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c869b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d33370>]}
[0m05:28:26.468680 [debug] [MainThread]: Flushing usage events
[0m05:43:00.799934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ee8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb624e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb624dff0>]}


============================== 05:43:00.805091 | 0aafd610-2b50-41eb-a424-f1e1f89eab2a ==============================
[0m05:43:00.805091 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:43:00.805619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:43:00.814732 [info ] [MainThread]: dbt version: 1.8.3
[0m05:43:00.815150 [info ] [MainThread]: python version: 3.10.14
[0m05:43:00.815440 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:43:00.815786 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:43:01.638501 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m05:43:01.639260 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m05:43:01.639717 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:43:01.640565 [info ] [MainThread]: adapter type: snowflake
[0m05:43:01.640954 [info ] [MainThread]: adapter version: 1.8.2
[0m05:43:01.695370 [info ] [MainThread]: Configuration:
[0m05:43:01.695859 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:43:01.696175 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:43:01.696512 [info ] [MainThread]: Required dependencies:
[0m05:43:01.696808 [debug] [MainThread]: Executing "git --help"
[0m05:43:01.706984 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:43:01.707722 [debug] [MainThread]: STDERR: "b''"
[0m05:43:01.708323 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:43:01.708887 [info ] [MainThread]: Connection:
[0m05:43:01.709481 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:43:01.709922 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:43:01.710352 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:43:01.710670 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:43:01.711073 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:43:01.711532 [info ] [MainThread]:   schema: STAGE
[0m05:43:01.711871 [info ] [MainThread]:   authenticator: jwt
[0m05:43:01.712125 [info ] [MainThread]:   oauth_client_id: None
[0m05:43:01.712396 [info ] [MainThread]:   query_tag: None
[0m05:43:01.712693 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:43:01.712939 [info ] [MainThread]:   host: None
[0m05:43:01.713263 [info ] [MainThread]:   port: None
[0m05:43:01.713611 [info ] [MainThread]:   proxy_host: None
[0m05:43:01.713993 [info ] [MainThread]:   proxy_port: None
[0m05:43:01.714291 [info ] [MainThread]:   protocol: None
[0m05:43:01.714592 [info ] [MainThread]:   connect_retries: 1
[0m05:43:01.714869 [info ] [MainThread]:   connect_timeout: None
[0m05:43:01.715103 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:43:01.715354 [info ] [MainThread]:   retry_all: False
[0m05:43:01.715598 [info ] [MainThread]:   insecure_mode: False
[0m05:43:01.715823 [info ] [MainThread]:   reuse_connections: None
[0m05:43:01.716171 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:43:01.783112 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:43:01.783841 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:43:01.784103 [debug] [MainThread]: On debug: select 1 as id
[0m05:43:01.784322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:43:02.348681 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.564 seconds
[0m05:43:02.353951 [debug] [MainThread]: On debug: Close
[0m05:43:02.437315 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:43:02.438563 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:43:02.441317 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6753238, "process_user_time": 2.407412, "process_kernel_time": 0.936998, "process_mem_max_rss": "187008", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m05:43:02.444427 [debug] [MainThread]: Command `dbt debug` succeeded at 05:43:02.444015 after 1.68 seconds
[0m05:43:02.445360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:43:02.445877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ee8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70fef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b18c70>]}
[0m05:43:02.446344 [debug] [MainThread]: Flushing usage events
[0m05:43:07.579895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d514310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b921ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b921f90>]}


============================== 05:43:07.583354 | e3cd6764-36b1-4310-a132-91d0cd640432 ==============================
[0m05:43:07.583354 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:43:07.583990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:43:07.672082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3cd6764-36b1-4310-a132-91d0cd640432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d537fd0>]}
[0m05:43:07.758797 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-znead6yd'
[0m05:43:07.759359 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:43:07.920826 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:43:07.922501 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:43:08.007724 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:43:08.013177 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:43:08.507714 [info ] [MainThread]: Installed from version 1.1.1
[0m05:43:08.508328 [info ] [MainThread]: Updated version available: 1.3.3
[0m05:43:08.508994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3cd6764-36b1-4310-a132-91d0cd640432', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce5d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b877d00>]}
[0m05:43:08.509396 [info ] [MainThread]: 
[0m05:43:08.509749 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:43:08.510793 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.96003586, "process_user_time": 1.19012, "process_kernel_time": 0.25248, "process_mem_max_rss": "94988", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m05:43:08.511240 [debug] [MainThread]: Command `dbt deps` succeeded at 05:43:08.511165 after 0.96 seconds
[0m05:43:08.511561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d514310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceb5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce5d480>]}
[0m05:43:08.511860 [debug] [MainThread]: Flushing usage events
[0m05:43:12.056936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a303d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e421d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e42170>]}


============================== 05:43:12.060426 | 4f5c25c5-fe70-4f09-a415-3671aab1e314 ==============================
[0m05:43:12.060426 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:43:12.060999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:43:12.616021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fa7df0>]}
[0m05:43:12.646338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777bbc70>]}
[0m05:43:12.646999 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:43:12.710522 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:43:12.837076 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:43:12.837578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983dc460>]}
[0m05:43:13.557646 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:43:13.558146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7765a860>]}
[0m05:43:13.747761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff769f4130>]}
[0m05:43:13.877957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7654c610>]}
[0m05:43:13.878398 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:43:13.878865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7654c5e0>]}
[0m05:43:13.880565 [info ] [MainThread]: 
[0m05:43:13.881176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:43:13.884458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:43:13.893796 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:43:13.894154 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:43:13.894431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:14.321482 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.426 seconds
[0m05:43:14.327179 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:43:14.403843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:43:14.406019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:43:14.431434 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:43:14.443572 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:43:14.445377 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:43:14.448048 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:43:14.449304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:14.450508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:43:14.871964 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.423 seconds
[0m05:43:14.875644 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:43:14.888652 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.438 seconds
[0m05:43:14.890916 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:43:14.993812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a33a30>]}
[0m05:43:14.995294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:43:14.996128 [info ] [MainThread]: 
[0m05:43:15.016433 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:43:15.017425 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:43:15.018398 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:43:15.019285 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:43:15.020074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m05:43:15.020754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m05:43:15.021306 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:43:15.021881 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:43:15.032499 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:43:15.038270 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:43:15.040371 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:43:15.047017 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:43:15.064846 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:43:15.067437 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:43:15.069304 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:43:15.070637 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m05:43:15.071009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:43:15.070365 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:43:15.071559 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m05:43:15.075428 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:43:15.577011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m05:43:15.609469 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:43:15.656173 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m05:43:15.658994 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:43:15.681418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77786680>]}
[0m05:43:15.682681 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.66s]
[0m05:43:15.686744 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:43:15.721556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5c25c5-fe70-4f09-a415-3671aab1e314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777baf50>]}
[0m05:43:15.722910 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.70s]
[0m05:43:15.723838 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:43:15.726036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:43:15.726706 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m05:43:15.727183 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m05:43:15.727750 [info ] [MainThread]: 
[0m05:43:15.728378 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m05:43:15.729455 [debug] [MainThread]: Command end result
[0m05:43:15.788202 [info ] [MainThread]: 
[0m05:43:15.788785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:43:15.789178 [info ] [MainThread]: 
[0m05:43:15.789743 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:43:15.791721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7635772, "process_user_time": 4.018647, "process_kernel_time": 0.388607, "process_mem_max_rss": "203328", "process_out_blocks": "3693", "process_in_blocks": "0"}
[0m05:43:15.792485 [debug] [MainThread]: Command `dbt run` succeeded at 05:43:15.792397 after 3.76 seconds
[0m05:43:15.792952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fa7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c73f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff773b0dc0>]}
[0m05:43:15.793336 [debug] [MainThread]: Flushing usage events
[0m05:43:18.674192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989483a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d56200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d561a0>]}


============================== 05:43:18.678056 | 2e062bc4-c372-4829-bb18-8020eed95b12 ==============================
[0m05:43:18.678056 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:43:18.678621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:43:19.182100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff776da560>]}
[0m05:43:19.211977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff776a8cd0>]}
[0m05:43:19.212581 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:43:19.277305 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:43:19.415187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:19.415586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:19.444284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff770e12a0>]}
[0m05:43:19.526673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98389c60>]}
[0m05:43:19.527107 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:43:19.527430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989620b0>]}
[0m05:43:19.529006 [info ] [MainThread]: 
[0m05:43:19.529573 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:43:19.535533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:43:19.554118 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:43:19.554523 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:43:19.554766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:19.908486 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.354 seconds
[0m05:43:19.910646 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:43:19.980024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:43:19.981107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:43:19.995936 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:43:20.001858 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:43:20.002749 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:43:20.003332 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:43:20.003941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:43:20.004446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:20.416885 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.412 seconds
[0m05:43:20.419026 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.415 seconds
[0m05:43:20.420949 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:43:20.422697 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:43:20.529404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a5a7d0>]}
[0m05:43:20.530964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:43:20.531628 [info ] [MainThread]: 
[0m05:43:20.548659 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m05:43:20.549078 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m05:43:20.549441 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:43:20.550152 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m05:43:20.550778 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m05:43:20.551275 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m05:43:20.551763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m05:43:20.552146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m05:43:20.552562 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m05:43:20.552902 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m05:43:20.553223 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m05:43:20.553549 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:43:20.559561 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m05:43:20.561836 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:43:20.564048 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:43:20.565602 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m05:43:20.579630 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m05:43:20.587183 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m05:43:20.587454 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:43:20.590736 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:43:20.594234 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:43:20.596041 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m05:43:20.596667 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
--categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m05:43:20.598048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:43:20.597660 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m05:43:20.598762 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:43:20.600624 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_timestamp
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m05:43:20.604047 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m05:43:20.606269 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:43:20.605455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:43:21.085124 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c260f7-0306-1845-0004-85da0005a8ae
[0m05:43:21.086174 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 0
invalid identifier 'REVIEW_TIMESTAMP'
[0m05:43:21.086930 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m05:43:21.182948 [debug] [Thread-2 (]: Database Error in model fct_reviews (models/marts/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 9 at position 0
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/fct_reviews.sql
[0m05:43:21.186722 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7656aa10>]}
[0m05:43:21.187676 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model STAGE_MART.fct_reviews ................... [[31mERROR[0m in 0.63s]
[0m05:43:21.189166 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m05:43:21.998071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.392 seconds
[0m05:43:22.030279 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m05:43:22.127774 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7767a650>]}
[0m05:43:22.129680 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.57s]
[0m05:43:22.130712 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:43:22.131853 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m05:43:22.132598 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m05:43:22.133446 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m05:43:22.134070 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m05:43:22.140451 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m05:43:22.142084 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m05:43:22.145967 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m05:43:22.147720 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m05:43:22.148256 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m05:43:22.148752 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:43:22.593331 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c260f7-0306-1845-0004-85da0005a8b6
[0m05:43:22.594516 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 5
invalid identifier 'REVIEW_TIMESTAMP'
[0m05:43:22.595608 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m05:43:22.666350 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:43:22.667100 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b6a530>]}
[0m05:43:22.667802 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 0.53s]
[0m05:43:22.668459 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m05:43:33.059397 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c260f7-0306-17b1-0004-85da0005c3aa
[0m05:43:33.063516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
[0m05:43:33.065296 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m05:43:33.166160 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:43:33.168590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e062bc4-c372-4829-bb18-8020eed95b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff770e7790>]}
[0m05:43:33.172295 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 12.62s]
[0m05:43:33.178106 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m05:43:33.184104 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:43:33.184853 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:43:33.185649 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m05:43:33.186221 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m05:43:33.186902 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:43:33.187449 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:43:33.190811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:43:33.191487 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m05:43:33.191868 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m05:43:33.192185 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m05:43:33.192530 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m05:43:33.193391 [info ] [MainThread]: 
[0m05:43:33.194024 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 13.66 seconds (13.66s).
[0m05:43:33.195546 [debug] [MainThread]: Command end result
[0m05:43:33.237576 [info ] [MainThread]: 
[0m05:43:33.238045 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:43:33.238377 [info ] [MainThread]: 
[0m05:43:33.238765 [error] [MainThread]:   Database Error in model fct_reviews (models/marts/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 9 at position 0
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/fct_reviews.sql
[0m05:43:33.239069 [info ] [MainThread]: 
[0m05:43:33.239420 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:43:33.239725 [info ] [MainThread]: 
[0m05:43:33.240237 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:43:33.240607 [info ] [MainThread]: 
[0m05:43:33.241046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m05:43:33.247022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.602137, "process_user_time": 3.35759, "process_kernel_time": 0.350357, "process_mem_max_rss": "201212", "process_out_blocks": "2507", "command_success": false, "process_in_blocks": "0"}
[0m05:43:33.247938 [debug] [MainThread]: Command `dbt run` failed at 05:43:33.247866 after 14.60 seconds
[0m05:43:33.248367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989483a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b5e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f2f850>]}
[0m05:43:33.248725 [debug] [MainThread]: Flushing usage events
[0m05:47:09.054025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c3c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0036050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0035ff0>]}


============================== 05:47:09.060632 | e08ca822-1009-4e62-b8a8-f36a11b2e685 ==============================
[0m05:47:09.060632 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:47:09.061207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:47:09.070847 [info ] [MainThread]: dbt version: 1.8.3
[0m05:47:09.071274 [info ] [MainThread]: python version: 3.10.14
[0m05:47:09.071547 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:47:09.071790 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:47:09.589110 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m05:47:09.589663 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m05:47:09.589970 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:47:09.590345 [info ] [MainThread]: adapter type: snowflake
[0m05:47:09.590601 [info ] [MainThread]: adapter version: 1.8.2
[0m05:47:09.645684 [info ] [MainThread]: Configuration:
[0m05:47:09.646302 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:47:09.646581 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:47:09.646813 [info ] [MainThread]: Required dependencies:
[0m05:47:09.647061 [debug] [MainThread]: Executing "git --help"
[0m05:47:09.654475 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:47:09.654899 [debug] [MainThread]: STDERR: "b''"
[0m05:47:09.655132 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:47:09.655406 [info ] [MainThread]: Connection:
[0m05:47:09.655699 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:47:09.655956 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:47:09.656237 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:47:09.656476 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:47:09.656701 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:47:09.656913 [info ] [MainThread]:   schema: STAGE
[0m05:47:09.657121 [info ] [MainThread]:   authenticator: jwt
[0m05:47:09.657340 [info ] [MainThread]:   oauth_client_id: None
[0m05:47:09.657579 [info ] [MainThread]:   query_tag: None
[0m05:47:09.657881 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:47:09.658151 [info ] [MainThread]:   host: None
[0m05:47:09.658401 [info ] [MainThread]:   port: None
[0m05:47:09.658657 [info ] [MainThread]:   proxy_host: None
[0m05:47:09.658894 [info ] [MainThread]:   proxy_port: None
[0m05:47:09.659144 [info ] [MainThread]:   protocol: None
[0m05:47:09.659383 [info ] [MainThread]:   connect_retries: 1
[0m05:47:09.659606 [info ] [MainThread]:   connect_timeout: None
[0m05:47:09.659844 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:47:09.660106 [info ] [MainThread]:   retry_all: False
[0m05:47:09.660362 [info ] [MainThread]:   insecure_mode: False
[0m05:47:09.660608 [info ] [MainThread]:   reuse_connections: None
[0m05:47:09.660984 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:47:09.720107 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:47:09.720779 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:47:09.721060 [debug] [MainThread]: On debug: select 1 as id
[0m05:47:09.721295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:10.252823 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.531 seconds
[0m05:47:10.254173 [debug] [MainThread]: On debug: Close
[0m05:47:10.519054 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:47:10.520683 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:47:10.523251 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4995594, "process_user_time": 2.182492, "process_kernel_time": 0.330711, "process_mem_max_rss": "186936", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m05:47:10.524856 [debug] [MainThread]: Command `dbt debug` succeeded at 05:47:10.524620 after 1.50 seconds
[0m05:47:10.525593 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:47:10.526224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c3c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e46f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947e0c70>]}
[0m05:47:10.526979 [debug] [MainThread]: Flushing usage events
[0m05:47:15.643474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f5c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb633a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6339fc0>]}


============================== 05:47:15.651333 | e2abcfe9-30b2-4e2c-bd33-f448fb246bae ==============================
[0m05:47:15.651333 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:47:15.653049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:47:15.793400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2abcfe9-30b2-4e2c-bd33-f448fb246bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64df070>]}
[0m05:47:15.866176 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x9urfkad'
[0m05:47:15.866747 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:47:16.004490 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:47:16.006017 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:47:16.099780 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:47:16.106257 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:47:16.536611 [info ] [MainThread]: Installed from version 1.1.1
[0m05:47:16.537246 [info ] [MainThread]: Updated version available: 1.3.3
[0m05:47:16.537727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e2abcfe9-30b2-4e2c-bd33-f448fb246bae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78a54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb628fd00>]}
[0m05:47:16.538159 [info ] [MainThread]: 
[0m05:47:16.538549 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:47:16.539714 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9652468, "process_user_time": 1.594243, "process_kernel_time": 0.324845, "process_mem_max_rss": "94936", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m05:47:16.540451 [debug] [MainThread]: Command `dbt deps` succeeded at 05:47:16.540345 after 0.97 seconds
[0m05:47:16.540812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f5c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78fcd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78a54e0>]}
[0m05:47:16.541234 [debug] [MainThread]: Flushing usage events
[0m05:47:19.120218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0630310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea42170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea42110>]}


============================== 05:47:19.123832 | 715d08d7-f69c-4750-b3d1-b8bbc0d90b55 ==============================
[0m05:47:19.123832 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:47:19.124365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:47:19.676515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb065ffd0>]}
[0m05:47:19.730299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3c0c40>]}
[0m05:47:19.731591 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:47:19.819778 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:47:20.033420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:47:20.034071 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews.sql
[0m05:47:20.227558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed4d780>]}
[0m05:47:20.319902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1c2890>]}
[0m05:47:20.320425 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:47:20.320924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03df790>]}
[0m05:47:20.322876 [info ] [MainThread]: 
[0m05:47:20.323393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:47:20.326670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:47:20.338627 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:47:20.339017 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:47:20.339287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:20.893314 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.553 seconds
[0m05:47:20.896043 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:47:20.989511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:47:20.990970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:47:21.002241 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:47:21.006064 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:47:21.006729 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:47:21.007312 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:47:21.007825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:21.008329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:47:21.469529 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.462 seconds
[0m05:47:21.472062 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:47:21.539288 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.531 seconds
[0m05:47:21.541413 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:47:21.660573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3972e0>]}
[0m05:47:21.662434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:47:21.663773 [info ] [MainThread]: 
[0m05:47:21.684974 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:47:21.685583 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:47:21.686419 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:47:21.687196 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:47:21.687960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m05:47:21.688603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m05:47:21.689220 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:47:21.689803 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:47:21.704968 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:47:21.712719 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:47:21.714400 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:47:21.714813 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:47:21.739157 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:47:21.741624 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:47:21.743044 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:47:21.743771 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m05:47:21.744975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:21.744672 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:47:21.745536 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m05:47:21.749852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:47:22.314300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m05:47:22.347076 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:47:22.349159 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m05:47:22.353970 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:47:22.446408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e137940>]}
[0m05:47:22.447459 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m05:47:22.448512 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:47:22.508936 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715d08d7-f69c-4750-b3d1-b8bbc0d90b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e193370>]}
[0m05:47:22.509721 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.82s]
[0m05:47:22.510523 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:47:22.513880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:47:22.514498 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m05:47:22.515018 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m05:47:22.515618 [info ] [MainThread]: 
[0m05:47:22.516210 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m05:47:22.517228 [debug] [MainThread]: Command end result
[0m05:47:22.563169 [info ] [MainThread]: 
[0m05:47:22.563672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:47:22.564068 [info ] [MainThread]: 
[0m05:47:22.564402 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:47:22.565329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4762793, "process_user_time": 3.272335, "process_kernel_time": 0.458691, "process_mem_max_rss": "201436", "process_out_blocks": "3700", "process_in_blocks": "0"}
[0m05:47:22.565866 [debug] [MainThread]: Command `dbt run` succeeded at 05:47:22.565782 after 3.48 seconds
[0m05:47:22.566241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0630310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf871480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb065ffd0>]}
[0m05:47:22.566558 [debug] [MainThread]: Flushing usage events
[0m05:47:25.007245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d54370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f15a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f15a1a0>]}


============================== 05:47:25.010729 | 01d87bf1-9157-4f73-87ae-c551d39a66a6 ==============================
[0m05:47:25.010729 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:47:25.011424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:47:25.557361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d77eb0>]}
[0m05:47:25.588597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa6fa00>]}
[0m05:47:25.589257 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:47:25.661105 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:47:25.811572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:47:25.812007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:47:25.841100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f501240>]}
[0m05:47:25.978862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5e5d50>]}
[0m05:47:25.979763 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:47:25.980295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5e5e10>]}
[0m05:47:25.982912 [info ] [MainThread]: 
[0m05:47:25.984087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:47:25.989124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:47:26.003282 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:47:26.003783 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:47:26.004075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:26.457981 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.454 seconds
[0m05:47:26.461992 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:47:26.547854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:47:26.548892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:47:26.559759 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:47:26.562972 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:47:26.563688 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:47:26.564292 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:47:26.564837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:26.565382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:47:27.064317 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.499 seconds
[0m05:47:27.068201 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:47:27.165769 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.601 seconds
[0m05:47:27.168128 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:47:27.273710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa6f850>]}
[0m05:47:27.275141 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:47:27.275793 [info ] [MainThread]: 
[0m05:47:27.288375 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m05:47:27.289294 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m05:47:27.289787 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:47:27.290628 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m05:47:27.291446 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m05:47:27.292484 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m05:47:27.293289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m05:47:27.293910 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m05:47:27.294708 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m05:47:27.295359 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m05:47:27.295950 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m05:47:27.296542 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:47:27.306075 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m05:47:27.309351 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:47:27.312646 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:47:27.315289 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m05:47:27.315691 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m05:47:27.329089 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:47:27.349491 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:47:27.350863 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m05:47:27.353194 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:47:27.354809 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m05:47:27.355317 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m05:47:27.356521 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
--categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m05:47:27.356183 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:47:27.355669 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m05:47:27.356837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:27.357186 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m05:47:27.357528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:47:27.357991 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:47:28.678938 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.321 seconds
[0m05:47:28.680890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m05:47:28.723896 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m05:47:28.725099 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m05:47:28.799064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f3001f0>]}
[0m05:47:28.801804 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.50s]
[0m05:47:28.800908 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa6e5f0>]}
[0m05:47:28.803481 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.51s]
[0m05:47:28.802851 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:47:28.804294 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m05:47:28.805320 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m05:47:28.806202 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m05:47:28.806909 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m05:47:28.807422 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m05:47:28.810848 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m05:47:28.812275 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m05:47:28.815045 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m05:47:28.816295 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m05:47:28.816670 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m05:47:28.817010 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:47:29.850936 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c260fb-0306-1875-0004-85da0005b70e
[0m05:47:29.859885 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 5
invalid identifier 'REVIEW_TIMESTAMP'
[0m05:47:29.867382 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m05:47:29.962785 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:47:29.964552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2b5090>]}
[0m05:47:29.971207 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 1.16s]
[0m05:47:29.975001 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m05:47:33.614640 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c260fb-0306-198a-0004-85da0005e206
[0m05:47:33.618859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$74.99" to FIXED
[0m05:47:33.621091 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m05:47:33.692508 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$74.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:47:33.694959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d87bf1-9157-4f73-87ae-c551d39a66a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f518a60>]}
[0m05:47:33.697678 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 6.40s]
[0m05:47:33.699440 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m05:47:33.705606 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:47:33.706698 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:47:33.707552 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m05:47:33.708383 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m05:47:33.709292 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:47:33.709894 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:47:33.723719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:47:33.724698 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m05:47:33.725243 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m05:47:33.725733 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m05:47:33.726217 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m05:47:33.727275 [info ] [MainThread]: 
[0m05:47:33.728110 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m05:47:33.730486 [debug] [MainThread]: Command end result
[0m05:47:33.792214 [info ] [MainThread]: 
[0m05:47:33.793017 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:47:33.793548 [info ] [MainThread]: 
[0m05:47:33.794244 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:47:33.795163 [info ] [MainThread]: 
[0m05:47:33.795915 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$74.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:47:33.796437 [info ] [MainThread]: 
[0m05:47:33.797026 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=2 TOTAL=6
[0m05:47:33.800453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.823402, "process_user_time": 4.306407, "process_kernel_time": 0.430856, "process_mem_max_rss": "200932", "process_out_blocks": "2505", "command_success": false, "process_in_blocks": "0"}
[0m05:47:33.801558 [debug] [MainThread]: Command `dbt run` failed at 05:47:33.801433 after 8.82 seconds
[0m05:47:33.802137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d54370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa6ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f3034c0>]}
[0m05:47:33.802450 [debug] [MainThread]: Flushing usage events
[0m05:50:07.056701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb54310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af4dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af4df90>]}


============================== 05:50:07.060519 | 27319336-ddea-498d-83d1-7c791061204f ==============================
[0m05:50:07.060519 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:50:07.061007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:50:07.066248 [info ] [MainThread]: dbt version: 1.8.3
[0m05:50:07.066598 [info ] [MainThread]: python version: 3.10.14
[0m05:50:07.066865 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:50:07.067125 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:50:07.599985 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m05:50:07.600596 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m05:50:07.600984 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:50:07.601382 [info ] [MainThread]: adapter type: snowflake
[0m05:50:07.601669 [info ] [MainThread]: adapter version: 1.8.2
[0m05:50:07.655642 [info ] [MainThread]: Configuration:
[0m05:50:07.656257 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:50:07.656529 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:50:07.656796 [info ] [MainThread]: Required dependencies:
[0m05:50:07.657079 [debug] [MainThread]: Executing "git --help"
[0m05:50:07.667405 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:50:07.668017 [debug] [MainThread]: STDERR: "b''"
[0m05:50:07.668438 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:50:07.668829 [info ] [MainThread]: Connection:
[0m05:50:07.669209 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:50:07.669658 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:50:07.670083 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:50:07.670418 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:50:07.670809 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:50:07.671148 [info ] [MainThread]:   schema: STAGE
[0m05:50:07.671587 [info ] [MainThread]:   authenticator: jwt
[0m05:50:07.672002 [info ] [MainThread]:   oauth_client_id: None
[0m05:50:07.672339 [info ] [MainThread]:   query_tag: None
[0m05:50:07.672637 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:50:07.673197 [info ] [MainThread]:   host: None
[0m05:50:07.673718 [info ] [MainThread]:   port: None
[0m05:50:07.674095 [info ] [MainThread]:   proxy_host: None
[0m05:50:07.674511 [info ] [MainThread]:   proxy_port: None
[0m05:50:07.674852 [info ] [MainThread]:   protocol: None
[0m05:50:07.675437 [info ] [MainThread]:   connect_retries: 1
[0m05:50:07.676044 [info ] [MainThread]:   connect_timeout: None
[0m05:50:07.676498 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:50:07.676840 [info ] [MainThread]:   retry_all: False
[0m05:50:07.677131 [info ] [MainThread]:   insecure_mode: False
[0m05:50:07.677471 [info ] [MainThread]:   reuse_connections: None
[0m05:50:07.677889 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:50:07.746574 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:50:07.747416 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:50:07.747742 [debug] [MainThread]: On debug: select 1 as id
[0m05:50:07.748003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:50:08.180603 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.432 seconds
[0m05:50:08.182190 [debug] [MainThread]: On debug: Close
[0m05:50:08.279646 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:50:08.281285 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:50:08.283803 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.262362, "process_user_time": 2.230658, "process_kernel_time": 0.360179, "process_mem_max_rss": "187024", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m05:50:08.285290 [debug] [MainThread]: Command `dbt debug` succeeded at 05:50:08.285102 after 1.26 seconds
[0m05:50:08.285967 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:50:08.286750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb54310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd5eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af8f430>]}
[0m05:50:08.287429 [debug] [MainThread]: Flushing usage events
[0m05:50:10.923221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88e83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c4e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c4e020>]}


============================== 05:50:10.926415 | 8c070262-2d23-4bc7-b0a0-0ddc3e122692 ==============================
[0m05:50:10.926415 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:50:10.926948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:50:10.999688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c070262-2d23-4bc7-b0a0-0ddc3e122692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8917e80>]}
[0m05:50:11.052054 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vdpiy_wu'
[0m05:50:11.052445 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:50:11.280388 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:50:11.298461 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:50:11.915779 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:50:11.930486 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:50:12.502764 [info ] [MainThread]: Installed from version 1.1.1
[0m05:50:12.504380 [info ] [MainThread]: Updated version available: 1.3.3
[0m05:50:12.505612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8c070262-2d23-4bc7-b0a0-0ddc3e122692', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb823ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ba7d00>]}
[0m05:50:12.506643 [info ] [MainThread]: 
[0m05:50:12.507113 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:50:12.513234 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.1369884, "process_user_time": 2.068619, "process_kernel_time": 0.292866, "process_mem_max_rss": "94968", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m05:50:12.515393 [debug] [MainThread]: Command `dbt deps` succeeded at 05:50:12.515156 after 2.14 seconds
[0m05:50:12.518483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88e83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8254ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb823ca30>]}
[0m05:50:12.518960 [debug] [MainThread]: Flushing usage events
[0m05:50:15.832507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9a03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd3e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd3e170>]}


============================== 05:50:15.836323 | 6b977356-93a8-4fa3-b1fc-647ee6aaf225 ==============================
[0m05:50:15.836323 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:50:15.836808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:50:16.358601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dea7df0>]}
[0m05:50:16.423018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6cbc70>]}
[0m05:50:16.424013 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:50:16.510215 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:50:16.666527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:50:16.667060 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m05:50:16.814233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e051810>]}
[0m05:50:16.893048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e1de7d0>]}
[0m05:50:16.893457 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:50:16.893905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e1dff10>]}
[0m05:50:16.895456 [info ] [MainThread]: 
[0m05:50:16.896277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:50:16.899897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:50:16.908825 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:50:16.909231 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:50:16.909492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:17.262042 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.352 seconds
[0m05:50:17.264193 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:50:17.394459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:50:17.396333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:50:17.406334 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:50:17.409622 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:50:17.410350 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:50:17.411002 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:50:17.411553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:17.412117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:17.841570 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.430 seconds
[0m05:50:17.846304 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:50:17.951748 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.539 seconds
[0m05:50:17.956365 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:50:18.036569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6974c0>]}
[0m05:50:18.037386 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:50:18.038179 [info ] [MainThread]: 
[0m05:50:18.050181 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:50:18.051041 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:50:18.051864 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:50:18.052766 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:50:18.053505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m05:50:18.054149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m05:50:18.054748 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:50:18.055302 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:50:18.064566 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:50:18.079313 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:50:18.081125 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:50:18.081519 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:50:18.103809 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:50:18.106413 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:50:18.108157 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:50:18.109472 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m05:50:18.109820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:18.109203 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:50:18.110329 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m05:50:18.113797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:50:18.612519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m05:50:18.646683 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:50:18.703465 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m05:50:18.706440 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:50:18.776433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d7e9e40>]}
[0m05:50:18.777750 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m05:50:18.781831 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:50:18.780958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b977356-93a8-4fa3-b1fc-647ee6aaf225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d733c10>]}
[0m05:50:18.782820 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.73s]
[0m05:50:18.783428 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:50:18.785461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:18.785958 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m05:50:18.786513 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m05:50:18.787093 [info ] [MainThread]: 
[0m05:50:18.787592 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m05:50:18.788694 [debug] [MainThread]: Command end result
[0m05:50:18.835083 [info ] [MainThread]: 
[0m05:50:18.835560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:50:18.835959 [info ] [MainThread]: 
[0m05:50:18.836306 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:50:18.837322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0339644, "process_user_time": 3.179996, "process_kernel_time": 0.317999, "process_mem_max_rss": "201040", "process_out_blocks": "3700", "process_in_blocks": "0"}
[0m05:50:18.837845 [debug] [MainThread]: Command `dbt run` succeeded at 05:50:18.837774 after 3.03 seconds
[0m05:50:18.838199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e105120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6cbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e146b00>]}
[0m05:50:18.838534 [debug] [MainThread]: Flushing usage events
[0m05:50:22.369929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5810250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c160b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c16050>]}


============================== 05:50:22.373458 | 8192e264-9313-4706-97c7-3886d11e8412 ==============================
[0m05:50:22.373458 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:50:22.374059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:50:22.967931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3db54e0>]}
[0m05:50:22.997625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985a8cd0>]}
[0m05:50:22.998212 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:50:23.061983 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:50:23.200806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:23.201296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:23.232184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f91150>]}
[0m05:50:23.305872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98085ed0>]}
[0m05:50:23.306303 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:50:23.306594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98085f00>]}
[0m05:50:23.307844 [info ] [MainThread]: 
[0m05:50:23.308365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:50:23.312119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:50:23.321603 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:50:23.321973 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:50:23.322231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:23.787741 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.465 seconds
[0m05:50:23.790644 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:50:23.897795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:50:23.900338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:50:23.925520 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:50:23.933512 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:50:23.934445 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:50:23.935392 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:50:23.936228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:23.937785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:24.363871 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.427 seconds
[0m05:50:24.367114 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:50:24.412102 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.474 seconds
[0m05:50:24.413619 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:50:24.496642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5914d90>]}
[0m05:50:24.497637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:50:24.498393 [info ] [MainThread]: 
[0m05:50:24.510025 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m05:50:24.510433 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m05:50:24.510804 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:50:24.511382 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m05:50:24.511947 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m05:50:24.512479 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m05:50:24.512988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m05:50:24.513447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m05:50:24.513962 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m05:50:24.514338 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m05:50:24.514942 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m05:50:24.515343 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:50:24.521599 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m05:50:24.523677 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:50:24.525801 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:50:24.527090 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m05:50:24.540038 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m05:50:24.546100 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m05:50:24.548166 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:50:24.548398 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:50:24.550759 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:50:24.551439 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m05:50:24.552231 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
title,
brand,
--categories, 
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m05:50:24.551934 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m05:50:24.553389 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m05:50:24.553090 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:50:24.552587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:24.553684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:50:24.553993 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m05:50:24.554578 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:50:25.017786 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c260fe-0306-198a-0004-85da0005e216
[0m05:50:25.018919 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 0
invalid identifier 'TITLE'
[0m05:50:25.019814 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m05:50:25.144590 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'TITLE'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:50:25.147504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93308a00>]}
[0m05:50:25.148605 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.63s]
[0m05:50:25.149658 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m05:50:25.823995 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m05:50:25.836979 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.282 seconds
[0m05:50:25.847559 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m05:50:25.849439 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m05:50:25.929121 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9334f820>]}
[0m05:50:25.930074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9334f430>]}
[0m05:50:25.931101 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.41s]
[0m05:50:25.932047 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.42s]
[0m05:50:25.932903 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:50:25.933530 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m05:50:25.934807 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m05:50:25.936311 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m05:50:25.937008 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m05:50:25.935262 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:50:25.938045 [info ] [Thread-1 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m05:50:25.937549 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m05:50:25.935652 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:50:25.943028 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m05:50:25.942390 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m05:50:25.938602 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:50:25.943542 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:50:25.945103 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m05:50:25.949985 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m05:50:25.951311 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m05:50:25.951733 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_timestamp as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m05:50:25.952083 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:50:26.387402 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c260fe-0306-1875-0004-85da0005b71a
[0m05:50:26.388313 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 5
invalid identifier 'REVIEW_TIMESTAMP'
[0m05:50:26.388978 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m05:50:26.462238 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:50:26.463266 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8192e264-9313-4706-97c7-3886d11e8412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93da7940>]}
[0m05:50:26.464238 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 0.53s]
[0m05:50:26.465262 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m05:50:26.467521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:26.467990 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m05:50:26.468363 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m05:50:26.468724 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m05:50:26.469066 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m05:50:26.469670 [info ] [MainThread]: 
[0m05:50:26.470204 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m05:50:26.471555 [debug] [MainThread]: Command end result
[0m05:50:26.523985 [info ] [MainThread]: 
[0m05:50:26.524508 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:50:26.524965 [info ] [MainThread]: 
[0m05:50:26.525448 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'TITLE'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:50:26.525834 [info ] [MainThread]: 
[0m05:50:26.526325 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 9 at position 5
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m05:50:26.526690 [info ] [MainThread]: 
[0m05:50:26.527061 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=2 TOTAL=6
[0m05:50:26.528590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1875997, "process_user_time": 3.402884, "process_kernel_time": 0.351706, "process_mem_max_rss": "200932", "process_out_blocks": "2505", "command_success": false, "process_in_blocks": "0"}
[0m05:50:26.529317 [debug] [MainThread]: Command `dbt run` failed at 05:50:26.529244 after 4.19 seconds
[0m05:50:26.529874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5810250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4a1be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93333400>]}
[0m05:50:26.530432 [debug] [MainThread]: Flushing usage events
[0m05:52:16.783705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a3c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e3a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e39fc0>]}


============================== 05:52:16.789888 | 693b3729-8439-4020-875d-0a943b853d76 ==============================
[0m05:52:16.789888 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:52:16.790461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:52:16.798236 [info ] [MainThread]: dbt version: 1.8.3
[0m05:52:16.798709 [info ] [MainThread]: python version: 3.10.14
[0m05:52:16.799010 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:52:16.799292 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:52:17.436958 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m05:52:17.437531 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m05:52:17.437833 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:52:17.438224 [info ] [MainThread]: adapter type: snowflake
[0m05:52:17.438540 [info ] [MainThread]: adapter version: 1.8.2
[0m05:52:17.498251 [info ] [MainThread]: Configuration:
[0m05:52:17.498813 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:52:17.499175 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:52:17.499447 [info ] [MainThread]: Required dependencies:
[0m05:52:17.499700 [debug] [MainThread]: Executing "git --help"
[0m05:52:17.503788 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:52:17.504169 [debug] [MainThread]: STDERR: "b''"
[0m05:52:17.504438 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:52:17.504725 [info ] [MainThread]: Connection:
[0m05:52:17.504999 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:52:17.505518 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:52:17.505975 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:52:17.506612 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:52:17.507232 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:52:17.507584 [info ] [MainThread]:   schema: STAGE
[0m05:52:17.507935 [info ] [MainThread]:   authenticator: jwt
[0m05:52:17.508318 [info ] [MainThread]:   oauth_client_id: None
[0m05:52:17.508559 [info ] [MainThread]:   query_tag: None
[0m05:52:17.508825 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:52:17.509113 [info ] [MainThread]:   host: None
[0m05:52:17.509375 [info ] [MainThread]:   port: None
[0m05:52:17.509621 [info ] [MainThread]:   proxy_host: None
[0m05:52:17.509906 [info ] [MainThread]:   proxy_port: None
[0m05:52:17.510201 [info ] [MainThread]:   protocol: None
[0m05:52:17.510445 [info ] [MainThread]:   connect_retries: 1
[0m05:52:17.510979 [info ] [MainThread]:   connect_timeout: None
[0m05:52:17.511256 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:52:17.511929 [info ] [MainThread]:   retry_all: False
[0m05:52:17.512354 [info ] [MainThread]:   insecure_mode: False
[0m05:52:17.512649 [info ] [MainThread]:   reuse_connections: None
[0m05:52:17.513129 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:52:17.580463 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:52:17.581129 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:52:17.581407 [debug] [MainThread]: On debug: select 1 as id
[0m05:52:17.581677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:52:18.070693 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.489 seconds
[0m05:52:18.072302 [debug] [MainThread]: On debug: Close
[0m05:52:18.166971 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:52:18.167831 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:52:18.169235 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4262329, "process_user_time": 4.174012, "process_kernel_time": 0.986652, "process_mem_max_rss": "187004", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m05:52:18.170070 [debug] [MainThread]: Command `dbt debug` succeeded at 05:52:18.169931 after 1.43 seconds
[0m05:52:18.170602 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:52:18.171106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a3c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a5fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877ce6b0>]}
[0m05:52:18.171602 [debug] [MainThread]: Flushing usage events
[0m05:52:22.924240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15d43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f93a080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f93a020>]}


============================== 05:52:22.929785 | 93c0b27e-4ddb-43db-8cbc-86b9d967ad61 ==============================
[0m05:52:22.929785 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:52:22.930536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m05:52:23.028571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c0b27e-4ddb-43db-8cbc-86b9d967ad61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15ffa60>]}
[0m05:52:23.098626 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kassr7g2'
[0m05:52:23.099134 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:52:23.237793 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:52:23.239734 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:52:23.311706 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:52:23.316796 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:52:23.791581 [info ] [MainThread]: Installed from version 1.1.1
[0m05:52:23.792217 [info ] [MainThread]: Updated version available: 1.3.3
[0m05:52:23.792770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93c0b27e-4ddb-43db-8cbc-86b9d967ad61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f2a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f893d00>]}
[0m05:52:23.793212 [info ] [MainThread]: 
[0m05:52:23.793730 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:52:23.795239 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.91099185, "process_user_time": 2.428358, "process_kernel_time": 0.620255, "process_mem_max_rss": "94828", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m05:52:23.795813 [debug] [MainThread]: Command `dbt deps` succeeded at 05:52:23.795719 after 0.91 seconds
[0m05:52:23.796165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15d43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f939540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f2bfa0>]}
[0m05:52:23.796533 [debug] [MainThread]: Flushing usage events
[0m05:52:27.583980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933083d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9172a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9172a170>]}


============================== 05:52:27.588595 | 51241bef-226f-47ca-bf09-fba956a09465 ==============================
[0m05:52:27.588595 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:52:27.589343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:52:28.468949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9188fdf0>]}
[0m05:52:28.515180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72088d60>]}
[0m05:52:28.516667 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:52:28.893394 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:52:29.252107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:52:29.253236 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m05:52:29.253699 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_date.sql
[0m05:52:29.463545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a0d7e0>]}
[0m05:52:29.553891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b99db0>]}
[0m05:52:29.554432 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:52:29.554827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b99d50>]}
[0m05:52:29.556731 [info ] [MainThread]: 
[0m05:52:29.557991 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:52:29.563253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:52:29.577459 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:52:29.577958 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:52:29.578256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:29.971421 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.393 seconds
[0m05:52:29.972967 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:52:30.086810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:52:30.087629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:52:30.096631 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:52:30.099605 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:52:30.100076 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:52:30.100401 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:52:30.100713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:30.101073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:52:30.450135 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.349 seconds
[0m05:52:30.452573 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:52:30.537656 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.437 seconds
[0m05:52:30.541244 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:52:30.637039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7205f4c0>]}
[0m05:52:30.637808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:52:30.638201 [info ] [MainThread]: 
[0m05:52:30.646676 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:52:30.647217 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:52:30.647736 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:52:30.648251 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:52:30.648690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m05:52:30.649130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m05:52:30.649432 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:52:30.649788 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:52:30.655355 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:52:30.664267 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:52:30.665379 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:52:30.675368 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:52:30.686436 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:52:30.688694 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:52:30.690000 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:52:30.690382 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m05:52:30.691441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:30.691190 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:52:30.691900 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m05:52:30.694030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:52:31.242300 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m05:52:31.259917 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:52:31.477950 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7205e680>]}
[0m05:52:31.479301 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.83s]
[0m05:52:31.480317 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:52:31.654200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m05:52:31.658998 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:52:31.762091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51241bef-226f-47ca-bf09-fba956a09465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715edab0>]}
[0m05:52:31.763609 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.11s]
[0m05:52:31.765201 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:52:31.780544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:52:31.781440 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m05:52:31.782425 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m05:52:31.783443 [info ] [MainThread]: 
[0m05:52:31.784182 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m05:52:31.785649 [debug] [MainThread]: Command end result
[0m05:52:31.869033 [info ] [MainThread]: 
[0m05:52:31.870830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:52:31.871595 [info ] [MainThread]: 
[0m05:52:31.873139 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:52:31.879225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.334598, "process_user_time": 4.136316, "process_kernel_time": 0.668641, "process_mem_max_rss": "201024", "process_out_blocks": "3699", "process_in_blocks": "0"}
[0m05:52:31.880930 [debug] [MainThread]: Command `dbt run` succeeded at 05:52:31.880776 after 4.34 seconds
[0m05:52:31.881596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933083d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff720ebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c3ac50>]}
[0m05:52:31.882002 [debug] [MainThread]: Flushing usage events
[0m05:52:35.453015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd54340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c15a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c15a140>]}


============================== 05:52:35.457615 | c6a1ac43-b976-4b8c-9591-719c9138c3d4 ==============================
[0m05:52:35.457615 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:52:35.458296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:52:36.054981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd77ee0>]}
[0m05:52:36.094006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80aafa00>]}
[0m05:52:36.095802 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:52:36.192724 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:52:36.403780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:52:36.404874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:52:36.473504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80519240>]}
[0m05:52:36.562893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805eb1c0>]}
[0m05:52:36.563504 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:52:36.563961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805eb400>]}
[0m05:52:36.565693 [info ] [MainThread]: 
[0m05:52:36.566287 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:52:36.569708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:52:36.582232 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:52:36.582883 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:52:36.583243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:37.018022 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.435 seconds
[0m05:52:37.019836 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:52:37.133841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:52:37.134665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:52:37.141786 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:52:37.144355 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:52:37.144855 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:52:37.145201 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:52:37.145524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:37.145929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:52:37.559084 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.413 seconds
[0m05:52:37.563400 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:52:37.617307 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.471 seconds
[0m05:52:37.620583 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:52:37.699873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80aaf850>]}
[0m05:52:37.701495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:52:37.702453 [info ] [MainThread]: 
[0m05:52:37.711002 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m05:52:37.711352 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m05:52:37.711786 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:52:37.712451 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m05:52:37.713114 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m05:52:37.713582 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m05:52:37.714069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m05:52:37.714463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m05:52:37.714914 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m05:52:37.715234 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m05:52:37.715564 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m05:52:37.715889 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:52:37.721586 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m05:52:37.724029 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:52:37.725992 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:52:37.727697 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m05:52:37.735169 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m05:52:37.741940 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:52:37.757878 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:52:37.756146 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m05:52:37.759991 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:52:37.761689 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m05:52:37.762232 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m05:52:37.762696 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m05:52:37.763056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:52:37.763525 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:52:37.767876 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m05:52:37.763810 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m05:52:37.769216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:37.768869 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:52:38.263195 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26100-0306-1845-0004-85da0005a8d2
[0m05:52:38.265449 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 0
invalid identifier 'TITLE'
[0m05:52:38.267190 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m05:52:38.356237 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'TITLE'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:52:38.357939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf5c1c0>]}
[0m05:52:38.358611 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 0.64s]
[0m05:52:38.359600 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m05:52:38.821010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.052 seconds
[0m05:52:38.841504 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m05:52:38.842162 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.079 seconds
[0m05:52:38.845725 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m05:52:38.922702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80aae5f0>]}
[0m05:52:38.923454 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.21s]
[0m05:52:38.924096 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:52:38.924925 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m05:52:38.925306 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:52:38.926531 [info ] [Thread-1 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m05:52:38.926054 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m05:52:38.925589 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:52:38.928008 [info ] [Thread-3 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m05:52:38.927581 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m05:52:38.927016 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:52:38.928720 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:52:38.929287 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m05:52:38.932770 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m05:52:38.933970 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m05:52:38.937397 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m05:52:38.938707 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m05:52:38.939087 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m05:52:38.939384 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:52:38.966162 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800e87c0>]}
[0m05:52:38.969134 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.25s]
[0m05:52:38.973026 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m05:52:40.732496 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.780 seconds
[0m05:52:40.827669 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m05:52:41.053656 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a1ac43-b976-4b8c-9591-719c9138c3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800e9fc0>]}
[0m05:52:41.057506 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 2.11s]
[0m05:52:41.062146 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m05:52:41.100585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:52:41.105874 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m05:52:41.108867 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m05:52:41.112138 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m05:52:41.114577 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m05:52:41.118215 [info ] [MainThread]: 
[0m05:52:41.123662 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m05:52:41.133186 [debug] [MainThread]: Command end result
[0m05:52:41.374438 [info ] [MainThread]: 
[0m05:52:41.376573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:52:41.379092 [info ] [MainThread]: 
[0m05:52:41.381574 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'TITLE'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:52:41.385005 [info ] [MainThread]: 
[0m05:52:41.390202 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m05:52:41.404843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.0012946, "process_user_time": 5.129094, "process_kernel_time": 0.622103, "process_mem_max_rss": "200788", "process_out_blocks": "2504", "command_success": false, "process_in_blocks": "0"}
[0m05:52:41.408031 [debug] [MainThread]: Command `dbt run` failed at 05:52:41.407514 after 6.01 seconds
[0m05:52:41.411592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd54340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf5e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801f89a0>]}
[0m05:52:41.414283 [debug] [MainThread]: Flushing usage events
[0m05:54:54.198622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb926c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb763a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7639ff0>]}


============================== 05:54:54.203679 | 8f4c2673-7b67-40a4-bf61-0f5b6e85c7ec ==============================
[0m05:54:54.203679 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:54:54.204239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:54:54.209444 [info ] [MainThread]: dbt version: 1.8.3
[0m05:54:54.209922 [info ] [MainThread]: python version: 3.10.14
[0m05:54:54.210234 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:54:54.210559 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:54:54.837745 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m05:54:54.839502 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m05:54:54.840382 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:54:54.841091 [info ] [MainThread]: adapter type: snowflake
[0m05:54:54.841385 [info ] [MainThread]: adapter version: 1.8.2
[0m05:54:54.906322 [info ] [MainThread]: Configuration:
[0m05:54:54.906961 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:54:54.907411 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:54:54.907756 [info ] [MainThread]: Required dependencies:
[0m05:54:54.908109 [debug] [MainThread]: Executing "git --help"
[0m05:54:54.911768 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:54:54.912236 [debug] [MainThread]: STDERR: "b''"
[0m05:54:54.912517 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:54:54.913253 [info ] [MainThread]: Connection:
[0m05:54:54.914376 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m05:54:54.915639 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m05:54:54.916327 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m05:54:54.917340 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m05:54:54.918492 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m05:54:54.919391 [info ] [MainThread]:   schema: STAGE
[0m05:54:54.920663 [info ] [MainThread]:   authenticator: jwt
[0m05:54:54.922678 [info ] [MainThread]:   oauth_client_id: None
[0m05:54:54.923841 [info ] [MainThread]:   query_tag: None
[0m05:54:54.924648 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:54:54.925193 [info ] [MainThread]:   host: None
[0m05:54:54.925895 [info ] [MainThread]:   port: None
[0m05:54:54.926530 [info ] [MainThread]:   proxy_host: None
[0m05:54:54.927389 [info ] [MainThread]:   proxy_port: None
[0m05:54:54.927846 [info ] [MainThread]:   protocol: None
[0m05:54:54.928317 [info ] [MainThread]:   connect_retries: 1
[0m05:54:54.928806 [info ] [MainThread]:   connect_timeout: None
[0m05:54:54.929375 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:54:54.929987 [info ] [MainThread]:   retry_all: False
[0m05:54:54.930541 [info ] [MainThread]:   insecure_mode: False
[0m05:54:54.931287 [info ] [MainThread]:   reuse_connections: None
[0m05:54:54.933192 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:54:55.046035 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:54:55.046851 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:54:55.047548 [debug] [MainThread]: On debug: select 1 as id
[0m05:54:55.047875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:54:55.581658 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.533 seconds
[0m05:54:55.583986 [debug] [MainThread]: On debug: Close
[0m05:54:55.691586 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:54:55.692583 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:54:55.695513 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5342855, "process_user_time": 2.407285, "process_kernel_time": 0.350298, "process_mem_max_rss": "186940", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m05:54:55.696521 [debug] [MainThread]: Command `dbt debug` succeeded at 05:54:55.696380 after 1.54 seconds
[0m05:54:55.697213 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:54:55.697868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb926c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8476f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97dc0c70>]}
[0m05:54:55.698498 [debug] [MainThread]: Flushing usage events
[0m05:54:59.215617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc0f43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba44e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba44e050>]}


============================== 05:54:59.230254 | 25c6a243-ec08-43c8-b05c-e0ba3094d820 ==============================
[0m05:54:59.230254 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:54:59.231830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:54:59.333019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c6a243-ec08-43c8-b05c-e0ba3094d820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5f6fe0>]}
[0m05:54:59.440719 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-waa8rb65'
[0m05:54:59.441701 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:54:59.606237 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:54:59.607937 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:54:59.681715 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:54:59.686975 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:55:00.158964 [info ] [MainThread]: Installed from version 1.1.1
[0m05:55:00.159727 [info ] [MainThread]: Updated version available: 1.3.3
[0m05:55:00.160359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '25c6a243-ec08-43c8-b05c-e0ba3094d820', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba3e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3a7d00>]}
[0m05:55:00.160921 [info ] [MainThread]: 
[0m05:55:00.161267 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:55:00.162778 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0000083, "process_user_time": 2.125481, "process_kernel_time": 0.528128, "process_mem_max_rss": "94980", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m05:55:00.163472 [debug] [MainThread]: Command `dbt deps` succeeded at 05:55:00.163369 after 1.00 seconds
[0m05:55:00.163947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc0f43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba95090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba3e3b0>]}
[0m05:55:00.164337 [debug] [MainThread]: Flushing usage events
[0m05:55:02.485063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90eb8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f256200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2561a0>]}


============================== 05:55:02.490701 | ea563cd8-c79a-4a22-85a7-e376fac4eac2 ==============================
[0m05:55:02.490701 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:55:02.491404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:55:03.036083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ee7eb0>]}
[0m05:55:03.066948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb6fa00>]}
[0m05:55:03.067689 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:55:03.135443 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:55:03.285444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:55:03.285989 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m05:55:03.433615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f545780>]}
[0m05:55:03.510914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f6da080>]}
[0m05:55:03.511415 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:55:03.511853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f6da050>]}
[0m05:55:03.513374 [info ] [MainThread]: 
[0m05:55:03.514040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:55:03.517652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:55:03.526336 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:55:03.526702 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:55:03.526977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:03.943673 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.417 seconds
[0m05:55:03.945971 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:55:04.064293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m05:55:04.066706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m05:55:04.076681 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:55:04.080467 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:55:04.081109 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:55:04.081699 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:55:04.082330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:04.082907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:04.514405 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.432 seconds
[0m05:55:04.521888 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:55:04.527413 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.444 seconds
[0m05:55:04.535138 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:55:04.628052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb6f850>]}
[0m05:55:04.629685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:55:04.630778 [info ] [MainThread]: 
[0m05:55:04.649172 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m05:55:04.650042 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m05:55:04.650930 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m05:55:04.651610 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m05:55:04.652825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m05:55:04.657022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m05:55:04.658917 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m05:55:04.661359 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m05:55:04.673889 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m05:55:04.693032 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:55:04.694782 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m05:55:04.695254 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m05:55:04.739340 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m05:55:04.743174 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m05:55:04.746921 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m05:55:04.752657 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--categories as categories,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m05:55:04.753680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:04.751431 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m05:55:04.758095 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m05:55:04.759760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:55:05.266878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m05:55:05.298728 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m05:55:05.315431 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m05:55:05.317981 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m05:55:05.388721 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f5a6440>]}
[0m05:55:05.390158 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.73s]
[0m05:55:05.394054 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m05:55:05.393074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea563cd8-c79a-4a22-85a7-e376fac4eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb6e5f0>]}
[0m05:55:05.395343 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.74s]
[0m05:55:05.396122 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m05:55:05.398444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:05.399043 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m05:55:05.399508 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m05:55:05.400080 [info ] [MainThread]: 
[0m05:55:05.400762 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m05:55:05.401760 [debug] [MainThread]: Command end result
[0m05:55:05.443877 [info ] [MainThread]: 
[0m05:55:05.444291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:55:05.444622 [info ] [MainThread]: 
[0m05:55:05.444976 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:55:05.446357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.994211, "process_user_time": 3.377688, "process_kernel_time": 0.346377, "process_mem_max_rss": "201276", "process_out_blocks": "3699", "process_in_blocks": "0"}
[0m05:55:05.446923 [debug] [MainThread]: Command `dbt run` succeeded at 05:55:05.446849 after 2.99 seconds
[0m05:55:05.447293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f611510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f14970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5035b0>]}
[0m05:55:05.447593 [debug] [MainThread]: Flushing usage events
[0m05:55:08.029646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91754340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb5a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb5a140>]}


============================== 05:55:08.033027 | 889ec9af-4e89-42d3-8165-2e605426b6da ==============================
[0m05:55:08.033027 [info ] [MainThread]: Running with dbt=1.8.3
[0m05:55:08.033478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:55:08.514017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91777ee0>]}
[0m05:55:08.543296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744afa00>]}
[0m05:55:08.543963 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m05:55:08.603640 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m05:55:08.741928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:55:08.742344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:55:08.771496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fead240>]}
[0m05:55:08.847185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff7b1c0>]}
[0m05:55:08.847643 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m05:55:08.847987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff7b400>]}
[0m05:55:08.849221 [info ] [MainThread]: 
[0m05:55:08.849717 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:55:08.853171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m05:55:08.862721 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m05:55:08.863093 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m05:55:08.863347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:10.202826 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.338 seconds
[0m05:55:10.211267 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m05:55:10.299047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m05:55:10.305617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m05:55:10.319851 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m05:55:10.324657 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m05:55:10.325337 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m05:55:10.325708 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m05:55:10.326176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:10.326609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:10.745856 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.419 seconds
[0m05:55:10.749258 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m05:55:10.758855 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.433 seconds
[0m05:55:10.761292 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m05:55:10.859254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744af850>]}
[0m05:55:10.860734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:55:10.861546 [info ] [MainThread]: 
[0m05:55:10.878385 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m05:55:10.878982 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m05:55:10.879353 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:55:10.879935 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m05:55:10.880426 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m05:55:10.880915 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m05:55:10.881394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m05:55:10.881766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m05:55:10.882179 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m05:55:10.882552 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m05:55:10.882914 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m05:55:10.883261 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:55:10.890103 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m05:55:10.892853 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:55:10.895485 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:55:10.897257 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m05:55:10.903685 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m05:55:10.919185 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m05:55:10.921349 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m05:55:10.921909 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:55:10.923959 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:55:10.924560 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m05:55:10.925573 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m05:55:10.925253 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m05:55:10.926673 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m05:55:10.926352 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m05:55:10.925886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:10.926983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:55:10.927289 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m05:55:10.927902 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:55:12.032096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m05:55:12.052347 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m05:55:12.053023 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.126 seconds
[0m05:55:12.056601 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m05:55:12.165815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e967820>]}
[0m05:55:12.166781 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.28s]
[0m05:55:12.167491 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m05:55:12.168736 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m05:55:12.169349 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m05:55:12.170026 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m05:55:12.170734 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m05:55:12.174301 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m05:55:12.175512 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m05:55:12.179694 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m05:55:12.181933 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m05:55:12.182666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e982a40>]}
[0m05:55:12.183964 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.30s]
[0m05:55:12.183182 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m05:55:12.185110 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:55:12.184661 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m05:55:14.905167 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.721 seconds
[0m05:55:14.908823 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m05:55:14.984708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e983670>]}
[0m05:55:14.985656 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 2.81s]
[0m05:55:14.986335 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m05:55:16.243451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26103-0306-198a-0004-85da0005e246
[0m05:55:16.244260 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
[0m05:55:16.245084 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m05:55:16.323124 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:55:16.324126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889ec9af-4e89-42d3-8165-2e605426b6da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6feb1de0>]}
[0m05:55:16.324996 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 5.44s]
[0m05:55:16.326267 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m05:55:16.329809 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:55:16.330603 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:55:16.331423 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m05:55:16.332137 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m05:55:16.332962 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m05:55:16.333846 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m05:55:16.336377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:16.337007 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m05:55:16.337858 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m05:55:16.338336 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m05:55:16.338832 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m05:55:16.339741 [info ] [MainThread]: 
[0m05:55:16.340412 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m05:55:16.342066 [debug] [MainThread]: Command end result
[0m05:55:16.393817 [info ] [MainThread]: 
[0m05:55:16.394357 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:16.394773 [info ] [MainThread]: 
[0m05:55:16.395241 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100071 (22000): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Failed to cast variant value "$11.99" to FIXED
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m05:55:16.395655 [info ] [MainThread]: 
[0m05:55:16.396238 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m05:55:16.398914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.399593, "process_user_time": 3.995048, "process_kernel_time": 0.34488, "process_mem_max_rss": "201064", "process_out_blocks": "2503", "command_success": false, "process_in_blocks": "0"}
[0m05:55:16.399852 [debug] [MainThread]: Command `dbt run` failed at 05:55:16.399763 after 8.40 seconds
[0m05:55:16.400341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91754340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90985480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e975390>]}
[0m05:55:16.400675 [debug] [MainThread]: Flushing usage events
[0m06:06:52.943814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ede0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d13e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d13dfc0>]}


============================== 06:06:52.948916 | 7fc5daea-cc80-4ed2-913f-3e1f977d6c5e ==============================
[0m06:06:52.948916 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:06:52.949493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:06:52.957794 [info ] [MainThread]: dbt version: 1.8.3
[0m06:06:52.958232 [info ] [MainThread]: python version: 3.10.14
[0m06:06:52.958506 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:06:52.958790 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:06:53.687293 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:06:53.688046 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:06:53.688470 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:06:53.689340 [info ] [MainThread]: adapter type: snowflake
[0m06:06:53.689728 [info ] [MainThread]: adapter version: 1.8.2
[0m06:06:53.779182 [info ] [MainThread]: Configuration:
[0m06:06:53.779867 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:06:53.780298 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:06:53.780605 [info ] [MainThread]: Required dependencies:
[0m06:06:53.780949 [debug] [MainThread]: Executing "git --help"
[0m06:06:53.790310 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:06:53.790886 [debug] [MainThread]: STDERR: "b''"
[0m06:06:53.791128 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:06:53.791381 [info ] [MainThread]: Connection:
[0m06:06:53.791675 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:06:53.791964 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:06:53.792250 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:06:53.792504 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:06:53.792765 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:06:53.793017 [info ] [MainThread]:   schema: STAGE
[0m06:06:53.793265 [info ] [MainThread]:   authenticator: jwt
[0m06:06:53.793528 [info ] [MainThread]:   oauth_client_id: None
[0m06:06:53.793841 [info ] [MainThread]:   query_tag: None
[0m06:06:53.794170 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:06:53.794451 [info ] [MainThread]:   host: None
[0m06:06:53.794745 [info ] [MainThread]:   port: None
[0m06:06:53.794999 [info ] [MainThread]:   proxy_host: None
[0m06:06:53.795275 [info ] [MainThread]:   proxy_port: None
[0m06:06:53.795547 [info ] [MainThread]:   protocol: None
[0m06:06:53.795807 [info ] [MainThread]:   connect_retries: 1
[0m06:06:53.796067 [info ] [MainThread]:   connect_timeout: None
[0m06:06:53.796312 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:06:53.796566 [info ] [MainThread]:   retry_all: False
[0m06:06:53.796831 [info ] [MainThread]:   insecure_mode: False
[0m06:06:53.797067 [info ] [MainThread]:   reuse_connections: None
[0m06:06:53.797453 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:06:53.858344 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:06:53.858972 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:06:53.859234 [debug] [MainThread]: On debug: select 1 as id
[0m06:06:53.859449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:06:54.668521 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.809 seconds
[0m06:06:54.671352 [debug] [MainThread]: On debug: Close
[0m06:06:54.791002 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:06:54.792649 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:06:54.795618 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8845681, "process_user_time": 2.346273, "process_kernel_time": 0.733274, "process_mem_max_rss": "187056", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:06:54.796794 [debug] [MainThread]: Command `dbt debug` succeeded at 06:06:54.796662 after 1.89 seconds
[0m06:06:54.797353 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:06:54.797935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ede0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee03ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bce6b0>]}
[0m06:06:54.798488 [debug] [MainThread]: Flushing usage events
[0m06:06:58.586038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ee8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8324dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8324df90>]}


============================== 06:06:58.590007 | f6df720d-9af0-4230-ac91-e374626f40b7 ==============================
[0m06:06:58.590007 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:06:58.590585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:06:58.674946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6df720d-9af0-4230-ac91-e374626f40b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f17fd0>]}
[0m06:06:58.758761 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1r_i_1py'
[0m06:06:58.759234 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:06:58.895949 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:06:58.897266 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:06:59.021826 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:06:59.027791 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:06:59.508422 [info ] [MainThread]: Installed from version 1.1.1
[0m06:06:59.509098 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:06:59.509748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f6df720d-9af0-4230-ac91-e374626f40b7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8483d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831abd00>]}
[0m06:06:59.510204 [info ] [MainThread]: 
[0m06:06:59.510569 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:06:59.511730 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.95430243, "process_user_time": 1.142657, "process_kernel_time": 0.256845, "process_mem_max_rss": "95128", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:06:59.512260 [debug] [MainThread]: Command `dbt deps` succeeded at 06:06:59.512152 after 0.95 seconds
[0m06:06:59.512668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ee8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84895150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8483d480>]}
[0m06:06:59.513026 [debug] [MainThread]: Flushing usage events
[0m06:07:02.621715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe7c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2421d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e242170>]}


============================== 06:07:02.625583 | 15ab9a9c-0d7b-4514-b095-a9a645893df1 ==============================
[0m06:07:02.625583 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:07:02.626134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:03.184597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e56f760>]}
[0m06:07:03.215184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ebabd30>]}
[0m06:07:03.215896 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:07:03.281457 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:07:03.479443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:07:03.480058 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m06:07:03.606323 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:07:03.606983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e9a0c40>]}
[0m06:07:03.716363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dda8eb0>]}
[0m06:07:03.799638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e57c7f0>]}
[0m06:07:03.800172 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:07:03.800609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e57ded0>]}
[0m06:07:03.802225 [info ] [MainThread]: 
[0m06:07:03.802790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:07:03.807054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:07:03.821800 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:07:03.822255 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:07:03.822519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:04.759685 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.936 seconds
[0m06:07:04.764401 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:07:04.887113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:07:04.888533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:07:04.899802 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:07:04.902829 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:07:04.903439 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:07:04.904082 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:07:04.904593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:04.905079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:05.355659 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.451 seconds
[0m06:07:05.358447 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:07:05.566359 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.661 seconds
[0m06:07:05.569158 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:07:05.638129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eb77d60>]}
[0m06:07:05.639393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:07:05.639941 [info ] [MainThread]: 
[0m06:07:05.653280 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:07:05.654041 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:07:05.654765 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:07:05.655330 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:07:05.655855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m06:07:05.656769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m06:07:05.657336 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:07:05.657805 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:07:05.666980 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:07:05.677479 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:07:05.678815 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:07:05.679171 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:07:05.695820 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:07:05.698652 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:07:05.700057 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:07:05.700938 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:07:05.701157 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:07:05.701507 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:07:05.701903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.702219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:07:06.319943 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m06:07:06.363001 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:07:06.494076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d5ab0a0>]}
[0m06:07:06.496095 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.83s]
[0m06:07:06.497425 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:07:06.936965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.235 seconds
[0m06:07:06.943643 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:07:07.030938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ab9a9c-0d7b-4514-b095-a9a645893df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d19b130>]}
[0m06:07:07.032174 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.37s]
[0m06:07:07.032972 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:07:07.035567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:07.036324 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:07:07.036848 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:07:07.037587 [info ] [MainThread]: 
[0m06:07:07.038256 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m06:07:07.039447 [debug] [MainThread]: Command end result
[0m06:07:07.098463 [info ] [MainThread]: 
[0m06:07:07.099022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:07.099395 [info ] [MainThread]: 
[0m06:07:07.099791 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:07.101800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5097036, "process_user_time": 3.453952, "process_kernel_time": 0.404434, "process_mem_max_rss": "204368", "process_out_blocks": "3698", "process_in_blocks": "0"}
[0m06:07:07.102677 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:07.102585 after 4.51 seconds
[0m06:07:07.103220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe7c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5ebd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e56f760>]}
[0m06:07:07.103721 [debug] [MainThread]: Flushing usage events
[0m06:07:10.200498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf270370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad63e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad63e170>]}


============================== 06:07:10.204345 | 5e5df2ee-64a1-4168-ba42-b41676d5fe10 ==============================
[0m06:07:10.204345 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:07:10.205028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'send_anonymous_usage_stats': 'True'}
[0m06:07:10.701313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad96f760>]}
[0m06:07:10.730824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfa0ca0>]}
[0m06:07:10.731387 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:07:10.805893 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:07:10.987917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:07:10.988302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:07:11.018148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9e5270>]}
[0m06:07:11.097585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab3880>]}
[0m06:07:11.098033 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:07:11.098374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab2410>]}
[0m06:07:11.099678 [info ] [MainThread]: 
[0m06:07:11.100178 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:07:11.104039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:07:11.116883 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:07:11.117259 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:07:11.117525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:12.142920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.025 seconds
[0m06:07:12.147572 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:07:12.249311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:07:12.250791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:07:12.264906 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:07:12.269921 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:07:12.270768 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:07:12.271335 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:07:12.271967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:12.272458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:12.709314 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.436 seconds
[0m06:07:12.711518 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:07:13.495849 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.223 seconds
[0m06:07:13.501009 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:07:13.612329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df77d60>]}
[0m06:07:13.614256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:07:13.615050 [info ] [MainThread]: 
[0m06:07:13.631544 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:07:13.632467 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:07:13.633041 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:07:13.634006 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:07:13.634877 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:07:13.635776 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:07:13.636744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m06:07:13.637496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m06:07:13.638236 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:07:13.638888 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:07:13.639468 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:07:13.640011 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:07:13.650002 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:07:13.653233 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:07:13.657664 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:07:13.659787 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:07:13.660191 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:07:13.672174 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:07:13.684504 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:07:13.686715 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:07:13.688878 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:07:13.690408 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:07:13.691052 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:07:13.691398 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:07:13.691896 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:07:13.692269 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:07:13.692636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:13.692985 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:07:13.693306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:07:13.694067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:07:15.215031 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m06:07:15.392576 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:07:15.431726 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c2610f-0306-17b1-0004-85da0005c41a
[0m06:07:15.434247 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$11.99' is not recognized
[0m06:07:15.439250 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:07:15.458831 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.765 seconds
[0m06:07:15.468171 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:07:15.507217 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c54f670>]}
[0m06:07:15.512592 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.87s]
[0m06:07:15.516015 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:07:15.524844 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:07:15.527465 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:07:15.530607 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:07:15.531575 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:07:15.545710 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:07:15.553499 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:07:15.568846 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:07:15.575197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c474970>]}
[0m06:07:15.577935 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$11.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:07:15.581026 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.94s]
[0m06:07:15.585810 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:07:15.586828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c474160>]}
[0m06:07:15.587966 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:07:15.588813 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:07:15.589842 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 1.95s]
[0m06:07:15.590864 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:07:15.592015 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:07:15.598595 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:07:15.599185 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:07:15.604021 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m06:07:15.605859 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m06:07:15.608794 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:07:15.611355 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:07:16.666651 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.075 seconds
[0m06:07:16.682887 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:07:16.758443 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5df2ee-64a1-4168-ba42-b41676d5fe10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c475bd0>]}
[0m06:07:16.761253 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.23s]
[0m06:07:16.763501 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:07:16.769087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:16.769973 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:07:16.770584 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m06:07:16.771128 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m06:07:16.771748 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:07:16.772516 [info ] [MainThread]: 
[0m06:07:16.773019 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m06:07:16.774327 [debug] [MainThread]: Command end result
[0m06:07:16.835420 [info ] [MainThread]: 
[0m06:07:16.835931 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:07:16.836334 [info ] [MainThread]: 
[0m06:07:16.836786 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$11.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:07:16.837133 [info ] [MainThread]: 
[0m06:07:16.837580 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m06:07:16.839998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.670469, "process_user_time": 3.67898, "process_kernel_time": 0.486226, "process_mem_max_rss": "201152", "process_out_blocks": "2503", "command_success": false, "process_in_blocks": "0"}
[0m06:07:16.840832 [debug] [MainThread]: Command `dbt run` failed at 06:07:16.840761 after 6.67 seconds
[0m06:07:16.841399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf270370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4b1960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c537730>]}
[0m06:07:16.841785 [debug] [MainThread]: Flushing usage events
[0m06:11:39.294999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa3c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e3a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e39ff0>]}


============================== 06:11:39.298942 | bba1f7d7-8908-47c4-8e3c-fc9ce1835db6 ==============================
[0m06:11:39.298942 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:11:39.299551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:11:39.306051 [info ] [MainThread]: dbt version: 1.8.3
[0m06:11:39.306433 [info ] [MainThread]: python version: 3.10.14
[0m06:11:39.306765 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:11:39.307106 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:11:39.939196 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:11:39.939905 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:11:39.945884 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:11:39.946325 [info ] [MainThread]: adapter type: snowflake
[0m06:11:39.946640 [info ] [MainThread]: adapter version: 1.8.2
[0m06:11:40.003724 [info ] [MainThread]: Configuration:
[0m06:11:40.004242 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:11:40.004613 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:11:40.004890 [info ] [MainThread]: Required dependencies:
[0m06:11:40.005177 [debug] [MainThread]: Executing "git --help"
[0m06:11:40.014807 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:11:40.015200 [debug] [MainThread]: STDERR: "b''"
[0m06:11:40.015433 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:11:40.015690 [info ] [MainThread]: Connection:
[0m06:11:40.016001 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:11:40.016312 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:11:40.016595 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:11:40.016883 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:11:40.017155 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:11:40.017424 [info ] [MainThread]:   schema: STAGE
[0m06:11:40.017687 [info ] [MainThread]:   authenticator: jwt
[0m06:11:40.017924 [info ] [MainThread]:   oauth_client_id: None
[0m06:11:40.018160 [info ] [MainThread]:   query_tag: None
[0m06:11:40.018404 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:11:40.018640 [info ] [MainThread]:   host: None
[0m06:11:40.018880 [info ] [MainThread]:   port: None
[0m06:11:40.019190 [info ] [MainThread]:   proxy_host: None
[0m06:11:40.019430 [info ] [MainThread]:   proxy_port: None
[0m06:11:40.019682 [info ] [MainThread]:   protocol: None
[0m06:11:40.019909 [info ] [MainThread]:   connect_retries: 1
[0m06:11:40.020120 [info ] [MainThread]:   connect_timeout: None
[0m06:11:40.020331 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:11:40.020534 [info ] [MainThread]:   retry_all: False
[0m06:11:40.020736 [info ] [MainThread]:   insecure_mode: False
[0m06:11:40.020938 [info ] [MainThread]:   reuse_connections: None
[0m06:11:40.021278 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:11:40.083255 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:11:40.083878 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:11:40.084177 [debug] [MainThread]: On debug: select 1 as id
[0m06:11:40.084399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:11:40.563649 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.479 seconds
[0m06:11:40.565148 [debug] [MainThread]: On debug: Close
[0m06:11:40.933129 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:11:40.934837 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:11:40.937415 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6728352, "process_user_time": 2.374699, "process_kernel_time": 0.596941, "process_mem_max_rss": "187092", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:11:40.938921 [debug] [MainThread]: Command `dbt debug` succeeded at 06:11:40.938789 after 1.67 seconds
[0m06:11:40.939571 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:11:40.940179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa3c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c46f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d5e0c70>]}
[0m06:11:40.940748 [debug] [MainThread]: Flushing usage events
[0m06:11:43.703787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade3c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac236080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac236020>]}


============================== 06:11:43.707904 | a9310728-d0f1-41ca-93e5-e90568b4c5c6 ==============================
[0m06:11:43.707904 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:11:43.708480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:11:43.784715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9310728-d0f1-41ca-93e5-e90568b4c5c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade5fe80>]}
[0m06:11:43.848479 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nr1blka4'
[0m06:11:43.849053 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:11:43.983110 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:11:43.984668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:11:44.070801 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:11:44.076169 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:11:44.490407 [info ] [MainThread]: Installed from version 1.1.1
[0m06:11:44.492277 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:11:44.493299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a9310728-d0f1-41ca-93e5-e90568b4c5c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad784a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac18fd00>]}
[0m06:11:44.494445 [info ] [MainThread]: 
[0m06:11:44.495464 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:11:44.498354 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.82371616, "process_user_time": 1.271726, "process_kernel_time": 0.212288, "process_mem_max_rss": "94928", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:11:44.499240 [debug] [MainThread]: Command `dbt deps` succeeded at 06:11:44.499143 after 0.83 seconds
[0m06:11:44.499622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade3c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad79cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad784a30>]}
[0m06:11:44.500004 [debug] [MainThread]: Flushing usage events
[0m06:11:47.804260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61ac3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45421d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4542170>]}


============================== 06:11:47.807846 | e714d4c2-185f-4fa3-85cc-6179fa986c46 ==============================
[0m06:11:47.807846 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:11:47.808469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:11:48.325664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46a7df0>]}
[0m06:11:48.355157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ef0d60>]}
[0m06:11:48.355749 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:11:48.415313 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:11:48.563448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:11:48.563806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:11:48.593404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8892d2d0>]}
[0m06:11:48.671796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a02020>]}
[0m06:11:48.672236 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:11:48.672532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a01720>]}
[0m06:11:48.673671 [info ] [MainThread]: 
[0m06:11:48.674531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:11:48.678507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:11:48.687835 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:11:48.688181 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:11:48.688414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:49.195679 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.507 seconds
[0m06:11:49.197428 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:11:49.330216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:11:49.331223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:11:49.341900 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:11:49.345342 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:11:49.346013 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:11:49.346625 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:11:49.347203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:49.347878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:49.770299 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.422 seconds
[0m06:11:49.773124 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:11:49.891564 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.544 seconds
[0m06:11:49.893920 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:11:49.976826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ec74c0>]}
[0m06:11:49.977939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:11:49.978820 [info ] [MainThread]: 
[0m06:11:49.992710 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:11:49.993609 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:11:49.994445 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:11:49.995345 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:11:49.996127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m06:11:49.996791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m06:11:49.997514 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:11:49.998095 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:11:50.006913 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:11:50.022120 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:11:50.023836 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:11:50.033910 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:11:50.051095 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:11:50.052828 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:11:50.054431 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:11:50.054874 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:11:50.055766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:11:50.055484 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:11:50.056256 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:11:50.059888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:50.898507 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m06:11:50.901401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m06:11:50.937672 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:11:50.938697 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:11:51.030159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885ebbb0>]}
[0m06:11:51.032108 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.03s]
[0m06:11:51.033198 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:11:51.055409 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e714d4c2-185f-4fa3-85cc-6179fa986c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885eb6a0>]}
[0m06:11:51.056508 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m06:11:51.057351 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:11:51.059665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:11:51.060254 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:11:51.060761 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:11:51.061367 [info ] [MainThread]: 
[0m06:11:51.061971 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m06:11:51.063040 [debug] [MainThread]: Command end result
[0m06:11:51.114419 [info ] [MainThread]: 
[0m06:11:51.114971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:11:51.115325 [info ] [MainThread]: 
[0m06:11:51.115695 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:11:51.116963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3424237, "process_user_time": 3.066341, "process_kernel_time": 0.277291, "process_mem_max_rss": "197824", "process_out_blocks": "2485", "process_in_blocks": "0"}
[0m06:11:51.117570 [debug] [MainThread]: Command `dbt run` succeeded at 06:11:51.117489 after 3.34 seconds
[0m06:11:51.117984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46a7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53e3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887953c0>]}
[0m06:11:51.118443 [debug] [MainThread]: Flushing usage events
[0m06:11:53.625912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ec4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9525a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9525a170>]}


============================== 06:11:53.629319 | 9fd8957f-d6ff-44dd-8899-0c9e8552790a ==============================
[0m06:11:53.629319 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:11:53.629879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:11:54.214852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95587760>]}
[0m06:11:54.244482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c3cca0>]}
[0m06:11:54.245136 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:11:54.318600 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:11:54.455827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:11:54.456179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:11:54.485472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79679270>]}
[0m06:11:54.558631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7974b880>]}
[0m06:11:54.559107 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:11:54.559432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7974a410>]}
[0m06:11:54.560609 [info ] [MainThread]: 
[0m06:11:54.561055 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:11:54.564429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:11:54.573809 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:11:54.574195 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:11:54.574455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:55.074612 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.500 seconds
[0m06:11:55.079143 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:11:55.212903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:11:55.214210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:11:55.232842 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:11:55.242880 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:11:55.243860 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:11:55.244503 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:11:55.245113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:55.245747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:55.795292 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.549 seconds
[0m06:11:55.800990 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:11:55.797372 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.552 seconds
[0m06:11:55.804741 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:11:55.927728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c0bd60>]}
[0m06:11:55.930306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:11:55.931617 [info ] [MainThread]: 
[0m06:11:55.950993 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:11:55.951485 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:11:55.951940 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:11:55.952873 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:11:55.953758 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:11:55.954607 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:11:55.955430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m06:11:55.956026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m06:11:55.956672 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:11:55.957257 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:11:55.957741 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:11:55.958245 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:11:55.967534 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:11:55.969868 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:11:55.972346 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:11:55.974444 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:11:55.974879 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:11:55.995705 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:11:55.996017 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:11:55.998158 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:11:56.000905 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:11:56.001990 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:11:56.002747 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:11:56.003493 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:11:56.003843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:56.004244 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:11:56.004598 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:11:56.008934 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:11:56.010077 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:11:56.009593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:11:57.974149 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.961 seconds
[0m06:11:58.026682 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:11:58.100240 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78163220>]}
[0m06:11:58.105515 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.14s]
[0m06:11:58.107290 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:11:58.400716 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26113-0306-198a-0004-85da0005e26a
[0m06:11:58.401936 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$74.99' is not recognized
[0m06:11:58.403845 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:11:58.527751 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$74.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:11:58.528862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff796a7df0>]}
[0m06:11:58.529856 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 2.57s]
[0m06:11:58.531152 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:11:59.393713 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.383 seconds
[0m06:11:59.396189 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:11:59.726067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78163610>]}
[0m06:11:59.728220 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.77s]
[0m06:11:59.729578 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:11:59.737971 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:11:59.738760 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:11:59.739249 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:11:59.740151 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:11:59.740974 [info ] [Thread-2 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m06:11:59.741997 [info ] [Thread-1 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m06:11:59.743096 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:11:59.743855 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:11:59.744446 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:11:59.745111 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:11:59.754440 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:11:59.757479 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:11:59.763900 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:11:59.766078 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:11:59.766635 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:11:59.767112 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:12:01.265232 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.498 seconds
[0m06:12:01.270096 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:12:01.424969 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd8957f-d6ff-44dd-8899-0c9e8552790a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960cd7e0>]}
[0m06:12:01.427276 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.68s]
[0m06:12:01.429076 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:12:01.431964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:01.432710 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:12:01.433207 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m06:12:01.433654 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m06:12:01.434167 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:12:01.434945 [info ] [MainThread]: 
[0m06:12:01.435651 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m06:12:01.437119 [debug] [MainThread]: Command end result
[0m06:12:01.493358 [info ] [MainThread]: 
[0m06:12:01.493946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:12:01.494420 [info ] [MainThread]: 
[0m06:12:01.494852 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$74.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:12:01.495482 [info ] [MainThread]: 
[0m06:12:01.496102 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m06:12:01.498569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.9016933, "process_user_time": 3.902129, "process_kernel_time": 0.351891, "process_mem_max_rss": "200780", "process_out_blocks": "2503", "command_success": false, "process_in_blocks": "0"}
[0m06:12:01.499360 [debug] [MainThread]: Command `dbt run` failed at 06:12:01.499285 after 7.90 seconds
[0m06:12:01.499852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ec4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960ed960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7813fc10>]}
[0m06:12:01.500238 [debug] [MainThread]: Flushing usage events
[0m06:12:14.951497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843043a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82716080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82716020>]}


============================== 06:12:14.955458 | a53861ff-5417-4d1f-9ac6-3de57e7d659e ==============================
[0m06:12:14.955458 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:12:14.956001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:12:14.960553 [info ] [MainThread]: dbt version: 1.8.3
[0m06:12:14.960927 [info ] [MainThread]: python version: 3.10.14
[0m06:12:14.961212 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:12:14.961483 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:12:15.617363 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:12:15.618558 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:12:15.619583 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:12:15.620872 [info ] [MainThread]: adapter type: snowflake
[0m06:12:15.621404 [info ] [MainThread]: adapter version: 1.8.2
[0m06:12:15.718953 [info ] [MainThread]: Configuration:
[0m06:12:15.719644 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:12:15.720058 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:12:15.720393 [info ] [MainThread]: Required dependencies:
[0m06:12:15.720759 [debug] [MainThread]: Executing "git --help"
[0m06:12:15.726556 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:12:15.726991 [debug] [MainThread]: STDERR: "b''"
[0m06:12:15.727285 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:12:15.727541 [info ] [MainThread]: Connection:
[0m06:12:15.727828 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:12:15.728075 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:12:15.728321 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:12:15.728557 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:12:15.728778 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:12:15.729096 [info ] [MainThread]:   schema: STAGE
[0m06:12:15.729620 [info ] [MainThread]:   authenticator: jwt
[0m06:12:15.729976 [info ] [MainThread]:   oauth_client_id: None
[0m06:12:15.730206 [info ] [MainThread]:   query_tag: None
[0m06:12:15.730515 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:12:15.730761 [info ] [MainThread]:   host: None
[0m06:12:15.730991 [info ] [MainThread]:   port: None
[0m06:12:15.731252 [info ] [MainThread]:   proxy_host: None
[0m06:12:15.731481 [info ] [MainThread]:   proxy_port: None
[0m06:12:15.731702 [info ] [MainThread]:   protocol: None
[0m06:12:15.731928 [info ] [MainThread]:   connect_retries: 1
[0m06:12:15.732145 [info ] [MainThread]:   connect_timeout: None
[0m06:12:15.732354 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:12:15.732562 [info ] [MainThread]:   retry_all: False
[0m06:12:15.732779 [info ] [MainThread]:   insecure_mode: False
[0m06:12:15.732985 [info ] [MainThread]:   reuse_connections: None
[0m06:12:15.733384 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:12:15.797623 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:12:15.798276 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:12:15.798624 [debug] [MainThread]: On debug: select 1 as id
[0m06:12:15.798921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:12:16.189647 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.391 seconds
[0m06:12:16.191102 [debug] [MainThread]: On debug: Close
[0m06:12:16.277283 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:12:16.279007 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:12:16.281807 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3614615, "process_user_time": 2.356248, "process_kernel_time": 0.311487, "process_mem_max_rss": "186908", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:12:16.283041 [debug] [MainThread]: Command `dbt debug` succeeded at 06:12:16.282913 after 1.36 seconds
[0m06:12:16.283670 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:12:16.284219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843043a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63575f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828be560>]}
[0m06:12:16.284834 [debug] [MainThread]: Flushing usage events
[0m06:12:19.118755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f10370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9731a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97319ff0>]}


============================== 06:12:19.122310 | 6e09952b-71e6-4b85-9664-4d4c2a28232d ==============================
[0m06:12:19.122310 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:12:19.123001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:12:19.191048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e09952b-71e6-4b85-9664-4d4c2a28232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f33eb0>]}
[0m06:12:19.242577 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l5ezh7fv'
[0m06:12:19.243013 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:12:19.331957 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:12:19.333387 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:12:19.581475 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:12:20.397415 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:12:21.020417 [info ] [MainThread]: Installed from version 1.1.1
[0m06:12:21.024673 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:12:21.026038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6e09952b-71e6-4b85-9664-4d4c2a28232d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988554e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97273d00>]}
[0m06:12:21.028496 [info ] [MainThread]: 
[0m06:12:21.030317 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:12:21.037227 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.9460468, "process_user_time": 1.856179, "process_kernel_time": 0.35991, "process_mem_max_rss": "95092", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:12:21.039178 [debug] [MainThread]: Command `dbt deps` succeeded at 06:12:21.038948 after 1.95 seconds
[0m06:12:21.041477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f10370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988554e0>]}
[0m06:12:21.041844 [debug] [MainThread]: Flushing usage events
[0m06:12:24.294471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee603a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d242200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2421a0>]}


============================== 06:12:24.298075 | e7e145d0-9272-452f-bd74-949ab37ad78c ==============================
[0m06:12:24.298075 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:12:24.298585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:12:24.809719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bf2560>]}
[0m06:12:24.849139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bcbd00>]}
[0m06:12:24.850251 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:12:24.931039 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:12:25.075665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:25.076040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:25.107308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815fd2a0>]}
[0m06:12:25.240558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816d3220>]}
[0m06:12:25.242015 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:12:25.243481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816d3280>]}
[0m06:12:25.249288 [info ] [MainThread]: 
[0m06:12:25.251476 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:12:25.257121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:12:25.287232 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:12:25.289888 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:12:25.291736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:25.712021 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.420 seconds
[0m06:12:25.714468 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:12:25.804596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:12:25.806081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:12:25.815722 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:12:25.818805 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:12:25.819365 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:12:25.819814 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:12:25.820303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:25.820764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:12:26.251287 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.431 seconds
[0m06:12:26.255647 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:12:26.260792 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.440 seconds
[0m06:12:26.262895 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:12:26.397863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b97d30>]}
[0m06:12:26.399158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:12:26.400024 [info ] [MainThread]: 
[0m06:12:26.413080 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:12:26.413766 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:12:26.414597 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:12:26.415442 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:12:26.416224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m06:12:26.416889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m06:12:26.417390 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:12:26.418084 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:12:26.428017 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:12:26.445074 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:12:26.446710 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:12:26.447214 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:12:26.469357 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:12:26.471938 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:12:26.473541 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:12:26.474788 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:12:26.475101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:26.474526 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:12:26.475549 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:12:26.479664 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:12:26.956029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m06:12:26.986214 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:12:27.108564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8014bd30>]}
[0m06:12:27.109926 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.69s]
[0m06:12:27.112522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m06:12:27.113482 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:12:27.116728 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:12:27.218156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e145d0-9272-452f-bd74-949ab37ad78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8159e6e0>]}
[0m06:12:27.219318 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.80s]
[0m06:12:27.219999 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:12:27.222296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:27.223151 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:12:27.223918 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:12:27.224641 [info ] [MainThread]: 
[0m06:12:27.225169 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m06:12:27.226299 [debug] [MainThread]: Command end result
[0m06:12:27.276127 [info ] [MainThread]: 
[0m06:12:27.276783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:27.277252 [info ] [MainThread]: 
[0m06:12:27.277766 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:12:27.279411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0147557, "process_user_time": 3.067112, "process_kernel_time": 0.295165, "process_mem_max_rss": "197700", "process_out_blocks": "2485", "process_in_blocks": "0"}
[0m06:12:27.280198 [debug] [MainThread]: Command `dbt run` succeeded at 06:12:27.280096 after 3.02 seconds
[0m06:12:27.280730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bf2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0a19c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8010bc10>]}
[0m06:12:27.281219 [debug] [MainThread]: Flushing usage events
[0m06:12:30.330252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f5a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f5a0b0>]}


============================== 06:12:30.333897 | 059be79e-6304-4d10-9ff3-c02df139dafd ==============================
[0m06:12:30.333897 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:12:30.334437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:12:30.835202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858afb20>]}
[0m06:12:30.865778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859098d0>]}
[0m06:12:30.866482 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:12:30.927746 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:12:31.084143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:31.084659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:31.127817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853151b0>]}
[0m06:12:31.210929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853eb640>]}
[0m06:12:31.211391 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:12:31.211712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853ea260>]}
[0m06:12:31.212971 [info ] [MainThread]: 
[0m06:12:31.213430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:12:31.217020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:12:31.226899 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:12:31.227297 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:12:31.227584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:31.838866 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.611 seconds
[0m06:12:31.840870 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:12:32.180723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:12:32.181883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:12:32.188431 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:12:32.190908 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:12:32.191343 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:12:32.191733 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:12:32.192084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:12:32.192384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:32.764347 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.572 seconds
[0m06:12:32.769283 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:12:32.839465 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.647 seconds
[0m06:12:32.841879 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:12:32.939950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c58d90>]}
[0m06:12:32.941208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:12:32.942120 [info ] [MainThread]: 
[0m06:12:32.954576 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:12:32.955190 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:12:32.955726 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:12:32.956724 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:12:32.957667 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:12:32.958486 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:12:32.959299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m06:12:32.959994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m06:12:32.960764 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:12:32.961386 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:12:32.962029 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:12:32.962655 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:12:32.971908 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:12:32.975407 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:12:32.978906 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:12:32.981478 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:12:32.989543 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:12:33.007656 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:12:33.008042 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:12:33.010313 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:12:33.012918 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:12:33.013843 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:12:33.014997 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:12:33.015332 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:12:33.015927 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:12:33.016281 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:12:33.017381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:12:33.017031 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:12:33.016660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:33.017860 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:12:34.007903 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m06:12:34.020051 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m06:12:34.046103 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:12:34.046744 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:12:34.173148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847674c0>]}
[0m06:12:34.174172 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m06:12:34.174957 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:12:34.268198 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b57d30>]}
[0m06:12:34.269065 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.31s]
[0m06:12:34.269738 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:12:34.270384 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:12:34.270849 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:12:34.271366 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:12:34.271787 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:12:34.274362 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:12:34.275452 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:12:34.278525 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:12:34.279634 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:12:34.279952 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:12:34.280294 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:12:34.470390 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26114-0306-1875-0004-85da0005b74e
[0m06:12:34.471067 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$74.99' is not recognized
[0m06:12:34.471716 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:12:34.541775 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$74.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:12:34.542647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8477d7b0>]}
[0m06:12:34.543465 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 1.58s]
[0m06:12:34.544304 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:12:34.545930 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:12:34.546404 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:12:34.547077 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m06:12:34.547763 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m06:12:34.548421 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:12:34.549080 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:12:35.044298 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m06:12:35.047720 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:12:35.127806 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '059be79e-6304-4d10-9ff3-c02df139dafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847c0c70>]}
[0m06:12:35.129980 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.86s]
[0m06:12:35.131508 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:12:35.134246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:35.134988 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m06:12:35.135537 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:12:35.136053 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m06:12:35.136508 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:12:35.137231 [info ] [MainThread]: 
[0m06:12:35.137932 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m06:12:35.139878 [debug] [MainThread]: Command end result
[0m06:12:35.247219 [info ] [MainThread]: 
[0m06:12:35.249569 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:12:35.251437 [info ] [MainThread]: 
[0m06:12:35.253353 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$74.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:12:35.254536 [info ] [MainThread]: 
[0m06:12:35.255615 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m06:12:35.260345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9591575, "process_user_time": 3.314382, "process_kernel_time": 0.293896, "process_mem_max_rss": "200956", "process_out_blocks": "2503", "command_success": false, "process_in_blocks": "0"}
[0m06:12:35.263612 [debug] [MainThread]: Command `dbt run` failed at 06:12:35.263453 after 4.96 seconds
[0m06:12:35.264206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d5fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8473f400>]}
[0m06:12:35.264712 [debug] [MainThread]: Flushing usage events
[0m06:14:59.971516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb751d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5625f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5625f30>]}


============================== 06:15:00.008027 | 1642fe84-189a-42c7-8c37-06f4fb3de512 ==============================
[0m06:15:00.008027 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:15:00.008629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:15:00.037995 [info ] [MainThread]: dbt version: 1.8.3
[0m06:15:00.038548 [info ] [MainThread]: python version: 3.10.14
[0m06:15:00.039107 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:15:00.039510 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:15:01.384035 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:15:01.384672 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:15:01.385028 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:15:01.385443 [info ] [MainThread]: adapter type: snowflake
[0m06:15:01.385727 [info ] [MainThread]: adapter version: 1.8.2
[0m06:15:01.483550 [info ] [MainThread]: Configuration:
[0m06:15:01.484026 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:15:01.484334 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:15:01.484576 [info ] [MainThread]: Required dependencies:
[0m06:15:01.484810 [debug] [MainThread]: Executing "git --help"
[0m06:15:01.497734 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:15:01.498190 [debug] [MainThread]: STDERR: "b''"
[0m06:15:01.498417 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:15:01.498649 [info ] [MainThread]: Connection:
[0m06:15:01.498947 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:15:01.499221 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:15:01.499465 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:15:01.499727 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:15:01.499970 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:15:01.500216 [info ] [MainThread]:   schema: STAGE
[0m06:15:01.500433 [info ] [MainThread]:   authenticator: jwt
[0m06:15:01.500656 [info ] [MainThread]:   oauth_client_id: None
[0m06:15:01.500862 [info ] [MainThread]:   query_tag: None
[0m06:15:01.501083 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:15:01.501289 [info ] [MainThread]:   host: None
[0m06:15:01.501492 [info ] [MainThread]:   port: None
[0m06:15:01.501696 [info ] [MainThread]:   proxy_host: None
[0m06:15:01.501931 [info ] [MainThread]:   proxy_port: None
[0m06:15:01.502162 [info ] [MainThread]:   protocol: None
[0m06:15:01.502373 [info ] [MainThread]:   connect_retries: 1
[0m06:15:01.502608 [info ] [MainThread]:   connect_timeout: None
[0m06:15:01.502849 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:15:01.503104 [info ] [MainThread]:   retry_all: False
[0m06:15:01.503345 [info ] [MainThread]:   insecure_mode: False
[0m06:15:01.503586 [info ] [MainThread]:   reuse_connections: None
[0m06:15:01.503943 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:15:01.571589 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:15:01.572290 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:15:01.572582 [debug] [MainThread]: On debug: select 1 as id
[0m06:15:01.572839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:15:02.896456 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.323 seconds
[0m06:15:02.899699 [debug] [MainThread]: On debug: Close
[0m06:15:02.979689 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:15:02.980708 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:15:02.985127 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.045616, "process_user_time": 3.322072, "process_kernel_time": 1.177697, "process_mem_max_rss": "190104", "process_out_blocks": "20981", "process_in_blocks": "0"}
[0m06:15:02.987386 [debug] [MainThread]: Command `dbt debug` succeeded at 06:15:02.987159 after 3.05 seconds
[0m06:15:02.988289 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:15:02.988763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb751d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a1dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6276e30>]}
[0m06:15:02.989251 [debug] [MainThread]: Flushing usage events
[0m06:15:05.895010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923483a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9074e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9074dff0>]}


============================== 06:15:05.898873 | 7b6a0540-93d1-4505-a517-a8899191eb96 ==============================
[0m06:15:05.898873 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:15:05.899399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:15:06.018113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b6a0540-93d1-4505-a517-a8899191eb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92377e80>]}
[0m06:15:06.076358 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5bjasnel'
[0m06:15:06.076881 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:15:06.249492 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:15:06.251352 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:15:06.335490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:15:06.340927 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:15:08.344439 [info ] [MainThread]: Installed from version 1.1.1
[0m06:15:08.382509 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:15:08.390115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7b6a0540-93d1-4505-a517-a8899191eb96', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c9ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906abd00>]}
[0m06:15:08.393343 [info ] [MainThread]: 
[0m06:15:08.399588 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:15:08.415795 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.5610945, "process_user_time": 1.575069, "process_kernel_time": 0.523512, "process_mem_max_rss": "95040", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:15:08.421068 [debug] [MainThread]: Command `dbt deps` succeeded at 06:15:08.419989 after 2.57 seconds
[0m06:15:08.424886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923483a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cf6140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c9ca30>]}
[0m06:15:08.425959 [debug] [MainThread]: Flushing usage events
[0m06:15:12.267060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94348370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9275a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9275a170>]}


============================== 06:15:12.271622 | 5fb8257e-96a6-4dbd-90bf-302ee7e36720 ==============================
[0m06:15:12.271622 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:15:12.272788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:15:13.060617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a87760>]}
[0m06:15:13.102569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730dcca0>]}
[0m06:15:13.103438 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:15:13.209787 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:15:13.408749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:15:13.409184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:15:13.444255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b15270>]}
[0m06:15:13.538463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72beb880>]}
[0m06:15:13.539009 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:15:13.539349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bea410>]}
[0m06:15:13.540691 [info ] [MainThread]: 
[0m06:15:13.541153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:15:13.544647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:15:13.560138 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:15:13.560516 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:15:13.561040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:14.084341 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.523 seconds
[0m06:15:14.088540 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:15:14.226464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:15:14.229245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:15:14.242274 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:15:14.247606 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:15:14.248296 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:15:14.248800 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:15:14.249285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:14.249738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:14.758056 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m06:15:14.762094 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:15:14.900430 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.651 seconds
[0m06:15:14.902619 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:15:15.013964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730abd60>]}
[0m06:15:15.015124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:15:15.016076 [info ] [MainThread]: 
[0m06:15:15.029787 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:15:15.030373 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:15:15.031217 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:15:15.032043 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:15:15.032779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m06:15:15.033458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m06:15:15.034088 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:15:15.034670 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:15:15.044039 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:15:15.059932 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:15:15.062122 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:15:15.062517 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:15:15.093637 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:15:15.094084 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:15:15.095581 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:15:15.096764 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
cast(price as float) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:15:15.097165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:15.096526 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:15:15.097645 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:15:15.101095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:15:15.693757 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m06:15:15.729685 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:15:15.808169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730aa620>]}
[0m06:15:15.809178 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.77s]
[0m06:15:15.810298 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:15:15.878672 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m06:15:15.881556 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:15:15.980201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb8257e-96a6-4dbd-90bf-302ee7e36720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff728c93f0>]}
[0m06:15:15.981356 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m06:15:15.982038 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:15:15.984242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:15.984879 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:15:15.985275 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:15:15.985712 [info ] [MainThread]: 
[0m06:15:15.986113 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m06:15:15.986931 [debug] [MainThread]: Command end result
[0m06:15:16.048281 [info ] [MainThread]: 
[0m06:15:16.048807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:15:16.049154 [info ] [MainThread]: 
[0m06:15:16.049508 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:15:16.050726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.856345, "process_user_time": 3.558241, "process_kernel_time": 0.644918, "process_mem_max_rss": "197156", "process_out_blocks": "2485", "process_in_blocks": "0"}
[0m06:15:16.051338 [debug] [MainThread]: Command `dbt run` succeeded at 06:15:16.051268 after 3.86 seconds
[0m06:15:16.051709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94348370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d39d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730dcca0>]}
[0m06:15:16.052036 [debug] [MainThread]: Flushing usage events
[0m06:15:18.728722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba27c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb863e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb863e140>]}


============================== 06:15:18.732130 | 830909ac-30e6-484b-baca-11be6795ec37 ==============================
[0m06:15:18.732130 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:15:18.732641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:15:19.230248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba29fee0>]}
[0m06:15:19.260646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf97340>]}
[0m06:15:19.261317 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:15:19.322894 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:15:19.463693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:15:19.464302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:15:19.495794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9fd240>]}
[0m06:15:19.569628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cad3820>]}
[0m06:15:19.570077 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:15:19.570444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cad23e0>]}
[0m06:15:19.571662 [info ] [MainThread]: 
[0m06:15:19.572164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:15:19.575669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:15:19.586516 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:15:19.586907 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:15:19.587184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:20.060490 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.473 seconds
[0m06:15:20.064453 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:15:20.144269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:15:20.145367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:15:20.156868 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:15:20.162469 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:15:20.163186 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:15:20.163734 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:15:20.164267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:20.164738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:21.024005 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.859 seconds
[0m06:15:21.028441 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:15:21.034005 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.870 seconds
[0m06:15:21.037166 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:15:21.109394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf97850>]}
[0m06:15:21.110423 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:15:21.111218 [info ] [MainThread]: 
[0m06:15:21.124190 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:15:21.124732 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:15:21.125229 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:15:21.126044 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:15:21.126834 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:15:21.127609 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:15:21.128276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m06:15:21.128827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m06:15:21.129451 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:15:21.129927 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:15:21.130432 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:15:21.130952 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:15:21.139000 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:15:21.141686 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:15:21.144364 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:15:21.146019 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:15:21.158210 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:15:21.170426 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:15:21.168105 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:15:21.165043 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:15:21.173378 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:15:21.174318 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:15:21.175138 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:15:21.174824 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:15:21.175658 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:15:21.175880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:15:21.176198 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:15:21.176515 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:15:21.180102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:21.180397 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:15:22.806503 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.625 seconds
[0m06:15:22.810537 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.622 seconds
[0m06:15:22.899059 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:15:22.899867 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:15:22.993154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6bf3a0>]}
[0m06:15:22.996385 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m06:15:22.999881 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6bf790>]}
[0m06:15:23.003566 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:15:23.004429 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.87s]
[0m06:15:23.006268 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:15:23.009006 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:15:23.009836 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:15:23.010805 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:15:23.011298 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:15:23.016636 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:15:23.021183 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:15:23.032683 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:15:23.042935 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:15:23.044066 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:15:23.046675 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:15:23.151110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26117-0306-1875-0004-85da0005b75e
[0m06:15:23.154753 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$11.99' is not recognized
[0m06:15:23.160481 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:15:23.281654 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$11.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:15:23.282619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c71d780>]}
[0m06:15:23.283516 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model STAGE_MART.dim_products .................. [[31mERROR[0m in 2.15s]
[0m06:15:23.284405 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:15:23.287128 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:15:23.287979 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:15:23.288676 [info ] [Thread-3 (]: 5 of 6 SKIP relation STAGE_MART.mart_avg_rating_by_year_brand .................. [[33mSKIP[0m]
[0m06:15:23.289619 [info ] [Thread-2 (]: 6 of 6 SKIP relation STAGE_MART.mart_product_kpi ............................... [[33mSKIP[0m]
[0m06:15:23.290895 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:15:23.292405 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:15:24.406735 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.360 seconds
[0m06:15:24.421432 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:15:24.537748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '830909ac-30e6-484b-baca-11be6795ec37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94841c0>]}
[0m06:15:24.538943 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.53s]
[0m06:15:24.540409 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:15:24.543858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:24.544436 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:15:24.544791 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews' was properly closed.
[0m06:15:24.545119 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m06:15:24.545394 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:15:24.545964 [info ] [MainThread]: 
[0m06:15:24.546444 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m06:15:24.547583 [debug] [MainThread]: Command end result
[0m06:15:24.585632 [info ] [MainThread]: 
[0m06:15:24.586113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:15:24.586424 [info ] [MainThread]: 
[0m06:15:24.586829 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  100038 (22018): DML operation to table NW13989.AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.DIM_PRODUCTS failed on column PRICE with error: Numeric value '$11.99' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_products.sql
[0m06:15:24.587178 [info ] [MainThread]: 
[0m06:15:24.587625 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m06:15:24.591893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8913817, "process_user_time": 3.552978, "process_kernel_time": 0.29415, "process_mem_max_rss": "200904", "process_out_blocks": "2503", "command_success": false, "process_in_blocks": "0"}
[0m06:15:24.592854 [debug] [MainThread]: Command `dbt run` failed at 06:15:24.592772 after 5.89 seconds
[0m06:15:24.593401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c22110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c68d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c68d630>]}
[0m06:15:24.593694 [debug] [MainThread]: Flushing usage events
[0m06:19:06.085491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a78c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b31fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b31f60>]}


============================== 06:19:06.089465 | 5101ae80-151c-4d8c-a6cb-3725061e809b ==============================
[0m06:19:06.089465 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:19:06.089959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:19:06.094872 [info ] [MainThread]: dbt version: 1.8.3
[0m06:19:06.095193 [info ] [MainThread]: python version: 3.10.14
[0m06:19:06.095461 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:19:06.095726 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:19:06.670812 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:19:06.671996 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:19:06.672777 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:19:06.673299 [info ] [MainThread]: adapter type: snowflake
[0m06:19:06.673683 [info ] [MainThread]: adapter version: 1.8.2
[0m06:19:06.734310 [info ] [MainThread]: Configuration:
[0m06:19:06.734829 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:19:06.735149 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:19:06.735421 [info ] [MainThread]: Required dependencies:
[0m06:19:06.735697 [debug] [MainThread]: Executing "git --help"
[0m06:19:06.747283 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:19:06.747925 [debug] [MainThread]: STDERR: "b''"
[0m06:19:06.748218 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:19:06.748561 [info ] [MainThread]: Connection:
[0m06:19:06.748881 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:19:06.749159 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:19:06.749425 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:19:06.749695 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:19:06.749954 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:19:06.750237 [info ] [MainThread]:   schema: STAGE
[0m06:19:06.750539 [info ] [MainThread]:   authenticator: jwt
[0m06:19:06.750782 [info ] [MainThread]:   oauth_client_id: None
[0m06:19:06.751081 [info ] [MainThread]:   query_tag: None
[0m06:19:06.751323 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:19:06.751587 [info ] [MainThread]:   host: None
[0m06:19:06.751843 [info ] [MainThread]:   port: None
[0m06:19:06.752085 [info ] [MainThread]:   proxy_host: None
[0m06:19:06.752323 [info ] [MainThread]:   proxy_port: None
[0m06:19:06.752550 [info ] [MainThread]:   protocol: None
[0m06:19:06.752792 [info ] [MainThread]:   connect_retries: 1
[0m06:19:06.753020 [info ] [MainThread]:   connect_timeout: None
[0m06:19:06.753237 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:19:06.753488 [info ] [MainThread]:   retry_all: False
[0m06:19:06.753750 [info ] [MainThread]:   insecure_mode: False
[0m06:19:06.753993 [info ] [MainThread]:   reuse_connections: None
[0m06:19:06.754338 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:19:06.812116 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:19:06.812856 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:19:06.813168 [debug] [MainThread]: On debug: select 1 as id
[0m06:19:06.813437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:19:07.326144 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.512 seconds
[0m06:19:07.328761 [debug] [MainThread]: On debug: Close
[0m06:19:07.423137 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:19:07.425118 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:19:07.428415 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3758608, "process_user_time": 2.238136, "process_kernel_time": 0.404262, "process_mem_max_rss": "187076", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:19:07.429642 [debug] [MainThread]: Command `dbt debug` succeeded at 06:19:07.429525 after 1.38 seconds
[0m06:19:07.430229 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:19:07.430788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a78c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99996ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b73400>]}
[0m06:19:07.431345 [debug] [MainThread]: Flushing usage events
[0m06:19:11.504315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf503a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b33a080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b33a020>]}


============================== 06:19:11.508265 | d21c49d0-7dcd-4c3b-b67b-0067516bd5d0 ==============================
[0m06:19:11.508265 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:19:11.508798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:19:11.585931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd21c49d0-7dcd-4c3b-b67b-0067516bd5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf7fe80>]}
[0m06:19:11.651901 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vinttp5d'
[0m06:19:11.652305 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:19:11.916853 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:19:11.920262 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:19:12.006596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:19:12.011600 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:19:12.471642 [info ] [MainThread]: Installed from version 1.1.1
[0m06:19:12.472717 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:19:12.473400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd21c49d0-7dcd-4c3b-b67b-0067516bd5d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8a4a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b28fd00>]}
[0m06:19:12.473989 [info ] [MainThread]: 
[0m06:19:12.474732 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:19:12.477414 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0017682, "process_user_time": 1.280421, "process_kernel_time": 0.205111, "process_mem_max_rss": "94916", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:19:12.478069 [debug] [MainThread]: Command `dbt deps` succeeded at 06:19:12.477992 after 1.00 seconds
[0m06:19:12.478515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf503a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8bcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8a4a30>]}
[0m06:19:12.478865 [debug] [MainThread]: Flushing usage events
[0m06:19:15.326653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4714340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b2a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b2a140>]}


============================== 06:19:15.330220 | fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f ==============================
[0m06:19:15.330220 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:19:15.330733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:19:15.903064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4737ee0>]}
[0m06:19:15.936498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347fa00>]}
[0m06:19:15.937320 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:19:15.999396 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:19:16.151476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:19:16.152045 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m06:19:16.281615 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:19:16.282162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f39810>]}
[0m06:19:16.384738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c0e80>]}
[0m06:19:16.461402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fb8790>]}
[0m06:19:16.461826 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:19:16.462167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fb8820>]}
[0m06:19:16.463397 [info ] [MainThread]: 
[0m06:19:16.463878 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:16.467587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:19:16.478943 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:19:16.479368 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:19:16.479655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:16.957774 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.478 seconds
[0m06:19:16.961852 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:19:17.066894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:19:17.068480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:19:17.078965 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:19:17.081521 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:19:17.082113 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:19:17.082636 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:19:17.083105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:17.083591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:17.504720 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.421 seconds
[0m06:19:17.507359 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.424 seconds
[0m06:19:17.512943 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:19:17.510919 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:19:17.635844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347f850>]}
[0m06:19:17.637270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:19:17.638175 [info ] [MainThread]: 
[0m06:19:17.649987 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:19:17.650979 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:19:17.651862 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:19:17.652831 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:19:17.653624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m06:19:17.654751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m06:19:17.655465 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:19:17.656097 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:19:17.664816 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:19:17.680830 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:19:17.682350 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:19:17.691075 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:19:17.709477 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:19:17.712970 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:19:17.714763 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:19:17.715158 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:19:17.716028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:19:17.715759 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:19:17.716461 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--cast(price as float) as price
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:19:17.719974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:18.367747 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m06:19:18.396426 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:19:18.909774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb481a020>]}
[0m06:19:18.911085 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.25s]
[0m06:19:18.913029 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:19:18.989689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m06:19:18.992625 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:19:19.067647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6ef9b8-9cf4-4a5e-97ca-bc21ca474a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91dac2e0>]}
[0m06:19:19.068725 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.41s]
[0m06:19:19.069615 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:19:19.071460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:19.072070 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:19:19.072576 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:19:19.073156 [info ] [MainThread]: 
[0m06:19:19.073692 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m06:19:19.074708 [debug] [MainThread]: Command end result
[0m06:19:19.118925 [info ] [MainThread]: 
[0m06:19:19.119404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:19.119769 [info ] [MainThread]: 
[0m06:19:19.120254 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:19:19.121272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8249784, "process_user_time": 3.230151, "process_kernel_time": 0.328148, "process_mem_max_rss": "204608", "process_out_blocks": "3700", "process_in_blocks": "0"}
[0m06:19:19.121696 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:19.121639 after 3.83 seconds
[0m06:19:19.122063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4714340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3948790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4737ee0>]}
[0m06:19:19.122417 [debug] [MainThread]: Flushing usage events
[0m06:19:21.336705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97004340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954161a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95416140>]}


============================== 06:19:21.340044 | 76eb4c4c-2bd6-48bc-8307-8fc0f20032d0 ==============================
[0m06:19:21.340044 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:19:21.340536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:19:22.129427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97033ee0>]}
[0m06:19:22.165563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d4b340>]}
[0m06:19:22.166436 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:19:22.258877 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:19:22.457288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:22.457677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:22.487382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff797b1240>]}
[0m06:19:22.562318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79887820>]}
[0m06:19:22.562778 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:19:22.563191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff798863e0>]}
[0m06:19:22.564600 [info ] [MainThread]: 
[0m06:19:22.565154 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:22.568851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:19:22.579946 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:19:22.580848 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:19:22.581388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:22.996222 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.415 seconds
[0m06:19:23.000248 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:19:23.102218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:19:23.103271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:19:23.114998 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:19:23.118473 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:19:23.119159 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:19:23.119673 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:19:23.120158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:23.120634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:23.549423 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.429 seconds
[0m06:19:23.551339 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:19:23.554289 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.434 seconds
[0m06:19:23.555608 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:19:23.627522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d4b850>]}
[0m06:19:23.628227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:19:23.628642 [info ] [MainThread]: 
[0m06:19:23.635807 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:19:23.636157 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:19:23.636427 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:19:23.636979 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:19:23.637476 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:19:23.637953 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:19:23.638420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m06:19:23.638837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m06:19:23.639292 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:19:23.639616 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:19:23.639955 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:19:23.640278 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:19:23.646775 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:19:23.651066 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:19:23.654626 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:19:23.657053 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:19:23.663111 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:19:23.682272 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:19:23.683698 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:19:23.683962 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:19:23.686551 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:19:23.687223 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:19:23.687737 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:19:23.688353 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:19:23.689514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:19:23.689197 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:19:23.688961 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:19:23.693027 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:19:23.689955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:23.693914 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:19:24.787694 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m06:19:24.806384 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:19:24.831198 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m06:19:24.833887 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:19:24.871784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d4a5f0>]}
[0m06:19:24.872936 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m06:19:24.874016 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:19:24.911459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7838f3d0>]}
[0m06:19:24.912448 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.27s]
[0m06:19:24.913196 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:19:24.914002 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:19:24.914583 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:19:24.915238 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:19:24.915735 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:19:24.919632 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:19:24.921185 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:19:24.925875 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:19:24.927611 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:19:24.928135 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:19:24.928638 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:19:25.812671 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.883 seconds
[0m06:19:25.818122 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:19:25.909537 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783b05b0>]}
[0m06:19:25.912284 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.99s]
[0m06:19:25.913938 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:19:26.221866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.532 seconds
[0m06:19:26.228194 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:19:26.339179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78d46380>]}
[0m06:19:26.341289 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.70s]
[0m06:19:26.342981 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:19:26.344444 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:19:26.345170 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:19:26.345831 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m06:19:26.346679 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m06:19:26.347508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m06:19:26.348317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m06:19:26.348945 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:19:26.349533 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m06:19:26.354015 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:19:26.357354 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:19:26.360424 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:19:26.360841 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m06:19:26.364513 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:19:26.367869 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:19:26.370495 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:19:26.372120 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:19:26.373390 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_timestamp) as first_review_date,
max(review_timestamp) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m06:19:26.374005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:19:26.372660 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_timestamp,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m06:19:26.376246 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:19:26.747870 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c2611b-0306-198a-0004-85da0005e2a2
[0m06:19:26.748806 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 5 unexpected '('.
syntax error line 21 at position 6 unexpected '*'.
syntax error line 21 at position 9 unexpected 'as'.
[0m06:19:26.749628 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m06:19:26.819400 [debug] [Thread-3 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 5 unexpected '('.
  syntax error line 21 at position 6 unexpected '*'.
  syntax error line 21 at position 9 unexpected 'as'.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m06:19:26.820478 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7838c610>]}
[0m06:19:26.821425 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.47s]
[0m06:19:26.823063 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:19:26.865328 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2611b-0306-1845-0004-85da0005a95a
[0m06:19:26.866748 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 4
invalid identifier 'REVIEW_TIMESTAMP'
[0m06:19:26.867718 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m06:19:26.978714 [debug] [Thread-2 (]: Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m06:19:26.980647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76eb4c4c-2bd6-48bc-8307-8fc0f20032d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7838e5f0>]}
[0m06:19:26.981967 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model STAGE_MART.mart_product_kpi .............. [[31mERROR[0m in 0.63s]
[0m06:19:26.983509 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:19:26.987008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:26.987899 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m06:19:26.988745 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:19:26.989373 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m06:19:26.990035 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:19:26.991223 [info ] [MainThread]: 
[0m06:19:26.992387 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m06:19:26.995398 [debug] [MainThread]: Command end result
[0m06:19:27.079063 [info ] [MainThread]: 
[0m06:19:27.080117 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:19:27.081123 [info ] [MainThread]: 
[0m06:19:27.081827 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 5 unexpected '('.
  syntax error line 21 at position 6 unexpected '*'.
  syntax error line 21 at position 9 unexpected 'as'.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m06:19:27.082369 [info ] [MainThread]: 
[0m06:19:27.082783 [error] [MainThread]:   Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIMESTAMP'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m06:19:27.083165 [info ] [MainThread]: 
[0m06:19:27.083729 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m06:19:27.085966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7784786, "process_user_time": 3.850739, "process_kernel_time": 0.346566, "process_mem_max_rss": "201264", "process_out_blocks": "2529", "command_success": false, "process_in_blocks": "0"}
[0m06:19:27.086753 [debug] [MainThread]: Command `dbt run` failed at 06:19:27.086674 after 5.78 seconds
[0m06:19:27.087137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97004340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783adf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9621a920>]}
[0m06:19:27.087443 [debug] [MainThread]: Flushing usage events
[0m06:28:31.797854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7a4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab3a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab39ff0>]}


============================== 06:28:31.801972 | d7305432-571b-4568-9262-b009bea427af ==============================
[0m06:28:31.801972 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:28:31.802560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:31.812039 [info ] [MainThread]: dbt version: 1.8.3
[0m06:28:31.812407 [info ] [MainThread]: python version: 3.10.14
[0m06:28:31.812720 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:28:31.813079 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:28:32.911907 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:28:32.912716 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:28:32.913170 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:28:32.913865 [info ] [MainThread]: adapter type: snowflake
[0m06:28:32.914437 [info ] [MainThread]: adapter version: 1.8.2
[0m06:28:32.973276 [info ] [MainThread]: Configuration:
[0m06:28:32.973790 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:28:32.974113 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:28:32.974386 [info ] [MainThread]: Required dependencies:
[0m06:28:32.974711 [debug] [MainThread]: Executing "git --help"
[0m06:28:32.986901 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:28:32.987345 [debug] [MainThread]: STDERR: "b''"
[0m06:28:32.987572 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:28:32.987827 [info ] [MainThread]: Connection:
[0m06:28:32.988109 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:28:32.988389 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:28:32.988677 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:28:32.988962 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:28:32.989252 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:28:32.989553 [info ] [MainThread]:   schema: STAGE
[0m06:28:32.989822 [info ] [MainThread]:   authenticator: jwt
[0m06:28:32.990067 [info ] [MainThread]:   oauth_client_id: None
[0m06:28:32.990305 [info ] [MainThread]:   query_tag: None
[0m06:28:32.990543 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:28:32.990759 [info ] [MainThread]:   host: None
[0m06:28:32.991005 [info ] [MainThread]:   port: None
[0m06:28:32.991264 [info ] [MainThread]:   proxy_host: None
[0m06:28:32.991488 [info ] [MainThread]:   proxy_port: None
[0m06:28:32.991713 [info ] [MainThread]:   protocol: None
[0m06:28:32.991945 [info ] [MainThread]:   connect_retries: 1
[0m06:28:32.992169 [info ] [MainThread]:   connect_timeout: None
[0m06:28:32.992427 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:28:32.992673 [info ] [MainThread]:   retry_all: False
[0m06:28:32.992905 [info ] [MainThread]:   insecure_mode: False
[0m06:28:32.993138 [info ] [MainThread]:   reuse_connections: None
[0m06:28:32.993519 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:28:33.066679 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:28:33.067590 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:28:33.067866 [debug] [MainThread]: On debug: select 1 as id
[0m06:28:33.068130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:28:33.657819 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.589 seconds
[0m06:28:33.662214 [debug] [MainThread]: On debug: Close
[0m06:28:33.767243 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:28:33.769152 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:28:33.771570 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0055013, "process_user_time": 2.567164, "process_kernel_time": 1.021078, "process_mem_max_rss": "187152", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:28:33.772715 [debug] [MainThread]: Command `dbt debug` succeeded at 06:28:33.772535 after 2.01 seconds
[0m06:28:33.773377 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:28:33.773956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7a4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9baf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b324c70>]}
[0m06:28:33.774562 [debug] [MainThread]: Flushing usage events
[0m06:28:37.703851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef50310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d34dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d34df90>]}


============================== 06:28:37.708050 | 7e4ae101-7f1a-435e-b4c5-ca8dce8066af ==============================
[0m06:28:37.708050 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:28:37.708640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:37.820825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e4ae101-7f1a-435e-b4c5-ca8dce8066af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef73fd0>]}
[0m06:28:37.896245 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-90qfxli2'
[0m06:28:37.896769 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:28:38.099968 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:28:38.101715 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:28:38.187584 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:28:38.193429 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:28:38.639665 [info ] [MainThread]: Installed from version 1.1.1
[0m06:28:38.640634 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:28:38.641299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7e4ae101-7f1a-435e-b4c5-ca8dce8066af', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e899480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2a3d00>]}
[0m06:28:38.641860 [info ] [MainThread]: 
[0m06:28:38.642238 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:28:38.643829 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9712791, "process_user_time": 1.240207, "process_kernel_time": 0.244405, "process_mem_max_rss": "94944", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:28:38.644491 [debug] [MainThread]: Command `dbt deps` succeeded at 06:28:38.644376 after 0.97 seconds
[0m06:28:38.644939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef50310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8f1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e899480>]}
[0m06:28:38.645300 [debug] [MainThread]: Flushing usage events
[0m06:28:42.448776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db48340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf561a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf56140>]}


============================== 06:28:42.453107 | a3c4955d-88d0-48a2-a153-dd76be69a22f ==============================
[0m06:28:42.453107 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:28:42.453820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:43.070224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db77ee0>]}
[0m06:28:43.103688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808afa00>]}
[0m06:28:43.104416 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:28:43.171206 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:28:43.339442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m06:28:43.340017 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m06:28:43.340316 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_product_kpi.sql
[0m06:28:43.485099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:28:43.485804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8027dc90>]}
[0m06:28:43.593728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfbcdc0>]}
[0m06:28:43.670269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803e9a80>]}
[0m06:28:43.670679 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:28:43.671000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803eb520>]}
[0m06:28:43.672264 [info ] [MainThread]: 
[0m06:28:43.672935 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:28:43.676368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:28:43.685605 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:28:43.686041 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:28:43.686322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:44.098052 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.411 seconds
[0m06:28:44.101319 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:28:44.178190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:28:44.187179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:28:44.187829 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:28:44.190308 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:28:44.190809 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:28:44.191306 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:28:44.191696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:44.192113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:44.649857 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.458 seconds
[0m06:28:44.654299 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:28:44.655914 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.464 seconds
[0m06:28:44.661337 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:28:44.824413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bff7790>]}
[0m06:28:44.826332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:44.827291 [info ] [MainThread]: 
[0m06:28:44.842173 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:28:44.843080 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:28:44.843913 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:28:44.844670 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:28:44.845357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m06:28:44.846179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m06:28:44.846657 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:28:44.847114 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:28:44.856733 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:28:44.871613 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:28:44.873764 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:28:44.883180 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:28:44.898823 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:28:44.895900 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:28:44.900604 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:28:44.901918 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--cast(price as float) as price
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:28:44.902289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:44.901636 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:28:44.902721 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:28:44.906060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:45.898335 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m06:28:45.900719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.998 seconds
[0m06:28:45.933814 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:28:45.931420 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:28:46.012432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd5c1c0>]}
[0m06:28:46.013659 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.17s]
[0m06:28:46.014666 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:28:46.022593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c4955d-88d0-48a2-a153-dd76be69a22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7bece0>]}
[0m06:28:46.023648 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.18s]
[0m06:28:46.024431 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:28:46.026017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:46.026521 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:28:46.026897 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:28:46.027319 [info ] [MainThread]: 
[0m06:28:46.027803 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m06:28:46.028698 [debug] [MainThread]: Command end result
[0m06:28:46.066913 [info ] [MainThread]: 
[0m06:28:46.067404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:28:46.067769 [info ] [MainThread]: 
[0m06:28:46.068162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:28:46.069123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.672875, "process_user_time": 3.410081, "process_kernel_time": 0.433347, "process_mem_max_rss": "204344", "process_out_blocks": "3699", "process_in_blocks": "0"}
[0m06:28:46.069586 [debug] [MainThread]: Command `dbt run` succeeded at 06:28:46.069507 after 3.67 seconds
[0m06:28:46.069923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db48340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8007b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db77ee0>]}
[0m06:28:46.070229 [debug] [MainThread]: Flushing usage events
[0m06:28:48.441139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8763c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a3e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a3e140>]}


============================== 06:28:48.444605 | d86f7f9b-0ed3-4f3c-9da6-0ea2d688b579 ==============================
[0m06:28:48.444605 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:28:48.445209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:28:48.942379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8765fee0>]}
[0m06:28:48.971422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66393340>]}
[0m06:28:48.972015 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:28:49.031726 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:28:49.180055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:28:49.180403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:28:49.209920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65df5240>]}
[0m06:28:49.285219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f65ff0>]}
[0m06:28:49.285641 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:28:49.285936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f65480>]}
[0m06:28:49.287121 [info ] [MainThread]: 
[0m06:28:49.287555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:28:49.290912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:28:49.300751 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:28:49.301113 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:28:49.301387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:49.680966 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.379 seconds
[0m06:28:49.683786 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:28:49.766091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:28:49.767673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:28:49.779077 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:28:49.783597 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:28:49.784603 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:28:49.785144 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:28:49.785686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:49.786219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:50.231712 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.445 seconds
[0m06:28:50.233414 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:28:50.237506 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.452 seconds
[0m06:28:50.239033 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:28:50.310297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66393850>]}
[0m06:28:50.311251 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:50.311981 [info ] [MainThread]: 
[0m06:28:50.325632 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:28:50.326292 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:28:50.326657 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:28:50.327240 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:28:50.327840 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:28:50.328441 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:28:50.328943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m06:28:50.329419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m06:28:50.329903 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:28:50.330647 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:28:50.331046 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:28:50.331442 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:28:50.337702 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:28:50.340080 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:28:50.342432 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:28:50.344618 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:28:50.345018 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:28:50.351807 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:28:50.364206 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:28:50.367492 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:28:50.371492 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:28:50.373086 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:28:50.373747 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:28:50.375293 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:28:50.374832 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:28:50.374169 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:28:50.375793 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:50.376297 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:28:50.376624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:50.377074 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:28:51.631891 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.256 seconds
[0m06:28:51.663759 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:28:51.664719 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.288 seconds
[0m06:28:51.670050 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:28:51.733284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6494f430>]}
[0m06:28:51.734363 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.40s]
[0m06:28:51.735482 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:28:51.752433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64963760>]}
[0m06:28:51.753430 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.42s]
[0m06:28:51.754276 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:28:51.755222 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:28:51.756065 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:28:51.757185 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:28:51.757842 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:28:51.761979 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:28:51.763705 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:28:51.768561 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:28:51.770279 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:28:51.770856 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:28:51.771343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:28:52.658498 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.886 seconds
[0m06:28:52.665262 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:28:52.748546 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff868441c0>]}
[0m06:28:52.750898 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 0.99s]
[0m06:28:52.753024 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:28:52.937194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.560 seconds
[0m06:28:52.944126 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:28:53.045046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64994940>]}
[0m06:28:53.047202 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.72s]
[0m06:28:53.048700 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:28:53.050245 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:28:53.050936 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:28:53.051748 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m06:28:53.052553 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m06:28:53.053508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m06:28:53.054206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m06:28:53.054859 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:28:53.055416 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m06:28:53.060233 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:28:53.063528 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:28:53.065384 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:28:53.065752 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m06:28:53.068865 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:28:53.071595 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:28:53.073326 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:28:53.073778 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m06:28:53.074907 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:28:53.074614 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:28:53.075437 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m06:28:53.076617 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:28:53.492162 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c26124-0306-17b1-0004-85da0005c45e
[0m06:28:53.493324 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 5 unexpected '('.
syntax error line 21 at position 6 unexpected '*'.
syntax error line 21 at position 9 unexpected 'as'.
[0m06:28:53.494221 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m06:28:53.586698 [debug] [Thread-3 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 5 unexpected '('.
  syntax error line 21 at position 6 unexpected '*'.
  syntax error line 21 at position 9 unexpected 'as'.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m06:28:53.588576 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64996e60>]}
[0m06:28:53.589788 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.54s]
[0m06:28:53.591042 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:28:54.088980 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m06:28:54.095148 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m06:28:54.167680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86f7f9b-0ed3-4f3c-9da6-0ea2d688b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64994c70>]}
[0m06:28:54.169153 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.11s]
[0m06:28:54.170220 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:28:54.172839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:54.173587 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:28:54.174125 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m06:28:54.174601 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m06:28:54.175143 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:28:54.175948 [info ] [MainThread]: 
[0m06:28:54.176575 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m06:28:54.178246 [debug] [MainThread]: Command end result
[0m06:28:54.223308 [info ] [MainThread]: 
[0m06:28:54.223825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:28:54.224243 [info ] [MainThread]: 
[0m06:28:54.224658 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 5 unexpected '('.
  syntax error line 21 at position 6 unexpected '*'.
  syntax error line 21 at position 9 unexpected 'as'.
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m06:28:54.225017 [info ] [MainThread]: 
[0m06:28:54.225401 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m06:28:54.227243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.816079, "process_user_time": 3.530402, "process_kernel_time": 0.300224, "process_mem_max_rss": "201388", "process_out_blocks": "2526", "command_success": false, "process_in_blocks": "0"}
[0m06:28:54.227949 [debug] [MainThread]: Command `dbt run` failed at 06:28:54.227869 after 5.82 seconds
[0m06:28:54.228434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8763c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65db60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65db5900>]}
[0m06:28:54.228790 [debug] [MainThread]: Flushing usage events
[0m06:30:03.704004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a536080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a536020>]}


============================== 06:30:03.709355 | 5871b83a-ab4e-4b81-a199-1669cf64a966 ==============================
[0m06:30:03.709355 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:30:03.709962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:30:03.716498 [info ] [MainThread]: dbt version: 1.8.3
[0m06:30:03.717041 [info ] [MainThread]: python version: 3.10.14
[0m06:30:03.717437 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:30:03.717778 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:30:04.234182 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:30:04.234829 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:30:04.235233 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:30:04.235682 [info ] [MainThread]: adapter type: snowflake
[0m06:30:04.235961 [info ] [MainThread]: adapter version: 1.8.2
[0m06:30:04.291179 [info ] [MainThread]: Configuration:
[0m06:30:04.291642 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:30:04.291897 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:30:04.292127 [info ] [MainThread]: Required dependencies:
[0m06:30:04.292361 [debug] [MainThread]: Executing "git --help"
[0m06:30:04.295103 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:30:04.295469 [debug] [MainThread]: STDERR: "b''"
[0m06:30:04.295759 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:30:04.295999 [info ] [MainThread]: Connection:
[0m06:30:04.296288 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:30:04.296597 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:30:04.296864 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:30:04.297130 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:30:04.297352 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:30:04.297582 [info ] [MainThread]:   schema: STAGE
[0m06:30:04.297811 [info ] [MainThread]:   authenticator: jwt
[0m06:30:04.298058 [info ] [MainThread]:   oauth_client_id: None
[0m06:30:04.298281 [info ] [MainThread]:   query_tag: None
[0m06:30:04.298501 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:30:04.298714 [info ] [MainThread]:   host: None
[0m06:30:04.298937 [info ] [MainThread]:   port: None
[0m06:30:04.299185 [info ] [MainThread]:   proxy_host: None
[0m06:30:04.299419 [info ] [MainThread]:   proxy_port: None
[0m06:30:04.299657 [info ] [MainThread]:   protocol: None
[0m06:30:04.299912 [info ] [MainThread]:   connect_retries: 1
[0m06:30:04.300145 [info ] [MainThread]:   connect_timeout: None
[0m06:30:04.300386 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:30:04.300686 [info ] [MainThread]:   retry_all: False
[0m06:30:04.300987 [info ] [MainThread]:   insecure_mode: False
[0m06:30:04.301236 [info ] [MainThread]:   reuse_connections: None
[0m06:30:04.301646 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:30:04.365916 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:30:04.366644 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:30:04.366948 [debug] [MainThread]: On debug: select 1 as id
[0m06:30:04.367243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:30:05.172254 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.804 seconds
[0m06:30:05.174945 [debug] [MainThread]: On debug: Close
[0m06:30:05.291324 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:30:05.292383 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:30:05.294094 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6285845, "process_user_time": 2.386663, "process_kernel_time": 0.402189, "process_mem_max_rss": "187080", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:30:05.294937 [debug] [MainThread]: Command `dbt debug` succeeded at 06:30:05.294782 after 1.63 seconds
[0m06:30:05.295541 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:30:05.296148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3edf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6da560>]}
[0m06:30:05.296794 [debug] [MainThread]: Flushing usage events
[0m06:30:08.224783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fa4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0339ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0339f90>]}


============================== 06:30:08.228433 | ed2b0871-f8ad-422b-a79d-6f9e3513fe8e ==============================
[0m06:30:08.228433 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:30:08.229016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:30:08.303502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed2b0871-f8ad-422b-a79d-6f9e3513fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fd3ee0>]}
[0m06:30:08.364699 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zqk8ckqt'
[0m06:30:08.365141 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:30:09.417288 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:30:09.507915 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:30:09.759086 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:30:09.778854 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:30:10.372453 [info ] [MainThread]: Installed from version 1.1.1
[0m06:30:10.375465 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:30:10.379085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed2b0871-f8ad-422b-a79d-6f9e3513fe8e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18f9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0293d30>]}
[0m06:30:10.381933 [info ] [MainThread]: 
[0m06:30:10.383055 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:30:10.387146 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.1926057, "process_user_time": 2.142567, "process_kernel_time": 0.434525, "process_mem_max_rss": "94792", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:30:10.389518 [debug] [MainThread]: Command `dbt deps` succeeded at 06:30:10.389274 after 2.20 seconds
[0m06:30:10.390326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fa4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa033ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1952890>]}
[0m06:30:10.390784 [debug] [MainThread]: Flushing usage events
[0m06:30:13.653970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955083d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9392a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9392a170>]}


============================== 06:30:13.658327 | 32463cab-fd23-49c9-ba4b-79c7c40f7c3c ==============================
[0m06:30:13.658327 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:30:13.658941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:30:14.328282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a8fdf0>]}
[0m06:30:14.363737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff782c3c70>]}
[0m06:30:14.364397 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:30:14.448279 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:30:14.631819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:30:14.632396 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m06:30:14.772303 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:30:14.772954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7811ac80>]}
[0m06:30:14.877184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff733c0eb0>]}
[0m06:30:14.968605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c0c520>]}
[0m06:30:14.969239 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:30:14.969589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f3f9d0>]}
[0m06:30:14.970918 [info ] [MainThread]: 
[0m06:30:14.971424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:30:14.974903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:30:14.986768 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:30:14.987133 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:30:14.987361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:15.480920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.493 seconds
[0m06:30:15.484645 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:30:15.636818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:30:15.638136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:30:15.652046 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:30:15.655151 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:30:15.655790 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:30:15.656354 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:30:15.656882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:15.657352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:16.070176 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.412 seconds
[0m06:30:16.073572 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:30:16.116180 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.459 seconds
[0m06:30:16.118770 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:30:16.237781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7828b4c0>]}
[0m06:30:16.239166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:30:16.239933 [info ] [MainThread]: 
[0m06:30:16.256340 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:30:16.256969 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:30:16.257804 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:30:16.258602 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:30:16.259411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m06:30:16.260508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m06:30:16.261050 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:30:16.261624 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:30:16.270195 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:30:16.283695 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:30:16.284981 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:30:16.285310 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:30:16.305663 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:30:16.307928 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:30:16.309994 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:30:16.310424 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:30:16.311285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:30:16.311027 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:30:16.311736 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--cast(price as float) as price
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:30:16.315567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:30:16.915114 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m06:30:16.942750 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:30:16.944255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m06:30:16.949110 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:30:17.018422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727949a0>]}
[0m06:30:17.019677 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m06:30:17.020585 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:30:17.025688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32463cab-fd23-49c9-ba4b-79c7c40f7c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7828a680>]}
[0m06:30:17.026557 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.77s]
[0m06:30:17.027414 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:30:17.029198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:17.029887 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:30:17.030383 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:30:17.031008 [info ] [MainThread]: 
[0m06:30:17.031598 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m06:30:17.032939 [debug] [MainThread]: Command end result
[0m06:30:17.076933 [info ] [MainThread]: 
[0m06:30:17.077402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:30:17.077782 [info ] [MainThread]: 
[0m06:30:17.078109 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:30:17.078972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4573972, "process_user_time": 3.472546, "process_kernel_time": 0.53369, "process_mem_max_rss": "204384", "process_out_blocks": "3699", "process_in_blocks": "0"}
[0m06:30:17.079416 [debug] [MainThread]: Command `dbt run` succeeded at 06:30:17.079345 after 3.46 seconds
[0m06:30:17.079784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a8fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9474bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72756a10>]}
[0m06:30:17.080125 [debug] [MainThread]: Flushing usage events
[0m06:30:19.366519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9167c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa3e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa3e170>]}


============================== 06:30:19.370289 | 53953011-4a56-4867-9265-828218c6e544 ==============================
[0m06:30:19.370289 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:30:19.370968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:30:19.880498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd6b760>]}
[0m06:30:19.911625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff743c0ca0>]}
[0m06:30:19.912349 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:30:19.973558 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:30:20.121642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:30:20.122057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:30:20.152058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd89270>]}
[0m06:30:20.283213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd44a60>]}
[0m06:30:20.283856 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:30:20.284331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd449d0>]}
[0m06:30:20.286573 [info ] [MainThread]: 
[0m06:30:20.289026 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:30:20.294134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:30:20.305784 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:30:20.306419 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:30:20.306875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:20.805842 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.499 seconds
[0m06:30:20.809184 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:30:20.998785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m06:30:21.000642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:30:21.012262 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:30:21.016780 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:30:21.017664 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:30:21.018247 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:30:21.018834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:21.019348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:21.745469 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.726 seconds
[0m06:30:21.753142 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:30:22.253813 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.235 seconds
[0m06:30:22.256571 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:30:22.382676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74397d60>]}
[0m06:30:22.383620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:30:22.384106 [info ] [MainThread]: 
[0m06:30:22.397911 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:30:22.398513 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:30:22.398794 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:30:22.399343 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:30:22.399815 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:30:22.400451 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:30:22.401049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m06:30:22.401429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m06:30:22.401893 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:30:22.402260 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:30:22.402593 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:30:22.402930 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:30:22.409604 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:30:22.411767 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:30:22.413939 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:30:22.415137 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:30:22.426066 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:30:22.462846 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:30:22.467187 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:30:22.468178 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:30:22.472398 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:30:22.473254 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:30:22.473889 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:30:22.474391 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:30:22.475943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:30:22.475532 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:30:22.475232 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:30:22.476457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:30:22.477748 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:30:22.479368 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:30:25.439659 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.954 seconds
[0m06:30:25.495570 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:30:25.698660 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.222 seconds
[0m06:30:25.704740 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f14f850>]}
[0m06:30:25.707971 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:30:25.711110 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.30s]
[0m06:30:25.717238 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:30:25.720069 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:30:25.721220 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:30:25.722184 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:30:25.722887 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:30:25.732592 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:30:25.734974 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:30:25.741072 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:30:25.743288 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:30:25.743769 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:30:25.744248 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:30:25.798080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f161120>]}
[0m06:30:25.803766 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 3.40s]
[0m06:30:25.805668 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:30:26.558713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.082 seconds
[0m06:30:26.565783 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:30:26.701320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f137cd0>]}
[0m06:30:26.703589 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 4.30s]
[0m06:30:26.704766 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:30:26.705972 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:30:26.706395 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:30:26.707138 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m06:30:26.707918 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m06:30:26.708829 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m06:30:26.709446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m06:30:26.710105 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:30:26.710671 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m06:30:26.715446 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:30:26.719134 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:30:26.721929 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m06:30:26.725739 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:30:26.726192 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:30:26.730583 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:30:26.732249 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:30:26.733355 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m06:30:26.736981 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:30:26.738252 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m06:30:26.738837 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:30:26.737455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:30:27.382859 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m06:30:27.386237 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:30:27.402886 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c26126-0306-1845-0004-85da0005a976
[0m06:30:27.403792 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 0
invalid identifier 'REVIEW_YEAR'
[0m06:30:27.404512 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m06:30:27.574607 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f14f730>]}
[0m06:30:27.576765 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.85s]
[0m06:30:27.577929 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:30:27.581516 [debug] [Thread-3 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 20 at position 0
  invalid identifier 'REVIEW_YEAR'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m06:30:27.582677 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb3e0b0>]}
[0m06:30:27.583619 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.87s]
[0m06:30:27.584711 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:30:28.409049 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.671 seconds
[0m06:30:28.413440 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m06:30:28.568164 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53953011-4a56-4867-9265-828218c6e544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f1c84c0>]}
[0m06:30:28.570150 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.86s]
[0m06:30:28.571139 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:30:28.576179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:28.576965 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:30:28.577472 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m06:30:28.577895 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m06:30:28.578238 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:30:28.578891 [info ] [MainThread]: 
[0m06:30:28.579465 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m06:30:28.581283 [debug] [MainThread]: Command end result
[0m06:30:28.634395 [info ] [MainThread]: 
[0m06:30:28.634966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:30:28.635461 [info ] [MainThread]: 
[0m06:30:28.635884 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 20 at position 0
  invalid identifier 'REVIEW_YEAR'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m06:30:28.636249 [info ] [MainThread]: 
[0m06:30:28.636927 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m06:30:28.639906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.3033085, "process_user_time": 6.372956, "process_kernel_time": 0.50302, "process_mem_max_rss": "201156", "process_out_blocks": "2526", "command_success": false, "process_in_blocks": "0"}
[0m06:30:28.640884 [debug] [MainThread]: Command `dbt run` failed at 06:30:28.640810 after 9.30 seconds
[0m06:30:28.641435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9167c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff743c0ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb9f970>]}
[0m06:30:28.641841 [debug] [MainThread]: Flushing usage events
[0m06:32:27.687346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f44370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb234a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2349ff0>]}


============================== 06:32:27.692052 | 2c6d1ce5-8c8d-496a-809a-6f76e4a58197 ==============================
[0m06:32:27.692052 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:32:27.692917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:32:27.702392 [info ] [MainThread]: dbt version: 1.8.3
[0m06:32:27.702885 [info ] [MainThread]: python version: 3.10.14
[0m06:32:27.703257 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m06:32:27.703564 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:32:28.300332 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m06:32:28.300960 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m06:32:28.301324 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m06:32:28.301707 [info ] [MainThread]: adapter type: snowflake
[0m06:32:28.301972 [info ] [MainThread]: adapter version: 1.8.2
[0m06:32:28.356911 [info ] [MainThread]: Configuration:
[0m06:32:28.357417 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:32:28.357724 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:32:28.358075 [info ] [MainThread]: Required dependencies:
[0m06:32:28.358339 [debug] [MainThread]: Executing "git --help"
[0m06:32:28.362802 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:32:28.363142 [debug] [MainThread]: STDERR: "b''"
[0m06:32:28.363369 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:32:28.363618 [info ] [MainThread]: Connection:
[0m06:32:28.363913 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m06:32:28.364226 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m06:32:28.364509 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m06:32:28.364804 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m06:32:28.365108 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m06:32:28.365435 [info ] [MainThread]:   schema: STAGE
[0m06:32:28.365690 [info ] [MainThread]:   authenticator: jwt
[0m06:32:28.365935 [info ] [MainThread]:   oauth_client_id: None
[0m06:32:28.366230 [info ] [MainThread]:   query_tag: None
[0m06:32:28.366448 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:32:28.366663 [info ] [MainThread]:   host: None
[0m06:32:28.366894 [info ] [MainThread]:   port: None
[0m06:32:28.367162 [info ] [MainThread]:   proxy_host: None
[0m06:32:28.367420 [info ] [MainThread]:   proxy_port: None
[0m06:32:28.367649 [info ] [MainThread]:   protocol: None
[0m06:32:28.367903 [info ] [MainThread]:   connect_retries: 1
[0m06:32:28.368164 [info ] [MainThread]:   connect_timeout: None
[0m06:32:28.368406 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:32:28.368687 [info ] [MainThread]:   retry_all: False
[0m06:32:28.368900 [info ] [MainThread]:   insecure_mode: False
[0m06:32:28.369269 [info ] [MainThread]:   reuse_connections: None
[0m06:32:28.370081 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:32:28.434305 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:32:28.435017 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:32:28.435378 [debug] [MainThread]: On debug: select 1 as id
[0m06:32:28.435651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:32:29.133858 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.698 seconds
[0m06:32:29.135560 [debug] [MainThread]: On debug: Close
[0m06:32:29.229860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:32:29.231107 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:32:29.232815 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5823764, "process_user_time": 2.412384, "process_kernel_time": 0.513795, "process_mem_max_rss": "187092", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m06:32:29.233591 [debug] [MainThread]: Command `dbt debug` succeeded at 06:32:29.233489 after 1.58 seconds
[0m06:32:29.234167 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:32:29.234758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f44370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb315af20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92af4c70>]}
[0m06:32:29.235511 [debug] [MainThread]: Flushing usage events
[0m06:32:33.293386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c10370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa500e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa500dff0>]}


============================== 06:32:33.298159 | 9fd36dd6-2b54-4197-ab0a-cbaa2bf81626 ==============================
[0m06:32:33.298159 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:32:33.298722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m06:32:33.394496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd36dd6-2b54-4197-ab0a-cbaa2bf81626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c33eb0>]}
[0m06:32:33.495301 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1cth8191'
[0m06:32:33.497536 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:32:33.675273 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:32:33.677764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:32:33.783138 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:32:33.789279 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:32:34.517192 [info ] [MainThread]: Installed from version 1.1.1
[0m06:32:34.522229 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:32:34.524065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9fd36dd6-2b54-4197-ab0a-cbaa2bf81626', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65594e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f63d00>]}
[0m06:32:34.525673 [info ] [MainThread]: 
[0m06:32:34.526448 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:32:34.535062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2775997, "process_user_time": 1.661298, "process_kernel_time": 0.362628, "process_mem_max_rss": "95172", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m06:32:34.536570 [debug] [MainThread]: Command `dbt deps` succeeded at 06:32:34.536366 after 1.28 seconds
[0m06:32:34.537438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c10370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65594e0>]}
[0m06:32:34.537811 [debug] [MainThread]: Flushing usage events
[0m06:32:38.931477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900f4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45a110>]}


============================== 06:32:38.935720 | ef7da3b9-9999-47ea-aad3-1975d395b07a ==============================
[0m06:32:38.935720 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:32:38.936283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:32:39.761806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90117ee0>]}
[0m06:32:39.802856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eee3d90>]}
[0m06:32:39.804386 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:32:39.942180 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:32:40.154641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:32:40.156571 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_avg_rating_by_year_brand.sql
[0m06:32:40.325338 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:32:40.326025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ef3b3d0>]}
[0m06:32:40.619782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e3c0df0>]}
[0m06:32:40.880125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e87c730>]}
[0m06:32:40.881301 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:32:40.881795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e87c4c0>]}
[0m06:32:40.884119 [info ] [MainThread]: 
[0m06:32:40.884987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:32:40.889175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:32:40.905854 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:32:40.906451 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:32:40.906832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:41.490478 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.583 seconds
[0m06:32:41.494163 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:32:41.601690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:32:41.602756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:32:41.611222 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:32:41.615094 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:32:41.615584 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:32:41.615891 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:32:41.616187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:41.616452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:42.138550 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.511 seconds
[0m06:32:42.133354 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.516 seconds
[0m06:32:42.159239 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:32:42.164541 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:32:42.356310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eeab2e0>]}
[0m06:32:42.367937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:32:42.375473 [info ] [MainThread]: 
[0m06:32:42.537975 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m06:32:42.541735 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m06:32:42.554268 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m06:32:42.563727 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m06:32:42.576697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m06:32:42.592163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m06:32:42.598528 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m06:32:42.602308 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m06:32:42.644912 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m06:32:42.679074 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:32:42.692152 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m06:32:42.793238 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m06:32:42.841405 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m06:32:42.839154 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m06:32:42.844832 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m06:32:42.846100 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m06:32:42.847773 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:32:42.847208 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m06:32:42.851722 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
--cast(price as float) as price
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m06:32:42.854943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:43.537697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m06:32:43.540698 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m06:32:43.569264 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m06:32:43.571106 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m06:32:43.666769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eeaa5c0>]}
[0m06:32:43.668240 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.09s]
[0m06:32:43.669329 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m06:32:43.667391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef7da3b9-9999-47ea-aad3-1975d395b07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e882440>]}
[0m06:32:43.672108 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.08s]
[0m06:32:43.673577 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m06:32:43.677412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:32:43.677981 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m06:32:43.678241 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m06:32:43.678949 [info ] [MainThread]: 
[0m06:32:43.679739 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m06:32:43.681487 [debug] [MainThread]: Command end result
[0m06:32:43.732247 [info ] [MainThread]: 
[0m06:32:43.732817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:32:43.733215 [info ] [MainThread]: 
[0m06:32:43.733596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:32:43.735671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8389325, "process_user_time": 4.814572, "process_kernel_time": 0.700414, "process_mem_max_rss": "204420", "process_out_blocks": "3700", "process_in_blocks": "0"}
[0m06:32:43.736438 [debug] [MainThread]: Command `dbt run` succeeded at 06:32:43.736356 after 4.84 seconds
[0m06:32:43.737020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900f4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f328790>]}
[0m06:32:43.737448 [debug] [MainThread]: Flushing usage events
[0m06:32:47.896225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc7c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab03e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab03e110>]}


============================== 06:32:47.900609 | 998e8219-dd26-43d1-b034-ccda0317502a ==============================
[0m06:32:47.900609 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:32:47.901321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:32:48.566330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc9ffd0>]}
[0m06:32:48.622589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b984c40>]}
[0m06:32:48.623959 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:32:48.764559 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:32:48.959633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:32:48.960117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:32:49.045511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3e9210>]}
[0m06:32:49.180875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b555300>]}
[0m06:32:49.181637 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:32:49.182418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b555480>]}
[0m06:32:49.184936 [info ] [MainThread]: 
[0m06:32:49.185664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:32:49.189528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m06:32:49.199615 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m06:32:49.200079 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m06:32:49.200373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:49.733175 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.533 seconds
[0m06:32:49.736505 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m06:32:49.821226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m06:32:49.822537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:32:49.828434 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:32:49.830742 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:32:49.831356 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:32:49.831700 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:32:49.832049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:49.832359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:50.224181 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.392 seconds
[0m06:32:50.227966 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:32:50.232883 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.400 seconds
[0m06:32:50.234239 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:32:50.343699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9572e0>]}
[0m06:32:50.344477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:32:50.345225 [info ] [MainThread]: 
[0m06:32:50.351621 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m06:32:50.351942 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m06:32:50.352243 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:32:50.352786 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m06:32:50.353773 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m06:32:50.354412 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m06:32:50.354948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m06:32:50.355397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m06:32:50.355846 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m06:32:50.356227 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m06:32:50.356623 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m06:32:50.356979 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:32:50.362390 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m06:32:50.364488 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:32:50.366508 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:32:50.367778 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m06:32:50.390920 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m06:32:50.391492 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:32:50.391760 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m06:32:50.394743 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:32:50.398088 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m06:32:50.398782 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m06:32:50.401053 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select
product_id,
product_title,
brand,
price
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select *
from products
        );
[0m06:32:50.401864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:50.402502 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m06:32:50.403913 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m06:32:50.405611 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m06:32:50.404584 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m06:32:50.408934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:32:50.409234 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:32:51.659916 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.250 seconds
[0m06:32:51.691873 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m06:32:51.739630 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.331 seconds
[0m06:32:51.742927 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m06:32:51.809701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f4f700>]}
[0m06:32:51.810931 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.45s]
[0m06:32:51.812206 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m06:32:51.813884 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m06:32:51.815263 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f4f310>]}
[0m06:32:51.815761 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m06:32:51.816581 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 1.46s]
[0m06:32:51.817626 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m06:32:51.818812 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m06:32:51.821443 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m06:32:51.826214 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m06:32:51.827706 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m06:32:51.831677 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m06:32:51.833153 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m06:32:51.833513 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m06:32:51.833868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:32:53.111307 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m06:32:53.136258 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m06:32:53.164506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.762 seconds
[0m06:32:53.170650 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m06:32:53.244828 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe86b90>]}
[0m06:32:53.247423 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.43s]
[0m06:32:53.249358 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m06:32:53.273280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f84580>]}
[0m06:32:53.274657 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.92s]
[0m06:32:53.275534 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m06:32:53.284313 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:32:53.285018 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:32:53.285752 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m06:32:53.286283 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m06:32:53.287087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m06:32:53.288040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m06:32:53.288923 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:32:53.289450 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m06:32:53.299986 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:32:53.305887 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:32:53.309556 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m06:32:53.311237 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:32:53.315753 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:32:53.325754 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:32:53.329343 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m06:32:53.331701 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m06:32:53.331146 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m06:32:53.333949 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m06:32:53.334746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:32:53.332753 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:32:54.318248 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m06:32:54.323136 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m06:32:54.395747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f87100>]}
[0m06:32:54.397503 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.11s]
[0m06:32:54.398500 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m06:32:54.460306 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.125 seconds
[0m06:32:54.462050 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m06:32:54.623188 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998e8219-dd26-43d1-b034-ccda0317502a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f852d0>]}
[0m06:32:54.624921 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.34s]
[0m06:32:54.626276 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m06:32:54.628865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:32:54.629366 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m06:32:54.629640 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m06:32:54.629873 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m06:32:54.630165 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m06:32:54.630570 [info ] [MainThread]: 
[0m06:32:54.630978 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m06:32:54.631981 [debug] [MainThread]: Command end result
[0m06:32:54.668208 [info ] [MainThread]: 
[0m06:32:54.668725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:32:54.669084 [info ] [MainThread]: 
[0m06:32:54.669456 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:32:54.672006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.814167, "process_user_time": 4.425635, "process_kernel_time": 0.645685, "process_mem_max_rss": "200248", "process_out_blocks": "2524", "process_in_blocks": "0"}
[0m06:32:54.673135 [debug] [MainThread]: Command `dbt run` succeeded at 06:32:54.673036 after 6.82 seconds
[0m06:32:54.673680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc7c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabeb1480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc9ffd0>]}
[0m06:32:54.674080 [debug] [MainThread]: Flushing usage events
[0m06:32:58.633660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7561a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d756140>]}


============================== 06:32:58.642412 | 9e0076e4-f0c5-43e9-903b-e4206ddec76d ==============================
[0m06:32:58.642412 [info ] [MainThread]: Running with dbt=1.8.3
[0m06:32:58.643938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:32:59.355403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0076e4-f0c5-43e9-903b-e4206ddec76d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da87580>]}
[0m06:32:59.393911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0076e4-f0c5-43e9-903b-e4206ddec76d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0e7d30>]}
[0m06:32:59.394798 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m06:32:59.534871 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m06:32:59.697342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:32:59.697829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:32:59.732888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e0076e4-f0c5-43e9-903b-e4206ddec76d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db19270>]}
[0m06:32:59.854993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e0076e4-f0c5-43e9-903b-e4206ddec76d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db4c820>]}
[0m06:32:59.855616 [info ] [MainThread]: Found 8 models, 9 data tests, 2 sources, 573 macros
[0m06:32:59.856254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0076e4-f0c5-43e9-903b-e4206ddec76d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7daea7a0>]}
[0m06:32:59.857712 [info ] [MainThread]: 
[0m06:32:59.858382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:32:59.862338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m06:32:59.863051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m06:32:59.874706 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m06:32:59.876808 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m06:32:59.877244 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m06:32:59.877652 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m06:32:59.877989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:59.878358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:00.344029 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.465 seconds
[0m06:33:00.347938 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m06:33:00.385542 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.507 seconds
[0m06:33:00.387911 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m06:33:00.474327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0076e4-f0c5-43e9-903b-e4206ddec76d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f397a30>]}
[0m06:33:00.475973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:33:00.476921 [info ] [MainThread]: 
[0m06:33:00.485151 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m06:33:00.485706 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m06:33:00.486153 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m06:33:00.486622 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m06:33:00.486960 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m06:33:00.487548 [info ] [Thread-2 (]: 2 of 9 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m06:33:00.488059 [info ] [Thread-3 (]: 3 of 9 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m06:33:00.488575 [info ] [Thread-4 (]: 4 of 9 START test not_null_stg_meta_product_id ................................. [RUN]
[0m06:33:00.489266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m06:33:00.489822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m06:33:00.490603 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m06:33:00.491213 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m06:33:00.491680 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m06:33:00.492199 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m06:33:00.492574 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m06:33:00.492924 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m06:33:00.503167 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m06:33:00.509517 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m06:33:00.514374 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m06:33:00.519196 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m06:33:00.522146 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m06:33:00.539472 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m06:33:00.540266 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m06:33:00.540519 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m06:33:00.540967 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m06:33:00.542964 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m06:33:00.545516 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m06:33:00.546281 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m06:33:00.548048 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m06:33:00.549157 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m06:33:00.550672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:00.550167 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m06:33:00.551118 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m06:33:00.552021 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m06:33:00.552286 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m06:33:00.556152 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m06:33:00.556786 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m06:33:00.557333 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:33:00.557869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:33:00.559101 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:33:01.051626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m06:33:01.063026 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m06:33:01.065802 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m06:33:01.067546 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m06:33:01.072012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m06:33:01.073416 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m06:33:01.140425 [info ] [Thread-2 (]: 2 of 9 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.65s]
[0m06:33:01.141261 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m06:33:01.141712 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m06:33:01.142213 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m06:33:01.142609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m06:33:01.142969 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m06:33:01.147022 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m06:33:01.149244 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.66s]
[0m06:33:01.149988 [info ] [Thread-3 (]: 3 of 9 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.66s]
[0m06:33:01.150726 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m06:33:01.151000 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m06:33:01.151462 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m06:33:01.151957 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m06:33:01.154849 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m06:33:01.155364 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m06:33:01.156438 [info ] [Thread-3 (]: 7 of 9 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m06:33:01.156974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m06:33:01.157434 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m06:33:01.155780 [info ] [Thread-1 (]: 6 of 9 START test not_null_stg_reviews_rating .................................. [RUN]
[0m06:33:01.158067 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m06:33:01.161960 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m06:33:01.162857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m06:33:01.163387 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m06:33:01.164039 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m06:33:01.164505 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m06:33:01.164741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:33:01.169141 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m06:33:01.171331 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m06:33:01.172784 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m06:33:01.175699 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m06:33:01.176582 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m06:33:01.177571 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m06:33:01.178793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:33:01.178526 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m06:33:01.180550 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m06:33:01.184378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:01.478376 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.921 seconds
[0m06:33:01.479993 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m06:33:01.578207 [info ] [Thread-4 (]: 4 of 9 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 1.09s]
[0m06:33:01.579383 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m06:33:01.580281 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m06:33:01.581267 [info ] [Thread-4 (]: 8 of 9 START test unique_stg_meta_product_id ................................... [RUN]
[0m06:33:01.581869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376)
[0m06:33:01.582317 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m06:33:01.587077 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m06:33:01.587971 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m06:33:01.590600 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m06:33:01.591542 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"
[0m06:33:01.591851 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:33:01.592138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:33:01.739650 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m06:33:01.744611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m06:33:01.749963 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m06:33:01.752112 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m06:33:01.859346 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.70s]
[0m06:33:01.860343 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m06:33:01.860876 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m06:33:01.861318 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_reviews_review_id ................................. [RUN]
[0m06:33:01.861765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m06:33:01.862085 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m06:33:01.865806 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m06:33:01.866711 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m06:33:01.868767 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m06:33:01.869698 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m06:33:01.870004 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:33:01.870293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:01.904786 [info ] [Thread-3 (]: 7 of 9 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.75s]
[0m06:33:01.907194 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m06:33:01.927130 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m06:33:01.931905 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m06:33:02.027307 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.88s]
[0m06:33:02.035295 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m06:33:02.420010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m06:33:02.423480 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m06:33:02.469344 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m06:33:02.474186 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376: Close
[0m06:33:02.515514 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_reviews_review_id ....................................... [[32mPASS[0m in 0.65s]
[0m06:33:02.516562 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m06:33:02.578696 [error] [Thread-4 (]: 8 of 9 FAIL 443 unique_stg_meta_product_id ..................................... [[31mFAIL 443[0m in 1.00s]
[0m06:33:02.582057 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376
[0m06:33:02.588735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:02.590469 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m06:33:02.592484 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m06:33:02.594732 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m06:33:02.596279 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376' was properly closed.
[0m06:33:02.598053 [info ] [MainThread]: 
[0m06:33:02.599648 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m06:33:02.602563 [debug] [MainThread]: Command end result
[0m06:33:02.704540 [info ] [MainThread]: 
[0m06:33:02.705440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:33:02.705939 [info ] [MainThread]: 
[0m06:33:02.706594 [error] [MainThread]: [31mFailure in test unique_stg_meta_product_id (models/staging/schema.yml)[0m
[0m06:33:02.707066 [error] [MainThread]:   Got 443 results, configured to fail if != 0
[0m06:33:02.707493 [info ] [MainThread]: 
[0m06:33:02.707918 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_meta_product_id.sql
[0m06:33:02.708326 [info ] [MainThread]: 
[0m06:33:02.708997 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m06:33:02.711411 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.158967, "process_user_time": 4.341701, "process_kernel_time": 0.521992, "process_mem_max_rss": "202348", "process_out_blocks": "2538", "command_success": false, "process_in_blocks": "0"}
[0m06:33:02.712324 [debug] [MainThread]: Command `dbt test` failed at 06:33:02.712230 after 4.16 seconds
[0m06:33:02.712862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0e7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8c4a30>]}
[0m06:33:02.713325 [debug] [MainThread]: Flushing usage events
[0m08:00:17.010748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893d43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8773a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8773a050>]}


============================== 08:00:17.029077 | fbd3edbf-b373-4f66-94c4-fb253aeb2baa ==============================
[0m08:00:17.029077 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:00:17.029745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:00:17.066448 [info ] [MainThread]: dbt version: 1.8.3
[0m08:00:17.067142 [info ] [MainThread]: python version: 3.10.14
[0m08:00:17.067671 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m08:00:17.068188 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m08:00:18.354068 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m08:00:18.354870 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m08:00:18.355301 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m08:00:18.355829 [info ] [MainThread]: adapter type: snowflake
[0m08:00:18.356196 [info ] [MainThread]: adapter version: 1.8.2
[0m08:00:18.457381 [info ] [MainThread]: Configuration:
[0m08:00:18.458301 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:00:18.458938 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:00:18.459506 [info ] [MainThread]: Required dependencies:
[0m08:00:18.459924 [debug] [MainThread]: Executing "git --help"
[0m08:00:18.483501 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:00:18.484081 [debug] [MainThread]: STDERR: "b''"
[0m08:00:18.484352 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:00:18.484607 [info ] [MainThread]: Connection:
[0m08:00:18.484868 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m08:00:18.485156 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m08:00:18.485434 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m08:00:18.485720 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m08:00:18.485988 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m08:00:18.486259 [info ] [MainThread]:   schema: STAGE
[0m08:00:18.486513 [info ] [MainThread]:   authenticator: jwt
[0m08:00:18.486794 [info ] [MainThread]:   oauth_client_id: None
[0m08:00:18.487117 [info ] [MainThread]:   query_tag: None
[0m08:00:18.487382 [info ] [MainThread]:   client_session_keep_alive: False
[0m08:00:18.487644 [info ] [MainThread]:   host: None
[0m08:00:18.487914 [info ] [MainThread]:   port: None
[0m08:00:18.488176 [info ] [MainThread]:   proxy_host: None
[0m08:00:18.488400 [info ] [MainThread]:   proxy_port: None
[0m08:00:18.488604 [info ] [MainThread]:   protocol: None
[0m08:00:18.488809 [info ] [MainThread]:   connect_retries: 1
[0m08:00:18.489016 [info ] [MainThread]:   connect_timeout: None
[0m08:00:18.489257 [info ] [MainThread]:   retry_on_database_errors: False
[0m08:00:18.489518 [info ] [MainThread]:   retry_all: False
[0m08:00:18.489749 [info ] [MainThread]:   insecure_mode: False
[0m08:00:18.489967 [info ] [MainThread]:   reuse_connections: None
[0m08:00:18.490361 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:00:18.674269 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m08:00:18.675661 [debug] [MainThread]: Using snowflake connection "debug"
[0m08:00:18.676225 [debug] [MainThread]: On debug: select 1 as id
[0m08:00:18.676605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:00:19.804420 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.127 seconds
[0m08:00:19.807442 [debug] [MainThread]: On debug: Close
[0m08:00:19.877818 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:00:19.878793 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:00:19.882950 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.0288591, "process_user_time": 3.129328, "process_kernel_time": 2.481102, "process_mem_max_rss": "187064", "process_in_blocks": "464", "process_out_blocks": "21"}
[0m08:00:19.886626 [debug] [MainThread]: Command `dbt debug` succeeded at 08:00:19.886216 after 3.03 seconds
[0m08:00:19.888412 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:00:19.889101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893d43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8777b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c1edb10>]}
[0m08:00:19.889709 [debug] [MainThread]: Flushing usage events
[0m08:00:22.813451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4eb43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb324a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb324a050>]}


============================== 08:00:22.817029 | d3eaacf0-2de7-4b4d-874b-5c3b90aede1b ==============================
[0m08:00:22.817029 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:00:22.817690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:00:22.925564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3eaacf0-2de7-4b4d-874b-5c3b90aede1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb33f6fe0>]}
[0m08:00:23.081092 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rsi_c8ue'
[0m08:00:23.081915 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:00:23.236767 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:00:23.243764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:00:23.565730 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:00:24.093190 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:00:24.973548 [info ] [MainThread]: Installed from version 1.1.1
[0m08:00:24.978403 [info ] [MainThread]: Updated version available: 1.3.3
[0m08:00:24.979954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd3eaacf0-2de7-4b4d-874b-5c3b90aede1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb480a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb31a3d00>]}
[0m08:00:24.982229 [info ] [MainThread]: 
[0m08:00:24.983351 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m08:00:24.991980 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.210294, "process_user_time": 1.774325, "process_kernel_time": 0.52186, "process_mem_max_rss": "94784", "process_in_blocks": "8", "process_out_blocks": "742"}
[0m08:00:24.993282 [debug] [MainThread]: Command `dbt deps` succeeded at 08:00:24.993124 after 2.21 seconds
[0m08:00:24.993994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4eb43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4861090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb480a3b0>]}
[0m08:00:24.994405 [debug] [MainThread]: Flushing usage events
[0m08:00:28.010604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b8c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f3e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f3e1a0>]}


============================== 08:00:28.014669 | 3c11f25f-455f-4f9d-9573-73cd0db5ab7e ==============================
[0m08:00:28.014669 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:00:28.015332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:00:28.769578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79926560>]}
[0m08:00:28.811368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff798fbd00>]}
[0m08:00:28.812191 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:00:28.886974 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m08:00:29.129519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:00:29.130594 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/schema.yml
[0m08:00:29.130891 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_meta.sql
[0m08:00:29.131186 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_products.sql
[0m08:00:29.380059 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m08:00:29.381023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff796f0cd0>]}
[0m08:00:29.516604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78da8c10>]}
[0m08:00:29.601499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff792cbf70>]}
[0m08:00:29.602072 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m08:00:29.602458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff792c82e0>]}
[0m08:00:29.603937 [info ] [MainThread]: 
[0m08:00:29.604512 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:00:29.608948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m08:00:29.621109 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m08:00:29.621532 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m08:00:29.621809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:30.458232 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.836 seconds
[0m08:00:30.462626 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m08:00:30.605341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m08:00:30.607080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m08:00:30.619611 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m08:00:30.623553 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m08:00:30.624316 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m08:00:30.624869 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m08:00:30.625672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:30.626184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:31.187740 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.562 seconds
[0m08:00:31.192524 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m08:00:31.475891 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.849 seconds
[0m08:00:31.480481 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m08:00:31.991697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ddfa60>]}
[0m08:00:31.993021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:31.993991 [info ] [MainThread]: 
[0m08:00:32.009016 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m08:00:32.009939 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m08:00:32.010892 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m08:00:32.011707 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m08:00:32.012475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m08:00:32.013631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m08:00:32.014221 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m08:00:32.014803 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m08:00:32.023683 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m08:00:32.036690 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m08:00:32.038738 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m08:00:32.039141 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m08:00:32.058959 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m08:00:32.061938 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m08:00:32.063641 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m08:00:32.064815 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m08:00:32.065160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:32.064569 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m08:00:32.069144 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
  
-- keep raw string

    review_time as review_time,



    -- parse date safely (force string!)

    coalesce(

      try_to_date(review_time::string, 'MM DD, YYYY'),

      try_to_date(review_time::string, 'MM D, YYYY')

    ) as review_date,



    year(

      coalesce(

        try_to_date(review_time::string, 'MM DD, YYYY'),

        try_to_date(review_time::string, 'MM D, YYYY')

      )

    ) as review_year




from source
where review_id is not null

)

select *
from renamed
  );
[0m08:00:32.069495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:00:32.661421 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m08:00:32.688908 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m08:00:32.714184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m08:00:32.717062 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m08:00:32.824589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78115ed0>]}
[0m08:00:32.825814 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m08:00:32.827116 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m08:00:32.840210 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11f25f-455f-4f9d-9573-73cd0db5ab7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78de16c0>]}
[0m08:00:32.841068 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.83s]
[0m08:00:32.841786 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m08:00:32.843805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:32.844741 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m08:00:32.845208 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m08:00:32.845754 [info ] [MainThread]: 
[0m08:00:32.846380 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m08:00:32.847507 [debug] [MainThread]: Command end result
[0m08:00:32.900138 [info ] [MainThread]: 
[0m08:00:32.900723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:32.901240 [info ] [MainThread]: 
[0m08:00:32.901752 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:00:32.905027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.925574, "process_user_time": 3.523856, "process_kernel_time": 0.593174, "process_mem_max_rss": "204380", "process_out_blocks": "3688", "process_in_blocks": "0"}
[0m08:00:32.906254 [debug] [MainThread]: Command `dbt run` succeeded at 08:00:32.906147 after 4.93 seconds
[0m08:00:32.906815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b8c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78d42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff798fbd00>]}
[0m08:00:32.907234 [debug] [MainThread]: Flushing usage events
[0m08:00:36.433227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8007c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4421a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e442140>]}


============================== 08:00:36.436701 | afd62b08-e851-4070-abe4-6cd938fccfa5 ==============================
[0m08:00:36.436701 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:00:36.437252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:00:36.941212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8009fee0>]}
[0m08:00:36.971024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed77340>]}
[0m08:00:36.971674 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:00:37.038007 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m08:00:37.193715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:37.194098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:37.224673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e7d9030>]}
[0m08:00:37.310191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e8bf130>]}
[0m08:00:37.310692 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m08:00:37.311018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e8bdf90>]}
[0m08:00:37.312872 [info ] [MainThread]: 
[0m08:00:37.313474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:00:37.317258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m08:00:37.333432 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m08:00:37.333806 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m08:00:37.334080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:37.902665 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.568 seconds
[0m08:00:37.908018 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m08:00:38.073323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m08:00:38.074840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m08:00:38.082818 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m08:00:38.086166 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m08:00:38.086879 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m08:00:38.087424 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m08:00:38.087878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:38.088337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:38.501404 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.413 seconds
[0m08:00:38.504018 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m08:00:39.060163 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.972 seconds
[0m08:00:39.064673 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m08:00:39.205382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed77850>]}
[0m08:00:39.206609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:39.207252 [info ] [MainThread]: 
[0m08:00:39.222588 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m08:00:39.223233 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m08:00:39.223655 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:00:39.224332 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m08:00:39.224964 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m08:00:39.225523 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m08:00:39.226133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m08:00:39.226590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m08:00:39.227103 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m08:00:39.227564 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m08:00:39.227957 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m08:00:39.228342 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:00:39.235237 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m08:00:39.237361 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m08:00:39.239862 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m08:00:39.242068 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m08:00:39.242395 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m08:00:39.242712 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:00:39.261638 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m08:00:39.263711 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m08:00:39.265677 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m08:00:39.267428 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m08:00:39.268015 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m08:00:39.268331 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m08:00:39.268745 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m08:00:39.269071 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m08:00:39.269376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:39.269686 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m08:00:39.269958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:00:39.270436 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:00:40.960459 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.689 seconds
[0m08:00:40.989370 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m08:00:41.159644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d34b310>]}
[0m08:00:41.161417 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 1.93s]
[0m08:00:41.162508 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:00:41.163677 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m08:00:41.164462 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m08:00:41.165262 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m08:00:41.165798 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m08:00:41.169778 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m08:00:41.172549 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m08:00:41.177139 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m08:00:41.178746 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m08:00:41.179278 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m08:00:41.179714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:00:41.601647 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.331 seconds
[0m08:00:41.607263 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m08:00:41.743672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d3a5270>]}
[0m08:00:41.745986 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.52s]
[0m08:00:41.748333 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m08:00:42.642614 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.462 seconds
[0m08:00:42.649476 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m08:00:42.854657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d3a4e50>]}
[0m08:00:42.857537 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.69s]
[0m08:00:42.859245 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m08:00:43.154107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.884 seconds
[0m08:00:43.159850 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m08:00:43.266788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e821de0>]}
[0m08:00:43.268767 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 4.04s]
[0m08:00:43.269790 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m08:00:43.271484 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:00:43.272203 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m08:00:43.272749 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m08:00:43.273505 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m08:00:43.274299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m08:00:43.274925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m08:00:43.275582 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:00:43.276158 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m08:00:43.281387 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m08:00:43.285109 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m08:00:43.287746 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m08:00:43.288215 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:00:43.291862 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m08:00:43.295159 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m08:00:43.297816 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m08:00:43.298668 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m08:00:43.300533 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m08:00:43.301716 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m08:00:43.302213 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:00:43.301124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:00:44.384580 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.082 seconds
[0m08:00:44.388873 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m08:00:44.558560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d3a9f30>]}
[0m08:00:44.561030 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.28s]
[0m08:00:44.562543 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:00:46.739079 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.440 seconds
[0m08:00:46.745063 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m08:00:46.868234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd62b08-e851-4070-abe4-6cd938fccfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d3a9450>]}
[0m08:00:46.870026 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 3.59s]
[0m08:00:46.871034 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m08:00:46.876255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:46.877010 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m08:00:46.877659 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m08:00:46.878153 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m08:00:46.878628 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m08:00:46.879706 [info ] [MainThread]: 
[0m08:00:46.881704 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m08:00:46.883558 [debug] [MainThread]: Command end result
[0m08:00:46.939604 [info ] [MainThread]: 
[0m08:00:46.940178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:46.940570 [info ] [MainThread]: 
[0m08:00:46.940950 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:00:46.943240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.5414915, "process_user_time": 3.618247, "process_kernel_time": 0.404144, "process_mem_max_rss": "200388", "process_out_blocks": "2514", "process_in_blocks": "0"}
[0m08:00:46.944025 [debug] [MainThread]: Command `dbt run` succeeded at 08:00:46.943917 after 10.54 seconds
[0m08:00:46.944472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8007c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea22110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed77340>]}
[0m08:00:46.944806 [debug] [MainThread]: Flushing usage events
[0m08:00:51.580098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac3c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8903e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8903e140>]}


============================== 08:00:51.591701 | c3eafa26-e403-4435-89fe-d4a6f6879f7b ==============================
[0m08:00:51.591701 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:00:51.592512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:00:52.240124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3eafa26-e403-4435-89fe-d4a6f6879f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9f76d0>]}
[0m08:00:52.272446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3eafa26-e403-4435-89fe-d4a6f6879f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d99b340>]}
[0m08:00:52.273277 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:00:52.345228 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m08:00:52.501498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:52.502017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:52.540081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3eafa26-e403-4435-89fe-d4a6f6879f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d3f9030>]}
[0m08:00:52.644650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3eafa26-e403-4435-89fe-d4a6f6879f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d42c820>]}
[0m08:00:52.645173 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m08:00:52.645628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3eafa26-e403-4435-89fe-d4a6f6879f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d3ce5c0>]}
[0m08:00:52.647174 [info ] [MainThread]: 
[0m08:00:52.647693 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:00:52.651088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m08:00:52.651624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m08:00:52.662472 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m08:00:52.664996 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m08:00:52.665612 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m08:00:52.666190 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m08:00:52.667121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:52.667464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:53.256058 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.588 seconds
[0m08:00:53.261214 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m08:00:53.372112 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.704 seconds
[0m08:00:53.376360 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m08:00:53.480676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3eafa26-e403-4435-89fe-d4a6f6879f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d99b850>]}
[0m08:00:53.483297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:53.484408 [info ] [MainThread]: 
[0m08:00:53.498584 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:00:53.499200 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:00:53.499755 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:00:53.500398 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:00:53.501024 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m08:00:53.501956 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m08:00:53.502896 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m08:00:53.504401 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m08:00:53.506437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m08:00:53.508056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m08:00:53.509710 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m08:00:53.510407 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m08:00:53.511283 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:00:53.512042 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:00:53.512617 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:00:53.513185 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:00:53.531351 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:00:53.540348 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m08:00:53.544275 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m08:00:53.547851 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:00:53.550069 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:00:53.550547 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:00:53.556135 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:00:53.562128 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:00:53.566011 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:00:53.568096 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m08:00:53.570550 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m08:00:53.572435 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:00:53.574894 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:00:53.575421 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m08:00:53.575858 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m08:00:53.576277 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:00:53.576786 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m08:00:53.578185 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m08:00:53.577517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:53.577857 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m08:00:53.577150 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m08:00:53.578475 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:00:53.578980 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:00:53.579372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:00:54.162779 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m08:00:54.178283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m08:00:54.182577 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m08:00:54.180380 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m08:00:54.253605 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m08:00:54.256892 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m08:00:54.259402 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.75s]
[0m08:00:54.262881 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:00:54.263716 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:00:54.264455 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m08:00:54.265164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m08:00:54.265722 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:00:54.271197 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:00:54.272856 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:00:54.277081 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:00:54.278673 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:00:54.279277 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m08:00:54.279752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:00:54.290124 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.78s]
[0m08:00:54.292577 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:00:54.294283 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:00:54.294852 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m08:00:54.295467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m08:00:54.299137 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:00:54.304783 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:00:54.306720 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:00:54.310135 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:00:54.311282 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:00:54.311712 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m08:00:54.312118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:54.370484 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.86s]
[0m08:00:54.375248 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:00:54.375704 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:00:54.376076 [info ] [Thread-2 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m08:00:54.377233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m08:00:54.378651 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:00:54.381987 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:00:54.383047 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:00:54.385340 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:00:54.386272 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:00:54.386601 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m08:00:54.387777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:00:54.572538 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m08:00:54.574619 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m08:00:55.031509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m08:00:55.036006 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m08:00:55.077491 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 1.57s]
[0m08:00:55.078736 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:00:55.079450 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:00:55.080149 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m08:00:55.080836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m08:00:55.081405 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:00:55.090030 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:00:55.091613 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:00:55.094905 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:00:55.096227 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:00:55.096727 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:00:55.097179 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:00:55.176762 [info ] [Thread-2 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.80s]
[0m08:00:55.177645 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:00:55.192635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m08:00:55.194458 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m08:00:55.211238 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m08:00:55.212749 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m08:00:55.335072 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 1.04s]
[0m08:00:55.335990 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:00:55.374915 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 1.11s]
[0m08:00:55.376198 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:00:55.620437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m08:00:55.623248 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m08:00:55.738685 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_reviews_review_id ....................................... [[32mPASS[0m in 0.66s]
[0m08:00:55.739912 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:00:55.741932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:55.744840 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m08:00:55.745388 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m08:00:55.745880 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m08:00:55.746335 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m08:00:55.746849 [info ] [MainThread]: 
[0m08:00:55.747470 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m08:00:55.749154 [debug] [MainThread]: Command end result
[0m08:00:55.798799 [info ] [MainThread]: 
[0m08:00:55.799367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:55.799803 [info ] [MainThread]: 
[0m08:00:55.800260 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:00:55.801642 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2610936, "process_user_time": 3.864514, "process_kernel_time": 0.360999, "process_mem_max_rss": "201996", "process_out_blocks": "2519", "process_in_blocks": "0"}
[0m08:00:55.802396 [debug] [MainThread]: Command `dbt test` succeeded at 08:00:55.802278 after 4.26 seconds
[0m08:00:55.802891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9f76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e44580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c62bfa0>]}
[0m08:00:55.803323 [debug] [MainThread]: Flushing usage events
[0m08:00:59.074602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb56230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb561d0>]}


============================== 08:00:59.079148 | 83abd4ff-71c3-4278-9d1a-b9c5790d245c ==============================
[0m08:00:59.079148 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:00:59.079677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:00:59.633954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83abd4ff-71c3-4278-9d1a-b9c5790d245c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcc0580>]}
[0m08:00:59.667369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83abd4ff-71c3-4278-9d1a-b9c5790d245c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802d76a0>]}
[0m08:00:59.668224 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m08:00:59.745436 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m08:00:59.925764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:59.926183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:59.958411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83abd4ff-71c3-4278-9d1a-b9c5790d245c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bea10c0>]}
[0m08:00:59.969411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83abd4ff-71c3-4278-9d1a-b9c5790d245c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bea2860>]}
[0m08:00:59.969880 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m08:00:59.970283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83abd4ff-71c3-4278-9d1a-b9c5790d245c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801dfa90>]}
[0m08:00:59.971694 [info ] [MainThread]: 
[0m08:00:59.972562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:00:59.977141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m08:00:59.977705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m08:00:59.994290 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m08:00:59.996492 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m08:00:59.996852 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m08:00:59.997202 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m08:00:59.997486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:59.997784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:00.504887 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.507 seconds
[0m08:01:00.573437 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m08:01:00.747478 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.750 seconds
[0m08:01:00.749594 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m08:01:00.836872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83abd4ff-71c3-4278-9d1a-b9c5790d245c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804ab4c0>]}
[0m08:01:00.838476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:01:00.839247 [info ] [MainThread]: 
[0m08:01:00.852899 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m08:01:00.853532 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m08:01:00.854411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m08:01:00.855147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m08:01:00.855782 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m08:01:00.856449 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m08:01:00.867744 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m08:01:00.881457 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m08:01:00.882794 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m08:01:00.883619 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m08:01:00.884080 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m08:01:00.884921 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m08:01:00.885317 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m08:01:00.885735 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:01:00.887727 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m08:01:00.886860 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_products'
[0m08:01:00.887187 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:01:00.888884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m08:01:00.888100 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:01:00.888475 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m08:01:00.886449 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m08:01:00.889233 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:01:00.899150 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m08:01:00.901850 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m08:01:00.902378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.fct_reviews)
[0m08:01:00.904589 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m08:01:00.905644 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m08:01:00.905982 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:01:00.906499 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m08:01:00.910223 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m08:01:00.909254 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:01:00.909729 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m08:01:00.908782 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m08:01:00.910535 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:01:00.911051 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m08:01:00.911411 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:01:00.911922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m08:01:00.912291 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:01:00.912706 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m08:01:00.914835 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m08:01:00.914049 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:01:00.914397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m08:01:00.913719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m08:01:00.915150 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:01:00.921509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m08:01:00.920777 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:01:00.921150 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:01:00.920211 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m08:01:00.921780 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:01:00.924518 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m08:01:00.927047 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m08:01:00.929783 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m08:01:00.930340 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:01:00.931017 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:01:00.931584 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m08:01:00.931804 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:01:00.932297 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m08:01:00.932492 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:01:00.932844 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:01:00.934522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m08:01:00.933715 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m08:01:00.934221 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m08:01:00.933363 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m08:01:00.934801 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:01:00.935159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now model.capstone_amazon_analytics.dim_date)
[0m08:01:00.935570 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:01:00.936068 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m08:01:00.941283 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m08:01:00.941935 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m08:01:00.942475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m08:01:00.942955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.mart_product_kpi)
[0m08:01:00.946900 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m08:01:00.947485 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:01:00.947775 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:01:00.948060 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m08:01:00.950414 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m08:01:00.951058 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m08:01:00.951295 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m08:01:00.953456 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m08:01:00.954406 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:01:00.954891 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m08:01:00.956109 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m08:01:00.956570 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m08:01:00.957039 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:01:00.957455 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m08:01:00.957702 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:01:00.958135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m08:01:00.958622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_date, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001)
[0m08:01:00.958949 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:01:00.959270 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:01:00.962197 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m08:01:00.964761 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m08:01:00.965578 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:01:00.966251 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m08:01:00.966590 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:01:00.967290 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m08:01:00.968636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:00.968956 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001' was properly closed.
[0m08:01:00.969216 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m08:01:00.969451 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d' was properly closed.
[0m08:01:00.969672 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m08:01:00.971010 [debug] [MainThread]: Command end result
[0m08:01:01.107366 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m08:01:01.107778 [info ] [MainThread]: Building catalog
[0m08:01:01.114894 [debug] [ThreadPool]: Acquiring new snowflake connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema'
[0m08:01:01.125494 [debug] [ThreadPool]: Using snowflake connection "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"
[0m08:01:01.126069 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m08:01:01.126549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:06.412454 [debug] [ThreadPool]: SQL status: SUCCESS 57 in 5.284 seconds
[0m08:01:06.453478 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: Close
[0m08:01:06.727016 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m08:01:06.736996 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.694107, "process_user_time": 3.252907, "process_kernel_time": 0.443809, "process_mem_max_rss": "198364", "process_out_blocks": "5538", "process_in_blocks": "0"}
[0m08:01:06.738709 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:01:06.738573 after 7.70 seconds
[0m08:01:06.739459 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:01:06.739800 [debug] [MainThread]: Connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema' was properly closed.
[0m08:01:06.740405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcc0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c99d300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8053dff0>]}
[0m08:01:06.740995 [debug] [MainThread]: Flushing usage events
[0m09:23:22.135658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab54e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab54e050>]}


============================== 09:23:22.148609 | 6772f0ca-f43b-4e3c-a24b-ceae835f17f4 ==============================
[0m09:23:22.148609 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:23:22.149204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:23:22.163370 [info ] [MainThread]: dbt version: 1.8.3
[0m09:23:22.163835 [info ] [MainThread]: python version: 3.10.14
[0m09:23:22.164139 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:23:22.164418 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m09:23:23.235466 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m09:23:23.236221 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m09:23:23.236523 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m09:23:23.236905 [info ] [MainThread]: adapter type: snowflake
[0m09:23:23.237142 [info ] [MainThread]: adapter version: 1.8.2
[0m09:23:23.296976 [info ] [MainThread]: Configuration:
[0m09:23:23.297476 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:23:23.297834 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:23:23.298166 [info ] [MainThread]: Required dependencies:
[0m09:23:23.298479 [debug] [MainThread]: Executing "git --help"
[0m09:23:23.327721 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:23:23.328257 [debug] [MainThread]: STDERR: "b''"
[0m09:23:23.328562 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:23:23.328892 [info ] [MainThread]: Connection:
[0m09:23:23.329207 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:23:23.329493 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:23:23.329751 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:23:23.330066 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:23:23.330343 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:23:23.330595 [info ] [MainThread]:   schema: STAGE
[0m09:23:23.330844 [info ] [MainThread]:   authenticator: jwt
[0m09:23:23.331125 [info ] [MainThread]:   oauth_client_id: None
[0m09:23:23.331403 [info ] [MainThread]:   query_tag: None
[0m09:23:23.331813 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:23:23.332121 [info ] [MainThread]:   host: None
[0m09:23:23.332379 [info ] [MainThread]:   port: None
[0m09:23:23.332634 [info ] [MainThread]:   proxy_host: None
[0m09:23:23.332861 [info ] [MainThread]:   proxy_port: None
[0m09:23:23.333103 [info ] [MainThread]:   protocol: None
[0m09:23:23.333364 [info ] [MainThread]:   connect_retries: 1
[0m09:23:23.333597 [info ] [MainThread]:   connect_timeout: None
[0m09:23:23.333820 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:23:23.334062 [info ] [MainThread]:   retry_all: False
[0m09:23:23.334288 [info ] [MainThread]:   insecure_mode: False
[0m09:23:23.334494 [info ] [MainThread]:   reuse_connections: None
[0m09:23:23.334895 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:23:23.402620 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:23:23.403284 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:23:23.403549 [debug] [MainThread]: On debug: select 1 as id
[0m09:23:23.403764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:24.106972 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.703 seconds
[0m09:23:24.109578 [debug] [MainThread]: On debug: Close
[0m09:23:24.301883 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:23:24.302729 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:23:24.305300 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2055304, "process_user_time": 2.61014, "process_kernel_time": 2.056782, "process_mem_max_rss": "182808", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m09:23:24.306074 [debug] [MainThread]: Command `dbt debug` succeeded at 09:23:24.305957 after 2.21 seconds
[0m09:23:24.306640 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:23:24.307367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90411fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc6d3c0>]}
[0m09:23:24.308088 [debug] [MainThread]: Flushing usage events
[0m09:23:27.168809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81503a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6536080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6536020>]}


============================== 09:23:27.174365 | 385a6d96-e9c3-44e2-bb0a-f75c56b2f760 ==============================
[0m09:23:27.174365 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:23:27.174946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:23:27.282625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '385a6d96-e9c3-44e2-bb0a-f75c56b2f760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa817fe80>]}
[0m09:23:27.388486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7y19blzv'
[0m09:23:27.388989 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:23:27.566498 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:23:27.568233 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:23:27.677820 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:23:27.754310 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:23:33.022990 [info ] [MainThread]: Installed from version 1.1.1
[0m09:23:33.031304 [info ] [MainThread]: Updated version available: 1.3.3
[0m09:23:33.039469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '385a6d96-e9c3-44e2-bb0a-f75c56b2f760', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7aa0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa648fd00>]}
[0m09:23:33.046345 [info ] [MainThread]: 
[0m09:23:33.047563 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:23:33.064386 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.927834, "process_user_time": 2.876689, "process_kernel_time": 1.421735, "process_mem_max_rss": "95040", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m09:23:33.066719 [debug] [MainThread]: Command `dbt deps` succeeded at 09:23:33.066514 after 5.93 seconds
[0m09:23:33.069592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81503a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7abcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7aa0a30>]}
[0m09:23:33.070138 [debug] [MainThread]: Flushing usage events
[0m09:23:36.308971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f54370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5356170>]}


============================== 09:23:36.313410 | 001243e7-3ebc-41af-8bd2-59fea273d1e0 ==============================
[0m09:23:36.313410 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:23:36.313914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:23:37.026835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5687760>]}
[0m09:23:37.062088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cd8ca0>]}
[0m09:23:37.062828 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:23:37.153149 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:23:37.331869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:37.332550 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m09:23:37.489861 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:23:37.491424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89732410>]}
[0m09:23:37.777837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89454100>]}
[0m09:23:37.916656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897f8b50>]}
[0m09:23:37.917381 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:23:37.917885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897fb730>]}
[0m09:23:37.921079 [info ] [MainThread]: 
[0m09:23:37.922725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:23:37.930773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:23:37.949857 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:23:37.950382 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:23:37.950769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:38.577199 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.626 seconds
[0m09:23:38.586696 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:23:38.656142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:23:38.657185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:23:38.671077 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:23:38.674660 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:23:38.675342 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:23:38.675687 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:23:38.676254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:38.676589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:39.147344 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.470 seconds
[0m09:23:39.153429 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:23:39.167657 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.491 seconds
[0m09:23:39.170007 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:23:39.275026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cafd60>]}
[0m09:23:39.276499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:23:39.277282 [info ] [MainThread]: 
[0m09:23:39.301501 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:23:39.302079 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:23:39.303052 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:23:39.303871 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:23:39.304613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m09:23:39.305653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m09:23:39.306163 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:23:39.306632 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:23:39.316733 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:23:39.321781 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:23:39.323816 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:23:39.324163 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:23:39.347392 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:23:39.349769 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:23:39.351682 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:23:39.352614 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
-- where review_id is not null

)

select *
from renamed
  );
[0m09:23:39.353016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:39.352355 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:23:39.353482 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m09:23:39.356871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:39.942666 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m09:23:39.979694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m09:23:39.992652 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:23:39.996461 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:23:40.070562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8889fa30>]}
[0m09:23:40.071455 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m09:23:40.072580 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:23:40.097976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001243e7-3ebc-41af-8bd2-59fea273d1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8941e440>]}
[0m09:23:40.098648 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m09:23:40.099224 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:23:40.100859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:40.101361 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m09:23:40.101662 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m09:23:40.102106 [info ] [MainThread]: 
[0m09:23:40.102587 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m09:23:40.103440 [debug] [MainThread]: Command end result
[0m09:23:40.143530 [info ] [MainThread]: 
[0m09:23:40.143955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:23:40.144311 [info ] [MainThread]: 
[0m09:23:40.144664 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:23:40.146437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8681438, "process_user_time": 3.582699, "process_kernel_time": 0.698789, "process_mem_max_rss": "200068", "process_out_blocks": "3685", "process_in_blocks": "0"}
[0m09:23:40.147133 [debug] [MainThread]: Command `dbt run` succeeded at 09:23:40.147061 after 3.87 seconds
[0m09:23:40.147537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f54370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5939d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5687760>]}
[0m09:23:40.147836 [debug] [MainThread]: Flushing usage events
[0m09:23:43.422157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f54250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13560b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1356050>]}


============================== 09:23:43.426250 | 2ccdd73c-2bdb-4707-8bc2-1080fe19081a ==============================
[0m09:23:43.426250 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:23:43.426851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m09:23:43.981699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14f94e0>]}
[0m09:23:44.011663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d0c0d0>]}
[0m09:23:44.012338 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:23:44.083082 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:23:44.223249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:23:44.223653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:23:44.253444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85710f40>]}
[0m09:23:44.329078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857f77c0>]}
[0m09:23:44.329596 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:23:44.329928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857f67d0>]}
[0m09:23:44.331208 [info ] [MainThread]: 
[0m09:23:44.331733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:23:44.335791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:23:44.345405 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:23:44.345807 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:23:44.346114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:44.773229 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.427 seconds
[0m09:23:44.775528 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:23:44.857848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:23:44.861526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:23:44.875506 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:23:44.879375 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:23:44.880104 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:23:44.880600 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:23:44.881074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:44.881509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:45.355473 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.474 seconds
[0m09:23:45.359858 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:23:45.380495 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.499 seconds
[0m09:23:45.382708 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:23:45.453428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85caf970>]}
[0m09:23:45.455044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:23:45.456036 [info ] [MainThread]: 
[0m09:23:45.470652 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:23:45.471416 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:23:45.471842 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:23:45.472616 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:23:45.473259 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:23:45.473861 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m09:23:45.474848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m09:23:45.475324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m09:23:45.475849 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m09:23:45.476282 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:23:45.476706 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:23:45.477122 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:23:45.484998 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:23:45.487580 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:23:45.489822 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:23:45.491453 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:23:45.491884 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:23:45.499348 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:23:45.514129 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:23:45.516498 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:23:45.518437 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:23:45.520108 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:23:45.520700 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:23:45.520978 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m09:23:45.521408 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:23:45.521768 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m09:23:45.522082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:45.522458 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m09:23:45.522782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:45.526956 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:23:48.607480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.086 seconds
[0m09:23:48.604119 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.078 seconds
[0m09:23:48.737663 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.212 seconds
[0m09:23:48.802304 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:23:48.803815 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:23:48.805348 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m09:23:48.917551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f57d30>]}
[0m09:23:48.919123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b4f3d0>]}
[0m09:23:48.925089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85cae440>]}
[0m09:23:48.929304 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 3.44s]
[0m09:23:48.931142 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.44s]
[0m09:23:48.933409 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 3.45s]
[0m09:23:48.936014 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:23:48.939551 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:23:48.943090 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:23:48.949318 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m09:23:48.950354 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:23:48.950666 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:23:48.951341 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m09:23:48.953770 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m09:23:48.955489 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m09:23:48.957025 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m09:23:48.957838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m09:23:48.958286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m09:23:48.958771 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m09:23:48.959163 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:23:48.959531 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m09:23:48.968347 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m09:23:48.973262 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:23:48.976517 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:23:48.979939 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:23:48.980461 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m09:23:48.984650 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:23:48.985735 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m09:23:48.996567 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m09:23:49.009219 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:23:49.011397 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:23:49.014690 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m09:23:49.016674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:23:49.019231 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m09:23:49.022748 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:23:49.024296 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
cast(review_time as date) as date_day
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m09:23:49.029728 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m09:23:49.033296 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:23:49.035029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:50.247144 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c261d3-0306-19bc-0004-85da0005f13e
[0m09:23:50.248114 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 100040 (22007): Date '02 19, 2016' is not recognized
[0m09:23:50.249230 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m09:23:50.331990 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  100040 (22007): Date '02 19, 2016' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m09:23:50.333857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b4faf0>]}
[0m09:23:50.335555 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 1.38s]
[0m09:23:50.337505 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m09:23:50.537968 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.521 seconds
[0m09:23:50.544699 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m09:23:50.657539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b0a500>]}
[0m09:23:50.659572 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.70s]
[0m09:23:50.660566 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:23:50.942750 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.908 seconds
[0m09:23:50.950103 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m09:23:51.034069 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccdd73c-2bdb-4707-8bc2-1080fe19081a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b630d0>]}
[0m09:23:51.036192 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.07s]
[0m09:23:51.037947 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:23:51.042232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:51.043015 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m09:23:51.043541 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m09:23:51.044007 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m09:23:51.044485 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m09:23:51.045431 [info ] [MainThread]: 
[0m09:23:51.046094 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m09:23:51.047860 [debug] [MainThread]: Command end result
[0m09:23:51.107973 [info ] [MainThread]: 
[0m09:23:51.108683 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:51.109187 [info ] [MainThread]: 
[0m09:23:51.109698 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  100040 (22007): Date '02 19, 2016' is not recognized
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m09:23:51.110060 [info ] [MainThread]: 
[0m09:23:51.110518 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:23:51.113224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.725423, "process_user_time": 4.467426, "process_kernel_time": 0.476498, "process_mem_max_rss": "197296", "process_out_blocks": "2515", "command_success": false, "process_in_blocks": "0"}
[0m09:23:51.113990 [debug] [MainThread]: Command `dbt run` failed at 09:23:51.113922 after 7.73 seconds
[0m09:23:51.114491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa217e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d0c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b0b9a0>]}
[0m09:23:51.114820 [debug] [MainThread]: Flushing usage events
[0m09:31:25.952355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa038c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7360b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e736050>]}


============================== 09:31:25.957060 | b27fde18-5170-4549-910a-7eeed2376c98 ==============================
[0m09:31:25.957060 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:31:25.957658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:31:25.966830 [info ] [MainThread]: dbt version: 1.8.3
[0m09:31:25.967278 [info ] [MainThread]: python version: 3.10.14
[0m09:31:25.967558 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:31:25.967847 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m09:31:26.764199 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m09:31:26.764913 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m09:31:26.765508 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m09:31:26.766342 [info ] [MainThread]: adapter type: snowflake
[0m09:31:26.766618 [info ] [MainThread]: adapter version: 1.8.2
[0m09:31:26.821719 [info ] [MainThread]: Configuration:
[0m09:31:26.822226 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:31:26.822603 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:31:26.822962 [info ] [MainThread]: Required dependencies:
[0m09:31:26.823306 [debug] [MainThread]: Executing "git --help"
[0m09:31:26.839629 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:31:26.840156 [debug] [MainThread]: STDERR: "b''"
[0m09:31:26.840451 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:31:26.840723 [info ] [MainThread]: Connection:
[0m09:31:26.841047 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:31:26.841373 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:31:26.841660 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:31:26.841960 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:31:26.842227 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:31:26.842472 [info ] [MainThread]:   schema: STAGE
[0m09:31:26.842745 [info ] [MainThread]:   authenticator: jwt
[0m09:31:26.843060 [info ] [MainThread]:   oauth_client_id: None
[0m09:31:26.843336 [info ] [MainThread]:   query_tag: None
[0m09:31:26.843590 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:31:26.843819 [info ] [MainThread]:   host: None
[0m09:31:26.844037 [info ] [MainThread]:   port: None
[0m09:31:26.844281 [info ] [MainThread]:   proxy_host: None
[0m09:31:26.844554 [info ] [MainThread]:   proxy_port: None
[0m09:31:26.844803 [info ] [MainThread]:   protocol: None
[0m09:31:26.845045 [info ] [MainThread]:   connect_retries: 1
[0m09:31:26.845282 [info ] [MainThread]:   connect_timeout: None
[0m09:31:26.845504 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:31:26.845735 [info ] [MainThread]:   retry_all: False
[0m09:31:26.845939 [info ] [MainThread]:   insecure_mode: False
[0m09:31:26.846154 [info ] [MainThread]:   reuse_connections: None
[0m09:31:26.846497 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:31:26.906047 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:31:26.906642 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:31:26.906980 [debug] [MainThread]: On debug: select 1 as id
[0m09:31:26.907295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:27.554055 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.647 seconds
[0m09:31:27.555690 [debug] [MainThread]: On debug: Close
[0m09:31:27.628581 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:31:27.630175 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:31:27.632462 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7118483, "process_user_time": 2.393896, "process_kernel_time": 0.974399, "process_mem_max_rss": "182956", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m09:31:27.633351 [debug] [MainThread]: Command `dbt debug` succeeded at 09:31:27.633238 after 1.71 seconds
[0m09:31:27.633863 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:31:27.634404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa038c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5edfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1393c0>]}
[0m09:31:27.634993 [debug] [MainThread]: Flushing usage events
[0m09:31:30.610341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8043a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c0a080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c0a020>]}


============================== 09:31:30.614608 | 7a534f73-4602-42c2-b575-b9180b72576d ==============================
[0m09:31:30.614608 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:31:30.615166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:31:30.701257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a534f73-4602-42c2-b575-b9180b72576d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a833e80>]}
[0m09:31:30.786889 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xzf8blpj'
[0m09:31:30.787356 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:31:30.924169 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:31:30.925707 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:31:31.010216 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:31:31.016048 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:31:31.460238 [info ] [MainThread]: Installed from version 1.1.1
[0m09:31:31.461317 [info ] [MainThread]: Updated version available: 1.3.3
[0m09:31:31.462099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7a534f73-4602-42c2-b575-b9180b72576d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a158a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b63d00>]}
[0m09:31:31.462579 [info ] [MainThread]: 
[0m09:31:31.462951 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:31:31.464326 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.885264, "process_user_time": 1.137336, "process_kernel_time": 0.25595, "process_mem_max_rss": "95064", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m09:31:31.464867 [debug] [MainThread]: Command `dbt deps` succeeded at 09:31:31.464768 after 0.89 seconds
[0m09:31:31.465263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8043a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a170ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a158a30>]}
[0m09:31:31.465661 [debug] [MainThread]: Flushing usage events
[0m09:31:35.078808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91216200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912161a0>]}


============================== 09:31:35.083334 | 7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59 ==============================
[0m09:31:35.083334 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:31:35.083812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m09:31:36.035126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ba2560>]}
[0m09:31:36.073537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b78cd0>]}
[0m09:31:36.074230 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:31:36.154675 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:31:36.357497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:31:36.358423 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m09:31:36.358734 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_date.sql
[0m09:31:36.539063 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:31:36.539711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff755c6e30>]}
[0m09:31:36.690579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74db0130>]}
[0m09:31:36.775807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff756906a0>]}
[0m09:31:36.776236 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:31:36.776557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75691f60>]}
[0m09:31:36.777782 [info ] [MainThread]: 
[0m09:31:36.778298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:31:36.781749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:31:36.796597 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:31:36.797099 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:31:36.797484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:37.244356 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.446 seconds
[0m09:31:37.246727 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:31:37.332718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:31:37.333812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:31:37.348370 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:31:37.350775 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:31:37.351205 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:31:37.351573 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:31:37.351914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:37.352254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:37.895271 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.543 seconds
[0m09:31:37.901053 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:31:38.002862 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.650 seconds
[0m09:31:38.011293 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:31:38.115901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d2b6a0>]}
[0m09:31:38.117915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:31:38.118763 [info ] [MainThread]: 
[0m09:31:38.138643 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:31:38.139570 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:31:38.140409 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:31:38.141049 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:31:38.141953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m09:31:38.143086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m09:31:38.143731 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:31:38.144324 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:31:38.154608 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:31:38.160089 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:31:38.161921 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:31:38.162325 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:31:38.186267 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:31:38.188752 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:31:38.190803 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:31:38.191861 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
 where review_id is not null

)

select *
from renamed
  );
[0m09:31:38.192305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:38.191568 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:31:38.192904 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m09:31:38.195217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:38.917869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m09:31:38.921624 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m09:31:39.003738 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:31:39.006535 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:31:39.088574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d923e0>]}
[0m09:31:39.090204 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m09:31:39.090917 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:31:39.093546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cd40-3a94-40f2-b6d9-70ace7cc5d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d80040>]}
[0m09:31:39.094331 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m09:31:39.094898 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:31:39.096379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:39.096756 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m09:31:39.097047 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m09:31:39.097414 [info ] [MainThread]: 
[0m09:31:39.097783 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m09:31:39.098484 [debug] [MainThread]: Command end result
[0m09:31:39.142499 [info ] [MainThread]: 
[0m09:31:39.142918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:31:39.143227 [info ] [MainThread]: 
[0m09:31:39.143559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:31:39.144952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.094321, "process_user_time": 3.258978, "process_kernel_time": 0.970694, "process_mem_max_rss": "200528", "process_out_blocks": "3687", "process_in_blocks": "0"}
[0m09:31:39.145486 [debug] [MainThread]: Command `dbt run` succeeded at 09:31:39.145415 after 4.09 seconds
[0m09:31:39.145801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91726590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b78cd0>]}
[0m09:31:39.146062 [debug] [MainThread]: Flushing usage events
[0m09:31:42.019670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a95a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a95a0e0>]}


============================== 09:31:42.023265 | cbe7fe12-62e2-4521-8b9e-6b242bac9257 ==============================
[0m09:31:42.023265 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:31:42.023982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:31:42.572193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b2e8520>]}
[0m09:31:42.621569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b2e91e0>]}
[0m09:31:42.625693 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:31:42.807826 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:31:42.994765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:42.995244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:43.028161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6acf0fd0>]}
[0m09:31:43.111671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6add98a0>]}
[0m09:31:43.112216 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:31:43.112719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6addb190>]}
[0m09:31:43.114790 [info ] [MainThread]: 
[0m09:31:43.115435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:31:43.118917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:31:43.131847 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:31:43.132248 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:31:43.132495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:43.554510 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.422 seconds
[0m09:31:43.558814 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:31:43.677769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:31:43.678944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:31:43.690454 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:31:43.695567 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:31:43.696767 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:31:43.697617 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:31:43.698277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:43.698850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:44.152400 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.453 seconds
[0m09:31:44.157565 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:31:44.200052 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.502 seconds
[0m09:31:44.202327 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:31:44.272087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b28fa30>]}
[0m09:31:44.273526 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:31:44.274389 [info ] [MainThread]: 
[0m09:31:44.287916 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:31:44.288887 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:31:44.289380 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:31:44.290274 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:31:44.291223 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:31:44.292267 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m09:31:44.293054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m09:31:44.293757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m09:31:44.294469 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m09:31:44.295042 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:31:44.295661 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:31:44.296224 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:31:44.306424 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:31:44.310047 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:31:44.313562 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:31:44.315314 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:31:44.322712 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:31:44.341568 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:31:44.342038 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:31:44.344371 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:31:44.346926 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:31:44.347874 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:31:44.349042 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:31:44.349373 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m09:31:44.350005 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m09:31:44.350727 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:31:44.351135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:44.351497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:44.351873 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m09:31:44.352585 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:31:46.908047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.557 seconds
[0m09:31:46.940694 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:31:46.945799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.596 seconds
[0m09:31:46.948852 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:31:47.020217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a163640>]}
[0m09:31:47.021585 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.72s]
[0m09:31:47.023143 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:31:47.054296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b28fa30>]}
[0m09:31:47.055401 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.76s]
[0m09:31:47.056374 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:31:47.092769 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.741 seconds
[0m09:31:47.095888 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m09:31:47.216632 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a163a30>]}
[0m09:31:47.218848 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.92s]
[0m09:31:47.220832 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:31:47.222983 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m09:31:47.223607 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:31:47.225766 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m09:31:47.225024 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m09:31:47.224085 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:31:47.228297 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m09:31:47.227550 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m09:31:47.226593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m09:31:47.230148 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:31:47.229593 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m09:31:47.228931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m09:31:47.246388 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m09:31:47.245362 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m09:31:47.236558 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:31:47.251247 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:31:47.254117 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:31:47.254633 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m09:31:47.259539 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:31:47.260274 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m09:31:47.264103 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m09:31:47.270012 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:31:47.272412 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:31:47.274276 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m09:31:47.273816 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m09:31:47.275160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:47.276430 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:31:47.276872 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day


    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day


from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m09:31:47.277753 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m09:31:47.283576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:47.282317 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:31:48.645207 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m09:31:48.651177 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m09:31:48.739179 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a1f9660>]}
[0m09:31:48.741693 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.51s]
[0m09:31:48.743062 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m09:31:48.804287 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.529 seconds
[0m09:31:48.808557 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m09:31:48.921871 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a180190>]}
[0m09:31:48.923802 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.69s]
[0m09:31:48.925130 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:31:49.361234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.077 seconds
[0m09:31:49.367277 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m09:31:49.483669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe7fe12-62e2-4521-8b9e-6b242bac9257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a1f7f40>]}
[0m09:31:49.484998 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.25s]
[0m09:31:49.485962 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:31:49.488894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:49.489664 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m09:31:49.490503 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m09:31:49.491236 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m09:31:49.492213 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m09:31:49.494192 [info ] [MainThread]: 
[0m09:31:49.494825 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m09:31:49.496508 [debug] [MainThread]: Command end result
[0m09:31:49.564857 [info ] [MainThread]: 
[0m09:31:49.565678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:31:49.566099 [info ] [MainThread]: 
[0m09:31:49.566515 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:31:49.569007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5795054, "process_user_time": 3.78165, "process_kernel_time": 0.386007, "process_mem_max_rss": "196596", "process_out_blocks": "2518", "process_in_blocks": "0"}
[0m09:31:49.570102 [debug] [MainThread]: Command `dbt run` succeeded at 09:31:49.570021 after 7.58 seconds
[0m09:31:49.570567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af3b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b2e91e0>]}
[0m09:31:49.570924 [debug] [MainThread]: Flushing usage events
[0m09:31:53.353500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba6043d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a0e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a0e140>]}


============================== 09:31:53.357361 | f41149c8-3960-4b47-a9c0-2ef96f26028d ==============================
[0m09:31:53.357361 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:31:53.357988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m09:31:53.896149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f41149c8-3960-4b47-a9c0-2ef96f26028d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d43580>]}
[0m09:31:53.928051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f41149c8-3960-4b47-a9c0-2ef96f26028d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d383d30>]}
[0m09:31:53.928810 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:31:53.996888 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:31:54.143564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:54.144004 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:54.174047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f41149c8-3960-4b47-a9c0-2ef96f26028d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cda9060>]}
[0m09:31:54.265621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f41149c8-3960-4b47-a9c0-2ef96f26028d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdb4550>]}
[0m09:31:54.266161 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:31:54.266512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41149c8-3960-4b47-a9c0-2ef96f26028d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd82830>]}
[0m09:31:54.267842 [info ] [MainThread]: 
[0m09:31:54.268404 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:31:54.271666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:31:54.272195 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:31:54.282887 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:31:54.284579 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:31:54.284910 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:31:54.285275 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:31:54.285569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:54.285879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:54.790339 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.504 seconds
[0m09:31:54.795085 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:31:54.903772 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.618 seconds
[0m09:31:54.910273 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:31:55.018179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41149c8-3960-4b47-a9c0-2ef96f26028d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdb7220>]}
[0m09:31:55.019642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:31:55.020464 [info ] [MainThread]: 
[0m09:31:55.032342 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:31:55.032920 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:31:55.033486 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:31:55.034035 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:31:55.034545 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m09:31:55.035283 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m09:31:55.035842 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m09:31:55.036414 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m09:31:55.037060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m09:31:55.037720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m09:31:55.038445 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m09:31:55.039166 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m09:31:55.039736 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:31:55.040435 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:31:55.041093 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:31:55.041685 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:31:55.059316 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:31:55.068221 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:31:55.072611 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:31:55.076431 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:31:55.078359 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:31:55.094372 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:31:55.095268 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:31:55.095548 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:31:55.095926 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:31:55.097977 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:31:55.100554 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:31:55.101174 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:31:55.103037 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:31:55.103983 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m09:31:55.104451 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:31:55.105187 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:31:55.105429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:55.106014 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:31:55.106234 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m09:31:55.106550 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m09:31:55.107097 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m09:31:55.107476 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:31:55.109206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.117203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:31:55.642136 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m09:31:55.659912 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m09:31:55.762408 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m09:31:55.765708 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m09:31:55.795116 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.76s]
[0m09:31:55.796902 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:31:55.797892 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:31:55.798797 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m09:31:55.799523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m09:31:55.800137 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:31:55.806143 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:31:55.807727 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:31:55.811404 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:31:55.813240 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:31:55.814317 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m09:31:55.814859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:55.865591 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.83s]
[0m09:31:55.867142 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:31:55.868257 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:31:55.870123 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m09:31:55.870567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m09:31:55.870872 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:31:55.874050 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:31:55.878357 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:31:55.881145 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:31:55.881982 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:31:55.882252 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m09:31:55.882554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:56.014169 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m09:31:56.016242 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m09:31:56.110091 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 1.07s]
[0m09:31:56.111389 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:31:56.111979 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:31:56.112514 [info ] [Thread-4 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m09:31:56.113035 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m09:31:56.113474 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:31:56.117765 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:31:56.118853 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:31:56.121189 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:31:56.122241 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:31:56.122609 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m09:31:56.122961 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:56.572158 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m09:31:56.576830 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m09:31:56.614785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.509 seconds
[0m09:31:56.617253 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m09:31:56.672180 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.87s]
[0m09:31:56.673530 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:31:56.674402 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:31:56.675218 [info ] [Thread-2 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m09:31:56.675980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m09:31:56.676698 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:31:56.684680 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:31:56.686207 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:31:56.690378 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:31:56.692225 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:31:56.692755 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:31:56.693225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:56.699117 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 1.66s]
[0m09:31:56.701473 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:31:56.744912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m09:31:56.747172 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m09:31:56.842504 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.97s]
[0m09:31:56.843273 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:31:56.911344 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m09:31:56.913274 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m09:31:56.982748 [info ] [Thread-4 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 0.87s]
[0m09:31:56.983771 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:31:57.656635 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.963 seconds
[0m09:31:57.661694 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m09:31:57.787118 [error] [Thread-2 (]: 8 of 8 FAIL 7812 unique_stg_reviews_review_id .................................. [[31mFAIL 7812[0m in 1.11s]
[0m09:31:57.789230 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:31:57.792382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:57.793136 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06' was properly closed.
[0m09:31:57.793615 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m09:31:57.794060 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m09:31:57.794500 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m09:31:57.795143 [info ] [MainThread]: 
[0m09:31:57.795725 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m09:31:57.797559 [debug] [MainThread]: Command end result
[0m09:31:57.850248 [info ] [MainThread]: 
[0m09:31:57.850749 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:31:57.851139 [info ] [MainThread]: 
[0m09:31:57.851614 [error] [MainThread]: [31mFailure in test unique_stg_reviews_review_id (models/staging/schema.yml)[0m
[0m09:31:57.852017 [error] [MainThread]:   Got 7812 results, configured to fail if != 0
[0m09:31:57.852331 [info ] [MainThread]: 
[0m09:31:57.852697 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m09:31:57.853141 [info ] [MainThread]: 
[0m09:31:57.853624 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:31:57.855431 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.5473676, "process_user_time": 3.884613, "process_kernel_time": 0.381829, "process_mem_max_rss": "198224", "process_out_blocks": "2520", "command_success": false, "process_in_blocks": "0"}
[0m09:31:57.856391 [debug] [MainThread]: Command `dbt test` failed at 09:31:57.856301 after 4.55 seconds
[0m09:31:57.856838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1eef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d383d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1df490>]}
[0m09:31:57.857232 [debug] [MainThread]: Flushing usage events
[0m09:33:07.995545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5710310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b19ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b19f90>]}


============================== 09:33:08.000831 | ecaf3f47-eb8a-4912-9c24-2552692bb152 ==============================
[0m09:33:08.000831 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:33:08.001960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:33:08.009199 [info ] [MainThread]: dbt version: 1.8.3
[0m09:33:08.009662 [info ] [MainThread]: python version: 3.10.14
[0m09:33:08.009999 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:33:08.010286 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m09:33:08.496906 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m09:33:08.497448 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m09:33:08.497761 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m09:33:08.498125 [info ] [MainThread]: adapter type: snowflake
[0m09:33:08.498370 [info ] [MainThread]: adapter version: 1.8.2
[0m09:33:08.553970 [info ] [MainThread]: Configuration:
[0m09:33:08.554588 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:33:08.554916 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:33:08.555234 [info ] [MainThread]: Required dependencies:
[0m09:33:08.555536 [debug] [MainThread]: Executing "git --help"
[0m09:33:08.559181 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:33:08.559749 [debug] [MainThread]: STDERR: "b''"
[0m09:33:08.560086 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:33:08.560357 [info ] [MainThread]: Connection:
[0m09:33:08.560737 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:33:08.561030 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:33:08.561284 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:33:08.561551 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:33:08.561810 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:33:08.562066 [info ] [MainThread]:   schema: STAGE
[0m09:33:08.562319 [info ] [MainThread]:   authenticator: jwt
[0m09:33:08.562557 [info ] [MainThread]:   oauth_client_id: None
[0m09:33:08.562773 [info ] [MainThread]:   query_tag: None
[0m09:33:08.563029 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:33:08.563280 [info ] [MainThread]:   host: None
[0m09:33:08.563524 [info ] [MainThread]:   port: None
[0m09:33:08.563763 [info ] [MainThread]:   proxy_host: None
[0m09:33:08.564072 [info ] [MainThread]:   proxy_port: None
[0m09:33:08.564359 [info ] [MainThread]:   protocol: None
[0m09:33:08.564644 [info ] [MainThread]:   connect_retries: 1
[0m09:33:08.565016 [info ] [MainThread]:   connect_timeout: None
[0m09:33:08.565371 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:33:08.565734 [info ] [MainThread]:   retry_all: False
[0m09:33:08.566125 [info ] [MainThread]:   insecure_mode: False
[0m09:33:08.566609 [info ] [MainThread]:   reuse_connections: None
[0m09:33:08.567111 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:33:08.631126 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:33:08.632819 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:33:08.633647 [debug] [MainThread]: On debug: select 1 as id
[0m09:33:08.634267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:33:09.138045 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.504 seconds
[0m09:33:09.139612 [debug] [MainThread]: On debug: Close
[0m09:33:09.222825 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:33:09.224017 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:33:09.226118 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2629215, "process_user_time": 2.268908, "process_kernel_time": 0.275141, "process_mem_max_rss": "182960", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m09:33:09.227031 [debug] [MainThread]: Command `dbt debug` succeeded at 09:33:09.226918 after 1.26 seconds
[0m09:33:09.227606 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:33:09.228179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5710310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb491aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b5b430>]}
[0m09:33:09.228760 [debug] [MainThread]: Flushing usage events
[0m09:33:12.205466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f110340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d51e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d51dfc0>]}


============================== 09:33:12.209602 | 5b802571-e5aa-41f7-9f4c-282e541d4ea0 ==============================
[0m09:33:12.209602 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:33:12.210146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:33:12.303959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b802571-e5aa-41f7-9f4c-282e541d4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f133ee0>]}
[0m09:33:12.366033 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-acw40fvm'
[0m09:33:12.366564 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:33:14.046238 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:33:14.071422 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:33:14.228968 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:33:14.239792 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:33:14.753102 [info ] [MainThread]: Installed from version 1.1.1
[0m09:33:14.755697 [info ] [MainThread]: Updated version available: 1.3.3
[0m09:33:14.756634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5b802571-e5aa-41f7-9f4c-282e541d4ea0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea59570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d473d30>]}
[0m09:33:14.757574 [info ] [MainThread]: 
[0m09:33:14.758355 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:33:14.761996 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.587426, "process_user_time": 2.631841, "process_kernel_time": 0.51122, "process_mem_max_rss": "95052", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m09:33:14.763645 [debug] [MainThread]: Command `dbt deps` succeeded at 09:33:14.763441 after 2.59 seconds
[0m09:33:14.766239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f110340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea71ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eab2890>]}
[0m09:33:14.766678 [debug] [MainThread]: Flushing usage events
[0m09:33:17.874178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba7c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e421a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e42140>]}


============================== 09:33:17.877629 | fba9df13-7987-4159-8b69-062c5f33e01d ==============================
[0m09:33:17.877629 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:33:17.878085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m09:33:18.448023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba9fee0>]}
[0m09:33:18.478251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a793a00>]}
[0m09:33:18.478896 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:33:18.544838 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:33:18.693170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:33:18.693759 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m09:33:18.823277 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:33:18.823829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5c1270>]}
[0m09:33:18.929011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f24130>]}
[0m09:33:19.003371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2ee080>]}
[0m09:33:19.003845 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:33:19.004144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2ee290>]}
[0m09:33:19.005288 [info ] [MainThread]: 
[0m09:33:19.005758 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:33:19.009415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:33:19.018138 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:33:19.018529 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:33:19.018793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:19.427324 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.408 seconds
[0m09:33:19.430589 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:33:19.499628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:33:19.501062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:33:19.511726 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:33:19.514915 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:33:19.515551 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:33:19.516154 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:33:19.516732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:19.517262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:19.969816 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.453 seconds
[0m09:33:19.974447 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:33:20.625597 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.108 seconds
[0m09:33:20.630087 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:33:20.738542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a793850>]}
[0m09:33:20.740211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:20.741196 [info ] [MainThread]: 
[0m09:33:20.753786 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:33:20.754759 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:33:20.755628 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:33:20.756426 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:33:20.757269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m09:33:20.758320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m09:33:20.758968 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:33:20.759529 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:33:20.768898 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:33:20.774249 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:33:20.776225 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:33:20.776672 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:33:20.803708 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:33:20.801124 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:33:20.805209 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:33:20.805659 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m09:33:20.807015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:20.806670 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:33:20.809659 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select
md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
product_id as product_id,
reviewer_id as reviewer_id,
cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
where review_id is not null

)

select *
from renamed
  );
[0m09:33:20.810618 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:33:21.373792 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m09:33:21.397998 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:33:21.399246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m09:33:21.403170 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:33:21.492431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9937fa60>]}
[0m09:33:21.493596 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.73s]
[0m09:33:21.494626 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:33:21.500035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba9df13-7987-4159-8b69-062c5f33e01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3e61d0>]}
[0m09:33:21.500943 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.74s]
[0m09:33:21.501753 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:33:21.504582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:21.505159 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m09:33:21.505758 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m09:33:21.506395 [info ] [MainThread]: 
[0m09:33:21.506960 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m09:33:21.507969 [debug] [MainThread]: Command end result
[0m09:33:21.548940 [info ] [MainThread]: 
[0m09:33:21.549415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:21.549780 [info ] [MainThread]: 
[0m09:33:21.550115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:33:21.550911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.705242, "process_user_time": 3.237782, "process_kernel_time": 0.28199, "process_mem_max_rss": "200124", "process_out_blocks": "3687", "process_in_blocks": "0"}
[0m09:33:21.551358 [debug] [MainThread]: Command `dbt run` succeeded at 09:33:21.551297 after 3.71 seconds
[0m09:33:21.551678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba7c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f03eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a793a00>]}
[0m09:33:21.551972 [debug] [MainThread]: Flushing usage events
[0m09:33:25.832607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf714340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb261a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb26140>]}


============================== 09:33:25.836449 | e7ec5786-406f-4170-ae25-4e4327e7a0a8 ==============================
[0m09:33:25.836449 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:33:25.837038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m09:33:26.348213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf737ee0>]}
[0m09:33:26.378160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45b340>]}
[0m09:33:26.378859 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:33:26.441556 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:33:26.584941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:26.585326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:26.615001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8debd030>]}
[0m09:33:26.692268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfa58d0>]}
[0m09:33:26.692732 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:33:26.693086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfa5450>]}
[0m09:33:26.694311 [info ] [MainThread]: 
[0m09:33:26.694873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:33:26.698291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:33:26.707290 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:33:26.707669 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:33:26.707944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:27.067833 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.360 seconds
[0m09:33:27.070073 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:33:27.172589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:33:27.174220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:33:27.184667 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:33:27.188350 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:33:27.188994 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:33:27.189607 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:33:27.190202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:27.190780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:27.585382 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.394 seconds
[0m09:33:27.587819 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:33:27.593471 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.403 seconds
[0m09:33:27.595878 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:33:27.700513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45b850>]}
[0m09:33:27.701807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:27.702564 [info ] [MainThread]: 
[0m09:33:27.714336 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:33:27.715124 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:33:27.715539 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:33:27.716208 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:33:27.717038 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:33:27.717846 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m09:33:27.718523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m09:33:27.719157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m09:33:27.719848 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m09:33:27.720389 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:33:27.721001 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:33:27.721593 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:33:27.730135 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:33:27.733095 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:33:27.735930 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:33:27.737665 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:33:27.738149 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:33:27.753079 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:33:27.761806 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:33:27.764065 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:33:27.766095 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:33:27.767642 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:33:27.768588 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m09:33:27.769362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:27.769079 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:33:27.768221 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:33:27.775950 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m09:33:27.775599 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m09:33:27.777882 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:33:27.777595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:33:30.331599 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.554 seconds
[0m09:33:30.333398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.564 seconds
[0m09:33:30.364516 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:33:30.365769 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:33:30.454229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf717d30>]}
[0m09:33:30.455053 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.73s]
[0m09:33:30.455703 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:33:30.460426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45a5f0>]}
[0m09:33:30.461183 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.74s]
[0m09:33:30.461675 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:33:30.567092 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.789 seconds
[0m09:33:30.569988 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m09:33:30.704699 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3a7610>]}
[0m09:33:30.706026 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.98s]
[0m09:33:30.706955 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:33:30.708598 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m09:33:30.709372 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:33:30.711408 [info ] [Thread-1 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m09:33:30.710665 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m09:33:30.709889 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:33:30.713640 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m09:33:30.712941 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m09:33:30.712153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m09:33:30.714329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m09:33:30.715017 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m09:33:30.715589 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:33:30.716074 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m09:33:30.720746 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m09:33:30.726046 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:33:30.729351 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:33:30.732313 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m09:33:30.732781 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:33:30.736455 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m09:33:30.736975 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m09:33:30.740348 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:33:30.744941 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:33:30.746460 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m09:33:30.747476 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day


    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day


from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m09:33:30.748629 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:33:30.749162 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:33:30.750193 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:33:30.750713 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m09:33:30.754670 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m09:33:30.757382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:30.757923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:33:32.388659 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m09:33:32.393963 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m09:33:32.435944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.678 seconds
[0m09:33:32.438857 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m09:33:32.488814 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd1dc90>]}
[0m09:33:32.490910 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.78s]
[0m09:33:32.492173 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m09:33:32.553321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d347370>]}
[0m09:33:32.554548 [info ] [Thread-1 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.84s]
[0m09:33:32.555477 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:33:32.674818 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.916 seconds
[0m09:33:32.687477 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m09:33:32.845007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec5786-406f-4170-ae25-4e4327e7a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3c73a0>]}
[0m09:33:32.847455 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.13s]
[0m09:33:32.849253 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:33:32.852270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:32.852769 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m09:33:32.853072 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m09:33:32.853566 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m09:33:32.853866 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m09:33:32.854372 [info ] [MainThread]: 
[0m09:33:32.854802 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m09:33:32.856004 [debug] [MainThread]: Command end result
[0m09:33:32.895588 [info ] [MainThread]: 
[0m09:33:32.896255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:32.896650 [info ] [MainThread]: 
[0m09:33:32.897039 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:33:32.898562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0965557, "process_user_time": 3.577226, "process_kernel_time": 0.274859, "process_mem_max_rss": "196392", "process_out_blocks": "2517", "process_in_blocks": "0"}
[0m09:33:32.899347 [debug] [MainThread]: Command `dbt run` succeeded at 09:33:32.899268 after 7.10 seconds
[0m09:33:32.899880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf714340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae948790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45b340>]}
[0m09:33:32.900259 [debug] [MainThread]: Flushing usage events
[0m09:33:35.854747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b94370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f52170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f52110>]}


============================== 09:33:35.858261 | fa32c666-4386-4d15-a87b-eafb8b7abee2 ==============================
[0m09:33:35.858261 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:33:35.858714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:33:36.323245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa32c666-4386-4d15-a87b-eafb8b7abee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff768f2bf0>]}
[0m09:33:36.353051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa32c666-4386-4d15-a87b-eafb8b7abee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76892980>]}
[0m09:33:36.353639 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:33:36.419334 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:33:36.579094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:36.579755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:36.648767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa32c666-4386-4d15-a87b-eafb8b7abee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762ed000>]}
[0m09:33:36.755580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa32c666-4386-4d15-a87b-eafb8b7abee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76310400>]}
[0m09:33:36.756120 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:33:36.756542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa32c666-4386-4d15-a87b-eafb8b7abee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762c6680>]}
[0m09:33:36.758178 [info ] [MainThread]: 
[0m09:33:36.758700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:33:36.762447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:33:36.762974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:33:36.774573 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:33:36.776504 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:33:36.776819 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:33:36.777171 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:33:36.777462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:36.777807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:38.092076 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.313 seconds
[0m09:33:38.094220 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.316 seconds
[0m09:33:38.102471 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:33:38.104469 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:33:38.193755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa32c666-4386-4d15-a87b-eafb8b7abee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff763103d0>]}
[0m09:33:38.198623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:38.199670 [info ] [MainThread]: 
[0m09:33:38.233296 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:33:38.233715 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:33:38.234083 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:33:38.234711 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:33:38.235566 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m09:33:38.236799 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m09:33:38.237756 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m09:33:38.238501 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m09:33:38.240987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m09:33:38.241798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m09:33:38.242316 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m09:33:38.242830 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m09:33:38.243250 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:33:38.243706 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:33:38.244046 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:33:38.244379 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:33:38.275399 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:33:38.278283 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:33:38.286503 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:33:38.293863 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:33:38.296955 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:33:38.303831 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:33:38.304394 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:33:38.340406 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:33:38.341169 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:33:38.341542 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:33:38.345534 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:33:38.350552 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:33:38.351543 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:33:38.352447 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:33:38.353354 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m09:33:38.353937 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:33:38.354424 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:33:38.354795 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m09:33:38.358005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:38.357258 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m09:33:38.357668 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m09:33:38.356871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:33:38.358751 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:33:38.363201 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:33:39.036705 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m09:33:39.049092 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m09:33:39.136011 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.89s]
[0m09:33:39.137326 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:33:39.138093 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:33:39.138883 [info ] [Thread-4 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m09:33:39.139618 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m09:33:39.140204 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:33:39.145544 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:33:39.146845 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:33:39.149563 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:33:39.151032 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:33:39.151461 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m09:33:39.151867 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:33:39.206375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m09:33:39.213562 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m09:33:39.216871 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m09:33:39.218133 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m09:33:39.277805 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.919 seconds
[0m09:33:39.279340 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m09:33:39.292575 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 1.05s]
[0m09:33:39.293532 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:33:39.294148 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 1.05s]
[0m09:33:39.294635 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:33:39.295559 [info ] [Thread-2 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m09:33:39.295985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m09:33:39.296352 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:33:39.295150 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:33:39.299748 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:33:39.300162 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:33:39.300852 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m09:33:39.301279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m09:33:39.301896 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:33:39.304708 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:33:39.301680 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:33:39.307210 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:33:39.308602 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:33:39.310984 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:33:39.311674 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:33:39.312129 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m09:33:39.312445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:33:39.313002 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:33:39.313464 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m09:33:39.315033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:39.346784 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 1.10s]
[0m09:33:39.347385 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:33:39.347826 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:33:39.348209 [info ] [Thread-3 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m09:33:39.348628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m09:33:39.349006 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:33:39.354163 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:33:39.363641 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:33:39.367969 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:33:39.368902 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:33:39.369226 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:33:39.369668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:33:39.712095 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m09:33:39.716894 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m09:33:39.799226 [info ] [Thread-4 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.66s]
[0m09:33:39.800925 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:33:40.426863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m09:33:40.428771 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m09:33:40.431170 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.061 seconds
[0m09:33:40.434464 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m09:33:40.436872 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m09:33:40.439419 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m09:33:40.521477 [info ] [Thread-2 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 1.23s]
[0m09:33:40.523920 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 1.22s]
[0m09:33:40.524716 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:33:40.525378 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:33:40.537130 [error] [Thread-3 (]: 8 of 8 FAIL 7812 unique_stg_reviews_review_id .................................. [[31mFAIL 7812[0m in 1.19s]
[0m09:33:40.538066 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:33:40.540879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:40.541402 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m09:33:40.541790 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m09:33:40.542121 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m09:33:40.542417 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m09:33:40.543011 [info ] [MainThread]: 
[0m09:33:40.543712 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m09:33:40.545987 [debug] [MainThread]: Command end result
[0m09:33:40.592581 [info ] [MainThread]: 
[0m09:33:40.593063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:33:40.593388 [info ] [MainThread]: 
[0m09:33:40.593805 [error] [MainThread]: [31mFailure in test unique_stg_reviews_review_id (models/staging/schema.yml)[0m
[0m09:33:40.594195 [error] [MainThread]:   Got 7812 results, configured to fail if != 0
[0m09:33:40.594564 [info ] [MainThread]: 
[0m09:33:40.595094 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m09:33:40.595447 [info ] [MainThread]: 
[0m09:33:40.595933 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:33:40.597977 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.771202, "process_user_time": 4.455701, "process_kernel_time": 0.470464, "process_mem_max_rss": "198392", "process_out_blocks": "2520", "command_success": false, "process_in_blocks": "0"}
[0m09:33:40.598795 [debug] [MainThread]: Command `dbt test` failed at 09:33:40.598715 after 4.77 seconds
[0m09:33:40.599290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b94370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960bb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975c9c90>]}
[0m09:33:40.599648 [debug] [MainThread]: Flushing usage events
[0m09:44:17.122271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d3e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d3dfc0>]}


============================== 09:44:17.127702 | 42e4d7a9-b284-4bca-8ad3-a990ebb65df4 ==============================
[0m09:44:17.127702 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:44:17.128217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:17.152875 [info ] [MainThread]: dbt version: 1.8.3
[0m09:44:17.153343 [info ] [MainThread]: python version: 3.10.14
[0m09:44:17.153647 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:44:17.153957 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m09:44:18.268102 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m09:44:18.268777 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m09:44:18.269135 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m09:44:18.269617 [info ] [MainThread]: adapter type: snowflake
[0m09:44:18.269931 [info ] [MainThread]: adapter version: 1.8.2
[0m09:44:18.333588 [info ] [MainThread]: Configuration:
[0m09:44:18.334511 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:44:18.335036 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:44:18.335610 [info ] [MainThread]: Required dependencies:
[0m09:44:18.336012 [debug] [MainThread]: Executing "git --help"
[0m09:44:18.355076 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:44:18.355623 [debug] [MainThread]: STDERR: "b''"
[0m09:44:18.355947 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:44:18.356248 [info ] [MainThread]: Connection:
[0m09:44:18.356577 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:44:18.356864 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:44:18.357095 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:44:18.357365 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:44:18.357651 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:44:18.357918 [info ] [MainThread]:   schema: STAGE
[0m09:44:18.358160 [info ] [MainThread]:   authenticator: jwt
[0m09:44:18.358423 [info ] [MainThread]:   oauth_client_id: None
[0m09:44:18.358737 [info ] [MainThread]:   query_tag: None
[0m09:44:18.358965 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:44:18.359183 [info ] [MainThread]:   host: None
[0m09:44:18.359441 [info ] [MainThread]:   port: None
[0m09:44:18.359672 [info ] [MainThread]:   proxy_host: None
[0m09:44:18.359881 [info ] [MainThread]:   proxy_port: None
[0m09:44:18.360086 [info ] [MainThread]:   protocol: None
[0m09:44:18.360307 [info ] [MainThread]:   connect_retries: 1
[0m09:44:18.360551 [info ] [MainThread]:   connect_timeout: None
[0m09:44:18.360779 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:44:18.361001 [info ] [MainThread]:   retry_all: False
[0m09:44:18.361220 [info ] [MainThread]:   insecure_mode: False
[0m09:44:18.361447 [info ] [MainThread]:   reuse_connections: None
[0m09:44:18.361833 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:44:18.445135 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:44:18.445864 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:44:18.446170 [debug] [MainThread]: On debug: select 1 as id
[0m09:44:18.446421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:19.092025 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.645 seconds
[0m09:44:19.094128 [debug] [MainThread]: On debug: Close
[0m09:44:19.227399 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:44:19.228699 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:44:19.234511 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1522155, "process_user_time": 2.551416, "process_kernel_time": 1.413389, "process_mem_max_rss": "187072", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m09:44:19.237429 [debug] [MainThread]: Command `dbt debug` succeeded at 09:44:19.236958 after 2.16 seconds
[0m09:44:19.238760 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:44:19.239313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a03ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6379e6b0>]}
[0m09:44:19.239955 [debug] [MainThread]: Flushing usage events
[0m09:44:25.603408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba3c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e35ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e35f90>]}


============================== 09:44:25.607783 | 950f5151-058d-4669-bfa0-3f65c7246cf4 ==============================
[0m09:44:25.607783 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:44:25.608286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:44:25.700908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '950f5151-058d-4669-bfa0-3f65c7246cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba5ffd0>]}
[0m09:44:25.794113 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ns17pk54'
[0m09:44:25.794583 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:44:25.959838 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:44:25.961251 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:44:26.047933 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:44:26.054179 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:44:26.537414 [info ] [MainThread]: Installed from version 1.1.1
[0m09:44:26.538214 [info ] [MainThread]: Updated version available: 1.3.3
[0m09:44:26.538874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '950f5151-058d-4669-bfa0-3f65c7246cf4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b385480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d8fd00>]}
[0m09:44:26.539354 [info ] [MainThread]: 
[0m09:44:26.539698 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:44:26.540768 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9715607, "process_user_time": 1.228654, "process_kernel_time": 0.350901, "process_mem_max_rss": "95036", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m09:44:26.541198 [debug] [MainThread]: Command `dbt deps` succeeded at 09:44:26.541136 after 0.97 seconds
[0m09:44:26.541527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba3c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3dd150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b385480>]}
[0m09:44:26.541882 [debug] [MainThread]: Flushing usage events
[0m09:44:29.214169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f56170>]}


============================== 09:44:29.217837 | 7c959741-db73-4adf-8df6-f42a0ebde3ef ==============================
[0m09:44:29.217837 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:44:29.218492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:30.021921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30bbdf0>]}
[0m09:44:30.053943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838d3c70>]}
[0m09:44:30.054541 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:44:30.139699 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:44:30.341809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:30.342418 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m09:44:30.509636 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:44:30.510154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83270490>]}
[0m09:44:30.663973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8303c100>]}
[0m09:44:30.750527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832707f0>]}
[0m09:44:30.750968 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:44:30.751339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832725c0>]}
[0m09:44:30.753284 [info ] [MainThread]: 
[0m09:44:30.754191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:44:30.758072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:44:30.773427 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:44:30.773890 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:44:30.774206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:31.202837 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.428 seconds
[0m09:44:31.204888 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:44:31.281504 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:44:31.282543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:44:31.299006 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:44:31.302771 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:44:31.303303 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:44:31.303689 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:44:31.304041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:31.304410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:31.750299 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.446 seconds
[0m09:44:31.755520 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:44:31.766608 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.462 seconds
[0m09:44:31.768867 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:44:31.899284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83012500>]}
[0m09:44:31.900928 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:31.901714 [info ] [MainThread]: 
[0m09:44:31.927168 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:44:31.927849 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:44:31.928665 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:44:31.929482 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:44:31.930328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m09:44:31.931532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m09:44:31.932068 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:44:31.932502 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:44:31.941296 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:44:31.946377 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:44:31.948313 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:44:31.948718 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:44:31.972021 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:44:31.974460 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:44:31.976721 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:44:31.977672 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select





md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
where review_id is not null

)

select *
from renamed
  );
[0m09:44:31.978035 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:31.977392 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:44:31.978454 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m09:44:31.982556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:32.567103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m09:44:32.598488 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:44:32.599661 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m09:44:32.603707 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:44:32.661807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8389a680>]}
[0m09:44:32.662896 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.73s]
[0m09:44:32.664143 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:44:32.781989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c959741-db73-4adf-8df6-f42a0ebde3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fae860>]}
[0m09:44:32.783430 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.85s]
[0m09:44:32.785165 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:44:32.787602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:32.788179 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m09:44:32.788732 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m09:44:32.789353 [info ] [MainThread]: 
[0m09:44:32.790012 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m09:44:32.791244 [debug] [MainThread]: Command end result
[0m09:44:32.851165 [info ] [MainThread]: 
[0m09:44:32.851840 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:32.852220 [info ] [MainThread]: 
[0m09:44:32.852540 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:44:32.853981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.669564, "process_user_time": 3.280759, "process_kernel_time": 0.849296, "process_mem_max_rss": "204028", "process_out_blocks": "3689", "process_in_blocks": "0"}
[0m09:44:32.854640 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:32.854563 after 3.67 seconds
[0m09:44:32.855053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dcbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30bbdf0>]}
[0m09:44:32.855431 [debug] [MainThread]: Flushing usage events
[0m09:44:36.191293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f8c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf342110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3420b0>]}


============================== 09:44:36.194831 | 9a34664b-1a2d-4d0f-a4fe-a5194415360f ==============================
[0m09:44:36.194831 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:44:36.195409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:36.727139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc57b20>]}
[0m09:44:36.757560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcb18d0>]}
[0m09:44:36.758262 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:44:36.821423 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:44:36.970849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:36.971255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:37.001074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6e4fa0>]}
[0m09:44:37.077346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7cd8a0>]}
[0m09:44:37.077842 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:44:37.078367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7cf040>]}
[0m09:44:37.079999 [info ] [MainThread]: 
[0m09:44:37.080683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:44:37.084735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:44:37.094347 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:44:37.094705 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:44:37.094968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:38.658151 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.560 seconds
[0m09:44:38.673437 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:44:38.764649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:44:38.776579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:44:38.797645 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:44:38.800877 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:44:38.802914 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:44:38.803644 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:44:38.803996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:38.804311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:39.339189 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.535 seconds
[0m09:44:39.344370 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:44:39.380629 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.576 seconds
[0m09:44:39.382929 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:44:39.451297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc57df0>]}
[0m09:44:39.452557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:39.453240 [info ] [MainThread]: 
[0m09:44:39.472373 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:44:39.472856 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:44:39.473180 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:44:39.473885 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:44:39.474562 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:44:39.475042 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m09:44:39.475539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m09:44:39.475945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m09:44:39.476387 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m09:44:39.476757 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:44:39.477123 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:44:39.477470 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:44:39.484390 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:44:39.486437 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:44:39.488595 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:44:39.490626 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:44:39.498105 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:44:39.498383 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:44:39.509901 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:44:39.512071 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:44:39.514168 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:44:39.515925 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:44:39.516449 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m09:44:39.517075 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:44:39.517499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:39.518073 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:44:39.519166 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m09:44:39.520265 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m09:44:39.526543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.527482 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:42.196271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.669 seconds
[0m09:44:42.233902 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:44:42.301506 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.784 seconds
[0m09:44:42.305107 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:44:42.311460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb47c70>]}
[0m09:44:42.312682 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.83s]
[0m09:44:42.313661 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:44:42.373287 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4e0430>]}
[0m09:44:42.374322 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.90s]
[0m09:44:42.375064 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:44:42.913749 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.386 seconds
[0m09:44:42.922879 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m09:44:43.005318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb47af0>]}
[0m09:44:43.006115 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.53s]
[0m09:44:43.006995 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:44:43.008927 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m09:44:43.009819 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:44:43.010621 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:44:43.011490 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m09:44:43.012045 [info ] [Thread-1 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m09:44:43.013928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m09:44:43.013157 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m09:44:43.012534 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m09:44:43.017108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m09:44:43.016085 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m09:44:43.015107 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:44:43.018052 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m09:44:43.027068 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m09:44:43.032335 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:44:43.035855 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:44:43.039201 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:44:43.039605 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m09:44:43.043616 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:44:43.043990 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m09:44:43.050098 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m09:44:43.058422 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:44:43.061099 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:44:43.063386 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m09:44:43.064157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:43.066125 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m09:44:43.067297 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:44:43.072954 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m09:44:43.068850 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day


    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day


from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m09:44:43.076352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:43.077996 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:44.339738 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.262 seconds
[0m09:44:44.345691 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m09:44:44.423491 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebfa920>]}
[0m09:44:44.424767 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.41s]
[0m09:44:44.426608 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m09:44:44.439637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m09:44:44.442384 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m09:44:44.532783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb65750>]}
[0m09:44:44.533806 [info ] [Thread-1 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.52s]
[0m09:44:44.534451 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:44:44.940505 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.864 seconds
[0m09:44:44.947310 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m09:44:45.061385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a34664b-1a2d-4d0f-a4fe-a5194415360f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb66f50>]}
[0m09:44:45.063529 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.04s]
[0m09:44:45.064670 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:44:45.075861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:45.077116 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m09:44:45.077880 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m09:44:45.078335 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m09:44:45.078821 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m09:44:45.079865 [info ] [MainThread]: 
[0m09:44:45.080631 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m09:44:45.082447 [debug] [MainThread]: Command end result
[0m09:44:45.150372 [info ] [MainThread]: 
[0m09:44:45.151280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:45.151752 [info ] [MainThread]: 
[0m09:44:45.152353 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:44:45.155236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.993999, "process_user_time": 4.185207, "process_kernel_time": 0.441903, "process_mem_max_rss": "200532", "process_out_blocks": "2517", "process_in_blocks": "0"}
[0m09:44:45.158417 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:45.158168 after 9.00 seconds
[0m09:44:45.160704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f8c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01bd570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcb18d0>]}
[0m09:44:45.161419 [debug] [MainThread]: Flushing usage events
[0m09:44:48.151018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50ac3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa343a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa343a140>]}


============================== 09:44:48.154529 | 29703e36-7a5e-4817-9a6b-6a469255fdbc ==============================
[0m09:44:48.154529 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:44:48.155098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:44:48.641101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29703e36-7a5e-4817-9a6b-6a469255fdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50cfe80>]}
[0m09:44:48.670826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29703e36-7a5e-4817-9a6b-6a469255fdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d5a620>]}
[0m09:44:48.671461 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:44:48.738037 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:44:48.881947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:48.882358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:48.911923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29703e36-7a5e-4817-9a6b-6a469255fdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83859030>]}
[0m09:44:49.008908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29703e36-7a5e-4817-9a6b-6a469255fdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83875d20>]}
[0m09:44:49.009372 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:44:49.009753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29703e36-7a5e-4817-9a6b-6a469255fdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8382e800>]}
[0m09:44:49.010995 [info ] [MainThread]: 
[0m09:44:49.011431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:44:49.014775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:44:49.015791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:44:49.027750 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:44:49.029733 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:44:49.030071 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:44:49.030458 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:44:49.030731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:49.031015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:49.458612 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.427 seconds
[0m09:44:49.462019 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:44:49.465308 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.435 seconds
[0m09:44:49.468587 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:44:49.559909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29703e36-7a5e-4817-9a6b-6a469255fdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83875c90>]}
[0m09:44:49.561100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:49.561980 [info ] [MainThread]: 
[0m09:44:49.573790 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:44:49.574419 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:44:49.574954 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:44:49.575679 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:44:49.576290 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m09:44:49.576992 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m09:44:49.577704 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m09:44:49.578443 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m09:44:49.579302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m09:44:49.580035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m09:44:49.580815 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m09:44:49.581641 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m09:44:49.582258 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:44:49.582821 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:44:49.583467 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:44:49.584012 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:44:49.598872 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:44:49.606055 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:44:49.609480 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:44:49.613097 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:44:49.615370 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:44:49.616112 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:44:49.628291 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:44:49.630050 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:44:49.631929 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:44:49.632281 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:44:49.634589 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:44:49.637042 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:44:49.637778 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:44:49.638497 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:44:49.639044 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m09:44:49.639540 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:44:49.639992 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:44:49.640282 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m09:44:49.641606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:49.640942 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m09:44:49.641323 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m09:44:49.640605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.642025 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:49.642346 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:50.182601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m09:44:50.199509 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m09:44:50.201064 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m09:44:50.206420 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m09:44:50.269108 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.69s]
[0m09:44:50.271450 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:44:50.272215 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:44:50.272808 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m09:44:50.273365 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m09:44:50.273856 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:44:50.270537 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.69s]
[0m09:44:50.280841 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:44:50.281524 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:44:50.282272 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m09:44:50.279808 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:44:50.282977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m09:44:50.284393 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:44:50.289839 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:44:50.290488 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:44:50.294294 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:44:50.295032 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:44:50.300581 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:44:50.301714 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:44:50.302474 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m09:44:50.303053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:50.303989 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:44:50.304641 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m09:44:50.308317 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:50.336983 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m09:44:50.338637 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m09:44:50.412293 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.83s]
[0m09:44:50.413139 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:44:50.413525 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:44:50.413953 [info ] [Thread-4 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m09:44:50.414337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m09:44:50.414662 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:44:50.417881 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:44:50.418769 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:44:50.421076 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:44:50.422024 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:44:50.422335 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m09:44:50.422619 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:50.743048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.102 seconds
[0m09:44:50.745323 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m09:44:50.839633 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 1.26s]
[0m09:44:50.840764 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:44:50.841476 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:44:50.842214 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m09:44:50.843010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m09:44:50.843619 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:44:50.852056 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:44:50.853844 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:44:50.858213 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:44:50.859848 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:44:50.860360 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:44:50.860856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:50.952918 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m09:44:50.954318 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m09:44:51.035022 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.76s]
[0m09:44:51.038375 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:44:52.012614 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.590 seconds
[0m09:44:52.013926 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.706 seconds
[0m09:44:52.016701 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m09:44:52.019173 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m09:44:52.098431 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 1.82s]
[0m09:44:52.099429 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:44:52.108564 [info ] [Thread-4 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 1.69s]
[0m09:44:52.109330 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:44:52.317291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.456 seconds
[0m09:44:52.322548 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m09:44:52.410614 [error] [Thread-1 (]: 8 of 8 FAIL 7407 unique_stg_reviews_review_id .................................. [[31mFAIL 7407[0m in 1.57s]
[0m09:44:52.412755 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:44:52.415066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:52.415878 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m09:44:52.416500 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m09:44:52.416967 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m09:44:52.417390 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m09:44:52.417922 [info ] [MainThread]: 
[0m09:44:52.418581 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m09:44:52.420427 [debug] [MainThread]: Command end result
[0m09:44:52.471676 [info ] [MainThread]: 
[0m09:44:52.472218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:44:52.472590 [info ] [MainThread]: 
[0m09:44:52.473062 [error] [MainThread]: [31mFailure in test unique_stg_reviews_review_id (models/staging/schema.yml)[0m
[0m09:44:52.473490 [error] [MainThread]:   Got 7407 results, configured to fail if != 0
[0m09:44:52.473827 [info ] [MainThread]: 
[0m09:44:52.474248 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m09:44:52.474625 [info ] [MainThread]: 
[0m09:44:52.475161 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:44:52.476606 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.3561068, "process_user_time": 3.610398, "process_kernel_time": 0.286459, "process_mem_max_rss": "202232", "process_out_blocks": "2520", "command_success": false, "process_in_blocks": "0"}
[0m09:44:52.477250 [debug] [MainThread]: Command `dbt test` failed at 09:44:52.477166 after 4.36 seconds
[0m09:44:52.477711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50ac3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ae1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d5a620>]}
[0m09:44:52.478155 [debug] [MainThread]: Flushing usage events
[0m09:45:46.496869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed10370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad11e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad11dff0>]}


============================== 09:45:46.504840 | 52426c10-7de2-446c-b9d3-4caaba9b6bb0 ==============================
[0m09:45:46.504840 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:45:46.505907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:45:46.525890 [info ] [MainThread]: dbt version: 1.8.3
[0m09:45:46.526448 [info ] [MainThread]: python version: 3.10.14
[0m09:45:46.526839 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:45:46.527165 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m09:45:47.470562 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m09:45:47.471132 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m09:45:47.471435 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m09:45:47.471788 [info ] [MainThread]: adapter type: snowflake
[0m09:45:47.472059 [info ] [MainThread]: adapter version: 1.8.2
[0m09:45:47.532527 [info ] [MainThread]: Configuration:
[0m09:45:47.533026 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:45:47.533286 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:45:47.533522 [info ] [MainThread]: Required dependencies:
[0m09:45:47.533782 [debug] [MainThread]: Executing "git --help"
[0m09:45:47.550676 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:45:47.551122 [debug] [MainThread]: STDERR: "b''"
[0m09:45:47.551407 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:45:47.551716 [info ] [MainThread]: Connection:
[0m09:45:47.551981 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:45:47.552240 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:45:47.552479 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:45:47.552708 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:45:47.552981 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:45:47.553233 [info ] [MainThread]:   schema: STAGE
[0m09:45:47.553457 [info ] [MainThread]:   authenticator: jwt
[0m09:45:47.553674 [info ] [MainThread]:   oauth_client_id: None
[0m09:45:47.553904 [info ] [MainThread]:   query_tag: None
[0m09:45:47.554148 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:45:47.554415 [info ] [MainThread]:   host: None
[0m09:45:47.554648 [info ] [MainThread]:   port: None
[0m09:45:47.554897 [info ] [MainThread]:   proxy_host: None
[0m09:45:47.555373 [info ] [MainThread]:   proxy_port: None
[0m09:45:47.555631 [info ] [MainThread]:   protocol: None
[0m09:45:47.556341 [info ] [MainThread]:   connect_retries: 1
[0m09:45:47.561986 [info ] [MainThread]:   connect_timeout: None
[0m09:45:47.562312 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:45:47.562804 [info ] [MainThread]:   retry_all: False
[0m09:45:47.563128 [info ] [MainThread]:   insecure_mode: False
[0m09:45:47.563356 [info ] [MainThread]:   reuse_connections: None
[0m09:45:47.563785 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:45:47.643983 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:45:47.644791 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:45:47.645091 [debug] [MainThread]: On debug: select 1 as id
[0m09:45:47.645344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:48.607690 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.960 seconds
[0m09:45:48.616577 [debug] [MainThread]: On debug: Close
[0m09:45:48.741348 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:45:48.742703 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:45:48.750473 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.309924, "process_user_time": 3.825266, "process_kernel_time": 1.787177, "process_mem_max_rss": "187028", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m09:45:48.754108 [debug] [MainThread]: Command `dbt debug` succeeded at 09:45:48.753341 after 2.31 seconds
[0m09:45:48.755358 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:45:48.756096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed10370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf1af20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918f4c70>]}
[0m09:45:48.756824 [debug] [MainThread]: Flushing usage events
[0m09:45:53.339075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae060340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac435ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac435f90>]}


============================== 09:45:53.343054 | 4b8c16c9-bda0-482e-b049-27001e137909 ==============================
[0m09:45:53.343054 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:45:53.343726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:45:53.447224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b8c16c9-bda0-482e-b049-27001e137909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae08fee0>]}
[0m09:45:53.596916 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jln0w1mu'
[0m09:45:53.597938 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:45:53.761854 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:45:53.763661 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:45:53.868569 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:45:53.873434 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:45:54.664457 [info ] [MainThread]: Installed from version 1.1.1
[0m09:45:54.669510 [info ] [MainThread]: Updated version available: 1.3.3
[0m09:45:54.673562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b8c16c9-bda0-482e-b049-27001e137909', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac38fd30>]}
[0m09:45:54.675704 [info ] [MainThread]: 
[0m09:45:54.677166 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:45:54.683953 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3839818, "process_user_time": 1.477524, "process_kernel_time": 0.414025, "process_mem_max_rss": "95156", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m09:45:54.685617 [debug] [MainThread]: Command `dbt deps` succeeded at 09:45:54.685440 after 1.39 seconds
[0m09:45:54.686436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae060340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac437a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada0e890>]}
[0m09:45:54.686826 [debug] [MainThread]: Flushing usage events
[0m09:46:00.366302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf543a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b356200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3561a0>]}


============================== 09:46:00.371670 | 6f7fd332-7f4d-4011-97f5-54145f2cc5c5 ==============================
[0m09:46:00.371670 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:46:00.373012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:01.152170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bcce560>]}
[0m09:46:01.186337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc9ccd0>]}
[0m09:46:01.187056 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:46:01.264221 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:46:01.466040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:01.466928 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m09:46:01.703849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:46:01.704904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b71e440>]}
[0m09:46:01.922986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b444100>]}
[0m09:46:02.052000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b69f310>]}
[0m09:46:02.052971 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:46:02.054125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b69f550>]}
[0m09:46:02.056039 [info ] [MainThread]: 
[0m09:46:02.056784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:46:02.061634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:46:02.079820 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:46:02.080286 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:46:02.080561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:02.618420 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.537 seconds
[0m09:46:02.625589 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:46:02.702895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m09:46:02.704077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:46:02.716355 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:46:02.720911 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:46:02.721367 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:46:02.721698 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:46:02.722023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:02.722304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:03.253406 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.531 seconds
[0m09:46:03.258552 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m09:46:03.260744 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:46:03.262608 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:46:03.738354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3adff0>]}
[0m09:46:03.741380 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:03.743073 [info ] [MainThread]: 
[0m09:46:03.787980 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:46:03.789632 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:46:03.788735 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:46:03.790569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m09:46:03.791342 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:46:03.792645 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:46:03.794145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m09:46:03.813254 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:46:03.820564 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:46:03.833150 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:46:03.836097 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:46:03.837168 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:46:03.881865 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:46:03.884308 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:46:03.886209 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:46:03.887478 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m09:46:03.887812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:03.887184 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:46:03.888388 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select





md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m09:46:03.891905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:04.402581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m09:46:04.427573 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:46:04.463346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m09:46:04.465492 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:46:04.518487 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc6e650>]}
[0m09:46:04.519233 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m09:46:04.519892 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:46:04.535739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f7fd332-7f4d-4011-97f5-54145f2cc5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3f8ee0>]}
[0m09:46:04.536410 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.75s]
[0m09:46:04.536916 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:46:04.538366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:04.538755 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m09:46:04.539059 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m09:46:04.539471 [info ] [MainThread]: 
[0m09:46:04.539798 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m09:46:04.540421 [debug] [MainThread]: Command end result
[0m09:46:04.593353 [info ] [MainThread]: 
[0m09:46:04.594222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:04.594851 [info ] [MainThread]: 
[0m09:46:04.595256 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:46:04.598569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2769256, "process_user_time": 3.879216, "process_kernel_time": 0.872299, "process_mem_max_rss": "204004", "process_out_blocks": "3689", "process_in_blocks": "0"}
[0m09:46:04.600302 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:04.600185 after 4.28 seconds
[0m09:46:04.600912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf543a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bace440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc9ccd0>]}
[0m09:46:04.601303 [debug] [MainThread]: Flushing usage events
[0m09:46:08.417973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91354310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f752170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f752110>]}


============================== 09:46:08.422312 | 9e742d23-63dd-452a-b7a7-c2768d485f38 ==============================
[0m09:46:08.422312 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:46:08.422925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:09.036085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91377fd0>]}
[0m09:46:09.069830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff740e3d90>]}
[0m09:46:09.070563 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:46:09.144287 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:46:09.323634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:09.324092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:09.357569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fafd000>]}
[0m09:46:09.550690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fbe5ed0>]}
[0m09:46:09.552880 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:46:09.555125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fbe5300>]}
[0m09:46:09.562153 [info ] [MainThread]: 
[0m09:46:09.567374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:46:09.579343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:46:09.616035 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:46:09.616822 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:46:09.617193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:10.137707 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.519 seconds
[0m09:46:10.143105 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:46:10.712509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:46:10.713536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:46:10.724282 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:46:10.728089 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:46:10.728475 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:46:10.728828 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:46:10.729162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:10.729456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:11.093624 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.364 seconds
[0m09:46:11.095338 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:46:11.151638 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.422 seconds
[0m09:46:11.155247 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:46:11.240261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff740af2e0>]}
[0m09:46:11.243001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:11.244545 [info ] [MainThread]: 
[0m09:46:11.289847 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:46:11.290662 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:46:11.296326 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:46:11.293951 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:46:11.308445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m09:46:11.298246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m09:46:11.291842 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:46:11.311738 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:46:11.313304 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:46:11.315877 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m09:46:11.326354 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:46:11.330532 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:46:11.331191 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m09:46:11.333997 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:46:11.341683 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:46:11.342949 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:46:11.344005 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:46:11.365158 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:46:11.389073 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:46:11.394450 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:46:11.398004 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:46:11.402103 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:46:11.403177 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m09:46:11.403801 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:46:11.404432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:11.404947 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:46:11.405582 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m09:46:11.408042 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m09:46:11.416887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:11.419391 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:46:13.521273 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.116 seconds
[0m09:46:13.563990 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:46:13.666402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ef5f640>]}
[0m09:46:13.667581 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.37s]
[0m09:46:13.668720 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:46:13.733023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.316 seconds
[0m09:46:13.737834 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:46:13.898475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb49720>]}
[0m09:46:13.900411 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.59s]
[0m09:46:13.901424 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:46:14.644393 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.225 seconds
[0m09:46:14.649238 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m09:46:14.820349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ef5d210>]}
[0m09:46:14.821990 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.49s]
[0m09:46:14.823039 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:46:14.824731 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m09:46:14.825137 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:46:14.825393 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:46:14.825842 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m09:46:14.826270 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m09:46:14.826677 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m09:46:14.827243 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m09:46:14.827650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m09:46:14.828699 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:46:14.828364 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m09:46:14.827993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m09:46:14.836171 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m09:46:14.835744 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m09:46:14.833207 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:46:14.838267 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:46:14.841936 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m09:46:14.842214 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m09:46:14.842527 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:46:14.845187 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:46:14.848603 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m09:46:14.851334 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:46:14.853182 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m09:46:14.854253 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:46:14.855277 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:46:14.855565 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day


    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day


from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m09:46:14.855937 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m09:46:14.856994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:14.856662 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:46:14.856313 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m09:46:14.860958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:16.297158 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.439 seconds
[0m09:46:16.311482 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m09:46:16.452530 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efffd00>]}
[0m09:46:16.454321 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.62s]
[0m09:46:16.455676 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m09:46:16.541681 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.681 seconds
[0m09:46:16.549324 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m09:46:16.555341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m09:46:16.557928 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m09:46:16.650962 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e51ad10>]}
[0m09:46:16.652749 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.82s]
[0m09:46:16.654681 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:46:16.677613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e742d23-63dd-452a-b7a7-c2768d485f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efb0940>]}
[0m09:46:16.678237 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.85s]
[0m09:46:16.678863 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:46:16.695379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:16.696074 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m09:46:16.696378 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m09:46:16.696647 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m09:46:16.696975 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m09:46:16.697744 [info ] [MainThread]: 
[0m09:46:16.698194 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m09:46:16.699910 [debug] [MainThread]: Command end result
[0m09:46:16.770668 [info ] [MainThread]: 
[0m09:46:16.771835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:16.772442 [info ] [MainThread]: 
[0m09:46:16.772994 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:46:16.775666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.373943, "process_user_time": 4.241113, "process_kernel_time": 0.691519, "process_mem_max_rss": "200412", "process_out_blocks": "2518", "process_in_blocks": "0"}
[0m09:46:16.779106 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:16.778980 after 8.38 seconds
[0m09:46:16.780791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91354310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f91bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff740e3d90>]}
[0m09:46:16.781150 [debug] [MainThread]: Flushing usage events
[0m09:46:20.538212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb158c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf93a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf93a110>]}


============================== 09:46:20.546295 | 84b24f4b-cc9f-4d2f-8007-23a9e57547bb ==============================
[0m09:46:20.546295 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:46:20.547016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:21.211764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84b24f4b-cc9f-4d2f-8007-23a9e57547bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94326bf0>]}
[0m09:46:21.242908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84b24f4b-cc9f-4d2f-8007-23a9e57547bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942c6980>]}
[0m09:46:21.243618 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:46:21.326470 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:46:21.559926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:21.560573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:21.597933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84b24f4b-cc9f-4d2f-8007-23a9e57547bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc85000>]}
[0m09:46:21.694491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84b24f4b-cc9f-4d2f-8007-23a9e57547bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcbc400>]}
[0m09:46:21.695134 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:46:21.695524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84b24f4b-cc9f-4d2f-8007-23a9e57547bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc5e680>]}
[0m09:46:21.697266 [info ] [MainThread]: 
[0m09:46:21.697852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:46:21.701786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:46:21.702853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:46:21.713874 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:46:21.716050 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:46:21.716440 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:46:21.716800 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:46:21.717113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:21.717428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:22.197181 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.480 seconds
[0m09:46:22.201733 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:46:22.202538 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.485 seconds
[0m09:46:22.205375 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:46:22.305726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84b24f4b-cc9f-4d2f-8007-23a9e57547bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942c72e0>]}
[0m09:46:22.307023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:22.307498 [info ] [MainThread]: 
[0m09:46:22.324015 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:46:22.324413 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:46:22.324700 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:46:22.325036 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:46:22.325438 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m09:46:22.325911 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m09:46:22.326315 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m09:46:22.326674 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m09:46:22.327227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m09:46:22.327644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m09:46:22.328098 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m09:46:22.328535 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m09:46:22.329007 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:46:22.329607 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:46:22.329982 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:46:22.330330 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:46:22.341527 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:46:22.347864 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:46:22.350746 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:46:22.353843 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:46:22.355086 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:46:22.355974 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:46:22.362452 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:46:22.369599 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:46:22.371737 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:46:22.372037 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:46:22.374338 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:46:22.376604 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:46:22.377189 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:46:22.378020 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:46:22.378595 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:46:22.378884 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m09:46:22.379335 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:46:22.380655 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m09:46:22.380048 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m09:46:22.380371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:22.379636 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m09:46:22.381805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:22.381227 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:46:22.380941 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:46:22.899946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m09:46:22.909931 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m09:46:22.942726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m09:46:22.944248 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m09:46:22.982603 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.65s]
[0m09:46:22.983423 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:46:22.983869 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:46:22.984327 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m09:46:22.984776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m09:46:22.985163 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:46:22.989117 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:46:22.990231 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:46:22.992298 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:46:22.993143 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:46:22.993438 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m09:46:22.993780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:23.002467 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m09:46:23.006866 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m09:46:23.012227 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.68s]
[0m09:46:23.012808 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:46:23.013246 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:46:23.013651 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m09:46:23.014058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m09:46:23.014373 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:46:23.017597 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:46:23.019285 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:46:23.023053 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:46:23.030378 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:46:23.030719 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m09:46:23.031194 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:46:23.045912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m09:46:23.049831 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m09:46:23.085656 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.76s]
[0m09:46:23.087735 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:46:23.090940 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:46:23.091371 [info ] [Thread-4 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m09:46:23.091877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m09:46:23.092171 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:46:23.096719 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:46:23.098047 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:46:23.100095 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:46:23.100936 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:46:23.101213 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m09:46:23.101512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:46:23.150723 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.82s]
[0m09:46:23.152679 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:46:23.153580 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:46:23.155968 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m09:46:23.157606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m09:46:23.159367 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:46:23.181607 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:46:23.194459 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:46:23.196772 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:46:23.200543 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:46:23.200905 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:46:23.201201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:23.864083 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m09:46:23.867498 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m09:46:23.883884 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m09:46:23.885496 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m09:46:23.952501 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.97s]
[0m09:46:23.953698 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:46:23.977289 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.96s]
[0m09:46:23.977912 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:46:24.485884 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m09:46:24.489557 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m09:46:24.561375 [info ] [Thread-4 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 1.47s]
[0m09:46:24.562817 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:46:24.633297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.432 seconds
[0m09:46:24.634980 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m09:46:24.719239 [error] [Thread-1 (]: 8 of 8 FAIL 7407 unique_stg_reviews_review_id .................................. [[31mFAIL 7407[0m in 1.56s]
[0m09:46:24.721322 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:46:24.724131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:24.724597 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m09:46:24.724894 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m09:46:24.725128 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m09:46:24.725348 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m09:46:24.725717 [info ] [MainThread]: 
[0m09:46:24.726133 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m09:46:24.727377 [debug] [MainThread]: Command end result
[0m09:46:24.769076 [info ] [MainThread]: 
[0m09:46:24.769656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:46:24.770043 [info ] [MainThread]: 
[0m09:46:24.770499 [error] [MainThread]: [31mFailure in test unique_stg_reviews_review_id (models/staging/schema.yml)[0m
[0m09:46:24.770852 [error] [MainThread]:   Got 7407 results, configured to fail if != 0
[0m09:46:24.771097 [info ] [MainThread]: 
[0m09:46:24.771386 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m09:46:24.771707 [info ] [MainThread]: 
[0m09:46:24.772071 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:46:24.774581 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.294204, "process_user_time": 4.261339, "process_kernel_time": 0.530614, "process_mem_max_rss": "202396", "process_out_blocks": "2520", "command_success": false, "process_in_blocks": "0"}
[0m09:46:24.775574 [debug] [MainThread]: Command `dbt test` failed at 09:46:24.775499 after 4.30 seconds
[0m09:46:24.776227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb158c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafaa7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fc3220>]}
[0m09:46:24.776716 [debug] [MainThread]: Flushing usage events
[0m09:57:05.670274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9913e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9913dfc0>]}


============================== 09:57:05.675434 | 9a15ef7c-7960-447e-a950-143a9657f485 ==============================
[0m09:57:05.675434 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:57:05.676012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:05.684942 [info ] [MainThread]: dbt version: 1.8.3
[0m09:57:05.685483 [info ] [MainThread]: python version: 3.10.14
[0m09:57:05.685780 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m09:57:05.686070 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m09:57:06.384834 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m09:57:06.385573 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m09:57:06.386123 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m09:57:06.386848 [info ] [MainThread]: adapter type: snowflake
[0m09:57:06.387152 [info ] [MainThread]: adapter version: 1.8.2
[0m09:57:06.442706 [info ] [MainThread]: Configuration:
[0m09:57:06.443248 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:57:06.443543 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:57:06.443808 [info ] [MainThread]: Required dependencies:
[0m09:57:06.444059 [debug] [MainThread]: Executing "git --help"
[0m09:57:06.454667 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:57:06.455101 [debug] [MainThread]: STDERR: "b''"
[0m09:57:06.455361 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:57:06.455668 [info ] [MainThread]: Connection:
[0m09:57:06.456026 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m09:57:06.456325 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m09:57:06.456627 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m09:57:06.456916 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m09:57:06.457211 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m09:57:06.457450 [info ] [MainThread]:   schema: STAGE
[0m09:57:06.457687 [info ] [MainThread]:   authenticator: jwt
[0m09:57:06.457917 [info ] [MainThread]:   oauth_client_id: None
[0m09:57:06.458154 [info ] [MainThread]:   query_tag: None
[0m09:57:06.458401 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:57:06.458628 [info ] [MainThread]:   host: None
[0m09:57:06.458851 [info ] [MainThread]:   port: None
[0m09:57:06.459091 [info ] [MainThread]:   proxy_host: None
[0m09:57:06.459309 [info ] [MainThread]:   proxy_port: None
[0m09:57:06.459543 [info ] [MainThread]:   protocol: None
[0m09:57:06.459774 [info ] [MainThread]:   connect_retries: 1
[0m09:57:06.459993 [info ] [MainThread]:   connect_timeout: None
[0m09:57:06.460202 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:57:06.460412 [info ] [MainThread]:   retry_all: False
[0m09:57:06.460644 [info ] [MainThread]:   insecure_mode: False
[0m09:57:06.460876 [info ] [MainThread]:   reuse_connections: None
[0m09:57:06.461217 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:57:06.525116 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:57:06.525873 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:57:06.526155 [debug] [MainThread]: On debug: select 1 as id
[0m09:57:06.526369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:07.072831 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.546 seconds
[0m09:57:07.074592 [debug] [MainThread]: On debug: Close
[0m09:57:07.161278 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:57:07.162144 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:57:07.163807 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5271896, "process_user_time": 2.352755, "process_kernel_time": 0.758434, "process_mem_max_rss": "186972", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m09:57:07.164765 [debug] [MainThread]: Command `dbt debug` succeeded at 09:57:07.164646 after 1.53 seconds
[0m09:57:07.165431 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:57:07.166045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9add3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db526b0>]}
[0m09:57:07.166629 [debug] [MainThread]: Flushing usage events
[0m09:57:10.016060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1310310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf71dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf71df90>]}


============================== 09:57:10.019947 | c58a4eeb-7870-462a-a041-1dafc9b9741a ==============================
[0m09:57:10.019947 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:57:10.020570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:57:10.096329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c58a4eeb-7870-462a-a041-1dafc9b9741a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1333fd0>]}
[0m09:57:10.179498 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-276jua4_'
[0m09:57:10.179957 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:57:11.291535 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:57:11.327344 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:57:11.522449 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:57:11.538102 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:57:12.206547 [info ] [MainThread]: Installed from version 1.1.1
[0m09:57:12.208397 [info ] [MainThread]: Updated version available: 1.3.3
[0m09:57:12.209844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c58a4eeb-7870-462a-a041-1dafc9b9741a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c59480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf673d00>]}
[0m09:57:12.211397 [info ] [MainThread]: 
[0m09:57:12.212428 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:57:12.216299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.2300293, "process_user_time": 2.145333, "process_kernel_time": 0.435983, "process_mem_max_rss": "94908", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m09:57:12.217698 [debug] [MainThread]: Command `dbt deps` succeeded at 09:57:12.217547 after 2.23 seconds
[0m09:57:12.218366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1310310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cb1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c59480>]}
[0m09:57:12.218809 [debug] [MainThread]: Flushing usage events
[0m09:57:15.146972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d26200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d261a0>]}


============================== 09:57:15.160201 | bf6c3582-c971-422d-9944-be463a8c2ae3 ==============================
[0m09:57:15.160201 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:57:15.163632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:15.710111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6ba560>]}
[0m09:57:15.741269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a688cd0>]}
[0m09:57:15.741934 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:57:15.812010 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:57:15.973242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:15.973641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:16.004572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a0c1090>]}
[0m09:57:16.085483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1a5930>]}
[0m09:57:16.086034 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:57:16.086509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1a54e0>]}
[0m09:57:16.087953 [info ] [MainThread]: 
[0m09:57:16.088604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:57:16.092997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:57:16.106326 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:57:16.106831 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:57:16.107158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:16.480709 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.373 seconds
[0m09:57:16.483142 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:57:16.550975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:57:16.551913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:57:16.564534 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:57:16.568872 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:57:16.569571 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:57:16.570096 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:57:16.570643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:16.571097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:16.946797 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.376 seconds
[0m09:57:16.949303 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:57:16.998288 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.428 seconds
[0m09:57:17.001342 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:57:17.082568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a65fd30>]}
[0m09:57:17.083667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:17.084436 [info ] [MainThread]: 
[0m09:57:17.098823 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m09:57:17.099750 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m09:57:17.100631 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m09:57:17.101451 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m09:57:17.102210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m09:57:17.102994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m09:57:17.103547 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m09:57:17.104103 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m09:57:17.113448 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m09:57:17.129358 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:57:17.131125 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m09:57:17.131643 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m09:57:17.160528 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m09:57:17.160994 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m09:57:17.162828 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m09:57:17.164062 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m09:57:17.164421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:17.163823 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m09:57:17.164936 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select





md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m09:57:17.169249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:17.788097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m09:57:17.809902 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m09:57:17.813347 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m09:57:17.814968 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m09:57:17.876903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7955f8e0>]}
[0m09:57:17.878068 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.77s]
[0m09:57:17.879132 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m09:57:17.888665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6c3582-c971-422d-9944-be463a8c2ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7955f3d0>]}
[0m09:57:17.889437 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m09:57:17.890208 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m09:57:17.892080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:17.892560 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m09:57:17.892899 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m09:57:17.893398 [info ] [MainThread]: 
[0m09:57:17.893836 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m09:57:17.894752 [debug] [MainThread]: Command end result
[0m09:57:17.930472 [info ] [MainThread]: 
[0m09:57:17.930907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:17.931246 [info ] [MainThread]: 
[0m09:57:17.931560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:57:17.933372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8452826, "process_user_time": 3.240028, "process_kernel_time": 0.375393, "process_mem_max_rss": "197700", "process_out_blocks": "2480", "process_in_blocks": "0"}
[0m09:57:17.934043 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:17.933975 after 2.85 seconds
[0m09:57:17.934471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab499c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a688cd0>]}
[0m09:57:17.934772 [debug] [MainThread]: Flushing usage events
[0m09:57:23.003976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807e42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb4a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb4a0e0>]}


============================== 09:57:23.007754 | d2cfb037-64b3-4655-90df-c5c01b0416a8 ==============================
[0m09:57:23.007754 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:57:23.008355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:57:23.591323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f598520>]}
[0m09:57:23.620904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f5991e0>]}
[0m09:57:23.621517 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:57:23.691782 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:57:23.858570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:23.858958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:23.888563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5efa0fd0>]}
[0m09:57:23.964039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f0818a0>]}
[0m09:57:23.964488 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:57:23.964896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f083190>]}
[0m09:57:23.966243 [info ] [MainThread]: 
[0m09:57:23.966719 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:57:23.970652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m09:57:23.979552 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m09:57:23.979927 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m09:57:23.980220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:24.386501 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.406 seconds
[0m09:57:24.390828 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m09:57:24.488905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:57:24.490165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m09:57:24.499835 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:57:24.504307 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:57:24.505103 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:57:24.505775 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:57:24.506360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:24.506900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:24.913495 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.407 seconds
[0m09:57:24.916732 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:57:24.944545 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.438 seconds
[0m09:57:24.946986 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:57:25.018856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f53fa30>]}
[0m09:57:25.019831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:25.020650 [info ] [MainThread]: 
[0m09:57:25.033456 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m09:57:25.034037 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m09:57:25.034554 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:57:25.035336 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m09:57:25.036201 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m09:57:25.036993 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m09:57:25.037735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m09:57:25.038393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m09:57:25.039079 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m09:57:25.039664 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m09:57:25.040227 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m09:57:25.040774 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:57:25.050368 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m09:57:25.053833 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:57:25.057292 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:57:25.059728 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m09:57:25.060579 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m09:57:25.086849 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m09:57:25.089189 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m09:57:25.089540 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:57:25.092178 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:57:25.093015 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m09:57:25.093987 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m09:57:25.093646 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m09:57:25.095307 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m09:57:25.094960 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m09:57:25.094370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:25.095621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:25.095969 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m09:57:25.096603 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:27.131730 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.036 seconds
[0m09:57:27.161922 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m09:57:27.256338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5db5b7f0>]}
[0m09:57:27.258013 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.22s]
[0m09:57:27.259251 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m09:57:27.396852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.302 seconds
[0m09:57:27.399602 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m09:57:27.480605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5db5bd60>]}
[0m09:57:27.481527 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.44s]
[0m09:57:27.482216 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m09:57:27.846805 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.750 seconds
[0m09:57:27.851222 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m09:57:28.092708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5db5bbe0>]}
[0m09:57:28.094886 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.05s]
[0m09:57:28.096829 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m09:57:28.099042 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m09:57:28.100138 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:57:28.101727 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m09:57:28.100878 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m09:57:28.099676 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:57:28.102507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m09:57:28.103324 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m09:57:28.104040 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m09:57:28.106196 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m09:57:28.105568 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m09:57:28.104925 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m09:57:28.106743 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:57:28.112499 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m09:57:28.117705 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:57:28.121133 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:57:28.124235 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m09:57:28.124765 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m09:57:28.128481 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:57:28.128929 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:57:28.132625 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m09:57:28.137091 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:57:28.138761 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m09:57:28.140099 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m09:57:28.141254 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day


    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day


from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m09:57:28.142739 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:57:28.142385 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m09:57:28.140603 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
--p.categories,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m09:57:28.143488 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m09:57:28.144134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:28.148676 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:29.487064 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m09:57:29.491756 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m09:57:29.584095 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5db27a30>]}
[0m09:57:29.586766 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.48s]
[0m09:57:29.588665 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m09:57:29.674891 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m09:57:29.678022 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m09:57:29.911648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.763 seconds
[0m09:57:29.916295 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m09:57:30.014397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5dbe1930>]}
[0m09:57:30.016676 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.91s]
[0m09:57:30.018607 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m09:57:30.613884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cfb037-64b3-4655-90df-c5c01b0416a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5dbdff40>]}
[0m09:57:30.616314 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 2.51s]
[0m09:57:30.618064 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m09:57:30.620971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:30.621702 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m09:57:30.622118 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m09:57:30.622448 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m09:57:30.622768 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m09:57:30.623450 [info ] [MainThread]: 
[0m09:57:30.624480 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m09:57:30.626894 [debug] [MainThread]: Command end result
[0m09:57:30.686075 [info ] [MainThread]: 
[0m09:57:30.687246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:30.687967 [info ] [MainThread]: 
[0m09:57:30.688797 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:57:30.692793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.717648, "process_user_time": 3.687554, "process_kernel_time": 0.443471, "process_mem_max_rss": "200292", "process_out_blocks": "2518", "process_in_blocks": "0"}
[0m09:57:30.694348 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:30.694129 after 7.72 seconds
[0m09:57:30.695430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807e42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa187f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f5991e0>]}
[0m09:57:30.696300 [debug] [MainThread]: Flushing usage events
[0m09:57:33.958807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a30340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e3e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e3e0e0>]}


============================== 09:57:33.962222 | c2258569-8ac7-4ad0-8834-77f79f0b0472 ==============================
[0m09:57:33.962222 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:57:33.962693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:57:34.457776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2258569-8ac7-4ad0-8834-77f79f0b0472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637b8ca0>]}
[0m09:57:34.491268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2258569-8ac7-4ad0-8834-77f79f0b0472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637b8c10>]}
[0m09:57:34.492198 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m09:57:34.556093 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:57:34.749027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:34.749428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:34.783319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2258569-8ac7-4ad0-8834-77f79f0b0472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631e4fd0>]}
[0m09:57:34.897996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2258569-8ac7-4ad0-8834-77f79f0b0472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631f5c30>]}
[0m09:57:34.898458 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m09:57:34.898771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2258569-8ac7-4ad0-8834-77f79f0b0472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631be650>]}
[0m09:57:34.901033 [info ] [MainThread]: 
[0m09:57:34.901514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:57:34.905049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m09:57:34.905824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m09:57:34.925825 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m09:57:34.929387 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m09:57:34.929685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:34.929049 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m09:57:34.930165 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m09:57:34.934209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:36.406190 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.471 seconds
[0m09:57:36.422138 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.492 seconds
[0m09:57:36.420847 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m09:57:36.426801 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m09:57:36.550211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2258569-8ac7-4ad0-8834-77f79f0b0472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6378ba30>]}
[0m09:57:36.552315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:36.552945 [info ] [MainThread]: 
[0m09:57:36.599585 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:57:36.600606 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:57:36.601203 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:57:36.601741 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:57:36.602176 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m09:57:36.602846 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m09:57:36.603562 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m09:57:36.604898 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m09:57:36.606061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m09:57:36.606955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m09:57:36.607470 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m09:57:36.607937 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m09:57:36.608408 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:57:36.608842 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:57:36.609406 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:57:36.609984 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:57:36.632330 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:57:36.640416 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:57:36.646693 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:57:36.652027 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:57:36.657476 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:57:36.658044 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:57:36.658360 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:57:36.701008 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:57:36.701886 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:57:36.702288 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:57:36.705334 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:57:36.710116 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:57:36.713744 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m09:57:36.714730 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m09:57:36.715849 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m09:57:36.716806 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m09:57:36.717743 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m09:57:36.718126 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m09:57:36.720455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:36.719459 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m09:57:36.719964 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m09:57:36.718926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:36.722409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:36.723135 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:57:38.431447 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.711 seconds
[0m09:57:38.451940 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.731 seconds
[0m09:57:38.485824 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m09:57:38.486315 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m09:57:38.572158 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 1.96s]
[0m09:57:38.573491 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m09:57:38.574301 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:57:38.575378 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m09:57:38.576120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m09:57:38.577036 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:57:38.586702 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:57:38.589101 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 1.98s]
[0m09:57:38.589822 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m09:57:38.590274 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:57:38.590942 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m09:57:38.591340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m09:57:38.591645 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:57:38.590691 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:57:38.596661 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:57:38.599962 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:57:38.601008 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:57:38.601795 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m09:57:38.605805 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m09:57:38.606225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:38.605234 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:57:38.612600 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m09:57:38.615277 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m09:57:38.615558 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:57:38.626593 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.904 seconds
[0m09:57:38.631271 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m09:57:38.705857 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 2.10s]
[0m09:57:38.710376 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m09:57:38.711032 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:57:38.711609 [info ] [Thread-4 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m09:57:38.712524 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m09:57:38.713126 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:57:38.720407 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:57:38.722036 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:57:38.726608 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:57:38.727737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.005 seconds
[0m09:57:38.730362 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m09:57:38.731213 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m09:57:38.734433 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m09:57:38.735191 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:57:38.818963 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 2.21s]
[0m09:57:38.819726 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m09:57:38.820183 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:57:38.820837 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m09:57:38.821573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m09:57:38.821920 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:57:38.828768 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:57:38.829721 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:57:38.832558 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:57:38.833738 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m09:57:38.834050 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:57:38.834349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:39.247485 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m09:57:39.252047 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m09:57:39.287558 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m09:57:39.291036 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m09:57:39.361901 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.77s]
[0m09:57:39.363835 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m09:57:39.378747 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.80s]
[0m09:57:39.379760 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m09:57:40.033822 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.299 seconds
[0m09:57:40.035793 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m09:57:40.121454 [info ] [Thread-4 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 1.41s]
[0m09:57:40.122289 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m09:57:40.273995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.439 seconds
[0m09:57:40.276690 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m09:57:40.344397 [error] [Thread-1 (]: 8 of 8 FAIL 7407 unique_stg_reviews_review_id .................................. [[31mFAIL 7407[0m in 1.52s]
[0m09:57:40.345524 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m09:57:40.348933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:40.349764 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m09:57:40.350268 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m09:57:40.350736 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m09:57:40.351187 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m09:57:40.351853 [info ] [MainThread]: 
[0m09:57:40.352579 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m09:57:40.354517 [debug] [MainThread]: Command end result
[0m09:57:40.419523 [info ] [MainThread]: 
[0m09:57:40.420005 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:57:40.420373 [info ] [MainThread]: 
[0m09:57:40.420841 [error] [MainThread]: [31mFailure in test unique_stg_reviews_review_id (models/staging/schema.yml)[0m
[0m09:57:40.421213 [error] [MainThread]:   Got 7407 results, configured to fail if != 0
[0m09:57:40.421475 [info ] [MainThread]: 
[0m09:57:40.421778 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m09:57:40.422134 [info ] [MainThread]: 
[0m09:57:40.422563 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:57:40.424706 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.494119, "process_user_time": 4.699464, "process_kernel_time": 0.598056, "process_mem_max_rss": "202288", "process_out_blocks": "2520", "command_success": false, "process_in_blocks": "0"}
[0m09:57:40.425439 [debug] [MainThread]: Command `dbt test` failed at 09:57:40.425379 after 6.49 seconds
[0m09:57:40.425869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a30340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637b8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84471c90>]}
[0m09:57:40.426224 [debug] [MainThread]: Flushing usage events
[0m11:11:15.137195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89060310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87439ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87439f90>]}


============================== 11:11:15.145489 | 35cdd819-078e-4abb-a394-04ae01485ce7 ==============================
[0m11:11:15.145489 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:11:15.146062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:15.161876 [info ] [MainThread]: dbt version: 1.8.3
[0m11:11:15.162369 [info ] [MainThread]: python version: 3.10.14
[0m11:11:15.162666 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:11:15.162986 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:11:16.388796 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:11:16.389563 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:11:16.390019 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:11:16.390569 [info ] [MainThread]: adapter type: snowflake
[0m11:11:16.390929 [info ] [MainThread]: adapter version: 1.8.2
[0m11:11:16.464649 [info ] [MainThread]: Configuration:
[0m11:11:16.465179 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:11:16.465483 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:11:16.465776 [info ] [MainThread]: Required dependencies:
[0m11:11:16.466121 [debug] [MainThread]: Executing "git --help"
[0m11:11:16.483234 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:11:16.483702 [debug] [MainThread]: STDERR: "b''"
[0m11:11:16.483985 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:11:16.484265 [info ] [MainThread]: Connection:
[0m11:11:16.484557 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:11:16.484834 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:11:16.485109 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:11:16.485351 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:11:16.485597 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:11:16.485816 [info ] [MainThread]:   schema: STAGE
[0m11:11:16.486102 [info ] [MainThread]:   authenticator: jwt
[0m11:11:16.486352 [info ] [MainThread]:   oauth_client_id: None
[0m11:11:16.486663 [info ] [MainThread]:   query_tag: None
[0m11:11:16.486931 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:11:16.487206 [info ] [MainThread]:   host: None
[0m11:11:16.487463 [info ] [MainThread]:   port: None
[0m11:11:16.487728 [info ] [MainThread]:   proxy_host: None
[0m11:11:16.488002 [info ] [MainThread]:   proxy_port: None
[0m11:11:16.488240 [info ] [MainThread]:   protocol: None
[0m11:11:16.488450 [info ] [MainThread]:   connect_retries: 1
[0m11:11:16.488659 [info ] [MainThread]:   connect_timeout: None
[0m11:11:16.488862 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:11:16.489075 [info ] [MainThread]:   retry_all: False
[0m11:11:16.489276 [info ] [MainThread]:   insecure_mode: False
[0m11:11:16.489490 [info ] [MainThread]:   reuse_connections: None
[0m11:11:16.489874 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:11:16.574127 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:11:16.575562 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:11:16.575867 [debug] [MainThread]: On debug: select 1 as id
[0m11:11:16.576625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:17.349533 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.773 seconds
[0m11:11:17.352146 [debug] [MainThread]: On debug: Close
[0m11:11:17.454812 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:11:17.455849 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:11:17.457797 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3684216, "process_user_time": 2.54721, "process_kernel_time": 1.979149, "process_mem_max_rss": "183092", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:11:17.458761 [debug] [MainThread]: Command `dbt debug` succeeded at 11:11:17.458591 after 2.37 seconds
[0m11:11:17.459348 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:11:17.460035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89060310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88276ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87477430>]}
[0m11:11:17.460674 [debug] [MainThread]: Flushing usage events
[0m11:11:20.742814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbb0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af3e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af3dfc0>]}


============================== 11:11:20.750711 | 0164557a-806b-452d-904b-d9d25a204711 ==============================
[0m11:11:20.750711 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:11:20.751514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:20.877688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0164557a-806b-452d-904b-d9d25a204711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbd3ee0>]}
[0m11:11:21.085863 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qzmhcq7f'
[0m11:11:21.091516 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:11:21.296451 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:11:21.299064 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:11:21.393435 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:11:21.399256 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:11:22.019705 [info ] [MainThread]: Installed from version 1.1.1
[0m11:11:22.021609 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:11:22.022952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0164557a-806b-452d-904b-d9d25a204711', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4f9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae93d30>]}
[0m11:11:22.024000 [info ] [MainThread]: 
[0m11:11:22.024458 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:11:22.027077 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3334689, "process_user_time": 1.587696, "process_kernel_time": 0.518263, "process_mem_max_rss": "95036", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:11:22.028160 [debug] [MainThread]: Command `dbt deps` succeeded at 11:11:22.028025 after 1.33 seconds
[0m11:11:22.028896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbb0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c511ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c552890>]}
[0m11:11:22.029361 [debug] [MainThread]: Flushing usage events
[0m11:11:27.110444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a16200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a161a0>]}


============================== 11:11:27.116691 | b2f65c92-b718-42fe-9f0d-82cf599008de ==============================
[0m11:11:27.116691 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:11:27.117593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:11:27.819857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff633a6560>]}
[0m11:11:27.850038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63374cd0>]}
[0m11:11:27.850797 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:11:27.916565 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:11:28.082624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:11:28.083209 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/mart_product_kpi.sql
[0m11:11:28.083555 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m11:11:28.083876 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews_granular.sql
[0m11:11:28.236456 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:11:28.236992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62e016f0>]}
[0m11:11:28.344953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff625bffd0>]}
[0m11:11:28.423461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62ea34c0>]}
[0m11:11:28.423900 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:11:28.424255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62ea21a0>]}
[0m11:11:28.425495 [info ] [MainThread]: 
[0m11:11:28.425957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:28.429029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:11:28.438047 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:11:28.438445 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:11:28.438723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:29.358975 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.920 seconds
[0m11:11:29.367262 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:11:29.453797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:11:29.454482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:11:29.465124 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:11:29.470012 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:11:29.470301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:29.469576 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:11:29.470771 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:11:29.474037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:30.078104 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.608 seconds
[0m11:11:30.081716 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:11:30.186048 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.712 seconds
[0m11:11:30.191580 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:11:30.313872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847167d0>]}
[0m11:11:30.315422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:30.316234 [info ] [MainThread]: 
[0m11:11:30.328653 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:11:30.329275 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:11:30.330211 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:11:30.331059 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:11:30.331872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m11:11:30.333285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m11:11:30.333851 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:11:30.334518 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:11:30.346440 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:11:30.352645 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:11:30.355722 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:11:30.363598 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:11:30.382192 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:11:30.384883 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:11:30.387284 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:11:30.388635 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:11:30.389012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:30.388375 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:11:30.389589 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select

md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:11:30.393104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:11:30.998357 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m11:11:31.000584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m11:11:31.028405 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:11:31.030795 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:11:31.156096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62c38070>]}
[0m11:11:31.160649 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.82s]
[0m11:11:31.164547 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:11:31.316366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f65c92-b718-42fe-9f0d-82cf599008de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61929f90>]}
[0m11:11:31.318226 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m11:11:31.319503 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:11:31.326818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:31.327394 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:11:31.327688 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:11:31.328169 [info ] [MainThread]: 
[0m11:11:31.328571 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m11:11:31.329717 [debug] [MainThread]: Command end result
[0m11:11:31.378659 [info ] [MainThread]: 
[0m11:11:31.379472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:31.379899 [info ] [MainThread]: 
[0m11:11:31.380392 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:11:31.383729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3063264, "process_user_time": 3.762377, "process_kernel_time": 0.505044, "process_mem_max_rss": "200276", "process_out_blocks": "3688", "process_in_blocks": "0"}
[0m11:11:31.384720 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:31.384606 after 4.31 seconds
[0m11:11:31.385293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838399c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63374cd0>]}
[0m11:11:31.385767 [debug] [MainThread]: Flushing usage events
[0m11:11:33.967142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee7c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d23e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d23e0b0>]}


============================== 11:11:33.971461 | 2030cbcc-914b-4c9e-bc5c-4cadd5879754 ==============================
[0m11:11:33.971461 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:11:33.972118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:11:34.510150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b93b20>]}
[0m11:11:34.539945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bed8d0>]}
[0m11:11:34.540561 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:11:34.603393 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:11:34.743771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:34.744157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:34.773603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815f4fa0>]}
[0m11:11:34.847206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816dc1c0>]}
[0m11:11:34.847628 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:11:34.847908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816dd840>]}
[0m11:11:34.849073 [info ] [MainThread]: 
[0m11:11:34.849556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:34.853625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:11:34.864562 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:11:34.864974 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:11:34.865314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:35.320259 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.455 seconds
[0m11:11:35.325472 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:11:35.444497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:11:35.446080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:11:35.456081 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:11:35.461261 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:11:35.461950 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:11:35.462541 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:11:35.463126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:35.463603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:35.933596 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.470 seconds
[0m11:11:35.938065 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:11:35.959114 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.495 seconds
[0m11:11:35.960964 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:11:36.067097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b93df0>]}
[0m11:11:36.068585 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:36.070220 [info ] [MainThread]: 
[0m11:11:36.088667 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:11:36.089272 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:11:36.089805 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:11:36.090652 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:11:36.091458 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:11:36.092198 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:11:36.092953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m11:11:36.093575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m11:11:36.094311 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:11:36.094940 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:11:36.095508 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:11:36.096043 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:11:36.104957 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:11:36.108377 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:11:36.111407 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:11:36.114102 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:11:36.114623 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:11:36.123622 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:11:36.139622 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:11:36.142143 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:11:36.144357 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:11:36.146479 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:11:36.147046 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:11:36.147598 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:11:36.147862 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:11:36.148243 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:11:36.148606 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:11:36.148939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:11:36.149214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:36.149528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:11:38.266321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.117 seconds
[0m11:11:38.296397 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:11:38.402058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b92560>]}
[0m11:11:38.403412 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.31s]
[0m11:11:38.404865 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:11:38.677066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.528 seconds
[0m11:11:38.680949 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:11:38.765160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801189d0>]}
[0m11:11:38.766445 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.67s]
[0m11:11:38.767674 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:11:39.294403 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.144 seconds
[0m11:11:39.300064 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:11:39.401543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80157a30>]}
[0m11:11:39.404403 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.31s]
[0m11:11:39.406225 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:11:39.408296 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:11:39.409452 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:11:39.408985 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:11:39.410287 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:11:39.411073 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:11:39.413420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:11:39.412740 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:11:39.411833 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:11:39.415155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:11:39.414570 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:11:39.413985 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:11:39.415568 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:11:39.421226 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:11:39.426304 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:11:39.429819 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:11:39.433221 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:11:39.433739 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:11:39.437623 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:11:39.438132 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:11:39.441361 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:11:39.445681 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:11:39.447237 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:11:39.448775 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day


    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day


from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:11:39.450097 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:11:39.450498 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:11:39.451592 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:11:39.452070 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:11:39.452978 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:11:39.457270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:39.457814 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:11:39.938306 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c2623f-0306-198a-0004-85da0005e5fa
[0m11:11:39.939708 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2623f-0306-19bc-0004-85da0005f21a
[0m11:11:39.940829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c2623f-0306-1875-0004-85da0005baca
[0m11:11:39.942562 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 18
invalid identifier 'REVIEW_TIME'
[0m11:11:39.944649 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 0
invalid identifier 'R.REVIEW_TIME'
[0m11:11:39.945531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 4
invalid identifier 'REVIEW_TIME'
[0m11:11:39.946624 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:11:39.947748 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:11:39.948939 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:11:40.037823 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 14 at position 18
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m11:11:40.038938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80108f10>]}
[0m11:11:40.039891 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 0.63s]
[0m11:11:40.042235 [debug] [Thread-2 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'R.REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m11:11:40.043274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801747c0>]}
[0m11:11:40.043738 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.63s]
[0m11:11:40.044285 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:11:40.042807 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:11:40.065031 [debug] [Thread-1 (]: Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m11:11:40.065978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2030cbcc-914b-4c9e-bc5c-4cadd5879754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801c99f0>]}
[0m11:11:40.066644 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model STAGE_MART.mart_product_kpi .............. [[31mERROR[0m in 0.65s]
[0m11:11:40.067302 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:11:40.070461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:40.071350 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:11:40.071678 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:11:40.071972 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m11:11:40.072237 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:11:40.072727 [info ] [MainThread]: 
[0m11:11:40.073121 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m11:11:40.074124 [debug] [MainThread]: Command end result
[0m11:11:40.107957 [info ] [MainThread]: 
[0m11:11:40.108507 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:11:40.108838 [info ] [MainThread]: 
[0m11:11:40.109246 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'R.REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m11:11:40.109546 [info ] [MainThread]: 
[0m11:11:40.109832 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 14 at position 18
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m11:11:40.110099 [info ] [MainThread]: 
[0m11:11:40.110390 [error] [MainThread]:   Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m11:11:40.110653 [info ] [MainThread]: 
[0m11:11:40.111001 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m11:11:40.112587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.178051, "process_user_time": 3.637155, "process_kernel_time": 0.324872, "process_mem_max_rss": "197368", "process_out_blocks": "2524", "command_success": false, "process_in_blocks": "0"}
[0m11:11:40.113242 [debug] [MainThread]: Command `dbt run` failed at 11:11:40.113174 after 6.18 seconds
[0m11:11:40.113759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee7c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bed8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b9bf10>]}
[0m11:11:40.114107 [debug] [MainThread]: Flushing usage events
[0m11:16:47.937323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa360e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa360dff0>]}


============================== 11:16:47.944334 | af38eb30-e554-4d96-ad5d-16e737f192e0 ==============================
[0m11:16:47.944334 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:16:47.945124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m11:16:47.973276 [info ] [MainThread]: dbt version: 1.8.3
[0m11:16:47.973744 [info ] [MainThread]: python version: 3.10.14
[0m11:16:47.974101 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:16:47.974447 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:16:49.486635 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:16:49.487856 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:16:49.488301 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:16:49.488954 [info ] [MainThread]: adapter type: snowflake
[0m11:16:49.489349 [info ] [MainThread]: adapter version: 1.8.2
[0m11:16:49.566681 [info ] [MainThread]: Configuration:
[0m11:16:49.567305 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:16:49.567622 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:16:49.567946 [info ] [MainThread]: Required dependencies:
[0m11:16:49.568321 [debug] [MainThread]: Executing "git --help"
[0m11:16:49.594198 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:16:49.594827 [debug] [MainThread]: STDERR: "b''"
[0m11:16:49.595097 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:16:49.595694 [info ] [MainThread]: Connection:
[0m11:16:49.596058 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:16:49.596384 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:16:49.596721 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:16:49.597056 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:16:49.597307 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:16:49.597535 [info ] [MainThread]:   schema: STAGE
[0m11:16:49.597804 [info ] [MainThread]:   authenticator: jwt
[0m11:16:49.598239 [info ] [MainThread]:   oauth_client_id: None
[0m11:16:49.598596 [info ] [MainThread]:   query_tag: None
[0m11:16:49.598916 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:16:49.599198 [info ] [MainThread]:   host: None
[0m11:16:49.599451 [info ] [MainThread]:   port: None
[0m11:16:49.599766 [info ] [MainThread]:   proxy_host: None
[0m11:16:49.600512 [info ] [MainThread]:   proxy_port: None
[0m11:16:49.600811 [info ] [MainThread]:   protocol: None
[0m11:16:49.601069 [info ] [MainThread]:   connect_retries: 1
[0m11:16:49.601300 [info ] [MainThread]:   connect_timeout: None
[0m11:16:49.601547 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:16:49.601785 [info ] [MainThread]:   retry_all: False
[0m11:16:49.602009 [info ] [MainThread]:   insecure_mode: False
[0m11:16:49.602264 [info ] [MainThread]:   reuse_connections: None
[0m11:16:49.602825 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:16:49.692683 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:16:49.693699 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:16:49.694014 [debug] [MainThread]: On debug: select 1 as id
[0m11:16:49.694314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:50.333309 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.639 seconds
[0m11:16:50.336358 [debug] [MainThread]: On debug: Close
[0m11:16:50.427430 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:16:50.435334 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:16:50.441229 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.5515883, "process_user_time": 2.808787, "process_kernel_time": 1.85341, "process_mem_max_rss": "186784", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:16:50.444791 [debug] [MainThread]: Command `dbt debug` succeeded at 11:16:50.444537 after 2.56 seconds
[0m11:16:50.445743 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:16:50.449067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa441af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d64c70>]}
[0m11:16:50.450012 [debug] [MainThread]: Flushing usage events
[0m11:16:53.527406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95980370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d36050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d35ff0>]}


============================== 11:16:53.537169 | 926834a1-f73a-4ff2-84e6-300a7fc57131 ==============================
[0m11:16:53.537169 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:16:53.537644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:16:53.621725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '926834a1-f73a-4ff2-84e6-300a7fc57131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959afeb0>]}
[0m11:16:53.715724 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pvlpypp7'
[0m11:16:53.716257 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:16:54.906115 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:16:54.941116 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:16:55.173329 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:16:55.203374 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:16:55.800414 [info ] [MainThread]: Installed from version 1.1.1
[0m11:16:55.805251 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:16:55.807711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '926834a1-f73a-4ff2-84e6-300a7fc57131', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c8fd00>]}
[0m11:16:55.810295 [info ] [MainThread]: 
[0m11:16:55.811012 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:16:55.818648 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.32088, "process_user_time": 2.010992, "process_kernel_time": 0.491293, "process_mem_max_rss": "95140", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:16:55.819839 [debug] [MainThread]: Command `dbt deps` succeeded at 11:16:55.819656 after 2.32 seconds
[0m11:16:55.820452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95980370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9532c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d54e0>]}
[0m11:16:55.820809 [debug] [MainThread]: Flushing usage events
[0m11:16:58.745107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b2a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b2a1a0>]}


============================== 11:16:58.748712 | 34eff1b2-5b99-4c13-bcfa-ddb875f383cf ==============================
[0m11:16:58.748712 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:16:58.749292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:16:59.467629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954ee560>]}
[0m11:16:59.500777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954c3d00>]}
[0m11:16:59.501435 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:16:59.573413 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:16:59.753072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:16:59.753670 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_date.sql
[0m11:16:59.941030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e3d5d0>]}
[0m11:17:00.035956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fe5f00>]}
[0m11:17:00.036762 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:17:00.037210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fe5300>]}
[0m11:17:00.038586 [info ] [MainThread]: 
[0m11:17:00.039203 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:17:00.043194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:17:00.058002 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:17:00.058633 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:17:00.059017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:00.509161 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.450 seconds
[0m11:17:00.511992 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:17:00.579332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m11:17:00.582145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:17:00.590904 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:17:00.594565 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:17:00.595113 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:17:00.595463 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:17:00.595799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:00.596113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:01.057202 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.461 seconds
[0m11:17:01.059860 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:17:01.090002 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.494 seconds
[0m11:17:01.094218 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:17:01.182842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9548bd30>]}
[0m11:17:01.183944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:01.185027 [info ] [MainThread]: 
[0m11:17:01.213150 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:17:01.214435 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:17:01.216814 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:17:01.219091 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:17:01.220274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m11:17:01.222509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m11:17:01.224107 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:17:01.225028 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:17:01.246331 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:17:01.290007 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:17:01.290821 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:17:01.307197 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:17:01.337594 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:17:01.340947 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:17:01.342785 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:17:01.344302 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:17:01.344969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:01.343906 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:17:01.346120 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select

md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:17:01.350904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:17:02.156807 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m11:17:02.180299 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:17:02.288429 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9548a650>]}
[0m11:17:02.290182 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m11:17:02.291920 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:17:02.456144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m11:17:02.460066 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:17:02.534218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34eff1b2-5b99-4c13-bcfa-ddb875f383cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945a79a0>]}
[0m11:17:02.535060 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.31s]
[0m11:17:02.535688 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:17:02.537582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:02.538028 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:17:02.538305 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:17:02.538720 [info ] [MainThread]: 
[0m11:17:02.539077 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m11:17:02.539874 [debug] [MainThread]: Command end result
[0m11:17:02.585026 [info ] [MainThread]: 
[0m11:17:02.585515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:02.585837 [info ] [MainThread]: 
[0m11:17:02.586186 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:17:02.588213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8726697, "process_user_time": 3.579874, "process_kernel_time": 0.66997, "process_mem_max_rss": "201124", "process_out_blocks": "3690", "process_in_blocks": "0"}
[0m11:17:02.588923 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:02.588849 after 3.87 seconds
[0m11:17:02.589358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb103a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954c3d00>]}
[0m11:17:02.589688 [debug] [MainThread]: Flushing usage events
[0m11:17:06.981872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951e4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935461a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93546140>]}


============================== 11:17:06.986179 | 96d508a3-d9a4-4961-8c68-971826e91add ==============================
[0m11:17:06.986179 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:17:06.986847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:17:07.547400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95207ee0>]}
[0m11:17:07.577624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e5f340>]}
[0m11:17:07.578307 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:17:07.640645 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:17:07.874317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:07.875001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:07.906760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7398d030>]}
[0m11:17:07.988677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a74c10>]}
[0m11:17:07.989192 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:17:07.989633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a75ea0>]}
[0m11:17:07.991309 [info ] [MainThread]: 
[0m11:17:07.991958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:17:07.996768 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:17:08.007090 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:17:08.007529 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:17:08.007800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:08.407919 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.400 seconds
[0m11:17:08.411649 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:17:08.510839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:17:08.512285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:17:08.525031 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:17:08.529191 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:17:08.530038 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:17:08.530709 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:17:08.531457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:08.532019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:08.896397 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.365 seconds
[0m11:17:08.899605 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:17:08.915070 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.383 seconds
[0m11:17:08.917114 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:17:09.029461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e5f850>]}
[0m11:17:09.030912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:09.031581 [info ] [MainThread]: 
[0m11:17:09.046268 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:17:09.047254 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:17:09.047756 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:17:09.048649 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:17:09.049493 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:17:09.050360 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:17:09.051088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m11:17:09.051716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m11:17:09.052399 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:17:09.052866 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:17:09.053327 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:17:09.053765 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:17:09.063302 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:17:09.066896 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:17:09.070265 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:17:09.072725 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:17:09.073175 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:17:09.086131 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:17:09.100925 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:17:09.098768 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:17:09.103452 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:17:09.105098 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:17:09.105719 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:17:09.106970 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:17:09.106620 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:17:09.106088 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:17:09.107265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:09.107591 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:17:09.107945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:17:09.109843 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:17:11.441447 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.328 seconds
[0m11:17:11.566867 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:17:11.632551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.525 seconds
[0m11:17:11.637136 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:17:11.648746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d53550>]}
[0m11:17:11.650928 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.60s]
[0m11:17:11.655785 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:17:11.734625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739da560>]}
[0m11:17:11.735776 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.68s]
[0m11:17:11.736657 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:17:11.995597 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.886 seconds
[0m11:17:11.998579 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:17:12.079281 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d53940>]}
[0m11:17:12.080388 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.03s]
[0m11:17:12.081280 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:17:12.084084 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:17:12.084650 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:17:12.085067 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:17:12.085781 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:17:12.086497 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:17:12.087272 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:17:12.088221 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:17:12.088902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:17:12.094250 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:17:12.091196 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:17:12.089682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:17:12.120305 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:17:12.124400 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:17:12.125521 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:17:12.131481 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:17:12.133636 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:17:12.134039 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:17:12.140662 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:17:12.141555 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:17:12.146239 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:17:12.149270 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:17:12.150520 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:17:12.151605 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:17:12.153477 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:17:12.154817 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:17:12.156339 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:17:12.158230 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:17:12.162951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:12.156872 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:17:12.163852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:17:12.688774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26245-0306-19bc-0004-85da0005f226
[0m11:17:12.689656 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 4
invalid identifier 'REVIEW_TIME'
[0m11:17:12.690313 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:17:12.725905 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c26245-0306-1845-0004-85da0005ac82
[0m11:17:12.726825 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'REVIEW_TIME'
[0m11:17:12.727550 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:17:12.762142 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c26245-0306-198a-0004-85da0005e60a
[0m11:17:12.762875 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 0
invalid identifier 'R.REVIEW_TIME'
[0m11:17:12.763558 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:17:12.791200 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m11:17:12.792122 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff737e6470>]}
[0m11:17:12.793003 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 0.70s]
[0m11:17:12.794046 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:17:12.825593 [debug] [Thread-1 (]: Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m11:17:12.826536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d70370>]}
[0m11:17:12.827492 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model STAGE_MART.mart_product_kpi .............. [[31mERROR[0m in 0.74s]
[0m11:17:12.828392 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:17:12.847202 [debug] [Thread-2 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'R.REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m11:17:12.848390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d508a3-d9a4-4961-8c68-971826e91add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d1f760>]}
[0m11:17:12.849899 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.76s]
[0m11:17:12.850663 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:17:12.854692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:12.855331 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:17:12.855811 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:17:12.856268 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m11:17:12.856700 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:17:12.857492 [info ] [MainThread]: 
[0m11:17:12.858173 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m11:17:12.860462 [debug] [MainThread]: Command end result
[0m11:17:12.913014 [info ] [MainThread]: 
[0m11:17:12.913615 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:17:12.913970 [info ] [MainThread]: 
[0m11:17:12.914363 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m11:17:12.914674 [info ] [MainThread]: 
[0m11:17:12.915024 [error] [MainThread]:   Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m11:17:12.915324 [info ] [MainThread]: 
[0m11:17:12.915632 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'R.REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m11:17:12.916035 [info ] [MainThread]: 
[0m11:17:12.916457 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m11:17:12.919928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9858937, "process_user_time": 3.921065, "process_kernel_time": 0.360977, "process_mem_max_rss": "200968", "process_out_blocks": "2524", "command_success": false, "process_in_blocks": "0"}
[0m11:17:12.920721 [debug] [MainThread]: Command `dbt run` failed at 11:17:12.920646 after 5.99 seconds
[0m11:17:12.921219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951e4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94419510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73afe710>]}
[0m11:17:12.921581 [debug] [MainThread]: Flushing usage events
[0m11:18:00.718364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb584a080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb584a020>]}


============================== 11:18:00.723062 | c6cdf7eb-9262-4c01-8a04-32d5ef4bea93 ==============================
[0m11:18:00.723062 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:18:00.723612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:00.732043 [info ] [MainThread]: dbt version: 1.8.3
[0m11:18:00.732570 [info ] [MainThread]: python version: 3.10.14
[0m11:18:00.733022 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:18:00.733343 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:18:01.527815 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:18:01.528605 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:18:01.529015 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:18:01.529536 [info ] [MainThread]: adapter type: snowflake
[0m11:18:01.529832 [info ] [MainThread]: adapter version: 1.8.2
[0m11:18:01.590231 [info ] [MainThread]: Configuration:
[0m11:18:01.590870 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:18:01.591203 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:18:01.591491 [info ] [MainThread]: Required dependencies:
[0m11:18:01.591872 [debug] [MainThread]: Executing "git --help"
[0m11:18:01.598432 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:18:01.598948 [debug] [MainThread]: STDERR: "b''"
[0m11:18:01.599220 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:18:01.599527 [info ] [MainThread]: Connection:
[0m11:18:01.599835 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:18:01.600086 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:18:01.600350 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:18:01.600648 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:18:01.600925 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:18:01.601141 [info ] [MainThread]:   schema: STAGE
[0m11:18:01.601360 [info ] [MainThread]:   authenticator: jwt
[0m11:18:01.601567 [info ] [MainThread]:   oauth_client_id: None
[0m11:18:01.601821 [info ] [MainThread]:   query_tag: None
[0m11:18:01.602108 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:18:01.602345 [info ] [MainThread]:   host: None
[0m11:18:01.602556 [info ] [MainThread]:   port: None
[0m11:18:01.602794 [info ] [MainThread]:   proxy_host: None
[0m11:18:01.603042 [info ] [MainThread]:   proxy_port: None
[0m11:18:01.603288 [info ] [MainThread]:   protocol: None
[0m11:18:01.603575 [info ] [MainThread]:   connect_retries: 1
[0m11:18:01.603843 [info ] [MainThread]:   connect_timeout: None
[0m11:18:01.604126 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:18:01.604349 [info ] [MainThread]:   retry_all: False
[0m11:18:01.604599 [info ] [MainThread]:   insecure_mode: False
[0m11:18:01.604833 [info ] [MainThread]:   reuse_connections: None
[0m11:18:01.605298 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:18:01.687306 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:18:01.688365 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:18:01.688686 [debug] [MainThread]: On debug: select 1 as id
[0m11:18:01.688932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:02.304466 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.615 seconds
[0m11:18:02.306691 [debug] [MainThread]: On debug: Close
[0m11:18:02.426045 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:18:02.427747 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:18:02.431042 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7496264, "process_user_time": 2.685822, "process_kernel_time": 0.613385, "process_mem_max_rss": "186812", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:18:02.432142 [debug] [MainThread]: Command `dbt debug` succeeded at 11:18:02.431969 after 1.75 seconds
[0m11:18:02.432874 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:18:02.433530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96711f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59ee560>]}
[0m11:18:02.434245 [debug] [MainThread]: Flushing usage events
[0m11:18:05.433710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbd4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f3a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f39ff0>]}


============================== 11:18:05.437883 | ec65e9e8-432f-4b35-af17-5f96b91a5f48 ==============================
[0m11:18:05.437883 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:18:05.438393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:05.513450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec65e9e8-432f-4b35-af17-5f96b91a5f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc03eb0>]}
[0m11:18:05.581698 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_7en2aev'
[0m11:18:05.582220 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:18:05.726495 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:18:05.728232 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:18:05.973932 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:18:06.854588 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:18:07.738835 [info ] [MainThread]: Installed from version 1.1.1
[0m11:18:07.741852 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:18:07.745523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ec65e9e8-432f-4b35-af17-5f96b91a5f48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5294e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e93d00>]}
[0m11:18:07.747664 [info ] [MainThread]: 
[0m11:18:07.748668 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:18:07.756215 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.35114, "process_user_time": 2.237371, "process_kernel_time": 0.5064, "process_mem_max_rss": "95292", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:18:07.757899 [debug] [MainThread]: Command `dbt deps` succeeded at 11:18:07.757703 after 2.35 seconds
[0m11:18:07.758890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbd4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b580160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5294e0>]}
[0m11:18:07.759338 [debug] [MainThread]: Flushing usage events
[0m11:18:10.829622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5543d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a956170>]}


============================== 11:18:10.833861 | 1e2f1c3e-46e4-4194-8d74-dcb96b61366e ==============================
[0m11:18:10.833861 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:18:10.834493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m11:18:11.720692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aabfdf0>]}
[0m11:18:11.765709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b2bcd60>]}
[0m11:18:11.766623 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:18:11.873554 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:18:12.057084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:12.057717 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/dim_date.sql
[0m11:18:12.244290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ac3d600>]}
[0m11:18:12.371966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5add5ff0>]}
[0m11:18:12.372839 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:18:12.373291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5add5390>]}
[0m11:18:12.375022 [info ] [MainThread]: 
[0m11:18:12.375679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:12.379415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:18:12.389222 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:18:12.389656 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:18:12.389949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:12.924640 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.535 seconds
[0m11:18:12.978917 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:18:13.078720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:18:13.079695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:18:13.089339 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:18:13.093115 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:18:13.093810 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:18:13.094353 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:18:13.094821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:13.095251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:13.500558 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.405 seconds
[0m11:18:13.506075 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:18:13.507793 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.413 seconds
[0m11:18:13.512600 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:18:13.611756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b28f4c0>]}
[0m11:18:13.613278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:13.614285 [info ] [MainThread]: 
[0m11:18:13.628032 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:18:13.628738 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:18:13.629652 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:18:13.630420 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:18:13.631280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m11:18:13.631916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m11:18:13.632599 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:18:13.633200 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:18:13.642759 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:18:13.658618 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:18:13.660238 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:18:13.660756 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:18:13.686410 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:18:13.689241 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:18:13.690812 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:18:13.691222 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select

md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:18:13.692161 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:13.691855 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:18:13.692670 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:18:13.696699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:14.451694 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m11:18:14.453464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m11:18:14.490789 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:18:14.491617 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:18:14.578581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5acf36d0>]}
[0m11:18:14.579919 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m11:18:14.581493 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:18:14.616562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2f1c3e-46e4-4194-8d74-dcb96b61366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b28e680>]}
[0m11:18:14.618398 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.98s]
[0m11:18:14.619708 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:18:14.623021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:14.623810 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:18:14.624311 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:18:14.625050 [info ] [MainThread]: 
[0m11:18:14.625798 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m11:18:14.626792 [debug] [MainThread]: Command end result
[0m11:18:14.677118 [info ] [MainThread]: 
[0m11:18:14.677613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:14.677929 [info ] [MainThread]: 
[0m11:18:14.678277 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:18:14.679721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8842652, "process_user_time": 3.640245, "process_kernel_time": 0.386629, "process_mem_max_rss": "201184", "process_out_blocks": "3690", "process_in_blocks": "0"}
[0m11:18:14.680267 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:14.680208 after 3.88 seconds
[0m11:18:14.680643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aabfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b78bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a3fa950>]}
[0m11:18:14.680926 [debug] [MainThread]: Flushing usage events
[0m11:18:18.813917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0703a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99442200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994421a0>]}


============================== 11:18:18.817727 | 76016489-0391-4e62-8a8c-73666133ddd2 ==============================
[0m11:18:18.817727 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:18:18.818341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:18:19.454349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddf2560>]}
[0m11:18:19.485729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddc0cd0>]}
[0m11:18:19.486446 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:18:19.553226 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:18:19.703695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:19.704093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:19.733429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7f5090>]}
[0m11:18:19.812305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8ddde0>]}
[0m11:18:19.812802 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:18:19.813202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8dd720>]}
[0m11:18:19.814609 [info ] [MainThread]: 
[0m11:18:19.815192 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:19.818471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:18:19.828267 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:18:19.828663 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:18:19.828940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:20.303765 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.475 seconds
[0m11:18:20.306369 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:18:20.380479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:18:20.381452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:18:20.391179 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:18:20.394858 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:18:20.395650 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:18:20.396279 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:18:20.397107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:20.397662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:20.840336 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.443 seconds
[0m11:18:20.843270 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:18:20.861266 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.464 seconds
[0m11:18:20.863205 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:18:20.925041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd97d30>]}
[0m11:18:20.925962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:20.926726 [info ] [MainThread]: 
[0m11:18:20.937230 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:18:20.937763 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:18:20.938271 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:18:20.939106 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:18:20.940046 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:18:20.940862 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:18:20.941586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.dim_products)
[0m11:18:20.942291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.fct_reviews)
[0m11:18:20.943026 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:18:20.943586 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:18:20.944204 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:18:20.944778 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:18:20.953327 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:18:20.956217 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:18:20.959340 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:18:20.960714 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:18:20.968185 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:18:20.968499 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:18:20.986097 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:18:20.983952 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:18:20.988221 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:18:20.989556 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:18:20.990024 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:18:20.990886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:20.990564 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:18:20.991396 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:18:20.991846 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:18:20.992211 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:18:20.995769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:20.996094 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:18:22.862400 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.869 seconds
[0m11:18:22.898084 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:18:22.995874 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c347700>]}
[0m11:18:22.997659 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.05s]
[0m11:18:22.999368 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:18:23.202564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.207 seconds
[0m11:18:23.205974 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:18:23.275708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c353be0>]}
[0m11:18:23.276510 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.33s]
[0m11:18:23.277375 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:18:23.499647 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.503 seconds
[0m11:18:23.505389 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:18:23.580885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c347af0>]}
[0m11:18:23.582305 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.64s]
[0m11:18:23.583253 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:18:23.586233 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:18:23.586878 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:18:23.588855 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:18:23.588107 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:18:23.587342 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:18:23.591187 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:18:23.590522 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:18:23.589686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:18:23.593049 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:18:23.592520 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:18:23.591805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:18:23.600167 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:18:23.605771 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:18:23.606457 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:18:23.611743 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:18:23.612636 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:18:23.613051 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:18:23.616746 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:18:23.617499 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:18:23.621074 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:18:23.627123 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:18:23.628811 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:18:23.629626 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:18:23.631132 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:18:23.633124 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:18:23.632610 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:18:23.631492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:23.633733 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:18:23.634363 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:18:23.635628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:24.047077 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26246-0306-19e6-0004-85da00061036
[0m11:18:24.049680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 4
invalid identifier 'REVIEW_TIME'
[0m11:18:24.050389 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:18:24.048906 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c26246-0306-198a-0004-85da0005e616
[0m11:18:24.053851 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 0
invalid identifier 'REVIEW_TIME'
[0m11:18:24.054481 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:18:24.058150 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c26246-0306-19e6-0004-85da0006103a
[0m11:18:24.058805 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 0
invalid identifier 'R.REVIEW_TIME'
[0m11:18:24.059419 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:18:24.134242 [debug] [Thread-1 (]: Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m11:18:24.135139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3b2c50>]}
[0m11:18:24.135856 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model STAGE_MART.mart_product_kpi .............. [[31mERROR[0m in 0.54s]
[0m11:18:24.136685 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:18:24.157379 [debug] [Thread-4 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m11:18:24.158104 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c330910>]}
[0m11:18:24.158890 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model STAGE_MART.dim_date ...................... [[31mERROR[0m in 0.57s]
[0m11:18:24.159718 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:18:24.209968 [debug] [Thread-2 (]: Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'R.REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m11:18:24.210765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76016489-0391-4e62-8a8c-73666133ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c34c9a0>]}
[0m11:18:24.211873 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model STAGE_MART.mart_avg_rating_by_year_brand . [[31mERROR[0m in 0.62s]
[0m11:18:24.213970 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:18:24.217346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:24.218174 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:18:24.218690 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:18:24.219154 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m11:18:24.219562 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:18:24.221493 [info ] [MainThread]: 
[0m11:18:24.223213 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m11:18:24.225396 [debug] [MainThread]: Command end result
[0m11:18:24.279473 [info ] [MainThread]: 
[0m11:18:24.280226 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:18:24.280749 [info ] [MainThread]: 
[0m11:18:24.281279 [error] [MainThread]:   Database Error in model mart_product_kpi (models/marts/mart_product_kpi.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_product_kpi.sql
[0m11:18:24.281702 [info ] [MainThread]: 
[0m11:18:24.282165 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  000904 (42000): SQL compilation error: error line 11 at position 0
  invalid identifier 'REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/dim_date.sql
[0m11:18:24.282732 [info ] [MainThread]: 
[0m11:18:24.283301 [error] [MainThread]:   Database Error in model mart_avg_rating_by_year_brand (models/marts/mart_avg_rating_by_year_brand.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'R.REVIEW_TIME'
  compiled code at target/run/capstone_amazon_analytics/models/marts/mart_avg_rating_by_year_brand.sql
[0m11:18:24.283797 [info ] [MainThread]: 
[0m11:18:24.284310 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m11:18:24.287213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.5042734, "process_user_time": 3.543522, "process_kernel_time": 0.464569, "process_mem_max_rss": "201120", "process_out_blocks": "2524", "command_success": false, "process_in_blocks": "0"}
[0m11:18:24.288238 [debug] [MainThread]: Command `dbt run` failed at 11:18:24.288126 after 5.51 seconds
[0m11:18:24.288902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0703a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2869b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdf0ac0>]}
[0m11:18:24.289828 [debug] [MainThread]: Flushing usage events
[0m11:20:57.569681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae150340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac536020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac535fc0>]}


============================== 11:20:57.576609 | be93c4b4-8583-4c22-b10e-6a781b1f9065 ==============================
[0m11:20:57.576609 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:20:57.577051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m11:20:57.586165 [info ] [MainThread]: dbt version: 1.8.3
[0m11:20:57.586775 [info ] [MainThread]: python version: 3.10.14
[0m11:20:57.587231 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:20:57.587664 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:20:58.120392 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:20:58.120956 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:20:58.121251 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:20:58.121899 [info ] [MainThread]: adapter type: snowflake
[0m11:20:58.122206 [info ] [MainThread]: adapter version: 1.8.2
[0m11:20:58.176637 [info ] [MainThread]: Configuration:
[0m11:20:58.177111 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:20:58.177391 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:20:58.177626 [info ] [MainThread]: Required dependencies:
[0m11:20:58.177858 [debug] [MainThread]: Executing "git --help"
[0m11:20:58.183977 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:20:58.184359 [debug] [MainThread]: STDERR: "b''"
[0m11:20:58.184615 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:20:58.184894 [info ] [MainThread]: Connection:
[0m11:20:58.185188 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:20:58.185439 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:20:58.185682 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:20:58.185913 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:20:58.186129 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:20:58.186379 [info ] [MainThread]:   schema: STAGE
[0m11:20:58.186621 [info ] [MainThread]:   authenticator: jwt
[0m11:20:58.186837 [info ] [MainThread]:   oauth_client_id: None
[0m11:20:58.187055 [info ] [MainThread]:   query_tag: None
[0m11:20:58.187279 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:20:58.187537 [info ] [MainThread]:   host: None
[0m11:20:58.187779 [info ] [MainThread]:   port: None
[0m11:20:58.188052 [info ] [MainThread]:   proxy_host: None
[0m11:20:58.188277 [info ] [MainThread]:   proxy_port: None
[0m11:20:58.188506 [info ] [MainThread]:   protocol: None
[0m11:20:58.188711 [info ] [MainThread]:   connect_retries: 1
[0m11:20:58.188935 [info ] [MainThread]:   connect_timeout: None
[0m11:20:58.189184 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:20:58.189398 [info ] [MainThread]:   retry_all: False
[0m11:20:58.189601 [info ] [MainThread]:   insecure_mode: False
[0m11:20:58.189818 [info ] [MainThread]:   reuse_connections: None
[0m11:20:58.190136 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:20:58.246635 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:20:58.247302 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:20:58.247588 [debug] [MainThread]: On debug: select 1 as id
[0m11:20:58.247852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:58.742671 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.495 seconds
[0m11:20:58.744121 [debug] [MainThread]: On debug: Close
[0m11:20:58.840648 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:20:58.841920 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:20:58.843463 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3058114, "process_user_time": 2.325094, "process_kernel_time": 0.430346, "process_mem_max_rss": "182964", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:20:58.844305 [debug] [MainThread]: Command `dbt debug` succeeded at 11:20:58.844184 after 1.31 seconds
[0m11:20:58.844819 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:20:58.845389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae150340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae17fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f1e6b0>]}
[0m11:20:58.846008 [debug] [MainThread]: Flushing usage events
[0m11:21:03.218117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2c0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c64a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c649ff0>]}


============================== 11:21:03.222221 | 9ab80d8c-e86c-4bbe-a72a-d0eef6450b1b ==============================
[0m11:21:03.222221 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:21:03.222842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:21:03.323370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab80d8c-e86c-4bbe-a72a-d0eef6450b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2e3eb0>]}
[0m11:21:03.398694 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kypsu0ob'
[0m11:21:03.399428 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:21:03.564375 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:21:03.566026 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:21:03.642219 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:21:03.647524 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:21:04.097688 [info ] [MainThread]: Installed from version 1.1.1
[0m11:21:04.098551 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:21:04.099171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ab80d8c-e86c-4bbe-a72a-d0eef6450b1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc094e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5a3d00>]}
[0m11:21:04.099642 [info ] [MainThread]: 
[0m11:21:04.099970 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:21:04.101434 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9153156, "process_user_time": 1.220989, "process_kernel_time": 0.272106, "process_mem_max_rss": "95084", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:21:04.102026 [debug] [MainThread]: Command `dbt deps` succeeded at 11:21:04.101930 after 0.92 seconds
[0m11:21:04.102428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2c0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc60160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc094e0>]}
[0m11:21:04.102783 [debug] [MainThread]: Flushing usage events
[0m11:21:07.007988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e7c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9723e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9723e1a0>]}


============================== 11:21:07.011784 | dea3b70d-6c63-475a-b162-d1def2c3018b ==============================
[0m11:21:07.011784 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:21:07.012514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m11:21:07.554294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e9feb0>]}
[0m11:21:07.585432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b53a00>]}
[0m11:21:07.586103 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:21:07.649016 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:21:07.792275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:07.792805 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews_granular.sql
[0m11:21:07.937823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7753d5a0>]}
[0m11:21:08.018438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff776ce7a0>]}
[0m11:21:08.018944 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:21:08.019281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff776cd990>]}
[0m11:21:08.020659 [info ] [MainThread]: 
[0m11:21:08.021184 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:21:08.024459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:21:08.034194 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:21:08.034568 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:21:08.034826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:08.543369 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m11:21:08.547642 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:21:08.647953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:21:08.648851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:21:08.658790 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:21:08.662748 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:21:08.663492 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:21:08.664143 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:21:08.664687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:08.665239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:09.109905 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.444 seconds
[0m11:21:09.114863 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:21:09.124466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.460 seconds
[0m11:21:09.126638 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:21:09.192291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b53850>]}
[0m11:21:09.193305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:21:09.194280 [info ] [MainThread]: 
[0m11:21:09.208779 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:21:09.209586 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:21:09.210307 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:21:09.211082 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:21:09.211859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m11:21:09.212509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_reviews)
[0m11:21:09.213102 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:21:09.213679 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:21:09.223944 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:21:09.240662 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:21:09.242512 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:21:09.242979 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:21:09.267918 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:21:09.270735 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:21:09.272427 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:21:09.272864 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select

md5(cast(coalesce(cast(reviewer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,

product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:21:09.273531 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:21:09.273896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:21:09.274244 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:21:09.274814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:09.855545 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m11:21:09.886501 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:21:09.905991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m11:21:09.908884 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:21:09.965628 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b525f0>]}
[0m11:21:09.966694 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.75s]
[0m11:21:09.967719 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:21:09.983257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dea3b70d-6c63-475a-b162-d1def2c3018b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff775317b0>]}
[0m11:21:09.984203 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.77s]
[0m11:21:09.985351 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:21:09.987123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:09.987646 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:21:09.988102 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:21:09.988629 [info ] [MainThread]: 
[0m11:21:09.989271 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m11:21:09.990382 [debug] [MainThread]: Command end result
[0m11:21:10.037387 [info ] [MainThread]: 
[0m11:21:10.037957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:10.038422 [info ] [MainThread]: 
[0m11:21:10.038852 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:21:10.039946 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0649445, "process_user_time": 3.244451, "process_kernel_time": 0.323942, "process_mem_max_rss": "197224", "process_out_blocks": "3690", "process_in_blocks": "0"}
[0m11:21:10.040586 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:10.040502 after 3.07 seconds
[0m11:21:10.041006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e7c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980b23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76933760>]}
[0m11:21:10.041423 [debug] [MainThread]: Flushing usage events
[0m11:21:13.227974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa987c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c420e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c42080>]}


============================== 11:21:13.231585 | e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9 ==============================
[0m11:21:13.231585 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:21:13.232206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m11:21:13.757641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5f32e0>]}
[0m11:21:13.789286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5f18a0>]}
[0m11:21:13.790022 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:21:13.851363 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:21:13.992927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:13.993317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:14.022605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f88f70>]}
[0m11:21:14.097028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0df2e0>]}
[0m11:21:14.097490 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:21:14.097838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0dc580>]}
[0m11:21:14.099027 [info ] [MainThread]: 
[0m11:21:14.099493 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:21:14.103320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:21:14.113021 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:21:14.113392 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:21:14.113660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:14.564445 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.450 seconds
[0m11:21:14.567301 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:21:14.647393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m11:21:14.648598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:21:14.659263 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:21:14.663524 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:21:14.664187 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:21:14.664749 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:21:14.665360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:14.665958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:15.124823 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.459 seconds
[0m11:21:15.129524 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:21:15.159303 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.494 seconds
[0m11:21:15.162023 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:21:15.233191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c596680>]}
[0m11:21:15.234474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:21:15.235302 [info ] [MainThread]: 
[0m11:21:15.245647 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:21:15.246554 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:21:15.247067 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:21:15.247918 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:21:15.248837 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:21:15.249691 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:21:15.250516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m11:21:15.251232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m11:21:15.251916 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:21:15.252579 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:21:15.253177 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:21:15.253757 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:21:15.262939 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:21:15.266117 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:21:15.269320 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:21:15.271507 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:21:15.278642 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:21:15.279002 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:21:15.307948 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:21:15.310803 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:21:15.313088 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:21:15.314581 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:21:15.315071 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:21:15.315875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:21:15.315597 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:21:15.316388 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:21:15.316896 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:21:15.317327 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
review_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:21:15.321269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:15.325140 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:21:18.380623 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.059 seconds
[0m11:21:18.436848 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:21:18.534304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8734ae90>]}
[0m11:21:18.536268 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 3.28s]
[0m11:21:18.538092 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:21:18.978115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.656 seconds
[0m11:21:18.983504 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:21:19.038160 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.713 seconds
[0m11:21:19.041886 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:21:19.113434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fa3190>]}
[0m11:21:19.115520 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 3.86s]
[0m11:21:19.116574 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:21:19.126965 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fa3b20>]}
[0m11:21:19.128134 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 3.87s]
[0m11:21:19.129018 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:21:19.135222 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:21:19.135855 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:21:19.138346 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:21:19.137414 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:21:19.136286 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:21:19.139460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:21:19.140362 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:21:19.141151 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:21:19.143113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:21:19.142471 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:21:19.141823 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:21:19.143529 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:21:19.151956 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:21:19.155790 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:21:19.159457 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:21:19.162760 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:21:19.163461 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:21:19.167659 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:21:19.168377 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:21:19.171346 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:21:19.176223 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:21:19.178901 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:21:19.179883 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:21:19.181174 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:21:19.181853 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:21:19.183173 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:21:19.183589 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:21:19.184755 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:21:19.189218 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:21:19.193322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:20.511899 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m11:21:20.514907 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:21:20.621186 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873fae30>]}
[0m11:21:20.623562 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.48s]
[0m11:21:20.624692 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:21:20.632581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.443 seconds
[0m11:21:20.635397 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:21:20.714102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873fb7f0>]}
[0m11:21:20.716957 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.57s]
[0m11:21:20.718422 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:21:21.127330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.934 seconds
[0m11:21:21.139712 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:21:21.216151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76bb7a4-33e0-404b-8503-9e9c2c2e9ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86904a30>]}
[0m11:21:21.218198 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.07s]
[0m11:21:21.219923 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:21:21.224184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:21.224951 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:21:21.225541 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:21:21.226014 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m11:21:21.226500 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:21:21.227348 [info ] [MainThread]: 
[0m11:21:21.228459 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m11:21:21.230227 [debug] [MainThread]: Command end result
[0m11:21:21.294875 [info ] [MainThread]: 
[0m11:21:21.297710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:21.299703 [info ] [MainThread]: 
[0m11:21:21.302447 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:21:21.309883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.112707, "process_user_time": 4.570752, "process_kernel_time": 0.410115, "process_mem_max_rss": "196708", "process_out_blocks": "2518", "process_in_blocks": "0"}
[0m11:21:21.313724 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:21.313310 after 8.12 seconds
[0m11:21:21.315970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa987c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8aad570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5f18a0>]}
[0m11:21:21.317734 [debug] [MainThread]: Flushing usage events
[0m11:21:24.800624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e188340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c552140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5520e0>]}


============================== 11:21:24.804216 | 9d71d41f-bf59-4460-b815-8b3007ecd1ef ==============================
[0m11:21:24.804216 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:21:24.804723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:21:25.302901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d71d41f-bf59-4460-b815-8b3007ecd1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ee0ca0>]}
[0m11:21:25.334090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d71d41f-bf59-4460-b815-8b3007ecd1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ee0c10>]}
[0m11:21:25.334785 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:21:25.401461 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:21:25.544244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:25.544656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:25.573658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d71d41f-bf59-4460-b815-8b3007ecd1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8090cfd0>]}
[0m11:21:25.667687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d71d41f-bf59-4460-b815-8b3007ecd1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8092c6a0>]}
[0m11:21:25.668137 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:21:25.668462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d71d41f-bf59-4460-b815-8b3007ecd1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808e63e0>]}
[0m11:21:25.669670 [info ] [MainThread]: 
[0m11:21:25.670105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:21:25.673321 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:21:25.673827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:21:25.685016 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:21:25.686752 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:21:25.687053 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:21:25.687357 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:21:25.687684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:25.687989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:26.121202 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.433 seconds
[0m11:21:26.124696 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:21:26.151184 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.463 seconds
[0m11:21:26.153618 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:21:26.245764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d71d41f-bf59-4460-b815-8b3007ecd1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbc9cf0>]}
[0m11:21:26.246973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:21:26.247916 [info ] [MainThread]: 
[0m11:21:26.259188 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:21:26.259830 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:21:26.260322 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:21:26.260911 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:21:26.261409 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m11:21:26.262089 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m11:21:26.262760 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m11:21:26.263397 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m11:21:26.264118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m11:21:26.264671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m11:21:26.265261 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m11:21:26.265961 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m11:21:26.266584 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:21:26.267115 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:21:26.267695 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:21:26.268258 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:21:26.286232 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:21:26.295225 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:21:26.299473 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:21:26.303187 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:21:26.306260 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:21:26.306655 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:21:26.319666 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:21:26.320030 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:21:26.322562 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:21:26.324748 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:21:26.327390 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:21:26.329359 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:21:26.331416 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:21:26.331866 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m11:21:26.332312 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:21:26.332919 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:21:26.333172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:21:26.333568 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:21:26.334767 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m11:21:26.334273 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m11:21:26.333947 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m11:21:26.336192 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:21:26.335913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:26.335588 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:21:26.847917 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m11:21:26.850994 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m11:21:26.868878 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m11:21:26.871077 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m11:21:26.940004 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.67s]
[0m11:21:26.941244 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:21:26.942032 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:21:26.942744 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m11:21:26.943429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m11:21:26.944072 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:21:26.949652 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:21:26.951099 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:21:26.954458 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:21:26.955941 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:21:26.956503 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m11:21:26.957131 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:21:26.962490 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.70s]
[0m11:21:26.964601 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m11:21:26.968769 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:21:26.970973 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m11:21:26.972789 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:21:26.974720 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m11:21:26.976808 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m11:21:26.980704 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:21:26.987551 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:21:26.992162 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:21:26.995672 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:21:26.996752 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:21:26.997177 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m11:21:26.997585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:21:27.063092 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.80s]
[0m11:21:27.063939 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:21:27.066967 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:21:27.068167 [info ] [Thread-4 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m11:21:27.068660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m11:21:27.069022 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:21:27.072591 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:21:27.073569 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:21:27.075602 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:21:27.076512 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:21:27.076960 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m11:21:27.077300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:21:27.102437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m11:21:27.105584 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m11:21:27.192062 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.93s]
[0m11:21:27.196538 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:21:27.197000 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:21:27.197418 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m11:21:27.197881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m11:21:27.198218 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:21:27.203019 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:21:27.203882 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:21:27.206581 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:21:27.207575 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:21:27.207884 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:21:27.208142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:27.518460 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m11:21:27.521083 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m11:21:27.615135 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.67s]
[0m11:21:27.616182 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:21:27.666859 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m11:21:27.669606 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m11:21:27.740104 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.76s]
[0m11:21:27.741282 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:21:28.169236 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m11:21:28.174110 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m11:21:28.276212 [info ] [Thread-4 (]: 7 of 8 PASS not_null_stg_reviews_review_id ..................................... [[32mPASS[0m in 1.21s]
[0m11:21:28.278744 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:21:28.600585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.392 seconds
[0m11:21:28.603911 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m11:21:28.723469 [error] [Thread-1 (]: 8 of 8 FAIL 7407 unique_stg_reviews_review_id .................................. [[31mFAIL 7407[0m in 1.53s]
[0m11:21:28.724531 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:21:28.726359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:28.726927 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m11:21:28.727400 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m11:21:28.727941 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m11:21:28.728374 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m11:21:28.728897 [info ] [MainThread]: 
[0m11:21:28.729432 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m11:21:28.731134 [debug] [MainThread]: Command end result
[0m11:21:28.773715 [info ] [MainThread]: 
[0m11:21:28.774179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:21:28.774623 [info ] [MainThread]: 
[0m11:21:28.775064 [error] [MainThread]: [31mFailure in test unique_stg_reviews_review_id (models/staging/schema.yml)[0m
[0m11:21:28.775447 [error] [MainThread]:   Got 7407 results, configured to fail if != 0
[0m11:21:28.775772 [info ] [MainThread]: 
[0m11:21:28.776099 [info ] [MainThread]:   compiled code at target/compiled/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m11:21:28.776420 [info ] [MainThread]: 
[0m11:21:28.776768 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m11:21:28.777759 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.006277, "process_user_time": 3.682773, "process_kernel_time": 0.303096, "process_mem_max_rss": "198460", "process_out_blocks": "2520", "command_success": false, "process_in_blocks": "0"}
[0m11:21:28.778283 [debug] [MainThread]: Command `dbt test` failed at 11:21:28.778210 after 4.01 seconds
[0m11:21:28.778705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e188340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d39c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8053afb0>]}
[0m11:21:28.779074 [debug] [MainThread]: Flushing usage events
[0m11:28:35.688981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45e0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa293e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa293dff0>]}


============================== 11:28:35.697020 | c79c764d-ba51-4960-bd17-cf5525b2649f ==============================
[0m11:28:35.697020 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:28:35.697534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:35.715003 [info ] [MainThread]: dbt version: 1.8.3
[0m11:28:35.715508 [info ] [MainThread]: python version: 3.10.14
[0m11:28:35.715813 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:28:35.716085 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:28:36.561288 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:28:36.561900 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:28:36.562205 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:28:36.562619 [info ] [MainThread]: adapter type: snowflake
[0m11:28:36.562896 [info ] [MainThread]: adapter version: 1.8.2
[0m11:28:36.625860 [info ] [MainThread]: Configuration:
[0m11:28:36.626453 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:28:36.626793 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:28:36.627111 [info ] [MainThread]: Required dependencies:
[0m11:28:36.627510 [debug] [MainThread]: Executing "git --help"
[0m11:28:36.643940 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:28:36.644478 [debug] [MainThread]: STDERR: "b''"
[0m11:28:36.644778 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:28:36.645141 [info ] [MainThread]: Connection:
[0m11:28:36.645568 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:28:36.645983 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:28:36.646315 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:28:36.646795 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:28:36.647068 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:28:36.647370 [info ] [MainThread]:   schema: STAGE
[0m11:28:36.647637 [info ] [MainThread]:   authenticator: jwt
[0m11:28:36.647906 [info ] [MainThread]:   oauth_client_id: None
[0m11:28:36.648163 [info ] [MainThread]:   query_tag: None
[0m11:28:36.648418 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:28:36.648698 [info ] [MainThread]:   host: None
[0m11:28:36.648939 [info ] [MainThread]:   port: None
[0m11:28:36.649208 [info ] [MainThread]:   proxy_host: None
[0m11:28:36.649422 [info ] [MainThread]:   proxy_port: None
[0m11:28:36.649644 [info ] [MainThread]:   protocol: None
[0m11:28:36.649893 [info ] [MainThread]:   connect_retries: 1
[0m11:28:36.650190 [info ] [MainThread]:   connect_timeout: None
[0m11:28:36.650424 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:28:36.650639 [info ] [MainThread]:   retry_all: False
[0m11:28:36.650953 [info ] [MainThread]:   insecure_mode: False
[0m11:28:36.651278 [info ] [MainThread]:   reuse_connections: None
[0m11:28:36.651707 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:28:36.718168 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:28:36.718803 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:28:36.719122 [debug] [MainThread]: On debug: select 1 as id
[0m11:28:36.719428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:37.407065 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.687 seconds
[0m11:28:37.408989 [debug] [MainThread]: On debug: Close
[0m11:28:37.490255 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:28:37.491624 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:28:37.499163 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8560066, "process_user_time": 4.164992, "process_kernel_time": 1.628036, "process_mem_max_rss": "182976", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:28:37.500638 [debug] [MainThread]: Command `dbt debug` succeeded at 11:28:37.500527 after 1.86 seconds
[0m11:28:37.501478 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:28:37.502085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45e0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37eaf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831b4c70>]}
[0m11:28:37.502646 [debug] [MainThread]: Flushing usage events
[0m11:28:41.166293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb5c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf39ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf39f90>]}


============================== 11:28:41.170839 | 592f7210-2795-4e47-85f1-b6430766d49c ==============================
[0m11:28:41.170839 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:28:41.171356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m11:28:41.272934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '592f7210-2795-4e47-85f1-b6430766d49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb7ffd0>]}
[0m11:28:41.360030 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mwzqi052'
[0m11:28:41.360633 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:28:41.489608 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:28:41.491292 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:28:41.580542 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:28:41.587165 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:28:42.019294 [info ] [MainThread]: Installed from version 1.1.1
[0m11:28:42.021031 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:28:42.021948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '592f7210-2795-4e47-85f1-b6430766d49c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4a5480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae8fd00>]}
[0m11:28:42.022732 [info ] [MainThread]: 
[0m11:28:42.023837 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:28:42.025919 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8968951, "process_user_time": 1.238107, "process_kernel_time": 0.296419, "process_mem_max_rss": "95060", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:28:42.026653 [debug] [MainThread]: Command `dbt deps` succeeded at 11:28:42.026542 after 0.90 seconds
[0m11:28:42.027601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb5c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4fd150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4a5480>]}
[0m11:28:42.028292 [debug] [MainThread]: Flushing usage events
[0m11:28:47.852947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4f4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b85a260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b85a200>]}


============================== 11:28:47.857117 | 842e407f-6da9-46bc-9ba3-9146859d58c3 ==============================
[0m11:28:47.857117 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:28:47.857774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m11:28:48.445216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842e407f-6da9-46bc-9ba3-9146859d58c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9f8ca0>]}
[0m11:28:48.487745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '842e407f-6da9-46bc-9ba3-9146859d58c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802e3c40>]}
[0m11:28:48.488549 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:28:48.569354 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:28:48.764549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:28:48.765297 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews_granular.sql
[0m11:28:48.765717 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m11:28:48.889469 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_reviews (models/staging/stg_reviews.sql)
  unexpected ']'
    line 18
      --]) }} as review_id,
[0m11:28:48.890943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.068998, "process_user_time": 2.529026, "process_kernel_time": 0.325263, "process_mem_max_rss": "185164", "process_in_blocks": "16", "process_out_blocks": "13", "command_success": false}
[0m11:28:48.891606 [debug] [MainThread]: Command `dbt run` failed at 11:28:48.891534 after 1.07 seconds
[0m11:28:48.892144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4f4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb31480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb32590>]}
[0m11:28:48.892727 [debug] [MainThread]: Flushing usage events
[0m11:31:35.588944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5e03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b93a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b93a050>]}


============================== 11:31:35.593936 | 243e6b95-64da-40ad-949c-fdcdfe9f357b ==============================
[0m11:31:35.593936 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:31:35.594546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:35.604044 [info ] [MainThread]: dbt version: 1.8.3
[0m11:31:35.604463 [info ] [MainThread]: python version: 3.10.14
[0m11:31:35.604804 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:31:35.605168 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:31:36.395777 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:31:36.396428 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:31:36.396775 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:31:36.397205 [info ] [MainThread]: adapter type: snowflake
[0m11:31:36.397488 [info ] [MainThread]: adapter version: 1.8.2
[0m11:31:36.451780 [info ] [MainThread]: Configuration:
[0m11:31:36.452251 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:31:36.452520 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:31:36.452747 [info ] [MainThread]: Required dependencies:
[0m11:31:36.452981 [debug] [MainThread]: Executing "git --help"
[0m11:31:36.470223 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:31:36.470663 [debug] [MainThread]: STDERR: "b''"
[0m11:31:36.470906 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:31:36.471145 [info ] [MainThread]: Connection:
[0m11:31:36.471396 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:31:36.471647 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:31:36.471956 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:31:36.472253 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:31:36.472511 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:31:36.472744 [info ] [MainThread]:   schema: STAGE
[0m11:31:36.472965 [info ] [MainThread]:   authenticator: jwt
[0m11:31:36.473208 [info ] [MainThread]:   oauth_client_id: None
[0m11:31:36.473472 [info ] [MainThread]:   query_tag: None
[0m11:31:36.473734 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:31:36.473965 [info ] [MainThread]:   host: None
[0m11:31:36.474175 [info ] [MainThread]:   port: None
[0m11:31:36.474381 [info ] [MainThread]:   proxy_host: None
[0m11:31:36.474614 [info ] [MainThread]:   proxy_port: None
[0m11:31:36.474850 [info ] [MainThread]:   protocol: None
[0m11:31:36.475091 [info ] [MainThread]:   connect_retries: 1
[0m11:31:36.475340 [info ] [MainThread]:   connect_timeout: None
[0m11:31:36.475592 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:31:36.475879 [info ] [MainThread]:   retry_all: False
[0m11:31:36.476115 [info ] [MainThread]:   insecure_mode: False
[0m11:31:36.476338 [info ] [MainThread]:   reuse_connections: None
[0m11:31:36.476691 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:31:36.542721 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:31:36.543388 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:31:36.543665 [debug] [MainThread]: On debug: select 1 as id
[0m11:31:36.543943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:37.278871 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.734 seconds
[0m11:31:37.282451 [debug] [MainThread]: On debug: Close
[0m11:31:37.409305 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:31:37.410447 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:31:37.414066 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8635771, "process_user_time": 2.504385, "process_kernel_time": 0.912803, "process_mem_max_rss": "182900", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:31:37.414894 [debug] [MainThread]: Command `dbt debug` succeeded at 11:31:37.414733 after 1.86 seconds
[0m11:31:37.415540 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:31:37.416067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5e03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808b5fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803ed3c0>]}
[0m11:31:37.416545 [debug] [MainThread]: Flushing usage events
[0m11:31:41.132243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42a0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2635f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2635ed0>]}


============================== 11:31:41.135818 | 2a1cd548-645a-4699-b0d3-953020054fc3 ==============================
[0m11:31:41.135818 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:31:41.136473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:41.218464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a1cd548-645a-4699-b0d3-953020054fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42ceb00>]}
[0m11:31:41.289483 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z_yq3wpi'
[0m11:31:41.290518 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:31:41.451517 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:31:41.454886 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:31:41.564132 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:31:41.570820 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:31:42.043460 [info ] [MainThread]: Installed from version 1.1.1
[0m11:31:42.044429 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:31:42.045062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a1cd548-645a-4699-b0d3-953020054fc3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c4db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa258fd30>]}
[0m11:31:42.045710 [info ] [MainThread]: 
[0m11:31:42.046267 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:31:42.051014 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.94721264, "process_user_time": 1.178535, "process_kernel_time": 0.250299, "process_mem_max_rss": "94920", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:31:42.053145 [debug] [MainThread]: Command `dbt deps` succeeded at 11:31:42.052882 after 0.95 seconds
[0m11:31:42.054510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42a0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c4e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2677580>]}
[0m11:31:42.054998 [debug] [MainThread]: Flushing usage events
[0m11:31:46.504771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86188370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84556170>]}


============================== 11:31:46.508383 | fcf7fd88-2877-4566-9f8d-7476ff948790 ==============================
[0m11:31:46.508383 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:31:46.508958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:47.042147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84887760>]}
[0m11:31:47.072215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68ee3d30>]}
[0m11:31:47.072941 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:31:47.139336 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:31:47.302538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:31:47.303093 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews_granular.sql
[0m11:31:47.303457 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/stg_reviews.sql
[0m11:31:47.453933 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:31:47.454541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68882a10>]}
[0m11:31:47.622171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff683d1840>]}
[0m11:31:47.731683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff689f47f0>]}
[0m11:31:47.732321 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:31:47.732759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff689f5720>]}
[0m11:31:47.734285 [info ] [MainThread]: 
[0m11:31:47.734880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:47.739865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:31:47.755727 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:31:47.756332 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:31:47.756750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:48.358841 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.602 seconds
[0m11:31:48.364001 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:31:49.078878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m11:31:49.080468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:31:49.092374 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:31:49.098913 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:31:49.099613 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:31:49.100134 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:31:49.100656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:49.101116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:49.585979 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.485 seconds
[0m11:31:49.589791 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:31:49.704732 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.604 seconds
[0m11:31:49.707274 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:31:49.795357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8629be20>]}
[0m11:31:49.796789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:31:49.797704 [info ] [MainThread]: 
[0m11:31:49.815706 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:31:49.816855 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:31:49.818324 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:31:49.819726 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:31:49.820588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m11:31:49.821804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m11:31:49.822587 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:31:49.823180 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:31:49.832475 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:31:49.835845 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:31:49.838343 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:31:49.838950 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:31:49.862341 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:31:49.865680 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:31:49.867472 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:31:49.868632 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:31:49.869001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:49.868356 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:31:49.869521 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select



product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:31:49.871258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:31:50.536075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m11:31:50.569845 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:31:50.628623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68eae620>]}
[0m11:31:50.629605 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m11:31:50.630531 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:31:50.750470 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m11:31:50.756345 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:31:50.862207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf7fd88-2877-4566-9f8d-7476ff948790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff681e3ac0>]}
[0m11:31:50.863381 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 1.04s]
[0m11:31:50.864279 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:31:50.866122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:50.866697 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:31:50.867157 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:31:50.867730 [info ] [MainThread]: 
[0m11:31:50.868423 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m11:31:50.869508 [debug] [MainThread]: Command end result
[0m11:31:50.917176 [info ] [MainThread]: 
[0m11:31:50.917711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:50.918046 [info ] [MainThread]: 
[0m11:31:50.918372 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:31:50.919302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4470043, "process_user_time": 3.32369, "process_kernel_time": 0.485817, "process_mem_max_rss": "200472", "process_out_blocks": "3683", "process_in_blocks": "0"}
[0m11:31:50.919817 [debug] [MainThread]: Command `dbt run` succeeded at 11:31:50.919758 after 4.45 seconds
[0m11:31:50.920145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86188370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853c5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68ee3d30>]}
[0m11:31:50.920472 [debug] [MainThread]: Flushing usage events
[0m11:31:55.279903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c30370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940421d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94042170>]}


============================== 11:31:55.286821 | e0b1e7cc-8d79-478d-8cc1-a260326d771d ==============================
[0m11:31:55.286821 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:31:55.287461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:55.852133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9436f760>]}
[0m11:31:55.883174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789cbd30>]}
[0m11:31:55.883946 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:31:55.961632 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:31:56.102621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:31:56.102984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:31:56.132316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783f9060>]}
[0m11:31:56.206532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784ddde0>]}
[0m11:31:56.206990 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:31:56.207293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784dc6a0>]}
[0m11:31:56.208657 [info ] [MainThread]: 
[0m11:31:56.209481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:56.213815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:31:56.223361 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:31:56.223810 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:31:56.224115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:56.696388 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.472 seconds
[0m11:31:56.699151 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:31:56.798948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:31:56.800595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:31:56.811267 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:31:56.815096 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:31:56.815692 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:31:56.816768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:56.816202 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:31:56.817623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:57.335730 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.518 seconds
[0m11:31:57.338203 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:31:57.444639 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.628 seconds
[0m11:31:57.446566 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:31:57.750767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78997d60>]}
[0m11:31:57.752956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:31:57.753756 [info ] [MainThread]: 
[0m11:31:57.762964 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:31:57.763427 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:31:57.763753 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:31:57.764422 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:31:57.764968 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:31:57.765516 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:31:57.766036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m11:31:57.766441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m11:31:57.766918 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:31:57.767329 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:31:57.767683 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:31:57.768009 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:31:57.774096 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:31:57.776261 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:31:57.778452 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:31:57.779835 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:31:57.786266 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:31:57.798964 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:31:57.800978 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:31:57.801195 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:31:57.803881 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:31:57.804676 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:31:57.805479 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:31:57.805186 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:31:57.806694 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
review_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:31:57.806415 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:31:57.805945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:57.806971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:31:57.807291 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
reviewer_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:31:57.811926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:31:59.440776 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c26253-0306-1845-0004-85da0005aca2
[0m11:31:59.441833 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 0
invalid identifier 'REVIEW_ID'
[0m11:31:59.442688 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:31:59.529197 [debug] [Thread-2 (]: Database Error in model fct_reviews (models/marts/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 6 at position 0
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/fct_reviews.sql
[0m11:31:59.532651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780bb7f0>]}
[0m11:31:59.533753 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model STAGE_MART.fct_reviews ................... [[31mERROR[0m in 1.76s]
[0m11:31:59.534803 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:32:00.582657 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.770 seconds
[0m11:32:00.603224 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:32:00.603881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.798 seconds
[0m11:32:00.607501 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:32:00.680981 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78996620>]}
[0m11:32:00.681806 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.91s]
[0m11:32:00.682794 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:32:00.684059 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:32:00.684508 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:32:00.684978 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:32:00.685279 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:32:00.688057 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:32:00.689634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780bbd60>]}
[0m11:32:00.690837 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.92s]
[0m11:32:00.691625 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:32:00.691906 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:32:00.692612 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:00.692947 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:00.696249 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:32:00.696811 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:32:00.697221 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:32:00.698041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:32:00.698483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:32:00.699946 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:00.699599 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:00.699273 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:32:00.702445 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:32:00.705220 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:32:00.705663 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:32:00.707594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:32:00.707311 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:00.708063 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:00.710571 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:32:00.714101 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:32:00.718978 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:32:00.719408 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:32:00.719785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:32:00.720599 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:32:00.721115 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:32:00.724689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:32:02.277813 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.552 seconds
[0m11:32:02.287315 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:32:02.359041 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.651 seconds
[0m11:32:02.363910 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:32:02.374880 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7809add0>]}
[0m11:32:02.376368 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.68s]
[0m11:32:02.377566 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:02.455421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7809afb0>]}
[0m11:32:02.457202 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.77s]
[0m11:32:02.458583 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:32:02.625565 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.906 seconds
[0m11:32:02.628894 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:32:02.737507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b1e7cc-8d79-478d-8cc1-a260326d771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f7a260>]}
[0m11:32:02.738834 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.04s]
[0m11:32:02.739858 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:02.744115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:02.745006 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m11:32:02.745516 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:32:02.746045 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:32:02.746469 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:32:02.747539 [info ] [MainThread]: 
[0m11:32:02.748239 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m11:32:02.750660 [debug] [MainThread]: Command end result
[0m11:32:02.818002 [info ] [MainThread]: 
[0m11:32:02.818588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:02.818966 [info ] [MainThread]: 
[0m11:32:02.819403 [error] [MainThread]:   Database Error in model fct_reviews (models/marts/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 6 at position 0
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/marts/fct_reviews.sql
[0m11:32:02.819750 [info ] [MainThread]: 
[0m11:32:02.820195 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:32:02.826598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.5948005, "process_user_time": 5.104721, "process_kernel_time": 0.629055, "process_mem_max_rss": "197604", "process_out_blocks": "2518", "command_success": false, "process_in_blocks": "0"}
[0m11:32:02.827727 [debug] [MainThread]: Command `dbt run` failed at 11:32:02.827627 after 7.60 seconds
[0m11:32:02.828389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c30370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e46920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f7d2d0>]}
[0m11:32:02.828754 [debug] [MainThread]: Flushing usage events
[0m11:32:37.890309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb50370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf36050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf35ff0>]}


============================== 11:32:37.894737 | 90bf7b1c-ab40-4524-85f5-c1aa66ae0535 ==============================
[0m11:32:37.894737 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:32:37.895324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:32:37.903755 [info ] [MainThread]: dbt version: 1.8.3
[0m11:32:37.904264 [info ] [MainThread]: python version: 3.10.14
[0m11:32:37.904567 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:32:37.904890 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:32:38.495362 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:32:38.496092 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:32:38.496653 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:32:38.497151 [info ] [MainThread]: adapter type: snowflake
[0m11:32:38.497428 [info ] [MainThread]: adapter version: 1.8.2
[0m11:32:38.551022 [info ] [MainThread]: Configuration:
[0m11:32:38.551560 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:32:38.551855 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:32:38.552100 [info ] [MainThread]: Required dependencies:
[0m11:32:38.552399 [debug] [MainThread]: Executing "git --help"
[0m11:32:38.564240 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:32:38.564671 [debug] [MainThread]: STDERR: "b''"
[0m11:32:38.564904 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:32:38.565161 [info ] [MainThread]: Connection:
[0m11:32:38.565429 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:32:38.565690 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:32:38.565950 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:32:38.566198 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:32:38.566449 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:32:38.566691 [info ] [MainThread]:   schema: STAGE
[0m11:32:38.566929 [info ] [MainThread]:   authenticator: jwt
[0m11:32:38.567197 [info ] [MainThread]:   oauth_client_id: None
[0m11:32:38.567482 [info ] [MainThread]:   query_tag: None
[0m11:32:38.567736 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:32:38.568002 [info ] [MainThread]:   host: None
[0m11:32:38.568250 [info ] [MainThread]:   port: None
[0m11:32:38.568507 [info ] [MainThread]:   proxy_host: None
[0m11:32:38.568747 [info ] [MainThread]:   proxy_port: None
[0m11:32:38.569010 [info ] [MainThread]:   protocol: None
[0m11:32:38.569257 [info ] [MainThread]:   connect_retries: 1
[0m11:32:38.569523 [info ] [MainThread]:   connect_timeout: None
[0m11:32:38.569766 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:32:38.570013 [info ] [MainThread]:   retry_all: False
[0m11:32:38.570266 [info ] [MainThread]:   insecure_mode: False
[0m11:32:38.570518 [info ] [MainThread]:   reuse_connections: None
[0m11:32:38.570891 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:32:38.629866 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:32:38.630518 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:32:38.630809 [debug] [MainThread]: On debug: select 1 as id
[0m11:32:38.631058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:39.053186 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.422 seconds
[0m11:32:39.054959 [debug] [MainThread]: On debug: Close
[0m11:32:39.142455 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:32:39.143725 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:32:39.145624 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2914953, "process_user_time": 2.407886, "process_kernel_time": 0.428091, "process_mem_max_rss": "183092", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:32:39.146511 [debug] [MainThread]: Command `dbt debug` succeeded at 11:32:39.146390 after 1.29 seconds
[0m11:32:39.147086 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:32:39.147684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb50370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd66f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61700c70>]}
[0m11:32:39.148345 [debug] [MainThread]: Flushing usage events
[0m11:32:42.434959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfe0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c33a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c339fc0>]}


============================== 11:32:42.438740 | c790ff53-ad54-4e94-9c82-ca30997f5c6c ==============================
[0m11:32:42.438740 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:32:42.439347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:42.512938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c790ff53-ad54-4e94-9c82-ca30997f5c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4e3070>]}
[0m11:32:42.570653 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z7f058t0'
[0m11:32:42.571117 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:32:42.704905 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:32:42.706663 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:32:42.821647 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:32:42.828387 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:32:43.234391 [info ] [MainThread]: Installed from version 1.1.1
[0m11:32:43.235170 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:32:43.235728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c790ff53-ad54-4e94-9c82-ca30997f5c6c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9294e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c293d00>]}
[0m11:32:43.236168 [info ] [MainThread]: 
[0m11:32:43.236660 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:32:43.237856 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8322289, "process_user_time": 1.178253, "process_kernel_time": 0.209975, "process_mem_max_rss": "95076", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:32:43.238452 [debug] [MainThread]: Command `dbt deps` succeeded at 11:32:43.238350 after 0.83 seconds
[0m11:32:43.238888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfe0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d980d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9294e0>]}
[0m11:32:43.239300 [debug] [MainThread]: Flushing usage events
[0m11:32:46.894295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa287c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c421a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c42140>]}


============================== 11:32:46.898423 | 0f0bf3e5-e87f-4ce8-89b0-e6d148485169 ==============================
[0m11:32:46.898423 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:32:46.899140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:47.419543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa289fee0>]}
[0m11:32:47.449427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85593a00>]}
[0m11:32:47.450039 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:32:47.565464 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:32:47.772501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:47.773429 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/marts/fct_reviews.sql
[0m11:32:47.968869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f4d5a0>]}
[0m11:32:48.055675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850de680>]}
[0m11:32:48.056155 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:32:48.056671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850dd240>]}
[0m11:32:48.058484 [info ] [MainThread]: 
[0m11:32:48.059093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:48.063743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:32:48.075125 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:32:48.075507 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:32:48.075739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:49.170063 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.094 seconds
[0m11:32:49.174782 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:32:49.261234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:32:49.263035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m11:32:49.275974 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:32:49.281292 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:32:49.282055 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:32:49.282614 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:32:49.283109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:49.283696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:49.750246 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.466 seconds
[0m11:32:49.753916 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:32:49.882609 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.599 seconds
[0m11:32:49.885675 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:32:49.953293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85593850>]}
[0m11:32:49.954432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:49.955091 [info ] [MainThread]: 
[0m11:32:49.972862 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:32:49.973690 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:32:49.974547 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:32:49.975428 [info ] [Thread-3 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:32:49.976195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_meta)
[0m11:32:49.976925 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.stg_reviews'
[0m11:32:49.977579 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:32:49.978166 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:32:49.987042 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:32:49.990292 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:32:49.992067 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:32:49.992450 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:32:50.017547 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:32:50.014990 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:32:50.019059 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:32:50.019460 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select



product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:32:50.020389 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:32:50.020050 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:32:50.020879 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:32:50.024384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:50.631829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m11:32:50.640460 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m11:32:50.710506 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:32:50.712348 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:32:50.812957 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855925f0>]}
[0m11:32:50.814108 [info ] [Thread-3 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.83s]
[0m11:32:50.815420 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:32:50.820785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0bf3e5-e87f-4ce8-89b0-e6d148485169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843cc3a0>]}
[0m11:32:50.821408 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 0.84s]
[0m11:32:50.821933 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:32:50.823820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:50.824176 [debug] [MainThread]: Connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE' was properly closed.
[0m11:32:50.824444 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:32:50.824665 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:32:50.825018 [info ] [MainThread]: 
[0m11:32:50.825322 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m11:32:50.826051 [debug] [MainThread]: Command end result
[0m11:32:50.871237 [info ] [MainThread]: 
[0m11:32:50.871861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:50.872224 [info ] [MainThread]: 
[0m11:32:50.872601 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:32:50.874326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.013315, "process_user_time": 3.314938, "process_kernel_time": 0.493114, "process_mem_max_rss": "198504", "process_out_blocks": "3685", "process_in_blocks": "0"}
[0m11:32:50.875034 [debug] [MainThread]: Command `dbt run` succeeded at 11:32:50.874957 after 4.01 seconds
[0m11:32:50.875566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa287c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ab1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fbace0>]}
[0m11:32:50.875914 [debug] [MainThread]: Flushing usage events
[0m11:32:54.795211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad46c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab83e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab83e110>]}


============================== 11:32:54.799218 | 8d808ace-461e-4449-9d4b-bfcd82ba4450 ==============================
[0m11:32:54.799218 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:32:54.799846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:55.350815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad48ffd0>]}
[0m11:32:55.383540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901cbd90>]}
[0m11:32:55.384366 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:32:55.494287 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:32:55.646257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:55.646738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:55.677021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb85000>]}
[0m11:32:55.760998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc7c640>]}
[0m11:32:55.762216 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:32:55.762657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc7c970>]}
[0m11:32:55.764786 [info ] [MainThread]: 
[0m11:32:55.765471 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:55.769607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:32:55.780714 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:32:55.781130 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:32:55.781398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:56.194294 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.413 seconds
[0m11:32:56.195992 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:32:56.294588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:32:56.296057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:32:56.303794 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:32:56.306683 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:32:56.307378 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:32:56.307761 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:32:56.308094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:56.308400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:56.767931 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.459 seconds
[0m11:32:56.773444 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:32:56.774642 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.467 seconds
[0m11:32:56.778103 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:32:56.924273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5708e0>]}
[0m11:32:56.925966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:56.926576 [info ] [MainThread]: 
[0m11:32:56.939263 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:32:56.939771 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:32:56.940161 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:32:56.940830 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:32:56.941334 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:32:56.941975 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:32:56.942591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m11:32:56.943032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m11:32:56.943471 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:32:56.943907 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:32:56.944215 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:32:56.944527 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:32:56.954559 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:32:56.957491 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:32:56.959908 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:32:56.961727 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:32:56.962021 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:32:56.969832 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:32:57.198428 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:32:57.200626 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:32:57.206616 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:32:57.228009 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:32:57.229369 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:32:57.230042 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:32:57.230736 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:32:57.231798 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
reviewer_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:32:57.236691 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:32:57.235225 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
reviewer_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:32:57.232894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:57.239288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:32:58.921240 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.681 seconds
[0m11:32:58.950506 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:32:59.011567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901925c0>]}
[0m11:32:59.013106 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.07s]
[0m11:32:59.015555 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:32:59.155199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m11:32:59.157306 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:32:59.175638 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.939 seconds
[0m11:32:59.177611 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:32:59.236949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afbb2b0>]}
[0m11:32:59.237900 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.29s]
[0m11:32:59.238527 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:32:59.239635 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:32:59.240290 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:32:59.242627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bbd2530>]}
[0m11:32:59.243189 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:32:59.243825 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.30s]
[0m11:32:59.244337 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:32:59.244783 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:32:59.251085 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:32:59.251863 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:59.252152 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:59.252750 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:32:59.253314 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:32:59.253995 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:32:59.254361 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:32:59.254748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:32:59.258252 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:59.257951 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:59.257503 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:32:59.260449 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:32:59.262680 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:32:59.264260 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:32:59.264684 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:32:59.265078 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:32:59.265369 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:32:59.265738 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:32:59.268490 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:32:59.272796 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:32:59.281176 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:32:59.282025 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:32:59.284671 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:32:59.288640 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:32:59.289497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:32:59.289898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:33:00.564296 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.298 seconds
[0m11:33:00.569889 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:33:00.653581 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.363 seconds
[0m11:33:00.657175 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:33:00.884461 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af69a80>]}
[0m11:33:00.886631 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.63s]
[0m11:33:00.888007 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:33:00.939936 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af4bb80>]}
[0m11:33:00.941468 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.70s]
[0m11:33:00.942194 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:33:01.147413 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.857 seconds
[0m11:33:01.154045 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:33:01.298857 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d808ace-461e-4449-9d4b-bfcd82ba4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afbb970>]}
[0m11:33:01.301005 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.04s]
[0m11:33:01.302849 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:33:01.305718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:01.306161 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m11:33:01.306411 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:33:01.306650 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:33:01.306859 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:33:01.307429 [info ] [MainThread]: 
[0m11:33:01.307837 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m11:33:01.308903 [debug] [MainThread]: Command end result
[0m11:33:01.348271 [info ] [MainThread]: 
[0m11:33:01.348797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:01.349125 [info ] [MainThread]: 
[0m11:33:01.349493 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:33:01.351952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5903077, "process_user_time": 4.848455, "process_kernel_time": 0.751938, "process_mem_max_rss": "196344", "process_out_blocks": "2516", "process_in_blocks": "0"}
[0m11:33:01.352963 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:01.352878 after 6.59 seconds
[0m11:33:01.353761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad46c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac695480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901cbd90>]}
[0m11:33:01.354148 [debug] [MainThread]: Flushing usage events
[0m11:33:05.206166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb443a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf4e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf4e140>]}


============================== 11:33:05.210587 | 82c705f3-ac1c-4125-a4a4-1451544d3ac5 ==============================
[0m11:33:05.210587 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:33:05.211135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:33:05.823868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82c705f3-ac1c-4125-a4a4-1451544d3ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb73e80>]}
[0m11:33:05.859081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82c705f3-ac1c-4125-a4a4-1451544d3ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff618aa620>]}
[0m11:33:05.859881 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:33:05.930860 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:33:06.081729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:06.082154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:06.113280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82c705f3-ac1c-4125-a4a4-1451544d3ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61309030>]}
[0m11:33:06.219318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82c705f3-ac1c-4125-a4a4-1451544d3ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6133f6d0>]}
[0m11:33:06.219826 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 573 macros
[0m11:33:06.220207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82c705f3-ac1c-4125-a4a4-1451544d3ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff612e5bd0>]}
[0m11:33:06.221733 [info ] [MainThread]: 
[0m11:33:06.222236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:33:06.226056 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:33:06.226646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:33:06.237393 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:33:06.239302 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:33:06.239660 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:33:06.240302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:06.240011 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:33:06.244634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:07.822888 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.579 seconds
[0m11:33:07.831176 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.586 seconds
[0m11:33:07.843368 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:33:07.847475 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:33:07.943670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82c705f3-ac1c-4125-a4a4-1451544d3ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec567d0>]}
[0m11:33:07.948945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:07.950024 [info ] [MainThread]: 
[0m11:33:07.972298 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:33:07.972994 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:33:07.973365 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:33:07.973745 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:33:07.974227 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m11:33:07.974611 [info ] [Thread-2 (]: 2 of 8 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m11:33:07.975117 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m11:33:07.975594 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_meta_product_id ................................. [RUN]
[0m11:33:07.976150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m11:33:07.976515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m11:33:07.976983 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m11:33:07.977404 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m11:33:07.977803 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:33:07.978124 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:33:07.978448 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:33:07.978776 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:33:07.995231 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:33:08.001288 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:33:08.005291 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:33:08.008349 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:33:08.010627 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:33:08.011100 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:33:08.011366 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:33:08.011581 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:33:08.026427 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:33:08.028947 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:33:08.031567 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:33:08.033563 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:33:08.036099 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:33:08.037319 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:33:08.037803 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:33:08.038078 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m11:33:08.038510 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m11:33:08.038958 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:33:08.040474 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m11:33:08.039801 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:33:08.040150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:08.039391 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m11:33:08.041651 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:33:08.040739 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:33:08.585634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m11:33:08.603706 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m11:33:08.605288 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m11:33:08.612362 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m11:33:08.690281 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 0.71s]
[0m11:33:08.692969 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:33:08.693433 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:33:08.693919 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m11:33:08.694373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m11:33:08.694715 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:33:08.692403 [info ] [Thread-2 (]: 2 of 8 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 0.72s]
[0m11:33:08.699030 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:33:08.699339 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:33:08.699663 [info ] [Thread-2 (]: 6 of 8 START test not_null_stg_reviews_rating .................................. [RUN]
[0m11:33:08.700008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m11:33:08.700344 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:33:08.698475 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:33:08.703252 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:33:08.704181 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:33:08.706301 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:33:08.706606 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:33:08.709781 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:33:08.710741 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:33:08.711099 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m11:33:08.711806 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:33:08.711579 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:33:08.712247 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m11:33:08.715427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:33:08.797524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m11:33:08.799153 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m11:33:08.830336 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m11:33:08.840562 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m11:33:08.895515 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 0.92s]
[0m11:33:08.896243 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:33:08.896663 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:33:08.897028 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_reviews_review_id ............................... [RUN]
[0m11:33:08.897367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4)
[0m11:33:08.897658 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:33:08.901126 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:33:08.911690 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:33:08.913979 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:33:08.915058 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"
[0m11:33:08.915473 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is null



      
    ) dbt_internal_test
[0m11:33:08.915780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:08.922795 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 0.94s]
[0m11:33:08.927087 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:33:08.927627 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:33:08.928300 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_reviews_review_id ................................. [RUN]
[0m11:33:08.928957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c)
[0m11:33:08.929373 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:33:08.934335 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:33:08.935435 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:33:08.937756 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:33:08.939020 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"
[0m11:33:08.939399 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    review_id as unique_field,
    count(*) as n_records

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where review_id is not null
group by review_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:33:08.939758 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:33:09.273352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c26255-0306-19e6-0004-85da0006106e
[0m11:33:09.273836 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'REVIEW_ID'
[0m11:33:09.274384 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4: Close
[0m11:33:09.295654 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m11:33:09.298065 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m11:33:09.346010 [debug] [Thread-1 (]: Database Error in test not_null_stg_reviews_review_id (models/staging/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/staging/schema.yml/not_null_stg_reviews_review_id.sql
[0m11:33:09.346635 [error] [Thread-1 (]: 7 of 8 ERROR not_null_stg_reviews_review_id .................................... [[31mERROR[0m in 0.45s]
[0m11:33:09.347249 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4
[0m11:33:09.349962 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m11:33:09.351379 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m11:33:09.357163 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.66s]
[0m11:33:09.357752 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:33:09.367597 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c26255-0306-1875-0004-85da0005bb2e
[0m11:33:09.367936 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'REVIEW_ID'
[0m11:33:09.368328 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c: Close
[0m11:33:09.420054 [info ] [Thread-2 (]: 6 of 8 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.72s]
[0m11:33:09.420720 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:33:09.443735 [debug] [Thread-4 (]: Database Error in test unique_stg_reviews_review_id (models/staging/schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m11:33:09.444302 [error] [Thread-4 (]: 8 of 8 ERROR unique_stg_reviews_review_id ...................................... [[31mERROR[0m in 0.52s]
[0m11:33:09.444866 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c
[0m11:33:09.446767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:09.447252 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4' was properly closed.
[0m11:33:09.447503 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m11:33:09.447816 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m11:33:09.448050 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c' was properly closed.
[0m11:33:09.448399 [info ] [MainThread]: 
[0m11:33:09.448747 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m11:33:09.449818 [debug] [MainThread]: Command end result
[0m11:33:09.484728 [info ] [MainThread]: 
[0m11:33:09.485321 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:33:09.485848 [info ] [MainThread]: 
[0m11:33:09.486289 [error] [MainThread]:   Database Error in test not_null_stg_reviews_review_id (models/staging/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/staging/schema.yml/not_null_stg_reviews_review_id.sql
[0m11:33:09.486649 [info ] [MainThread]: 
[0m11:33:09.487295 [error] [MainThread]:   Database Error in test unique_stg_reviews_review_id (models/staging/schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'REVIEW_ID'
  compiled code at target/run/capstone_amazon_analytics/models/staging/schema.yml/unique_stg_reviews_review_id.sql
[0m11:33:09.487857 [info ] [MainThread]: 
[0m11:33:09.488494 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m11:33:09.490789 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.316222, "process_user_time": 5.075307, "process_kernel_time": 0.628497, "process_mem_max_rss": "199104", "process_out_blocks": "2523", "command_success": false, "process_in_blocks": "0"}
[0m11:33:09.491897 [debug] [MainThread]: Command `dbt test` failed at 11:33:09.491815 after 4.32 seconds
[0m11:33:09.492460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb443a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff618aa620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd5a9b0>]}
[0m11:33:09.492810 [debug] [MainThread]: Flushing usage events
[0m11:36:45.260993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83980310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d35ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d35f90>]}


============================== 11:36:45.266195 | 0836185b-dbb0-4159-a7d1-5b3f0fb94bb6 ==============================
[0m11:36:45.266195 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:36:45.266801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:36:45.274049 [info ] [MainThread]: dbt version: 1.8.3
[0m11:36:45.274517 [info ] [MainThread]: python version: 3.10.14
[0m11:36:45.274876 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m11:36:45.275293 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m11:36:45.766137 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt-profiles
[0m11:36:45.766656 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt-profiles/profiles.yml
[0m11:36:45.767118 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:36:45.768281 [info ] [MainThread]: adapter type: snowflake
[0m11:36:45.768762 [info ] [MainThread]: adapter version: 1.8.2
[0m11:36:45.826239 [info ] [MainThread]: Configuration:
[0m11:36:45.826754 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:36:45.827019 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:36:45.827249 [info ] [MainThread]: Required dependencies:
[0m11:36:45.827522 [debug] [MainThread]: Executing "git --help"
[0m11:36:45.832205 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:36:45.832607 [debug] [MainThread]: STDERR: "b''"
[0m11:36:45.832846 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:36:45.833099 [info ] [MainThread]: Connection:
[0m11:36:45.833371 [info ] [MainThread]:   account: KEMXMAE-OW63667
[0m11:36:45.833597 [info ] [MainThread]:   user: DBT_AIRFLOW_SVC
[0m11:36:45.833825 [info ] [MainThread]:   database: AMAZON_REVIEW_ANALYTICS_DEV
[0m11:36:45.834070 [info ] [MainThread]:   warehouse: ARA_WH_DEV
[0m11:36:45.834281 [info ] [MainThread]:   role: ARA_TRANSFORM_DEV
[0m11:36:45.834500 [info ] [MainThread]:   schema: STAGE
[0m11:36:45.834717 [info ] [MainThread]:   authenticator: jwt
[0m11:36:45.835001 [info ] [MainThread]:   oauth_client_id: None
[0m11:36:45.835345 [info ] [MainThread]:   query_tag: None
[0m11:36:45.835702 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:36:45.835950 [info ] [MainThread]:   host: None
[0m11:36:45.836171 [info ] [MainThread]:   port: None
[0m11:36:45.836488 [info ] [MainThread]:   proxy_host: None
[0m11:36:45.836751 [info ] [MainThread]:   proxy_port: None
[0m11:36:45.837005 [info ] [MainThread]:   protocol: None
[0m11:36:45.837253 [info ] [MainThread]:   connect_retries: 1
[0m11:36:45.837495 [info ] [MainThread]:   connect_timeout: None
[0m11:36:45.837728 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:36:45.837953 [info ] [MainThread]:   retry_all: False
[0m11:36:45.838159 [info ] [MainThread]:   insecure_mode: False
[0m11:36:45.838388 [info ] [MainThread]:   reuse_connections: None
[0m11:36:45.838767 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:36:45.898013 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:36:45.898653 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:36:45.898927 [debug] [MainThread]: On debug: select 1 as id
[0m11:36:45.899192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:46.483768 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.584 seconds
[0m11:36:46.486362 [debug] [MainThread]: On debug: Close
[0m11:36:46.581136 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:36:46.582852 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:36:46.584433 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3559475, "process_user_time": 2.573674, "process_kernel_time": 0.433547, "process_mem_max_rss": "183092", "process_out_blocks": "21", "process_in_blocks": "0"}
[0m11:36:46.585345 [debug] [MainThread]: Command `dbt debug` succeeded at 11:36:46.585204 after 1.36 seconds
[0m11:36:46.585921 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:36:46.586739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83980310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b96ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d77430>]}
[0m11:36:46.587647 [debug] [MainThread]: Flushing usage events
[0m11:36:49.592604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e6c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90236020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90235fc0>]}


============================== 11:36:49.596565 | d786a677-6bf1-4d38-9437-47e316faa758 ==============================
[0m11:36:49.596565 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:36:49.597166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:36:49.682575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd786a677-6bf1-4d38-9437-47e316faa758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e8fee0>]}
[0m11:36:49.747158 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-393j98uf'
[0m11:36:49.747990 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:36:49.898404 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:36:49.900001 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:36:49.979030 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:36:49.983403 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:36:50.441170 [info ] [MainThread]: Installed from version 1.1.1
[0m11:36:50.442209 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:36:50.443163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd786a677-6bf1-4d38-9437-47e316faa758', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9018fd30>]}
[0m11:36:50.443831 [info ] [MainThread]: 
[0m11:36:50.444219 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:36:50.445714 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8842778, "process_user_time": 1.175749, "process_kernel_time": 0.245856, "process_mem_max_rss": "94908", "process_out_blocks": "742", "process_in_blocks": "0"}
[0m11:36:50.446412 [debug] [MainThread]: Command `dbt deps` succeeded at 11:36:50.446296 after 0.89 seconds
[0m11:36:50.446851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e6c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917cded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9180e890>]}
[0m11:36:50.447212 [debug] [MainThread]: Flushing usage events
[0m11:36:53.105866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fba4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df42170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df42110>]}


============================== 11:36:53.109752 | e061a827-fa8d-48b7-9428-e25dcf512a46 ==============================
[0m11:36:53.109752 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:36:53.110411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:36:53.792017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbd3fd0>]}
[0m11:36:53.857062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8e8c40>]}
[0m11:36:53.858145 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:36:53.948738 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:36:54.133536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:54.134415 [debug] [MainThread]: Partial parsing: updated file: capstone_amazon_analytics://models/staging/schema.yml
[0m11:36:54.424268 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:36:54.425276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e317c70>]}
[0m11:36:54.551420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddc15a0>]}
[0m11:36:54.645539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4006d0>]}
[0m11:36:54.646151 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m11:36:54.646570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4007c0>]}
[0m11:36:54.648396 [info ] [MainThread]: 
[0m11:36:54.649083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:54.652482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:36:54.661666 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:36:54.662041 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:36:54.662347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:55.195333 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.532 seconds
[0m11:36:55.200792 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:36:55.729399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:36:55.733702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART)
[0m11:36:55.749862 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:36:55.753227 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:36:55.753884 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:36:55.754582 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:36:55.755203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:55.755768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:56.208949 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.453 seconds
[0m11:36:56.214767 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:36:56.217320 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.462 seconds
[0m11:36:56.223594 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:36:56.297798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8b72e0>]}
[0m11:36:56.298908 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:56.299812 [info ] [MainThread]: 
[0m11:36:56.318146 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:36:56.319250 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:36:56.320290 [info ] [Thread-1 (]: 1 of 2 START sql view model STAGE_STAGE.stg_meta ............................... [RUN]
[0m11:36:56.321133 [info ] [Thread-2 (]: 2 of 2 START sql view model STAGE_STAGE.stg_reviews ............................ [RUN]
[0m11:36:56.321888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m11:36:56.322915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m11:36:56.323454 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:36:56.324008 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:36:56.332316 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:36:56.335573 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:36:56.338103 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:36:56.338509 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:36:56.363431 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_meta"
[0m11:36:56.366565 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:36:56.368318 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_meta"
[0m11:36:56.369596 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_meta"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     

),

renamed as (

select
product_id as product_id,
title as product_title,
brand as brand,
try_to_number(regexp_replace(price, '[^0-9.]', '')) as price
from source
where product_id is not null

)

select *
from renamed
  );
[0m11:36:56.370029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:56.369308 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.stg_reviews"
[0m11:36:56.370561 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.stg_reviews"} */
create or replace   view AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
  
   as (
    with source as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE

),

renamed as (

select



product_id as product_id,
reviewer_id as reviewer_id,

cast(rating as integer) as rating,
review_text as review_text,
  
    -- keep raw string
    review_time as review_time,
    -- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as review_date,
    year(
      coalesce(
        try_to_date(review_time::string, 'MM DD, YYYY'),
        try_to_date(review_time::string, 'MM D, YYYY')
      )
    ) as review_year

from source
--where review_id is not null

)

select *
from renamed
  );
[0m11:36:56.374806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:36:56.886599 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m11:36:56.909710 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.stg_reviews: Close
[0m11:36:56.921402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m11:36:56.923376 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.stg_meta: Close
[0m11:36:56.991184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd5e380>]}
[0m11:36:56.992078 [info ] [Thread-2 (]: 2 of 2 OK created sql view model STAGE_STAGE.stg_reviews ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m11:36:56.993168 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:36:57.523693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e061a827-fa8d-48b7-9428-e25dcf512a46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d12ca30>]}
[0m11:36:57.532068 [info ] [Thread-1 (]: 1 of 2 OK created sql view model STAGE_STAGE.stg_meta .......................... [[32mSUCCESS 1[0m in 1.20s]
[0m11:36:57.535077 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:36:57.538973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:57.539529 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_reviews' was properly closed.
[0m11:36:57.539836 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.stg_meta' was properly closed.
[0m11:36:57.540312 [info ] [MainThread]: 
[0m11:36:57.540848 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m11:36:57.542127 [debug] [MainThread]: Command end result
[0m11:36:57.577675 [info ] [MainThread]: 
[0m11:36:57.578162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:57.578506 [info ] [MainThread]: 
[0m11:36:57.578883 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:36:57.580441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.507371, "process_user_time": 3.667464, "process_kernel_time": 0.428691, "process_mem_max_rss": "200676", "process_out_blocks": "3670", "process_in_blocks": "0"}
[0m11:36:57.581139 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:57.581025 after 4.51 seconds
[0m11:36:57.582165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fba4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e107bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbd3fd0>]}
[0m11:36:57.582545 [debug] [MainThread]: Flushing usage events
[0m11:37:01.962106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e46c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c83e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c83e170>]}


============================== 11:37:01.965910 | 0b5c8448-9797-468b-ab68-daf785561532 ==============================
[0m11:37:01.965910 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:37:01.966503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:02.498171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb6f760>]}
[0m11:37:02.528799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff711cbd30>]}
[0m11:37:02.529476 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:37:02.592156 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:37:02.734176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:02.734561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:02.764399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70bfcdc0>]}
[0m11:37:02.843875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70cc0bb0>]}
[0m11:37:02.844903 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m11:37:02.845403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70cc1990>]}
[0m11:37:02.846954 [info ] [MainThread]: 
[0m11:37:02.847543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:02.853608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m11:37:02.866026 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m11:37:02.866508 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m11:37:02.866775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:03.257446 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.391 seconds
[0m11:37:03.265786 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m11:37:03.432186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m11:37:03.433140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:37:03.443304 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:37:03.450190 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:37:03.450687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:03.449373 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:37:03.454864 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:37:03.455367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:03.962796 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.507 seconds
[0m11:37:03.969831 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:37:03.975414 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.520 seconds
[0m11:37:03.976925 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:37:04.043307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71197d60>]}
[0m11:37:04.047179 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:37:04.049581 [info ] [MainThread]: 
[0m11:37:04.067983 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:37:04.068433 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:37:04.068718 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:04.069494 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m11:37:04.071709 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m11:37:04.073301 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m11:37:04.074137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m11:37:04.074564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m11:37:04.075141 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m11:37:04.075591 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:37:04.076011 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:37:04.076367 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:04.085271 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:37:04.087591 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:37:04.090112 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:37:04.092427 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:37:04.092841 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:37:04.114617 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m11:37:04.117048 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:37:04.117326 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:04.120249 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:37:04.120993 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m11:37:04.121621 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m11:37:04.122212 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m11:37:04.122627 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
reviewer_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m11:37:04.123864 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:37:04.123474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:04.123137 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:37:04.125473 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
reviewer_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m11:37:04.126127 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:37:06.122725 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.998 seconds
[0m11:37:06.166163 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m11:37:06.253356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71196620>]}
[0m11:37:06.254921 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.18s]
[0m11:37:06.256284 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:37:06.835723 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.709 seconds
[0m11:37:06.842175 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m11:37:06.845956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.722 seconds
[0m11:37:06.850488 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m11:37:06.941288 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7004b310>]}
[0m11:37:06.942247 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.87s]
[0m11:37:06.943091 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:06.944181 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:37:06.944904 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m11:37:06.945444 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m11:37:06.945892 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:37:06.949314 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:37:06.950359 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:37:06.954281 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m11:37:06.956113 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m11:37:06.956659 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m11:37:06.957040 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:37:06.977821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff700a5990>]}
[0m11:37:06.980123 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.90s]
[0m11:37:06.980850 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:37:06.981418 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:06.981706 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:06.982229 [info ] [Thread-3 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m11:37:06.982768 [info ] [Thread-2 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m11:37:06.983248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:37:06.983686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:37:06.984030 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:06.984362 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:06.986789 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:37:06.989001 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:37:06.990526 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:06.993695 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:37:06.993972 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:06.999848 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:37:07.000915 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:37:07.001273 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m11:37:07.002299 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:37:07.002971 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m11:37:07.003351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:37:07.002592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:37:08.266476 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.309 seconds
[0m11:37:08.271403 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m11:37:08.376932 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7004b1f0>]}
[0m11:37:08.378358 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.43s]
[0m11:37:08.380221 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:37:08.422135 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.419 seconds
[0m11:37:08.427036 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m11:37:08.782811 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m11:37:08.787885 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m11:37:08.822532 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff700a54b0>]}
[0m11:37:08.823639 [info ] [Thread-3 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.84s]
[0m11:37:08.824529 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:08.896811 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c8448-9797-468b-ab68-daf785561532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7002f2e0>]}
[0m11:37:08.899101 [info ] [Thread-2 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.91s]
[0m11:37:08.901479 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:08.904576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:08.905273 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m11:37:08.905796 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_products' was properly closed.
[0m11:37:08.906256 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:37:08.906696 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:37:08.907484 [info ] [MainThread]: 
[0m11:37:08.908139 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m11:37:08.910054 [debug] [MainThread]: Command end result
[0m11:37:08.966095 [info ] [MainThread]: 
[0m11:37:08.966643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:08.967056 [info ] [MainThread]: 
[0m11:37:08.967505 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:37:08.970678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0383787, "process_user_time": 3.7431, "process_kernel_time": 0.343385, "process_mem_max_rss": "196192", "process_out_blocks": "2506", "process_in_blocks": "0"}
[0m11:37:08.972515 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:08.972394 after 7.04 seconds
[0m11:37:08.973650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e46c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce22590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff711cbd30>]}
[0m11:37:08.974250 [debug] [MainThread]: Flushing usage events
[0m11:37:11.943468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab94370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f52170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f52110>]}


============================== 11:37:11.947614 | 1b1550b8-06c6-46bc-b9dc-456274f37b7a ==============================
[0m11:37:11.947614 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:37:11.948258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt-profiles', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:12.471515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b1550b8-06c6-46bc-b9dc-456274f37b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abb7eb0>]}
[0m11:37:12.502351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b1550b8-06c6-46bc-b9dc-456274f37b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d8e0c10>]}
[0m11:37:12.503274 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:37:12.570352 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:37:12.711334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:12.711705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:12.741378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b1550b8-06c6-46bc-b9dc-456274f37b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d314d30>]}
[0m11:37:12.823156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b1550b8-06c6-46bc-b9dc-456274f37b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d31cd00>]}
[0m11:37:12.823599 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m11:37:12.823900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1550b8-06c6-46bc-b9dc-456274f37b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d2de230>]}
[0m11:37:12.825120 [info ] [MainThread]: 
[0m11:37:12.825572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:12.829377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:37:12.830212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:37:12.841066 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:37:12.842785 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:37:12.843122 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:37:12.843465 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:37:12.843788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:12.844169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:13.277135 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.433 seconds
[0m11:37:13.280089 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:37:13.296467 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.452 seconds
[0m11:37:13.298050 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:37:13.355324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1550b8-06c6-46bc-b9dc-456274f37b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d34a860>]}
[0m11:37:13.356194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:37:13.356937 [info ] [MainThread]: 
[0m11:37:13.367260 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:13.367980 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:13.368362 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:13.368806 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:13.369163 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_reviews_rating__1__2__3__4__5 ............ [RUN]
[0m11:37:13.369687 [info ] [Thread-2 (]: 2 of 7 START test not_null_mart_avg_rating_by_year_brand_brand ................. [RUN]
[0m11:37:13.370107 [info ] [Thread-3 (]: 3 of 7 START test not_null_mart_avg_rating_by_year_brand_review_year ........... [RUN]
[0m11:37:13.370525 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_meta_product_id ................................. [RUN]
[0m11:37:13.371051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m11:37:13.371508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m11:37:13.371979 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001'
[0m11:37:13.372441 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m11:37:13.372827 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:13.373210 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:13.373525 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:13.373885 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:13.385794 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:37:13.391770 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:37:13.394804 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:37:13.397835 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:37:13.399537 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:13.400260 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:13.400557 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:13.471256 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:13.552623 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:37:13.573876 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:37:13.575848 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:37:13.577942 [debug] [Thread-4 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:37:13.610179 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:37:13.621629 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:37:13.638968 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where brand is null



      
    ) dbt_internal_test
[0m11:37:13.646658 [debug] [Thread-4 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:37:13.650399 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rating as value_field,
        count(*) as n_records

    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
    group by rating

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5'
)



      
    ) dbt_internal_test
[0m11:37:13.657056 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:37:13.694172 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select review_year
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
where review_year is null



      
    ) dbt_internal_test
[0m11:37:13.669977 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta
where product_id is null



      
    ) dbt_internal_test
[0m11:37:13.676727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:13.660885 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:37:13.696225 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:37:13.699585 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:37:15.233612 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.571 seconds
[0m11:37:15.250299 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.554 seconds
[0m11:37:15.268557 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001: Close
[0m11:37:15.266180 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d: Close
[0m11:37:15.361991 [info ] [Thread-3 (]: 3 of 7 PASS not_null_mart_avg_rating_by_year_brand_review_year ................. [[32mPASS[0m in 1.99s]
[0m11:37:15.363993 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:15.367712 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:15.370022 [info ] [Thread-3 (]: 5 of 7 START test not_null_stg_reviews_product_id .............................. [RUN]
[0m11:37:15.371007 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m11:37:15.372063 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:15.381314 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:37:15.383139 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:15.386446 [debug] [Thread-3 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:37:15.388018 [debug] [Thread-3 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:37:15.388430 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where product_id is null



      
    ) dbt_internal_test
[0m11:37:15.388969 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:37:15.413382 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.714 seconds
[0m11:37:15.415534 [debug] [Thread-4 (]: On test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c: Close
[0m11:37:15.418589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m11:37:15.423701 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06: Close
[0m11:37:15.427654 [info ] [Thread-2 (]: 2 of 7 PASS not_null_mart_avg_rating_by_year_brand_brand ....................... [[32mPASS[0m in 2.06s]
[0m11:37:15.428280 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:15.428619 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:15.429016 [info ] [Thread-2 (]: 6 of 7 START test not_null_stg_reviews_rating .................................. [RUN]
[0m11:37:15.429411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m11:37:15.429745 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:15.434347 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:37:15.436650 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:15.439903 [debug] [Thread-2 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:37:15.441350 [debug] [Thread-2 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:37:15.441794 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rating
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where rating is null



      
    ) dbt_internal_test
[0m11:37:15.442193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:37:15.506643 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_reviews_rating__1__2__3__4__5 .................. [[32mPASS[0m in 2.14s]
[0m11:37:15.510012 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:15.511022 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:15.512896 [info ] [Thread-1 (]: 7 of 7 START test not_null_stg_reviews_reviewer_id ............................. [RUN]
[0m11:37:15.516878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d)
[0m11:37:15.517249 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:15.521086 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"
[0m11:37:15.524713 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:15.525563 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_meta_product_id ....................................... [[32mPASS[0m in 2.15s]
[0m11:37:15.531043 [debug] [Thread-1 (]: Writing runtime sql for node "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"
[0m11:37:15.531906 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:15.533902 [debug] [Thread-1 (]: Using snowflake connection "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"
[0m11:37:15.534374 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_id
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews
where reviewer_id is null



      
    ) dbt_internal_test
[0m11:37:15.535202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:15.998327 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m11:37:16.003537 [debug] [Thread-3 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef: Close
[0m11:37:16.057844 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m11:37:16.064621 [debug] [Thread-2 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e: Close
[0m11:37:16.098706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m11:37:16.101439 [debug] [Thread-1 (]: On test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d: Close
[0m11:37:16.106537 [info ] [Thread-3 (]: 5 of 7 PASS not_null_stg_reviews_product_id .................................... [[32mPASS[0m in 0.74s]
[0m11:37:16.107808 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:16.148333 [info ] [Thread-2 (]: 6 of 7 PASS not_null_stg_reviews_rating ........................................ [[32mPASS[0m in 0.72s]
[0m11:37:16.154330 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:16.191889 [info ] [Thread-1 (]: 7 of 7 PASS not_null_stg_reviews_reviewer_id ................................... [[32mPASS[0m in 0.67s]
[0m11:37:16.194525 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:16.205038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:16.207013 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d' was properly closed.
[0m11:37:16.209172 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e' was properly closed.
[0m11:37:16.211973 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef' was properly closed.
[0m11:37:16.212582 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c' was properly closed.
[0m11:37:16.213412 [info ] [MainThread]: 
[0m11:37:16.214329 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m11:37:16.217843 [debug] [MainThread]: Command end result
[0m11:37:16.269527 [info ] [MainThread]: 
[0m11:37:16.270500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:16.271314 [info ] [MainThread]: 
[0m11:37:16.272260 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:37:16.275362 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.3628716, "process_user_time": 6.827353, "process_kernel_time": 0.634007, "process_mem_max_rss": "197816", "process_out_blocks": "2500", "process_in_blocks": "0"}
[0m11:37:16.276519 [debug] [MainThread]: Command `dbt test` succeeded at 11:37:16.276412 after 4.36 seconds
[0m11:37:16.277305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab94370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d135180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c636140>]}
[0m11:37:16.277907 [debug] [MainThread]: Flushing usage events
[0m11:37:19.424054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39483a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d562f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d56290>]}


============================== 11:37:19.428456 | 50ddf386-0f73-4d66-8723-fb358bd3ab02 ==============================
[0m11:37:19.428456 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:37:19.428956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt-profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:37:19.937928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50ddf386-0f73-4d66-8723-fb358bd3ab02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3977e80>]}
[0m11:37:19.968981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50ddf386-0f73-4d66-8723-fb358bd3ab02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92701780>]}
[0m11:37:19.969834 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m11:37:20.032997 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:37:20.176422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:20.176848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:20.208002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50ddf386-0f73-4d66-8723-fb358bd3ab02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92114ee0>]}
[0m11:37:20.218493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50ddf386-0f73-4d66-8723-fb358bd3ab02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92114730>]}
[0m11:37:20.218924 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m11:37:20.219242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ddf386-0f73-4d66-8723-fb358bd3ab02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92114760>]}
[0m11:37:20.220668 [info ] [MainThread]: 
[0m11:37:20.221129 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:20.224339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m11:37:20.225203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m11:37:20.238381 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m11:37:20.240380 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m11:37:20.240714 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m11:37:20.241092 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m11:37:20.241387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:20.241756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:20.661993 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.420 seconds
[0m11:37:20.663127 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.422 seconds
[0m11:37:20.668008 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m11:37:20.665658 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m11:37:20.783472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ddf386-0f73-4d66-8723-fb358bd3ab02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926af610>]}
[0m11:37:20.784704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:37:20.785454 [info ] [MainThread]: 
[0m11:37:20.796443 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m11:37:20.797129 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m11:37:20.797785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m11:37:20.798465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m11:37:20.799011 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m11:37:20.799571 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m11:37:20.809711 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m11:37:20.813314 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m11:37:20.814940 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m11:37:20.815925 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m11:37:20.816299 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m11:37:20.817187 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m11:37:20.817758 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:20.818504 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m11:37:20.819304 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_products'
[0m11:37:20.820149 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m11:37:20.821142 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m11:37:20.823178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.fct_reviews)
[0m11:37:20.822001 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m11:37:20.822559 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:20.821523 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:20.840069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m11:37:20.827382 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m11:37:20.839433 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m11:37:20.823646 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m11:37:20.840521 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:20.844015 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m11:37:20.846820 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m11:37:20.847208 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m11:37:20.847632 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:20.848665 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m11:37:20.849002 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m11:37:20.849585 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m11:37:20.849858 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:20.852056 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m11:37:20.850928 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m11:37:20.851393 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:20.850297 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:20.852462 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:20.853095 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:20.853690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m11:37:20.855580 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:20.854725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m11:37:20.855214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d)
[0m11:37:20.854231 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m11:37:20.860786 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:20.860111 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:20.860467 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:20.859686 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m11:37:20.865865 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m11:37:20.868772 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m11:37:20.871712 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"
[0m11:37:20.872914 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:20.873257 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:20.873784 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:20.874287 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m11:37:20.874823 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m11:37:20.875022 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:20.875488 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m11:37:20.877061 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:20.876265 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:20.876769 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m11:37:20.875856 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m11:37:20.878169 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.dim_date)
[0m11:37:20.877695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m11:37:20.877358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now model.capstone_amazon_analytics.mart_product_kpi)
[0m11:37:20.879055 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:20.878789 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:20.878459 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m11:37:20.881206 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m11:37:20.883218 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m11:37:20.885802 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m11:37:20.887057 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:20.887780 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m11:37:20.888009 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:20.888816 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m11:37:20.888381 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m11:37:20.889307 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:20.889542 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:20.890542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.mart_product_kpi, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001)
[0m11:37:20.890228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m11:37:20.889887 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m11:37:20.890830 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:20.891134 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:20.893930 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m11:37:20.896475 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m11:37:20.897418 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:20.898087 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m11:37:20.898370 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:20.898916 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m11:37:20.899766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:20.900045 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001' was properly closed.
[0m11:37:20.900288 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d' was properly closed.
[0m11:37:20.900500 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m11:37:20.900693 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m11:37:20.901912 [debug] [MainThread]: Command end result
[0m11:37:21.027226 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:37:21.027602 [info ] [MainThread]: Building catalog
[0m11:37:21.034831 [debug] [ThreadPool]: Acquiring new snowflake connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema'
[0m11:37:21.045658 [debug] [ThreadPool]: Using snowflake connection "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"
[0m11:37:21.046220 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:37:21.046735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:25.797873 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 4.751 seconds
[0m11:37:25.821605 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: Close
[0m11:37:26.009832 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m11:37:26.013262 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.621741, "process_user_time": 2.905501, "process_kernel_time": 0.304935, "process_mem_max_rss": "194224", "process_out_blocks": "5523", "process_in_blocks": "0"}
[0m11:37:26.014368 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:37:26.014229 after 6.62 seconds
[0m11:37:26.014891 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:37:26.015157 [debug] [MainThread]: Connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema' was properly closed.
[0m11:37:26.015659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3722d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b5c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920bdde0>]}
[0m11:37:26.016176 [debug] [MainThread]: Flushing usage events
[0m18:58:23.409399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b54340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f4a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f4a110>]}


============================== 18:58:23.413619 | 1a2fa12e-8919-43ec-878d-aab49c185145 ==============================
[0m18:58:23.413619 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:58:23.414286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:58:24.261964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b77ee0>]}
[0m18:58:24.291792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778ecc40>]}
[0m18:58:24.292544 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m18:58:24.364128 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:58:24.519690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:24.520060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:24.548873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77324e20>]}
[0m18:58:24.628606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff773ebfa0>]}
[0m18:58:24.629023 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m18:58:24.629352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff773ea830>]}
[0m18:58:24.630676 [info ] [MainThread]: 
[0m18:58:24.631191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:24.634337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m18:58:24.643935 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m18:58:24.644298 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m18:58:24.644564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:25.656600 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.011 seconds
[0m18:58:25.661966 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m18:58:25.749797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m18:58:25.751437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m18:58:25.768952 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m18:58:25.772550 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m18:58:25.773253 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m18:58:25.773927 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m18:58:25.774559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:25.775138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:26.216155 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.441 seconds
[0m18:58:26.219999 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m18:58:26.293531 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.519 seconds
[0m18:58:26.299472 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m18:58:26.384743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778bf2e0>]}
[0m18:58:26.386597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:26.387600 [info ] [MainThread]: 
[0m18:58:26.402467 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m18:58:26.403630 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m18:58:26.404302 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m18:58:26.405953 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m18:58:26.406988 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m18:58:26.408050 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m18:58:26.409063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m18:58:26.409878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m18:58:26.410721 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m18:58:26.411416 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m18:58:26.412095 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m18:58:26.412857 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m18:58:26.422699 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m18:58:26.425833 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m18:58:26.429931 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m18:58:26.434113 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m18:58:26.441474 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m18:58:26.441862 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m18:58:26.464376 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m18:58:26.466584 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m18:58:26.468856 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m18:58:26.470826 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m18:58:26.472200 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
reviewer_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m18:58:26.471983 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m18:58:26.471436 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m18:58:26.472491 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:58:26.472810 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
reviewer_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m18:58:26.473142 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m18:58:26.474691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:26.474391 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:28.936920 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.462 seconds
[0m18:58:28.971115 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m18:58:29.026724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.552 seconds
[0m18:58:29.030629 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m18:58:29.083434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff767fd5a0>]}
[0m18:58:29.085039 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.67s]
[0m18:58:29.086608 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m18:58:29.139982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778bf2e0>]}
[0m18:58:29.141892 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.73s]
[0m18:58:29.143379 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m18:58:29.297683 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.825 seconds
[0m18:58:29.303411 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m18:58:29.369570 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff767b98a0>]}
[0m18:58:29.370949 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.96s]
[0m18:58:29.372194 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m18:58:29.373811 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m18:58:29.374520 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m18:58:29.375107 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m18:58:29.375793 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m18:58:29.376901 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m18:58:29.377812 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m18:58:29.378807 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m18:58:29.379606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m18:58:29.380373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m18:58:29.381101 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m18:58:29.381821 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m18:58:29.382415 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m18:58:29.386943 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m18:58:29.390634 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m18:58:29.394140 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m18:58:29.396221 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m18:58:29.396752 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m18:58:29.399741 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m18:58:29.400249 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m18:58:29.403018 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m18:58:29.406732 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m18:58:29.408027 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m18:58:29.409605 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m18:58:29.409956 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m18:58:29.411746 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:58:29.411326 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m18:58:29.411017 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m18:58:29.415957 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m18:58:29.415564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:29.416488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:30.679307 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.267 seconds
[0m18:58:30.685745 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m18:58:30.692008 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.276 seconds
[0m18:58:30.695846 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m18:58:30.757719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75dc1cf0>]}
[0m18:58:30.759249 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.38s]
[0m18:58:30.760719 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m18:58:30.792202 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75dc14b0>]}
[0m18:58:30.793615 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.41s]
[0m18:58:30.794949 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m18:58:31.090704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m18:58:31.096892 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m18:58:31.171845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fa12e-8919-43ec-878d-aab49c185145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75335990>]}
[0m18:58:31.172716 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 1.79s]
[0m18:58:31.173519 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m18:58:31.176402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:31.176780 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m18:58:31.177038 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m18:58:31.177275 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m18:58:31.177502 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m18:58:31.177845 [info ] [MainThread]: 
[0m18:58:31.178518 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m18:58:31.181239 [debug] [MainThread]: Command end result
[0m18:58:31.223360 [info ] [MainThread]: 
[0m18:58:31.223926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:31.224414 [info ] [MainThread]: 
[0m18:58:31.224831 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:58:31.226028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8470807, "process_user_time": 4.014493, "process_kernel_time": 0.339807, "process_mem_max_rss": "202116", "process_in_blocks": "56352", "process_out_blocks": "4419"}
[0m18:58:31.226555 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:31.226461 after 7.85 seconds
[0m18:58:31.226917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d85510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778ecc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b63c40>]}
[0m18:58:31.227230 [debug] [MainThread]: Flushing usage events
[0m19:24:33.399903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97f83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c222f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c22290>]}


============================== 19:24:33.404481 | 2bac17f5-424a-48ec-91e3-b76b2755dc17 ==============================
[0m19:24:33.404481 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:24:33.405003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt-profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:33.968330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bac17f5-424a-48ec-91e3-b76b2755dc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9823a60>]}
[0m19:24:33.997551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bac17f5-424a-48ec-91e3-b76b2755dc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5b9780>]}
[0m19:24:33.998082 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:24:34.059746 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:24:34.224792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:34.225164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:34.254719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bac17f5-424a-48ec-91e3-b76b2755dc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fa4fa0>]}
[0m19:24:34.264455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bac17f5-424a-48ec-91e3-b76b2755dc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fa53c0>]}
[0m19:24:34.264809 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m19:24:34.265203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bac17f5-424a-48ec-91e3-b76b2755dc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c28f970>]}
[0m19:24:34.266680 [info ] [MainThread]: 
[0m19:24:34.267298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:24:34.270757 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m19:24:34.271237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m19:24:34.284607 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m19:24:34.286588 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m19:24:34.286935 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m19:24:34.287251 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m19:24:34.287504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:34.287777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:35.033786 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.746 seconds
[0m19:24:35.037979 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m19:24:35.676565 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.388 seconds
[0m19:24:35.681964 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m19:24:35.786374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bac17f5-424a-48ec-91e3-b76b2755dc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c55f610>]}
[0m19:24:35.787745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:35.788818 [info ] [MainThread]: 
[0m19:24:35.802857 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m19:24:35.803961 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m19:24:35.804908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m19:24:35.805886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m19:24:35.806629 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m19:24:35.807322 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m19:24:35.818686 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m19:24:35.821959 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m19:24:35.824574 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m19:24:35.825532 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m19:24:35.825913 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m19:24:35.826951 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m19:24:35.827496 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m19:24:35.827998 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:24:35.828758 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m19:24:35.830632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.fct_reviews)
[0m19:24:35.829512 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_products'
[0m19:24:35.830190 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m19:24:35.829065 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:24:35.832387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m19:24:35.831465 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m19:24:35.831906 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:24:35.831019 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m19:24:35.848392 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:24:35.835920 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m19:24:35.846057 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m19:24:35.832774 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:24:35.851999 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:24:35.850025 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m19:24:35.852560 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m19:24:35.853353 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m19:24:35.853602 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:24:35.854027 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:24:35.854428 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m19:24:35.854793 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:24:35.856602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m19:24:35.855862 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:24:35.856236 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:24:35.855334 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:24:35.856901 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:24:35.857268 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:24:35.857761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m19:24:35.858117 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:24:35.865646 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d)
[0m19:24:35.864952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m19:24:35.865294 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:24:35.864409 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m19:24:35.865974 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:24:35.866321 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:24:35.869247 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m19:24:35.872213 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"
[0m19:24:35.874696 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m19:24:35.874977 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:24:35.876080 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:24:35.877002 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m19:24:35.876758 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:24:35.876334 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:24:35.877244 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:24:35.877602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now model.capstone_amazon_analytics.dim_date)
[0m19:24:35.878066 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:24:35.878467 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:24:35.878923 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:24:35.879207 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m19:24:35.879532 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:24:35.879882 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:24:35.881943 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m19:24:35.882390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m19:24:35.882755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.mart_product_kpi)
[0m19:24:35.883236 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:24:35.883592 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m19:24:35.883827 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m19:24:35.885826 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:24:35.888443 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:24:35.888899 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m19:24:35.889748 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:24:35.890348 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:24:35.890008 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m19:24:35.890876 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:24:35.891173 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:24:35.891410 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:24:35.891814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m19:24:35.892154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_date, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001)
[0m19:24:35.892458 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:24:35.892747 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:24:35.898010 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m19:24:35.895292 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m19:24:35.899893 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:24:35.900588 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:24:35.900209 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:24:35.901091 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:24:35.901872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:35.902148 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d' was properly closed.
[0m19:24:35.902372 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001' was properly closed.
[0m19:24:35.902589 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m19:24:35.902788 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m19:24:35.903957 [debug] [MainThread]: Command end result
[0m19:24:35.978054 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:24:35.978394 [info ] [MainThread]: Building catalog
[0m19:24:35.986732 [debug] [ThreadPool]: Acquiring new snowflake connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema'
[0m19:24:35.996428 [debug] [ThreadPool]: Using snowflake connection "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"
[0m19:24:35.996894 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:24:35.997366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:41.139035 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 5.139 seconds
[0m19:24:41.169026 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: Close
[0m19:24:41.342023 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:24:41.344820 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.9792347, "process_user_time": 3.024988, "process_kernel_time": 0.349773, "process_mem_max_rss": "198264", "process_in_blocks": "3000", "process_out_blocks": "5522"}
[0m19:24:41.345719 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:24:41.345583 after 7.98 seconds
[0m19:24:41.346158 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:24:41.346409 [debug] [MainThread]: Connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema' was properly closed.
[0m19:24:41.346791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9823a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5b9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c28c1c0>]}
[0m19:24:41.347246 [debug] [MainThread]: Flushing usage events
[0m19:32:09.031489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7461d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f746170>]}


============================== 19:32:09.036920 | 071d1a4a-4bfe-4528-9ffc-a57c7265b0bb ==============================
[0m19:32:09.036920 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:32:09.037646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt-profiles --select path:models/marts', 'send_anonymous_usage_stats': 'True'}
[0m19:32:09.589177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8abdf0>]}
[0m19:32:09.618219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640f4d60>]}
[0m19:32:09.618786 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:32:09.683087 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:32:09.825717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:32:09.826090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:32:09.854602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5faecee0>]}
[0m19:32:09.927551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fbb57e0>]}
[0m19:32:09.927965 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m19:32:09.928264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fbb5780>]}
[0m19:32:09.929493 [info ] [MainThread]: 
[0m19:32:09.929991 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:32:09.933369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV'
[0m19:32:09.942694 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV"
[0m19:32:09.943040 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV"} */
show terse schemas in database AMAZON_REVIEW_ANALYTICS_DEV
    limit 10000
[0m19:32:09.943293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:10.842652 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.899 seconds
[0m19:32:10.847559 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV: Close
[0m19:32:10.925594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV, now list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE)
[0m19:32:10.927137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m19:32:10.943132 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m19:32:10.947352 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m19:32:10.948156 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m19:32:10.948850 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m19:32:10.949516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:32:10.950138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:11.448136 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.499 seconds
[0m19:32:11.451290 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m19:32:11.460196 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.510 seconds
[0m19:32:11.463039 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m19:32:11.551075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640cb4c0>]}
[0m19:32:11.552507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:32:11.553427 [info ] [MainThread]: 
[0m19:32:11.567971 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m19:32:11.569331 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m19:32:11.570030 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:32:11.570973 [info ] [Thread-1 (]: 1 of 6 START sql table model STAGE_MART.dim_products ........................... [RUN]
[0m19:32:11.572435 [info ] [Thread-2 (]: 2 of 6 START sql table model STAGE_MART.fct_reviews ............................ [RUN]
[0m19:32:11.573471 [info ] [Thread-3 (]: 3 of 6 START sql table model STAGE_MART.fct_reviews_granular ................... [RUN]
[0m19:32:11.574390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.dim_products)
[0m19:32:11.575209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.fct_reviews)
[0m19:32:11.576053 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.fct_reviews_granular'
[0m19:32:11.576734 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m19:32:11.577464 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m19:32:11.578125 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:32:11.587807 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m19:32:11.590899 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:32:11.593972 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:32:11.596053 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m19:32:11.603233 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:32:11.603651 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m19:32:11.620551 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_products"
[0m19:32:11.622770 [debug] [Thread-3 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:32:11.624756 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:32:11.626927 [debug] [Thread-3 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:32:11.627825 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_products"
[0m19:32:11.629090 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_products"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products
         as
        (with products as (

select *,
row_number() over (
partition by product_id
order by product_id
) as rn
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta

)

select
product_id,
product_title,
brand,
price
from products
where rn = 1
        );
[0m19:32:11.628730 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.fct_reviews"
[0m19:32:11.628228 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews_granular"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular
         as
        (-- This model preserves the lowest level of granularity
-- Each row represents one review event
-- No aggregation is performed here

with reviews as (

select
reviewer_id,
product_id,
rating,
review_time,
review_year

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

)

select *
from reviews
        );
[0m19:32:11.629382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:11.629702 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.fct_reviews"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews
         as
        (with reviews as (

select
reviewer_id,
product_id,
rating,
review_time
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating
from reviews
group by product_id

)

select *
from aggregated
        );
[0m19:32:11.630034 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:32:11.630489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:32:13.726177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.095 seconds
[0m19:32:13.763696 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.fct_reviews: Close
[0m19:32:13.856901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fb32650>]}
[0m19:32:13.858450 [info ] [Thread-2 (]: 2 of 6 OK created sql table model STAGE_MART.fct_reviews ....................... [[32mSUCCESS 1[0m in 2.28s]
[0m19:32:13.860072 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m19:32:13.874670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.245 seconds
[0m19:32:13.878204 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.dim_products: Close
[0m19:32:14.007893 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.377 seconds
[0m19:32:14.012391 [debug] [Thread-3 (]: On model.capstone_amazon_analytics.fct_reviews_granular: Close
[0m19:32:14.030185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64155420>]}
[0m19:32:14.031709 [info ] [Thread-1 (]: 1 of 6 OK created sql table model STAGE_MART.dim_products ...................... [[32mSUCCESS 1[0m in 2.46s]
[0m19:32:14.033192 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m19:32:14.118075 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fb0b460>]}
[0m19:32:14.120979 [info ] [Thread-3 (]: 3 of 6 OK created sql table model STAGE_MART.fct_reviews_granular .............. [[32mSUCCESS 1[0m in 2.54s]
[0m19:32:14.122243 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:32:14.124513 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m19:32:14.125550 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:32:14.126298 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:32:14.127431 [info ] [Thread-4 (]: 4 of 6 START sql table model STAGE_MART.dim_date ............................... [RUN]
[0m19:32:14.128881 [info ] [Thread-2 (]: 5 of 6 START sql table model STAGE_MART.mart_avg_rating_by_year_brand .......... [RUN]
[0m19:32:14.131622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m19:32:14.131029 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_date'
[0m19:32:14.130117 [info ] [Thread-1 (]: 6 of 6 START sql table model STAGE_MART.mart_product_kpi ....................... [RUN]
[0m19:32:14.133296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now model.capstone_amazon_analytics.mart_product_kpi)
[0m19:32:14.132739 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m19:32:14.132158 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:32:14.133831 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m19:32:14.141502 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m19:32:14.147546 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:32:14.152079 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:32:14.155095 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m19:32:14.155990 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:32:14.159446 [debug] [Thread-4 (]: Writing runtime sql for node "model.capstone_amazon_analytics.dim_date"
[0m19:32:14.159907 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m19:32:14.163417 [debug] [Thread-2 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:32:14.167312 [debug] [Thread-1 (]: Writing runtime sql for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:32:14.168879 [debug] [Thread-4 (]: Using snowflake connection "model.capstone_amazon_analytics.dim_date"
[0m19:32:14.169830 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.dim_date"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date
         as
        (-- Date dimension built from review timestamps
-- This enables time-based analysis in BI tools

with dates as (

select distinct
--cast(review_time as date) as date_day

review_time as review_time,

-- parse date safely (force string!)
    coalesce(
      try_to_date(review_time::string, 'MM DD, YYYY'),
      try_to_date(review_time::string, 'MM D, YYYY')
    ) as date_day,
   

from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

date_enriched as (

select
date_day,
year(date_day) as year,
month(date_day) as month,
day(date_day) as day,
week(date_day) as week,
quarter(date_day) as quarter,
dayofweek(date_day) as day_of_week
from dates

)

select *
from date_enriched
        );
[0m19:32:14.171011 [debug] [Thread-2 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:32:14.171402 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:32:14.172774 [debug] [Thread-1 (]: Using snowflake connection "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:32:14.173240 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand
         as
        (with reviews_enriched as (
select
r.product_id,
r.rating,
r.review_time,
r.review_year,
p.brand
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on r.product_id = p.product_id

),

aggregated as (

select
brand,
--extract(year from review_timestamp) as review_year,
review_year,
count(*) as review_count,
avg(rating) as avg_rating
from reviews_enriched
where brand is not null
group by
brand,
review_year

)

select *
from aggregated
        );
[0m19:32:14.177094 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "node_id": "model.capstone_amazon_analytics.mart_product_kpi"} */
create or replace transient table AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi
         as
        (-- Presentation layer model
-- This model is designed specifically for QuickSight dashboards
-- Aggregations are isolated here

with reviews as (

select *
from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular

),

aggregated as (

select
product_id,
count(*) as review_count,
avg(rating) as avg_rating,
min(review_time) as first_review_date,
max(review_time) as last_review_date
from reviews
group by product_id

),

final as (

select
p.product_id,
p.product_title,
p.brand,
p.price,
a.review_count,
a.avg_rating,
a.first_review_date,
a.last_review_date
from aggregated a
left join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p
on a.product_id = p.product_id

)

select *
from final
        );
[0m19:32:14.179568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:14.179165 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:32:15.684787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.507 seconds
[0m19:32:15.688473 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.517 seconds
[0m19:32:15.691628 [debug] [Thread-2 (]: On model.capstone_amazon_analytics.mart_avg_rating_by_year_brand: Close
[0m19:32:15.693135 [debug] [Thread-4 (]: On model.capstone_amazon_analytics.dim_date: Close
[0m19:32:15.763736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5eff5510>]}
[0m19:32:15.764672 [info ] [Thread-2 (]: 5 of 6 OK created sql table model STAGE_MART.mart_avg_rating_by_year_brand ..... [[32mSUCCESS 1[0m in 1.63s]
[0m19:32:15.765460 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:32:15.798246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5eff5c60>]}
[0m19:32:15.799220 [info ] [Thread-4 (]: 4 of 6 OK created sql table model STAGE_MART.dim_date .......................... [[32mSUCCESS 1[0m in 1.67s]
[0m19:32:15.799861 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m19:32:16.080340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.900 seconds
[0m19:32:16.087049 [debug] [Thread-1 (]: On model.capstone_amazon_analytics.mart_product_kpi: Close
[0m19:32:16.151254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d1a4a-4bfe-4528-9ffc-a57c7265b0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef23820>]}
[0m19:32:16.152657 [info ] [Thread-1 (]: 6 of 6 OK created sql table model STAGE_MART.mart_product_kpi .................. [[32mSUCCESS 1[0m in 2.02s]
[0m19:32:16.153977 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:32:16.156630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:16.157447 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m19:32:16.158110 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m19:32:16.158747 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.fct_reviews_granular' was properly closed.
[0m19:32:16.159348 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.dim_date' was properly closed.
[0m19:32:16.160193 [info ] [MainThread]: 
[0m19:32:16.161016 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m19:32:16.162791 [debug] [MainThread]: Command end result
[0m19:32:16.206930 [info ] [MainThread]: 
[0m19:32:16.207478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:32:16.207830 [info ] [MainThread]: 
[0m19:32:16.208276 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:32:16.209478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4439626, "process_user_time": 3.948482, "process_kernel_time": 0.247039, "process_mem_max_rss": "202256", "process_in_blocks": "136", "process_out_blocks": "4675"}
[0m19:32:16.210052 [debug] [MainThread]: Command `dbt run` succeeded at 19:32:16.209980 after 7.44 seconds
[0m19:32:16.210437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80583f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8abdf0>]}
[0m19:32:16.210781 [debug] [MainThread]: Flushing usage events
[0m19:33:23.280560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01543a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5422f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e542290>]}


============================== 19:33:23.285803 | 698973af-8917-4437-926a-42496c5f1d72 ==============================
[0m19:33:23.285803 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:33:23.286209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt-profiles', 'send_anonymous_usage_stats': 'True'}
[0m19:33:23.782296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698973af-8917-4437-926a-42496c5f1d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0177e80>]}
[0m19:33:23.811392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698973af-8917-4437-926a-42496c5f1d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eef9780>]}
[0m19:33:23.811947 [info ] [MainThread]: Registered adapter: snowflake=1.8.2
[0m19:33:23.871413 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:33:24.012332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:24.012702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:24.041202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698973af-8917-4437-926a-42496c5f1d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e908fa0>]}
[0m19:33:24.049055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698973af-8917-4437-926a-42496c5f1d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e909210>]}
[0m19:33:24.049406 [info ] [MainThread]: Found 8 models, 7 data tests, 2 sources, 573 macros
[0m19:33:24.049729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698973af-8917-4437-926a-42496c5f1d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e909240>]}
[0m19:33:24.051018 [info ] [MainThread]: 
[0m19:33:24.051533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:24.054844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART'
[0m19:33:24.055309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE'
[0m19:33:24.067764 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"
[0m19:33:24.069728 [debug] [ThreadPool]: Using snowflake connection "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"
[0m19:33:24.070067 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART limit 10000
[0m19:33:24.070392 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE"} */
show objects in AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE limit 10000
[0m19:33:24.070639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:24.070916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:24.611496 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.540 seconds
[0m19:33:24.615890 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE: Close
[0m19:33:24.702400 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.632 seconds
[0m19:33:24.705882 [debug] [ThreadPool]: On list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART: Close
[0m19:33:24.830986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698973af-8917-4437-926a-42496c5f1d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee9f610>]}
[0m19:33:24.833430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:24.834685 [info ] [MainThread]: 
[0m19:33:24.850290 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.stg_meta
[0m19:33:24.851471 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.stg_reviews
[0m19:33:24.852486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_STAGE, now model.capstone_amazon_analytics.stg_meta)
[0m19:33:24.853444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AMAZON_REVIEW_ANALYTICS_DEV_STAGE_MART, now model.capstone_amazon_analytics.stg_reviews)
[0m19:33:24.854270 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.stg_meta
[0m19:33:24.855047 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.stg_reviews
[0m19:33:24.866776 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_meta"
[0m19:33:24.870143 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.stg_reviews"
[0m19:33:24.872461 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.stg_meta
[0m19:33:24.873352 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.stg_meta
[0m19:33:24.873757 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.stg_reviews
[0m19:33:24.874617 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_products
[0m19:33:24.875011 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:33:24.875605 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.stg_reviews
[0m19:33:24.876247 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.capstone_amazon_analytics.dim_products'
[0m19:33:24.877130 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c'
[0m19:33:24.878013 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.fct_reviews
[0m19:33:24.878336 [debug] [Thread-2 (]: Began running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:33:24.878767 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_products
[0m19:33:24.879232 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:33:24.879842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_meta, now model.capstone_amazon_analytics.fct_reviews)
[0m19:33:24.880316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.stg_reviews, now model.capstone_amazon_analytics.fct_reviews_granular)
[0m19:33:24.883827 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_products"
[0m19:33:24.894308 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c"
[0m19:33:24.894811 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews
[0m19:33:24.895209 [debug] [Thread-2 (]: Began compiling node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:33:24.898319 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews"
[0m19:33:24.900818 [debug] [Thread-2 (]: Writing injected SQL for node "model.capstone_amazon_analytics.fct_reviews_granular"
[0m19:33:24.901171 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_products
[0m19:33:24.901630 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:33:24.902719 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_products
[0m19:33:24.903185 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.fct_reviews
[0m19:33:24.904968 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.fct_reviews
[0m19:33:24.903908 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c
[0m19:33:24.904290 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:33:24.903445 [debug] [Thread-2 (]: Began executing node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:33:24.905325 [debug] [Thread-1 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:33:24.905712 [debug] [Thread-3 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:33:24.906125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_products, now test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06)
[0m19:33:24.906671 [debug] [Thread-2 (]: Finished running node model.capstone_amazon_analytics.fct_reviews_granular
[0m19:33:24.907020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews, now test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef)
[0m19:33:24.907474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c, now test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e)
[0m19:33:24.907985 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:33:24.908394 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:33:24.908888 [debug] [Thread-1 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:33:24.909276 [debug] [Thread-3 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:33:24.915087 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06"
[0m19:33:24.915507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.fct_reviews_granular, now test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d)
[0m19:33:24.918319 [debug] [Thread-1 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef"
[0m19:33:24.920981 [debug] [Thread-3 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e"
[0m19:33:24.921617 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:33:24.922111 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:33:24.924903 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d"
[0m19:33:24.925167 [debug] [Thread-1 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:33:24.925645 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06
[0m19:33:24.925868 [debug] [Thread-3 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:33:24.926513 [debug] [Thread-1 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef
[0m19:33:24.926892 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:33:24.927149 [debug] [Thread-4 (]: Began running node model.capstone_amazon_analytics.dim_date
[0m19:33:24.927596 [debug] [Thread-3 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e
[0m19:33:24.929079 [debug] [Thread-3 (]: Began running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:33:24.928456 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d
[0m19:33:24.928796 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06, now model.capstone_amazon_analytics.dim_date)
[0m19:33:24.927941 [debug] [Thread-1 (]: Began running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:33:24.930114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef, now model.capstone_amazon_analytics.mart_avg_rating_by_year_brand)
[0m19:33:24.929810 [debug] [Thread-4 (]: Began compiling node model.capstone_amazon_analytics.dim_date
[0m19:33:24.929348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e, now model.capstone_amazon_analytics.mart_product_kpi)
[0m19:33:24.932554 [debug] [Thread-3 (]: Began compiling node model.capstone_amazon_analytics.mart_product_kpi
[0m19:33:24.932261 [debug] [Thread-4 (]: Writing injected SQL for node "model.capstone_amazon_analytics.dim_date"
[0m19:33:24.930389 [debug] [Thread-1 (]: Began compiling node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:33:24.934484 [debug] [Thread-3 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_product_kpi"
[0m19:33:24.937534 [debug] [Thread-1 (]: Writing injected SQL for node "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand"
[0m19:33:24.938385 [debug] [Thread-4 (]: Began executing node model.capstone_amazon_analytics.dim_date
[0m19:33:24.939003 [debug] [Thread-4 (]: Finished running node model.capstone_amazon_analytics.dim_date
[0m19:33:24.939326 [debug] [Thread-1 (]: Began executing node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:33:24.939578 [debug] [Thread-3 (]: Began executing node model.capstone_amazon_analytics.mart_product_kpi
[0m19:33:24.940114 [debug] [Thread-1 (]: Finished running node model.capstone_amazon_analytics.mart_avg_rating_by_year_brand
[0m19:33:24.940566 [debug] [Thread-3 (]: Finished running node model.capstone_amazon_analytics.mart_product_kpi
[0m19:33:24.941026 [debug] [Thread-2 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:33:24.941283 [debug] [Thread-4 (]: Began running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:33:24.941671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d)
[0m19:33:24.942290 [debug] [Thread-2 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:33:24.941982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.capstone_amazon_analytics.dim_date, now test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001)
[0m19:33:24.945133 [debug] [Thread-4 (]: Began compiling node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:33:24.944837 [debug] [Thread-2 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d"
[0m19:33:24.947674 [debug] [Thread-4 (]: Writing injected SQL for node "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001"
[0m19:33:24.949166 [debug] [Thread-2 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:33:24.949920 [debug] [Thread-2 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d
[0m19:33:24.949533 [debug] [Thread-4 (]: Began executing node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:33:24.950417 [debug] [Thread-4 (]: Finished running node test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001
[0m19:33:24.951130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:24.951394 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d' was properly closed.
[0m19:33:24.951608 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_avg_rating_by_year_brand' was properly closed.
[0m19:33:24.951795 [debug] [MainThread]: Connection 'test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001' was properly closed.
[0m19:33:24.952000 [debug] [MainThread]: Connection 'model.capstone_amazon_analytics.mart_product_kpi' was properly closed.
[0m19:33:24.953201 [debug] [MainThread]: Command end result
[0m19:33:25.035046 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:33:25.035463 [info ] [MainThread]: Building catalog
[0m19:33:25.042646 [debug] [ThreadPool]: Acquiring new snowflake connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema'
[0m19:33:25.054245 [debug] [ThreadPool]: Using snowflake connection "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"
[0m19:33:25.054922 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "capstone_amazon_profile", "target_name": "dev", "connection_name": "AMAZON_REVIEW_ANALYTICS_DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AMAZON_REVIEW_ANALYTICS_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews_granular' and upper("table_name") = upper('fct_reviews_granular')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_product_kpi' and upper("table_name") = upper('mart_product_kpi')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_date' and upper("table_name") = upper('dim_date')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_REVIEW_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_REVIEW_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'mart_avg_rating_by_year_brand' and upper("table_name") = upper('mart_avg_rating_by_year_brand')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'CAPSTONE_AMAZON_META_RAW_TABLE' and upper("table_name") = upper('CAPSTONE_AMAZON_META_RAW_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_MART' and upper("table_schema") = upper('STAGE_MART')

                    and 
    "table_name" ilike 'fct_reviews' and upper("table_name") = upper('fct_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_reviews' and upper("table_name") = upper('stg_reviews')

                )
             or 
                (
                    
    "table_schema" ilike 'STAGE_STAGE' and upper("table_schema") = upper('STAGE_STAGE')

                    and 
    "table_name" ilike 'stg_meta' and upper("table_name") = upper('stg_meta')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:33:25.055398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:31.794212 [debug] [ThreadPool]: SQL status: SUCCESS 54 in 6.733 seconds
[0m19:33:31.824158 [debug] [ThreadPool]: On AMAZON_REVIEW_ANALYTICS_DEV.information_schema: Close
[0m19:33:32.031669 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:33:32.034897 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.78516, "process_user_time": 2.903524, "process_kernel_time": 0.268376, "process_mem_max_rss": "198992", "process_out_blocks": "5522", "process_in_blocks": "0"}
[0m19:33:32.035725 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:33:32.035617 after 8.79 seconds
[0m19:33:32.036101 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:33:32.036356 [debug] [MainThread]: Connection 'AMAZON_REVIEW_ANALYTICS_DEV.information_schema' was properly closed.
[0m19:33:32.036769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0177e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f35c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e909210>]}
[0m19:33:32.037189 [debug] [MainThread]: Flushing usage events
[0m19:33:49.410900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0603a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d44e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d44e170>]}


============================== 19:33:49.414898 | 9239974e-5838-45ef-b0f1-1377918b99cb ==============================
[0m19:33:49.414898 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:33:49.415476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt-profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/dbt-profiles --port 8085 --host 0.0.0.0', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:49.897167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9239974e-5838-45ef-b0f1-1377918b99cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d783820>]}
[0m19:33:49.925988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9239974e-5838-45ef-b0f1-1377918b99cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d8cca0>]}
[0m15:03:15.688769 [error] [MainThread]: Encountered an error:

[0m15:03:15.790304 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/airflow/.local/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:03:15.888317 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 30720.578, "process_user_time": 9.08164, "process_kernel_time": 2.761299, "process_mem_max_rss": "184936", "process_in_blocks": "176", "process_out_blocks": "2956", "command_success": false}
[0m15:03:15.908116 [debug] [MainThread]: Command `dbt docs serve` failed at 15:03:15.907345 after 30720.60 seconds
[0m15:03:15.919275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0603a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b538e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b53a90>]}
[0m15:03:15.925632 [debug] [MainThread]: Flushing usage events
