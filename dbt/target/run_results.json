{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2026-02-11T20:13:29.996876Z", "invocation_id": "d2bbd684-a52e-4ece-a57c-4386617d744a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.897782Z", "completed_at": "2026-02-11T20:13:29.908851Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.909307Z", "completed_at": "2026-02-11T20:13:29.909328Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014227628707885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.stg_meta", "compiled": true, "compiled_code": "with source as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     \n\n),\n\nrenamed as (\n\nselect\nproduct_id as product_id,\ntitle as product_title,\nbrand as brand,\ncategories as categories,\ncast(price as float) as price\nfrom source\nwhere product_id is not null\n\n)\n\nselect *\nfrom renamed", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.906144Z", "completed_at": "2026-02-11T20:13:29.909940Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.910499Z", "completed_at": "2026-02-11T20:13:29.910506Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014657735824584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.stg_reviews", "compiled": true, "compiled_code": "with source as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE\n\n),\n\nrenamed as (\n\nselect\nreview_id as review_id,\nproduct_id as product_id,\nreviewer_id as reviewer_id,\ncast(rating as integer) as rating,\nreview_text as review_text,\ncast(review_time as timestamp) as review_timestamp\nfrom source\nwhere review_id is not null\n\n)\n\nselect *\nfrom renamed", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.914197Z", "completed_at": "2026-02-11T20:13:29.928460Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.929733Z", "completed_at": "2026-02-11T20:13:29.929742Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01726055145263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.dim_products", "compiled": true, "compiled_code": "with products as (\n\nselect\nproduct_id,\nproduct_title,\nbrand,\ncategories, \nprice\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\n\n)\n\nselect *\nfrom products", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.916191Z", "completed_at": "2026-02-11T20:13:29.928863Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.930229Z", "completed_at": "2026-02-11T20:13:29.930233Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017275333404541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.925543Z", "completed_at": "2026-02-11T20:13:29.929516Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.934395Z", "completed_at": "2026-02-11T20:13:29.934402Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02082991600036621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.fct_reviews", "compiled": true, "compiled_code": "with reviews as (\n\nselect\nreview_id,\nproduct_id,\nrating,\nreview_timestamp\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n\n),\n\naggregated as (\n\nselect\nproduct_id,\ncount(*) as review_count,\navg(rating) as avg_rating\nfrom reviews\ngroup by product_id\n\n)\n\nselect *\nfrom aggregated", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.930765Z", "completed_at": "2026-02-11T20:13:29.937424Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.940693Z", "completed_at": "2026-02-11T20:13:29.940702Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01283574104309082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.unique_stg_meta_product_id.87607bd376", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.938321Z", "completed_at": "2026-02-11T20:13:29.952218Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.953850Z", "completed_at": "2026-02-11T20:13:29.953860Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0175323486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.fct_reviews_granular", "compiled": true, "compiled_code": "-- This model preserves the lowest level of granularity\n-- Each row represents one review event\n-- No aggregation is performed here\n\nwith reviews as (\n\nselect\nreview_id,\nproduct_id,\nrating,\nreview_timestamp\n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n\n)\n\nselect *\nfrom reviews", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.941713Z", "completed_at": "2026-02-11T20:13:29.953491Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.955125Z", "completed_at": "2026-02-11T20:13:29.955131Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019555091857910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rating as value_field,\n        count(*) as n_records\n\n    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n    group by rating\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','3','4','5'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.948893Z", "completed_at": "2026-02-11T20:13:29.954503Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.956309Z", "completed_at": "2026-02-11T20:13:29.956315Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018742799758911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.956885Z", "completed_at": "2026-02-11T20:13:29.962587Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.967451Z", "completed_at": "2026-02-11T20:13:29.967459Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014616727828979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.968270Z", "completed_at": "2026-02-11T20:13:29.975418Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.976885Z", "completed_at": "2026-02-11T20:13:29.976890Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01508021354675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.unique_stg_reviews_review_id.9b6c259f3c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    review_id as unique_field,\n    count(*) as n_records\n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere review_id is not null\ngroup by review_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.963585Z", "completed_at": "2026-02-11T20:13:29.974257Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.975803Z", "completed_at": "2026-02-11T20:13:29.975818Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015117645263671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_review_id.943b8fc3e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere review_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.971922Z", "completed_at": "2026-02-11T20:13:29.976341Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.977693Z", "completed_at": "2026-02-11T20:13:29.977697Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01484370231628418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.dim_date", "compiled": true, "compiled_code": "-- Date dimension built from review timestamps\n-- This enables time-based analysis in BI tools\n\nwith dates as (\n\nselect distinct\ncast(review_timestamp as date) as date_day\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular\n\n),\n\ndate_enriched as (\n\nselect\ndate_day,\nyear(date_day) as year,\nmonth(date_day) as month,\nday(date_day) as day,\nweek(date_day) as week,\nquarter(date_day) as quarter,\ndayofweek(date_day) as day_of_week\nfrom dates\n\n)\n\nselect *\nfrom date_enriched", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.978157Z", "completed_at": "2026-02-11T20:13:29.981304Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.983462Z", "completed_at": "2026-02-11T20:13:29.983467Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008661270141601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand", "compiled": true, "compiled_code": "with reviews_enriched as (\nselect\nr.product_id,\nr.rating,\nr.review_timestamp,\np.brand\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r\nleft join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p\non r.product_id = p.product_id\n\n),\n\naggregated as (\n\nselect\nbrand,\nextract(year from review_timestamp) as review_year,\ncount(*) as review_count,\navg(rating) as avg_rating\nfrom reviews_enriched\nwhere brand is not null\ngroup by\nbrand,\nreview_year\n\n)\n\nselect *\nfrom aggregated", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.981547Z", "completed_at": "2026-02-11T20:13:29.985439Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.986465Z", "completed_at": "2026-02-11T20:13:29.986471Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0062255859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.mart_product_kpi", "compiled": true, "compiled_code": "-- Presentation layer model\n-- This model is designed specifically for QuickSight dashboards\n-- Aggregations are isolated here\n\nwith reviews as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular\n\n),\n\naggregated as (\n\nselect\nproduct_id,\ncount(*) as review_count,\navg(rating) as avg_rating,\nmin(review_timestamp) as first_review_date,\nmax(review_timestamp) as last_review_date\nfrom reviews\ngroup by product_id\n\n),\n\nfinal as (\n\nselect\np.product_id,\np.product_title,\np.brand,\np.categories,\np.price,\na.review_count,\na.avg_rating,\na.first_review_date,\na.last_review_date\nfrom aggregated a\nleft join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p\non a.product_id = p.product_id\n\n)\n\nselect *\nfrom final", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.986984Z", "completed_at": "2026-02-11T20:13:29.993769Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.994341Z", "completed_at": "2026-02-11T20:13:29.994347Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009659290313720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect brand\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand\nwhere brand is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T20:13:29.990270Z", "completed_at": "2026-02-11T20:13:29.994094Z"}, {"name": "execute", "started_at": "2026-02-11T20:13:29.994921Z", "completed_at": "2026-02-11T20:13:29.994924Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00982975959777832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_year\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand\nwhere review_year is null\n\n\n", "relation_name": null}], "elapsed_time": 0.6209394931793213, "args": {"send_anonymous_usage_stats": true, "cache_selected_only": false, "quiet": false, "vars": {}, "write_json": true, "use_colors_file": true, "invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt-profiles", "log_format": "default", "require_resource_names_without_spaces": false, "static_parser": true, "populate_cache": true, "log_level_file": "debug", "partial_parse": true, "favor_state": false, "version_check": true, "which": "generate", "print": true, "profiles_dir": "/opt/airflow/dbt-profiles", "partial_parse_file_diff": true, "project_dir": "/opt/airflow/dbt", "printer_width": 80, "log_format_file": "debug", "use_colors": true, "defer": false, "select": [], "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "empty_catalog": false, "log_path": "/opt/airflow/dbt/logs", "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "static": false, "exclude": [], "introspect": true, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "log_level": "info", "indirect_selection": "eager", "compile": true, "enable_legacy_logger": false}}