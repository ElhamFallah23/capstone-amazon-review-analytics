{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2026-02-16T19:33:24.952199Z", "invocation_id": "698973af-8917-4437-926a-42496c5f1d72", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.855578Z", "completed_at": "2026-02-16T19:33:24.872319Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.872882Z", "completed_at": "2026-02-16T19:33:24.872898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020864248275756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.stg_meta", "compiled": true, "compiled_code": "with source as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     \n\n),\n\nrenamed as (\n\nselect\nproduct_id as product_id,\ntitle as product_title,\nbrand as brand,\ntry_to_number(regexp_replace(price, '[^0-9.]', '')) as price\nfrom source\nwhere product_id is not null\n\n)\n\nselect *\nfrom renamed", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.867275Z", "completed_at": "2026-02-16T19:33:24.873625Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.875259Z", "completed_at": "2026-02-16T19:33:24.875268Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022124290466308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.stg_reviews", "compiled": true, "compiled_code": "with source as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE\n\n),\n\nrenamed as (\n\nselect\n\n\n\nproduct_id as product_id,\nreviewer_id as reviewer_id,\n\ncast(rating as integer) as rating,\nreview_text as review_text,\n  \n    -- keep raw string\n    review_time as review_time,\n    -- parse date safely (force string!)\n    coalesce(\n      try_to_date(review_time::string, 'MM DD, YYYY'),\n      try_to_date(review_time::string, 'MM D, YYYY')\n    ) as review_date,\n    year(\n      coalesce(\n        try_to_date(review_time::string, 'MM DD, YYYY'),\n        try_to_date(review_time::string, 'MM D, YYYY')\n      )\n    ) as review_year\n\nfrom source\n--where review_id is not null\n\n)\n\nselect *\nfrom renamed", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.880712Z", "completed_at": "2026-02-16T19:33:24.901077Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.902391Z", "completed_at": "2026-02-16T19:33:24.902404Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026478290557861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.dim_products", "compiled": true, "compiled_code": "with products as (\n\nselect *,\nrow_number() over (\npartition by product_id\norder by product_id\n) as rn\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\n\n)\n\nselect\nproduct_id,\nproduct_title,\nbrand,\nprice\nfrom products\nwhere rn = 1", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.896150Z", "completed_at": "2026-02-16T19:33:24.903101Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.904608Z", "completed_at": "2026-02-16T19:33:24.904614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025007963180541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.fct_reviews", "compiled": true, "compiled_code": "with reviews as (\n\nselect\nreviewer_id,\nproduct_id,\nrating,\nreview_time\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n\n),\n\naggregated as (\n\nselect\nproduct_id,\ncount(*) as review_count,\navg(rating) as avg_rating\nfrom reviews\ngroup by product_id\n\n)\n\nselect *\nfrom aggregated", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.884374Z", "completed_at": "2026-02-16T19:33:24.901544Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.903637Z", "completed_at": "2026-02-16T19:33:24.903643Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0267946720123291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.898764Z", "completed_at": "2026-02-16T19:33:24.903363Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.906424Z", "completed_at": "2026-02-16T19:33:24.906430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02631354331970215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.fct_reviews_granular", "compiled": true, "compiled_code": "-- This model preserves the lowest level of granularity\n-- Each row represents one review event\n-- No aggregation is performed here\n\nwith reviews as (\n\nselect\nreviewer_id,\nproduct_id,\nrating,\nreview_time,\nreview_year\n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n\n)\n\nselect *\nfrom reviews", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.909548Z", "completed_at": "2026-02-16T19:33:24.922029Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.925406Z", "completed_at": "2026-02-16T19:33:24.925413Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019459962844848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rating as value_field,\n        count(*) as n_records\n\n    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n    group by rating\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','3','4','5'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.915803Z", "completed_at": "2026-02-16T19:33:24.925091Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.926282Z", "completed_at": "2026-02-16T19:33:24.926288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01941967010498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.918654Z", "completed_at": "2026-02-16T19:33:24.925812Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.927389Z", "completed_at": "2026-02-16T19:33:24.927393Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020087003707885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.922597Z", "completed_at": "2026-02-16T19:33:24.926824Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.928251Z", "completed_at": "2026-02-16T19:33:24.928256Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012907981872558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere reviewer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.930624Z", "completed_at": "2026-02-16T19:33:24.938301Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.938719Z", "completed_at": "2026-02-16T19:33:24.938727Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010111093521118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.dim_date", "compiled": true, "compiled_code": "-- Date dimension built from review timestamps\n-- This enables time-based analysis in BI tools\n\nwith dates as (\n\nselect distinct\n--cast(review_time as date) as date_day\n\nreview_time as review_time,\n\n-- parse date safely (force string!)\n    coalesce(\n      try_to_date(review_time::string, 'MM DD, YYYY'),\n      try_to_date(review_time::string, 'MM D, YYYY')\n    ) as date_day,\n   \n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular\n\n),\n\ndate_enriched as (\n\nselect\ndate_day,\nyear(date_day) as year,\nmonth(date_day) as month,\nday(date_day) as day,\nweek(date_day) as week,\nquarter(date_day) as quarter,\ndayofweek(date_day) as day_of_week\nfrom dates\n\n)\n\nselect *\nfrom date_enriched", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.935118Z", "completed_at": "2026-02-16T19:33:24.939253Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.939897Z", "completed_at": "2026-02-16T19:33:24.939902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009936094284057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand", "compiled": true, "compiled_code": "with reviews_enriched as (\nselect\nr.product_id,\nr.rating,\nr.review_time,\nr.review_year,\np.brand\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r\nleft join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p\non r.product_id = p.product_id\n\n),\n\naggregated as (\n\nselect\nbrand,\n--extract(year from review_timestamp) as review_year,\nreview_year,\ncount(*) as review_count,\navg(rating) as avg_rating\nfrom reviews_enriched\nwhere brand is not null\ngroup by\nbrand,\nreview_year\n\n)\n\nselect *\nfrom aggregated", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.932746Z", "completed_at": "2026-02-16T19:33:24.939497Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.940366Z", "completed_at": "2026-02-16T19:33:24.940371Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011147022247314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.mart_product_kpi", "compiled": true, "compiled_code": "-- Presentation layer model\n-- This model is designed specifically for QuickSight dashboards\n-- Aggregations are isolated here\n\nwith reviews as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular\n\n),\n\naggregated as (\n\nselect\nproduct_id,\ncount(*) as review_count,\navg(rating) as avg_rating,\nmin(review_time) as first_review_date,\nmax(review_time) as last_review_date\nfrom reviews\ngroup by product_id\n\n),\n\nfinal as (\n\nselect\np.product_id,\np.product_title,\np.brand,\np.price,\na.review_count,\na.avg_rating,\na.first_review_date,\na.last_review_date\nfrom aggregated a\nleft join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p\non a.product_id = p.product_id\n\n)\n\nselect *\nfrom final", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.942469Z", "completed_at": "2026-02-16T19:33:24.949077Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.949682Z", "completed_at": "2026-02-16T19:33:24.949688Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008179187774658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect brand\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand\nwhere brand is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-16T19:33:24.945343Z", "completed_at": "2026-02-16T19:33:24.949449Z"}, {"name": "execute", "started_at": "2026-02-16T19:33:24.950212Z", "completed_at": "2026-02-16T19:33:24.950216Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008373260498046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_year\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand\nwhere review_year is null\n\n\n", "relation_name": null}], "elapsed_time": 0.9008345603942871, "args": {"show_resource_report": false, "version_check": true, "print": true, "static_parser": true, "log_level_file": "debug", "project_dir": "/opt/airflow/dbt", "exclude": [], "require_resource_names_without_spaces": false, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false, "static": false, "write_json": true, "log_level": "info", "strict_mode": false, "which": "generate", "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt-profiles", "indirect_selection": "eager", "partial_parse": true, "populate_cache": true, "select": [], "partial_parse_file_diff": true, "log_format_file": "debug", "introspect": true, "empty_catalog": false, "compile": true, "enable_legacy_logger": false, "use_colors_file": true, "log_path": "/opt/airflow/dbt/logs", "profiles_dir": "/opt/airflow/dbt-profiles", "quiet": false, "favor_state": false, "send_anonymous_usage_stats": true, "log_format": "default", "vars": {}, "use_colors": true, "defer": false, "cache_selected_only": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true}}