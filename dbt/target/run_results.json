{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2026-02-13T11:37:20.900884Z", "invocation_id": "50ddf386-0f73-4d66-8723-fb358bd3ab02", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.800005Z", "completed_at": "2026-02-13T11:37:20.814794Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.815415Z", "completed_at": "2026-02-13T11:37:20.815432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018047809600830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.stg_meta", "compiled": true, "compiled_code": "with source as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_META_RAW_TABLE     \n\n),\n\nrenamed as (\n\nselect\nproduct_id as product_id,\ntitle as product_title,\nbrand as brand,\ntry_to_number(regexp_replace(price, '[^0-9.]', '')) as price\nfrom source\nwhere product_id is not null\n\n)\n\nselect *\nfrom renamed", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.810293Z", "completed_at": "2026-02-13T11:37:20.816185Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.818083Z", "completed_at": "2026-02-13T11:37:20.818094Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01991724967956543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.stg_reviews", "compiled": true, "compiled_code": "with source as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.RAW.CAPSTONE_AMAZON_REVIEW_RAW_TABLE\n\n),\n\nrenamed as (\n\nselect\n\n\n\nproduct_id as product_id,\nreviewer_id as reviewer_id,\n\ncast(rating as integer) as rating,\nreview_text as review_text,\n  \n    -- keep raw string\n    review_time as review_time,\n    -- parse date safely (force string!)\n    coalesce(\n      try_to_date(review_time::string, 'MM DD, YYYY'),\n      try_to_date(review_time::string, 'MM D, YYYY')\n    ) as review_date,\n    year(\n      coalesce(\n        try_to_date(review_time::string, 'MM DD, YYYY'),\n        try_to_date(review_time::string, 'MM D, YYYY')\n      )\n    ) as review_year\n\nfrom source\n--where review_id is not null\n\n)\n\nselect *\nfrom renamed", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.824108Z", "completed_at": "2026-02-13T11:37:20.847122Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.848340Z", "completed_at": "2026-02-13T11:37:20.848351Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029391050338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.dim_products", "compiled": true, "compiled_code": "with products as (\n\nselect *,\nrow_number() over (\npartition by product_id\norder by product_id\n) as rn\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\n\n)\n\nselect\nproduct_id,\nproduct_title,\nbrand,\nprice\nfrom products\nwhere rn = 1", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.827924Z", "completed_at": "2026-02-13T11:37:20.847542Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.849279Z", "completed_at": "2026-02-13T11:37:20.849286Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02949690818786621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_meta_product_id.9fa0f11d0c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_meta\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.844630Z", "completed_at": "2026-02-13T11:37:20.849787Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.851752Z", "completed_at": "2026-02-13T11:37:20.851759Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011939525604248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.fct_reviews_granular", "compiled": true, "compiled_code": "-- This model preserves the lowest level of granularity\n-- Each row represents one review event\n-- No aggregation is performed here\n\nwith reviews as (\n\nselect\nreviewer_id,\nproduct_id,\nrating,\nreview_time,\nreview_year\n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n\n)\n\nselect *\nfrom reviews", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.841577Z", "completed_at": "2026-02-13T11:37:20.848897Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.850637Z", "completed_at": "2026-02-13T11:37:20.850644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02769923210144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.fct_reviews", "compiled": true, "compiled_code": "with reviews as (\n\nselect\nreviewer_id,\nproduct_id,\nrating,\nreview_time\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n\n),\n\naggregated as (\n\nselect\nproduct_id,\ncount(*) as review_count,\navg(rating) as avg_rating\nfrom reviews\ngroup by product_id\n\n)\n\nselect *\nfrom aggregated", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.855836Z", "completed_at": "2026-02-13T11:37:20.872834Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.873997Z", "completed_at": "2026-02-13T11:37:20.874006Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020540952682495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_product_id.0f400ff2ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.861014Z", "completed_at": "2026-02-13T11:37:20.873178Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.874592Z", "completed_at": "2026-02-13T11:37:20.874597Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020569562911987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.accepted_values_stg_reviews_rating__1__2__3__4__5.0037ac3b06", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rating as value_field,\n        count(*) as n_records\n\n    from AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\n    group by rating\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','3','4','5'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.866154Z", "completed_at": "2026-02-13T11:37:20.873706Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.875276Z", "completed_at": "2026-02-13T11:37:20.875281Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020743131637573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_rating.b94d4a057e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere rating is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.869149Z", "completed_at": "2026-02-13T11:37:20.874970Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.876526Z", "completed_at": "2026-02-13T11:37:20.876531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02149367332458496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_stg_reviews_reviewer_id.85e230bf6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_id\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_STAGE.stg_reviews\nwhere reviewer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.879249Z", "completed_at": "2026-02-13T11:37:20.886953Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.887466Z", "completed_at": "2026-02-13T11:37:20.887475Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010319948196411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.mart_product_kpi", "compiled": true, "compiled_code": "-- Presentation layer model\n-- This model is designed specifically for QuickSight dashboards\n-- Aggregations are isolated here\n\nwith reviews as (\n\nselect *\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular\n\n),\n\naggregated as (\n\nselect\nproduct_id,\ncount(*) as review_count,\navg(rating) as avg_rating,\nmin(review_time) as first_review_date,\nmax(review_time) as last_review_date\nfrom reviews\ngroup by product_id\n\n),\n\nfinal as (\n\nselect\np.product_id,\np.product_title,\np.brand,\np.price,\na.review_count,\na.avg_rating,\na.first_review_date,\na.last_review_date\nfrom aggregated a\nleft join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p\non a.product_id = p.product_id\n\n)\n\nselect *\nfrom final", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_product_kpi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.881498Z", "completed_at": "2026-02-13T11:37:20.887939Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.888588Z", "completed_at": "2026-02-13T11:37:20.888593Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011039972305297852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.mart_avg_rating_by_year_brand", "compiled": true, "compiled_code": "with reviews_enriched as (\nselect\nr.product_id,\nr.rating,\nr.review_time,\nr.review_year,\np.brand\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular r\nleft join AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_products p\non r.product_id = p.product_id\n\n),\n\naggregated as (\n\nselect\nbrand,\n--extract(year from review_timestamp) as review_year,\nreview_year,\ncount(*) as review_count,\navg(rating) as avg_rating\nfrom reviews_enriched\nwhere brand is not null\ngroup by\nbrand,\nreview_year\n\n)\n\nselect *\nfrom aggregated", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.883456Z", "completed_at": "2026-02-13T11:37:20.888317Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.889688Z", "completed_at": "2026-02-13T11:37:20.889691Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01166987419128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.capstone_amazon_analytics.dim_date", "compiled": true, "compiled_code": "-- Date dimension built from review timestamps\n-- This enables time-based analysis in BI tools\n\nwith dates as (\n\nselect distinct\n--cast(review_time as date) as date_day\n\nreview_time as review_time,\n\n-- parse date safely (force string!)\n    coalesce(\n      try_to_date(review_time::string, 'MM DD, YYYY'),\n      try_to_date(review_time::string, 'MM D, YYYY')\n    ) as date_day,\n   \n\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.fct_reviews_granular\n\n),\n\ndate_enriched as (\n\nselect\ndate_day,\nyear(date_day) as year,\nmonth(date_day) as month,\nday(date_day) as day,\nweek(date_day) as week,\nquarter(date_day) as quarter,\ndayofweek(date_day) as day_of_week\nfrom dates\n\n)\n\nselect *\nfrom date_enriched", "relation_name": "AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.dim_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.891431Z", "completed_at": "2026-02-13T11:37:20.897297Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.897789Z", "completed_at": "2026-02-13T11:37:20.897797Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007439613342285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_review_year.47fb43c001", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_year\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand\nwhere review_year is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-13T11:37:20.894228Z", "completed_at": "2026-02-13T11:37:20.898279Z"}, {"name": "execute", "started_at": "2026-02-13T11:37:20.898693Z", "completed_at": "2026-02-13T11:37:20.898697Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00863504409790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.capstone_amazon_analytics.not_null_mart_avg_rating_by_year_brand_brand.66d9c2825d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect brand\nfrom AMAZON_REVIEW_ANALYTICS_DEV.STAGE_MART.mart_avg_rating_by_year_brand\nwhere brand is null\n\n\n", "relation_name": null}], "elapsed_time": 0.6799116134643555, "args": {"invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt-profiles", "use_colors_file": true, "vars": {}, "strict_mode": false, "which": "generate", "log_format": "default", "exclude": [], "source_freshness_run_project_hooks": false, "static_parser": true, "use_colors": true, "macro_debugging": false, "profiles_dir": "/opt/airflow/dbt-profiles", "select": [], "version_check": true, "log_level": "info", "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "log_path": "/opt/airflow/dbt/logs", "indirect_selection": "eager", "log_format_file": "debug", "favor_state": false, "compile": true, "project_dir": "/opt/airflow/dbt", "require_resource_names_without_spaces": false, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "write_json": true, "log_file_max_bytes": 10485760, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "quiet": false, "cache_selected_only": false, "introspect": true, "enable_legacy_logger": false, "log_level_file": "debug", "printer_width": 80, "empty_catalog": false, "show_resource_report": false, "static": false}}